---
phase: 01-audit-assessment
plan: 02
type: execute
depends_on: []
files_modified: [.planning/phases/01-audit-assessment/01-02-SUMMARY.md]
---

<objective>
Audit extraction and template generation scripts — understand the existing translation workflow code.

Purpose: Map the actual code paths for the extract → generate → translate workflow to identify what's reusable vs needs rebuilding.
Output: Detailed documentation of script patterns, shared code, redundancies, and workflow gaps.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/ARCHITECTURE.md
@.planning/codebase/CONCERNS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Read and document all check-*.ts, create-*-en.ts, and utility scripts</name>
  <files>.planning/phases/01-audit-assessment/01-02-SUMMARY.md</files>
  <action>
  1. Read 3-5 representative `check-*.ts` files from `ADVISORI Sanity Migration/`. For each document:
     - What does it check? (page existence, content fields, specific page?)
     - How does it connect to Sanity? (hardcoded client vs import vs env vars)
     - What does it output?
     - Is it generic/reusable or page-specific?
  2. Read 3-5 representative `create-*-en.ts` files. For each document:
     - Structure: how is the English content defined?
     - Sanity operations: createOrReplace? create? patch?
     - Does it handle FAQs inline or via separate batch files?
     - Does it set i18n fields (__i18n_lang, __i18n_base)?
     - Are slugs correctly formatted with -en suffix?
  3. Look for any shared utility code — imported modules, helper functions, common patterns
  4. Identify redundancies: are there duplicated patterns that should be abstracted?
  5. Check the `translation-batch/` template files — how do they differ from the `create-*-en.ts` pattern?

  This is READ-ONLY analysis. Do not modify any files.
  </action>
  <verify>At least 3 check scripts and 3 create scripts analyzed. Pattern summary covers: Sanity client setup, content structure, i18n fields, slug format, FAQ handling.</verify>
  <done>Detailed pattern analysis with code examples, identifying what's reusable, redundant, and missing</done>
</task>

<task type="auto">
  <name>Task 2: Test the extraction and template generation workflow</name>
  <files>.planning/phases/01-audit-assessment/01-02-SUMMARY.md</files>
  <action>
  1. Look for extraction scripts — search for files containing GROQ queries or `client.fetch`:
     - In `ADVISORI Sanity Migration/` directory
     - In root directory
     - In `translation-batch/` directory
  2. Look for template generation scripts — files that read German JSON and produce TypeScript templates
  3. Read the `translation-batch/batch-summary.json` to understand the batch generation output
  4. Read one German JSON source file (e.g., from translation-batch/) and one corresponding template to understand the transformation
  5. Document the actual data flow:
     - What fields are extracted from Sanity?
     - How are they transformed into the template?
     - What fields require translation vs pass-through?
     - What's the FAQ structure (how are batches split)?
  6. Identify gaps: what parts of the workflow are missing or broken?

  READ-ONLY. Do not execute extraction scripts against Sanity.
  </action>
  <verify>Data flow documented from Sanity → JSON → template → translation file. Gaps identified.</verify>
  <done>Complete workflow documentation showing extraction → generation → translation data flow with identified gaps</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] check-*.ts pattern documented with examples
- [ ] create-*-en.ts pattern documented with examples
- [ ] Extraction workflow mapped
- [ ] Template generation workflow mapped
- [ ] Redundancies and shared patterns identified
- [ ] Gaps documented
</verification>

<success_criteria>

- Clear understanding of existing code patterns
- Reusable vs page-specific scripts identified
- Data flow from Sanity → JSON → template → translation documented
- Gaps and missing automation steps identified
</success_criteria>

<output>
After completion, create `.planning/phases/01-audit-assessment/01-02-SUMMARY.md`
</output>
