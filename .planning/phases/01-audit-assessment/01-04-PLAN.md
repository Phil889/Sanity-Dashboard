---
phase: 01-audit-assessment
plan: 04
type: execute
depends_on: []
files_modified: [.planning/phases/01-audit-assessment/01-04-SUMMARY.md]
---

<objective>
Map Sanity schema and i18n document structure by querying the live CMS.

Purpose: Understand the actual Sanity data model â€” what fields exist, how i18n linking works in practice, and what the servicePage schema looks like.
Output: Complete documentation of the servicePage schema and i18n linking mechanism.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/INTEGRATIONS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Query Sanity API to inspect servicePage schema and field structure</name>
  <files>.planning/phases/01-audit-assessment/01-04-SUMMARY.md</files>
  <action>
  1. Create a temporary TypeScript script that queries Sanity to inspect the servicePage schema:
     - Fetch one German servicePage document with ALL fields (no field filtering)
     - Fetch one English servicePage document with ALL fields
     - Use GROQ: `*[_type == "servicePage" && language == "de"][0]` and `*[_type == "servicePage" && language == "en"][0]`
  2. Document EVERY field on both documents:
     - Field name, type, example value (truncated if long)
     - Which fields are required vs optional
     - Which fields contain references (_ref)
     - Which fields are arrays (and their item structure)
  3. Specifically identify:
     - How is language stored? (language field? __i18n_lang? both?)
     - What's the slug structure for German vs English pages?
     - How are parent/child relationships defined?
     - What's the references structure (topLevelParent)?
     - How are FAQs structured (inline array? separate documents?)
     - What's the SEO structure?
     - What's the heroSection structure?
  4. Run the script via `npx tsx`, capture output, then delete the temporary script

  READ-ONLY queries only. Do not create or modify Sanity documents.
  </action>
  <verify>Both German and English document schemas captured. All fields documented with types.</verify>
  <done>Complete servicePage field inventory for both German and English documents</done>
</task>

<task type="auto">
  <name>Task 2: Map the i18n linking mechanism between German and English documents</name>
  <files>.planning/phases/01-audit-assessment/01-04-SUMMARY.md</files>
  <action>
  1. Create a temporary script to investigate i18n linking:
     - Find a German page that HAS an English translation linked
     - Query both documents and compare their i18n fields
     - GROQ: `*[_type == "servicePage" && language == "de" && defined(__i18n_refs)][0]{..., "__i18n_refs": __i18n_refs[]->{ _id, slug, language }}`
  2. Document the linking mechanism:
     - Does the German doc have __i18n_refs pointing to English?
     - Does the English doc have __i18n_base pointing to German?
     - Is __i18n_lang used? What values?
     - Are there any other i18n-related fields?
     - Is the linking bidirectional or one-directional?
  3. Check for unlinked translations:
     - Are there English pages that exist but aren't linked to their German counterpart?
     - Are there German pages with __i18n_refs that point to non-existent English pages?
  4. Document the exact steps needed to properly link a new English translation:
     - What fields to set on the English document
     - What fields to patch on the German document
     - What order (create English first, then patch German? Or both at once?)
  5. Run the script, capture output, delete the temporary script

  READ-ONLY queries only.
  </action>
  <verify>i18n linking pattern documented with real examples. Linking steps defined.</verify>
  <done>Complete i18n linking documentation: fields, direction, steps to create a properly linked translation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] servicePage schema fully documented (all fields, types, structure)
- [ ] German vs English document differences mapped
- [ ] i18n linking mechanism documented with real examples
- [ ] Steps to properly link translations defined
- [ ] Unlinked translations identified (if any)
</verification>

<success_criteria>

- Exact servicePage schema known with all fields
- i18n linking mechanism fully understood
- Clear documentation of what fields to set when creating and linking a translation
- Foundation for Phase 4 (detection) and Phase 9 (linking) established
</success_criteria>

<output>
After completion, create `.planning/phases/01-audit-assessment/01-04-SUMMARY.md`
</output>
