import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Business Continuity Management Process page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'business-continuity-management-process' })
    
    if (!existingDoc) {
      throw new Error('Document "business-continuity-management-process" not found')
    }
    
    // Create new FAQs for BCM Process fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was sind Business Continuity Management Prozesse und welche strukturellen Komponenten umfassen sie?',
        answer: "Business Continuity Management Prozesse sind systematische, wiederholbare Methodiken zur strukturierten Sicherstellung der Gesch√§ftskontinuit√§t. Sie transformieren strategische BCM-Konzepte in operative Workflows und schaffen die Grundlage f√ºr reproduzierbare Resilienz-Exzellenz durch integrierte Prozessarchitekturen.\n\nüèóÔ∏è Prozessarchitektur und strukturelle Grundlagen:\n‚Ä¢ Hierarchische Prozessstrukturen mit strategischen, taktischen und operativen Ebenen f√ºr klare Verantwortlichkeiten\n‚Ä¢ Modulare Workflow-Designs erm√∂glichen flexible Anpassung an verschiedene St√∂rungsszenarien und Organisationsbereiche\n‚Ä¢ Standardisierte Prozessdokumentation gew√§hrleistet Konsistenz und erleichtert Verst√§ndnis unter Zeitdruck\n‚Ä¢ Integrierte Entscheidungsb√§ume f√ºhren systematisch durch kritische Prozessschritte und Handlungsoptionen\n‚Ä¢ Cross-referenzierte Prozesslandkarten bieten schnellen Zugriff auf ben√∂tigte Workflow-Informationen\n\n‚öôÔ∏è Operative Workflow-Komponenten:\n‚Ä¢ Business Impact Analysis Prozesse definieren kritische Workflows und deren Wiederherstellungszeiten\n‚Ä¢ Priorisierungsmatrizen strukturieren Ressourcenallokation basierend auf Prozesskritikalit√§t\n‚Ä¢ Abh√§ngigkeitsmapping visualisiert Interdependenzen zwischen verschiedenen Gesch√§ftsprozessen\n‚Ä¢ Service Level Agreement Prozesse definieren minimale Betriebsanforderungen f√ºr kritische Workflows\n‚Ä¢ Eskalationsprozesse regeln Entscheidungsbefugnisse bei verschiedenen St√∂rungsgraden\n\nüîÑ Aktivierungs- und Steuerungsmechanismen:\n‚Ä¢ Klare Aktivierungskriterien definieren wann und wie Prozesse in Kraft treten\n‚Ä¢ Prozess-Governance-Strukturen f√ºhren durch komplexe Situationsbewertungen und Handlungsoptionen\n‚Ä¢ Kommunikationsprozesse gew√§hrleisten zeitnahe Information aller relevanten Stakeholder\n‚Ä¢ Rollback-Mechanismen erm√∂glichen kontrollierte R√ºckkehr zu Normalbetriebsprozessen\n‚Ä¢ Dokumentationsprozesse sichern Nachvollziehbarkeit aller getroffenen Ma√ünahmen\n\nüë• Rollen- und Verantwortlichkeits-Prozesse:\n‚Ä¢ Crisis Management Prozesse mit definierten Rollen und Entscheidungsbefugnissen\n‚Ä¢ Fachbereichsprozesse f√ºr spezifische Wiederherstellungsaktivit√§ten\n‚Ä¢ Kommunikationsprozesse f√ºr interne und externe Stakeholder-Information\n‚Ä¢ Technische Prozesse f√ºr IT-Systeme und Infrastruktur-Wiederherstellung\n‚Ä¢ Externe Dienstleister-Integration in Wiederherstellungsprozesse\n\nüìû Kommunikations- und Koordinationsprozesse:\n‚Ä¢ Mehrstufige Kommunikationsprozesse f√ºr verschiedene Zielgruppen und Situationen\n‚Ä¢ Alternative Kommunikationskan√§le f√ºr den Fall von Infrastrukturausf√§llen\n‚Ä¢ Stakeholder-spezifische Messaging-Prozesse f√ºr konsistente Kommunikation\n‚Ä¢ Medien- und √ñffentlichkeitsarbeit-Prozesse zum Schutz der Reputation\n‚Ä¢ Regelm√§√üige Status-Update-Prozesse und Fortschrittsberichte w√§hrend der Krisenbew√§ltigung\n\nüõ†Ô∏è Ressourcen- und Infrastruktur-Prozesse:\n‚Ä¢ Detaillierte Inventarisierungsprozesse kritischer Ressourcen und deren Verf√ºgbarkeit\n‚Ä¢ Alternative Arbeitsplatz-Prozesse und Backup-Standort-Aktivierung\n‚Ä¢ Technologie-Ressourcen-Prozesse einschlie√ülich Hardware, Software und Datenbackups\n‚Ä¢ Externe Dienstleister-Prozesse und Lieferanten f√ºr kritische Unterst√ºtzungsleistungen\n‚Ä¢ Finanzielle Ressourcen-Prozesse und Budgetfreigaben f√ºr Notfallma√ünahmen\n\nüìä Monitoring- und Fortschrittsverfolgungsprozesse:\n‚Ä¢ Key Performance Indicator Prozesse zur Messung der Wiederherstellungseffektivit√§t\n‚Ä¢ Echtzeit-Dashboard-Prozesse f√ºr kontinuierliche Situations√ºberwachung\n‚Ä¢ Meilenstein-Tracking-Prozesse f√ºr systematische Fortschrittskontrolle\n‚Ä¢ Qualit√§tssicherungs-Prozesse zur Validierung wiederhergestellter Funktionen\n‚Ä¢ Lessons-Learned-Prozesse f√ºr kontinuierliche Prozessverbesserung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie erfolgt die systematische Entwicklung und Strukturierung effektiver BCM-Prozesse?',
        answer: "Die systematische Entwicklung von BCM-Prozessen erfordert einen methodischen Ansatz, der organisationsspezifische Anforderungen mit bew√§hrten Prozess-Standards verbindet. Ein strukturierter Entwicklungsprozess gew√§hrleistet Vollst√§ndigkeit, Konsistenz und operative Wirksamkeit der resultierenden Prozessarchitektur.\n\nüîç Anforderungsanalyse und Prozess-Scope-Definition:\n‚Ä¢ Comprehensive Business Impact Analysis identifiziert kritische Gesch√§ftsprozesse und deren Abh√§ngigkeiten\n‚Ä¢ Process Risk Assessment bewertet potenzielle Bedrohungen und deren Auswirkungen auf verschiedene Workflows\n‚Ä¢ Stakeholder-Mapping erfasst alle relevanten internen und externen Prozessbeteiligten\n‚Ä¢ Regulatory Requirements Analysis ber√ºcksichtigt branchenspezifische Compliance-Prozessanforderungen\n‚Ä¢ Organisational Context Review analysiert Unternehmenskultur, Struktur und verf√ºgbare Prozessressourcen\n\nüìê Prozessarchitektur und Design-Prinzipien:\n‚Ä¢ Modularer Prozessaufbau erm√∂glicht flexible Anpassung an verschiedene St√∂rungsszenarien\n‚Ä¢ Hierarchische Prozessstruktur trennt strategische Entscheidungen von operativen Ma√ünahmen\n‚Ä¢ Standardisierte Prozess-Templates gew√§hrleisten Konsistenz √ºber verschiedene Gesch√§ftsbereiche\n‚Ä¢ Cross-funktionale Prozess-Integration verbindet verschiedene Organisationseinheiten\n‚Ä¢ Skalierbare Prozessstrukturen unterst√ºtzen sowohl lokale als auch unternehmensweite St√∂rungen\n\nüìù Prozess-Inhaltsentwicklung und Dokumentationsstandards:\n‚Ä¢ Strukturierte Informationssammlung durch systematische Interviews und Workshops\n‚Ä¢ Collaborative Process Creation mit allen relevanten Fachbereichen und Stakeholdern\n‚Ä¢ Standardisierte Prozessdokumentationsformate f√ºr einheitliche Darstellung und Verst√§ndlichkeit\n‚Ä¢ Version Control Mechanismen f√ºr nachvollziehbare Prozessentwicklung und √Ñnderungsverfolgung\n‚Ä¢ Quality Assurance Prozesse zur Validierung von Vollst√§ndigkeit und Genauigkeit\n\nüéØ Szenario-basierte Prozessentwicklung:\n‚Ä¢ Multiple Scenario Planning f√ºr verschiedene St√∂rungstypen und Schweregrade\n‚Ä¢ Worst-Case-Analysen zur Vorbereitung auf extreme Situationen\n‚Ä¢ Cascading Failure Modeling f√ºr komplexe Interdependenz-Szenarien\n‚Ä¢ Recovery Time Objective Definition f√ºr verschiedene Kritikalit√§tsstufen\n‚Ä¢ Alternative Strategy Development f√ºr verschiedene Ressourcenverf√ºgbarkeiten\n\nüîó Prozess-Integration und Koordination:\n‚Ä¢ Cross-departmental Alignment gew√§hrleistet organisationsweite Konsistenz\n‚Ä¢ External Stakeholder Integration bindet Lieferanten, Partner und Dienstleister ein\n‚Ä¢ Technology Integration verbindet BCM-Prozesse mit IT-Disaster-Recovery-Strategien\n‚Ä¢ Regulatory Compliance Mapping stellt Einhaltung aller relevanten Vorschriften sicher\n‚Ä¢ Corporate Strategy Alignment verbindet BCM-Prozesse mit Unternehmenszielen\n\n‚úÖ Prozess-Validierung und Qualit√§tssicherung:\n‚Ä¢ Expert Review Prozesse durch interne und externe BCM-Spezialisten\n‚Ä¢ Stakeholder Validation durch systematische Review-Zyklen mit allen Beteiligten\n‚Ä¢ Completeness Checks anhand standardisierter Checklisten und Frameworks\n‚Ä¢ Consistency Verification √ºber verschiedene Prozess-Komponenten und Gesch√§ftsbereiche\n‚Ä¢ Usability Testing zur √úberpr√ºfung der praktischen Anwendbarkeit unter Stress\n\nüîÑ Iterative Prozessverfeinerung und Optimierung:\n‚Ä¢ Feedback Integration aus Stakeholder-Reviews und Expertenbeurteilungen\n‚Ä¢ Continuous Improvement durch systematische Identifikation von Verbesserungspotenzialen\n‚Ä¢ Benchmark Comparison mit Industry Best Practices und Standards\n‚Ä¢ Pilot Testing in kontrollierten Umgebungen vor vollst√§ndiger Implementierung\n‚Ä¢ Change Management f√ºr systematische Einf√ºhrung von Prozessaktualisierungen\n\nüìö Prozess-Dokumentation und Wissensmanagement:\n‚Ä¢ Comprehensive Documentation aller Entwicklungsentscheidungen und Rationale\n‚Ä¢ Knowledge Transfer Mechanismen f√ºr nachhaltige Organisationskompetenz\n‚Ä¢ Training Material Development f√ºr effektive Prozessvermittlung\n‚Ä¢ Best Practice Capture f√ºr zuk√ºnftige Prozessentwicklungsprojekte\n‚Ä¢ Institutional Memory Preservation durch strukturierte Wissensdokumentation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Governance-Strukturen und Kontrollmechanismen sind f√ºr effektive BCM-Prozesse erforderlich?',
        answer: "Effektive BCM-Prozesse erfordern robuste Governance-Strukturen und systematische Kontrollmechanismen, die operative Exzellenz gew√§hrleisten und kontinuierliche Verbesserung erm√∂glichen. Eine integrierte Governance-Architektur schafft die Grundlage f√ºr nachhaltige Prozessqualit√§t und organisationale Resilienz.\n\nüèõÔ∏è Prozess-Governance-Framework:\n‚Ä¢ Executive Governance Committee mit strategischer Verantwortung f√ºr BCM-Prozess-Richtlinien\n‚Ä¢ Operational Steering Committee f√ºr taktische Prozesssteuerung und Ressourcenallokation\n‚Ä¢ Process Owner Struktur mit klaren Verantwortlichkeiten f√ºr spezifische Prozessbereiche\n‚Ä¢ Cross-functional Working Groups f√ºr prozess√ºbergreifende Koordination und Integration\n‚Ä¢ External Advisory Board mit Branchenexperten f√ºr strategische Prozessberatung\n\nüìã Rollen- und Verantwortlichkeits-Matrizen:\n‚Ä¢ RACI-Matrizen definieren Responsible, Accountable, Consulted und Informed Rollen\n‚Ä¢ Escalation Pathways mit klaren Entscheidungsbefugnissen f√ºr verschiedene Prozessebenen\n‚Ä¢ Decision Rights Framework f√ºr autonome und kollaborative Entscheidungsfindung\n‚Ä¢ Delegation Authorities mit definierten Grenzen und Berichtspflichten\n‚Ä¢ Conflict Resolution Mechanisms f√ºr prozessbezogene Meinungsverschiedenheiten\n\nüîç Kontroll- und √úberwachungsmechanismen:\n‚Ä¢ Process Performance Monitoring durch kontinuierliche KPI-√úberwachung\n‚Ä¢ Regular Process Audits zur Validierung von Compliance und Effektivit√§t\n‚Ä¢ Exception Reporting f√ºr Abweichungen von definierten Prozessstandards\n‚Ä¢ Risk Control Assessments zur Identifikation von Prozessrisiken\n‚Ä¢ Quality Assurance Reviews f√ºr systematische Prozessverbesserung\n\nüìä Performance-Messung und Reporting:\n‚Ä¢ Balanced Scorecard Ans√§tze f√ºr ganzheitliche Prozessleistungsmessung\n‚Ä¢ Real-time Dashboards f√ºr kontinuierliche Prozess√ºberwachung\n‚Ä¢ Management Reporting mit strukturierten Berichten f√ºr verschiedene F√ºhrungsebenen\n‚Ä¢ Trend Analysis f√ºr proaktive Identifikation von Verbesserungspotenzialen\n‚Ä¢ Benchmark Comparisons gegen interne und externe Standards\n\n‚öñÔ∏è Compliance- und Audit-Strukturen:\n‚Ä¢ Regulatory Compliance Monitoring zur Sicherstellung gesetzlicher Anforderungen\n‚Ä¢ Internal Audit Programs f√ºr regelm√§√üige Prozessvalidierung\n‚Ä¢ External Audit Coordination mit unabh√§ngigen Pr√ºfungsorganisationen\n‚Ä¢ Documentation Standards f√ºr audit-konforme Prozessdokumentation\n‚Ä¢ Corrective Action Tracking f√ºr systematische Behebung identifizierter M√§ngel\n\nüîÑ Kontinuierliche Verbesserungsmechanismen:\n‚Ä¢ Process Improvement Committees f√ºr strukturierte Optimierungsinitiative\n‚Ä¢ Innovation Labs f√ºr Entwicklung neuer Prozessans√§tze\n‚Ä¢ Lessons Learned Integration aus realen Ereignissen und √úbungen\n‚Ä¢ Best Practice Sharing zwischen verschiedenen Organisationseinheiten\n‚Ä¢ Change Management Processes f√ºr systematische Prozessverbesserungen\n\nüìã Dokumentations- und Versionskontrolle:\n‚Ä¢ Document Management Systems f√ºr zentrale Prozessdokumentation\n‚Ä¢ Version Control Mechanisms f√ºr nachvollziehbare Prozess√§nderungen\n‚Ä¢ Access Control Systems f√ºr rollenbasierte Dokumentenzugriffe\n‚Ä¢ Approval Workflows f√ºr strukturierte Prozessfreigaben\n‚Ä¢ Archive Management f√ºr historische Prozessversionen\n\nüéì Schulungs- und Kompetenzmanagement:\n‚Ä¢ Training Programs f√ºr prozessspezifische Kompetenzen\n‚Ä¢ Certification Requirements f√ºr kritische Prozessrollen\n‚Ä¢ Competency Assessments zur Validierung von Prozessf√§higkeiten\n‚Ä¢ Knowledge Management Systems f√ºr Prozesswissen\n‚Ä¢ Succession Planning f√ºr kritische Prozessverantwortlichkeiten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie werden BCM-Prozesse systematisch gemessen, analysiert und kontinuierlich optimiert?',
        answer: "Die systematische Messung, Analyse und Optimierung von BCM-Prozessen ist entscheidend f√ºr deren langfristige Wirksamkeit und kontinuierliche Verbesserung. Ein strukturiertes Performance-Management-Framework gew√§hrleistet datenbasierte Entscheidungsfindung und nachhaltige Prozessexzellenz.\n\nüìä Mehrdimensionales Messsystem:\n‚Ä¢ Process Efficiency Metrics f√ºr Durchlaufzeiten, Ressourcenverbrauch und Kosteneffektivit√§t\n‚Ä¢ Effectiveness Indicators f√ºr Zielerreichung, Qualit√§t und Stakeholder-Zufriedenheit\n‚Ä¢ Resilience Metrics f√ºr Anpassungsf√§higkeit, Robustheit und Wiederherstellungsgeschwindigkeit\n‚Ä¢ Innovation Measures f√ºr Prozessverbesserungen, Automatisierung und Modernisierung\n‚Ä¢ Compliance Indicators f√ºr Einhaltung von Standards, Vorschriften und internen Richtlinien\n\nüéØ KPI-Entwicklung und Messsystem-Design:\n‚Ä¢ SMART-Kriterien basierte KPI-Definition f√ºr spezifische, messbare und erreichbare Ziele\n‚Ä¢ Leading Indicators f√ºr proaktive Fr√ºherkennung von Prozesstrends\n‚Ä¢ Lagging Indicators f√ºr retrospektive Leistungsbewertung und Ergebnismessung\n‚Ä¢ Balanced Scorecard Integration f√ºr ganzheitliche Prozessleistungsmessung\n‚Ä¢ Benchmarking Standards gegen interne historische Daten und externe Best Practices\n\nüìà Datensammlung und Analyse-Methoden:\n‚Ä¢ Automated Data Collection durch integrierte Monitoring-Systeme\n‚Ä¢ Manual Assessment Protocols f√ºr qualitative Prozessbewertungen\n‚Ä¢ Statistical Analysis f√ºr Trend-Identifikation und Korrelationsanalysen\n‚Ä¢ Root Cause Analysis f√ºr systematische Problemidentifikation\n‚Ä¢ Predictive Analytics f√ºr proaktive Prozessoptimierung\n\nüîç Performance-Analyse und Interpretation:\n‚Ä¢ Variance Analysis zur Identifikation von Abweichungen von Sollwerten\n‚Ä¢ Trend Analysis f√ºr langfristige Entwicklungsmuster\n‚Ä¢ Comparative Analysis zwischen verschiedenen Prozessbereichen\n‚Ä¢ Impact Assessment f√ºr Bewertung von Verbesserungsma√ünahmen\n‚Ä¢ Risk-adjusted Performance Evaluation f√ºr kontextuelle Leistungsbewertung\n\nüîÑ Kontinuierliche Verbesserungs-Zyklen:\n‚Ä¢ Plan-Do-Check-Act Zyklen f√ºr systematische Prozessoptimierung\n‚Ä¢ Regular Review Cycles mit definierten Zeitintervallen und Verantwortlichkeiten\n‚Ä¢ Improvement Opportunity Identification durch strukturierte Analysemethoden\n‚Ä¢ Prioritization Frameworks f√ºr Ressourcenallokation bei Verbesserungsma√ünahmen\n‚Ä¢ Implementation Tracking f√ºr Verfolgung von Optimierungsfortschritten\n\nüìã Feedback-Mechanismen und Stakeholder-Input:\n‚Ä¢ Stakeholder Surveys f√ºr systematische Zufriedenheitsmessung\n‚Ä¢ Process User Feedback f√ºr operative Verbesserungsvorschl√§ge\n‚Ä¢ Expert Reviews durch interne und externe Spezialisten\n‚Ä¢ Customer Voice Integration f√ºr externe Perspektiven\n‚Ä¢ Cross-functional Workshops f√ºr kollaborative Optimierung\n\nüöÄ Innovation-Management und Best-Practice-Integration:\n‚Ä¢ Innovation Pipeline f√ºr neue Prozessans√§tze und Technologien\n‚Ä¢ Pilot Program Management f√ºr kontrollierte Testung von Verbesserungen\n‚Ä¢ Best Practice Repositories f√ºr Wissensmanagement und Sharing\n‚Ä¢ External Learning Integration durch Konferenzen, Netzwerke und Partnerschaften\n‚Ä¢ Technology Adoption Strategies f√ºr Prozessmodernisierung\n\nüìä Reporting und Kommunikation:\n‚Ä¢ Executive Dashboards f√ºr strategische F√ºhrungsebene\n‚Ä¢ Operational Reports f√ºr taktische Prozesssteuerung\n‚Ä¢ Performance Scorecards f√ºr verschiedene Organisationsebenen\n‚Ä¢ Improvement Success Stories f√ºr Motivation und Engagement\n‚Ä¢ Lessons Learned Documentation f√ºr organisationales Lernen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
