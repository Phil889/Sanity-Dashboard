import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Business Continuity Management System page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'business-continuity-management-system' })
    
    if (!existingDoc) {
      throw new Error('Document "business-continuity-management-system" not found')
    }
    
    // Create new FAQs for BCMS fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was ist ein Business Continuity Management System und welche Kernkomponenten umfasst es?',
        answer: "Ein Business Continuity Management System ist ein strukturiertes Framework, das alle Aspekte der organisationalen Resilienz systematisch koordiniert und verwaltet. Es integriert Governance, Prozesse, Technologie und Menschen in einem koh√§renten System zur Sicherstellung der Gesch√§ftskontinuit√§t und geht weit √ºber traditionelle Notfallplanung hinaus.\n\nüèóÔ∏è Systemarchitektur und Framework-Struktur:\n‚Ä¢ Ein BCMS basiert auf einer robusten Architektur, die alle organisationalen Ebenen durchdringt und strategische, taktische und operative Komponenten integriert\n‚Ä¢ Das Framework folgt dem Plan-Do-Check-Act-Zyklus und erm√∂glicht kontinuierliche Verbesserung durch systematische Feedbackschleifen\n‚Ä¢ Modulare Systemkomponenten k√∂nnen flexibel an organisationsspezifische Anforderungen angepasst werden\n‚Ä¢ Integration in bestehende Managementsysteme erfolgt durch standardisierte Schnittstellen und gemeinsame Governance-Strukturen\n‚Ä¢ Das System schafft eine einheitliche Sprache und gemeinsame Verst√§ndnisgrundlage f√ºr alle Stakeholder\n\nüìã Governance und Management-Framework:\n‚Ä¢ Klare Governance-Strukturen definieren Entscheidungswege, Verantwortlichkeiten und Eskalationsprozesse f√ºr alle BCM-Aktivit√§ten\n‚Ä¢ Das Management-Framework umfasst Policy-Entwicklung, strategische Planung und operative Steuerung\n‚Ä¢ Rollen und Verantwortlichkeiten werden in einer detaillierten RACI-Matrix definiert und regelm√§√üig √ºberpr√ºft\n‚Ä¢ Entscheidungsstrukturen erm√∂glichen schnelle Reaktionen in Krisensituationen bei gleichzeitiger strategischer Ausrichtung\n‚Ä¢ Kommunikationsstrukturen verbinden alle Organisationsebenen und externe Stakeholder\n\nüîç Risikomanagement und Business Impact Analysis:\n‚Ä¢ Systematische Identifikation, Bewertung und Behandlung aller relevanten Risiken f√ºr die Gesch√§ftskontinuit√§t\n‚Ä¢ Business Impact Analysis bestimmt kritische Gesch√§ftsfunktionen und deren Abh√§ngigkeiten\n‚Ä¢ Risikobewertung erfolgt kontinuierlich und ber√ºcksichtigt sich √§ndernde Bedrohungslandschaften\n‚Ä¢ Szenario-basierte Analysen entwickeln Verst√§ndnis f√ºr komplexe Risikointerdependenzen\n‚Ä¢ Risikotoleranz und Akzeptanzkriterien werden klar definiert und regelm√§√üig √ºberpr√ºft\n\nüìä Strategieentwicklung und Planungskomponenten:\n‚Ä¢ Entwicklung umfassender Business Continuity Strategien f√ºr alle kritischen Gesch√§ftsfunktionen\n‚Ä¢ Detaillierte Kontinuit√§tspl√§ne definieren spezifische Ma√ünahmen und Verfahren f√ºr verschiedene St√∂rungsszenarien\n‚Ä¢ Alternative Betriebsmodelle und Workaround-L√∂sungen werden systematisch entwickelt und getestet\n‚Ä¢ Ressourcenplanung umfasst Personal, Technologie, Standorte und externe Dienstleister\n‚Ä¢ Wiederherstellungsstrategien ber√ºcksichtigen verschiedene Zeitrahmen und Priorit√§ten\n\nüéì Kompetenzmanagement und Organisationsentwicklung:\n‚Ä¢ Umfassende Training- und Awareness-Programme f√ºr alle Organisationsebenen\n‚Ä¢ Spezialisierte BCM-Kompetenzen werden systematisch entwickelt und gepflegt\n‚Ä¢ Change Management unterst√ºtzt die Integration von BCM in die Organisationskultur\n‚Ä¢ Kontinuierliche Weiterbildung h√§lt das System auf dem neuesten Stand\n‚Ä¢ Wissensmanagement sichert kritisches Know-how und erm√∂glicht organisationales Lernen\n\nüîß Technologie-Integration und Automatisierung:\n‚Ä¢ Moderne BCMS-Software unterst√ºtzt alle Systemkomponenten und erm√∂glicht integrierte Verwaltung\n‚Ä¢ Automatisierte Monitoring-Systeme √ºberwachen kontinuierlich kritische Parameter und Risikoindikatoren\n‚Ä¢ Integration in bestehende IT-Landschaften erfolgt √ºber standardisierte APIs und Datenformate\n‚Ä¢ Real-time Dashboards bieten aktuelle Einblicke in den Status aller BCM-Komponenten\n‚Ä¢ Mobile L√∂sungen erm√∂glichen Zugriff und Steuerung auch in Krisensituationen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie unterscheidet sich ein BCMS von traditionellen Ans√§tzen und welche strategischen Vorteile bietet es?',
        answer: "Ein Business Continuity Management System unterscheidet sich fundamental von traditionellen Ans√§tzen durch seine systematische, integrierte und strategische Herangehensweise. W√§hrend traditionelle Methoden oft fragmentiert und reaktiv sind, schafft ein BCMS eine koh√§rente, proaktive und adaptive Resilienz-Architektur.\n\nüîÑ Systematischer vs. fragmentierter Ansatz:\n‚Ä¢ Traditionelle Ans√§tze behandeln Kontinuit√§ts-Aspekte oft isoliert in verschiedenen Abteilungen ohne √ºbergreifende Koordination\n‚Ä¢ Ein BCMS integriert alle Resilienz-Komponenten in einem einheitlichen System mit gemeinsamer Governance\n‚Ä¢ Systematische Methodik gew√§hrleistet Vollst√§ndigkeit und Konsistenz aller BCM-Aktivit√§ten\n‚Ä¢ Standardisierte Prozesse und Verfahren schaffen Effizienz und Qualit√§tssicherung\n‚Ä¢ Zentrale Koordination vermeidet Doppelarbeit und Inkonsistenzen zwischen verschiedenen Bereichen\n\nüìà Strategische vs. operative Fokussierung:\n‚Ä¢ Traditionelle Notfallplanung konzentriert sich prim√§r auf operative Ma√ünahmen und kurzfristige Reaktionen\n‚Ä¢ Ein BCMS verankert Kontinuit√§tsmanagement strategisch in der Unternehmensf√ºhrung und langfristigen Planung\n‚Ä¢ Strategische Ausrichtung erm√∂glicht Wettbewerbsvorteile durch √ºberlegene Resilienz-F√§higkeiten\n‚Ä¢ Integration in Corporate Governance schafft Verantwortlichkeit auf h√∂chster F√ºhrungsebene\n‚Ä¢ Langfristige Perspektive ber√ºcksichtigt sich √§ndernde Gesch√§ftsmodelle und Marktbedingungen\n\nüöÄ Proaktive vs. reaktive Herangehensweise:\n‚Ä¢ Traditionelle Ans√§tze reagieren auf eingetretene St√∂rungen mit vorgefertigten Pl√§nen\n‚Ä¢ Ein BCMS antizipiert potenzielle St√∂rungen und entwickelt pr√§ventive Ma√ünahmen\n‚Ä¢ Fr√ºhwarnsysteme erm√∂glichen rechtzeitige Intervention vor Eskalation von Problemen\n‚Ä¢ Kontinuierliche Risiko√ºberwachung identifiziert emerging threats und neue Vulnerabilit√§ten\n‚Ä¢ Adaptive Kapazit√§ten erm√∂glichen flexible Reaktionen auf unvorhersehbare Ereignisse\n\nüí° Wertsch√∂pfung vs. Kostenverursachung:\n‚Ä¢ Traditionelle BCM wird oft als notwendiges √úbel und Kostenfaktor betrachtet\n‚Ä¢ Ein professionelles BCMS wird zum strategischen Asset und Wertsch√∂pfungsinstrument\n‚Ä¢ Resilienz-F√§higkeiten schaffen Wettbewerbsvorteile und neue Gesch√§ftsm√∂glichkeiten\n‚Ä¢ Effizienzsteigerungen durch optimierte Prozesse und reduzierte Redundanzen\n‚Ä¢ ROI-positive Investition durch vermiedene Sch√§den und verbesserte Performance\n\nüåê Integrierte vs. isolierte Betrachtung:\n‚Ä¢ Traditionelle Ans√§tze betrachten einzelne Risiken und Bereiche isoliert\n‚Ä¢ Ein BCMS ber√ºcksichtigt komplexe Interdependenzen und Systemdynamiken\n‚Ä¢ Ganzheitliche Perspektive umfasst interne und externe Stakeholder sowie Lieferketten\n‚Ä¢ Ecosystem-weite Betrachtung entwickelt kollaborative Resilienz-Netzwerke\n‚Ä¢ Systemisches Denken erm√∂glicht Verst√§ndnis f√ºr Kaskadeneffekte und Sekund√§rrisiken\n\nüìä Messbare vs. intuitive Steuerung:\n‚Ä¢ Traditionelle Ans√§tze basieren oft auf Erfahrung und Intuition ohne systematische Messung\n‚Ä¢ Ein BCMS nutzt KPIs, Metriken und datenbasierte Entscheidungsfindung\n‚Ä¢ Kontinuierliche Messung erm√∂glicht objektive Bewertung der BCM-Effektivit√§t\n‚Ä¢ Benchmarking gegen Best Practices und Branchenstandards\n‚Ä¢ Evidence-based Management verbessert Qualit√§t und Nachvollziehbarkeit von Entscheidungen\n\nüîß Technologie-gest√ºtzte vs. manuelle Prozesse:\n‚Ä¢ Traditionelle Ans√§tze sind oft papierbasiert und manuell gesteuert\n‚Ä¢ Ein modernes BCMS nutzt fortschrittliche Technologien f√ºr Automatisierung und Effizienz\n‚Ä¢ Digitale Plattformen erm√∂glichen Real-time Collaboration und Information Sharing\n‚Ä¢ Automatisierte Workflows reduzieren menschliche Fehler und beschleunigen Reaktionszeiten\n‚Ä¢ Analytics und AI unterst√ºtzen Entscheidungsfindung und Vorhersagef√§higkeiten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Governance-Strukturen und Managementprozesse sind f√ºr ein effektives BCMS erforderlich?',
        answer: "Effektive Governance-Strukturen und Managementprozesse bilden das R√ºckgrat eines erfolgreichen BCMS. Sie schaffen die notwendige F√ºhrung, Koordination und Kontrolle f√ºr alle BCM-Aktivit√§ten und gew√§hrleisten strategische Ausrichtung sowie operative Exzellenz.\n\nüëë Strategische Governance und F√ºhrungsstrukturen:\n‚Ä¢ BCM-Steering Committee auf Vorstandsebene definiert strategische Ausrichtung und allokiert Ressourcen\n‚Ä¢ Chief Resilience Officer oder BCM-Direktor tr√§gt Gesamtverantwortung f√ºr das BCMS\n‚Ä¢ BCM-Board mit Vertretern aller kritischen Gesch√§ftsbereiche koordiniert √ºbergreifende Aktivit√§ten\n‚Ä¢ Klare Eskalationswege verbinden operative Ebene mit strategischer F√ºhrung\n‚Ä¢ Regelm√§√üige Management-Reviews gew√§hrleisten kontinuierliche strategische Ausrichtung\n\nüìã Organisationsstrukturen und Rollenverteilung:\n‚Ä¢ BCM-Manager koordiniert t√§gliche BCM-Aktivit√§ten und fungiert als zentrale Anlaufstelle\n‚Ä¢ Business Continuity Coordinators in allen kritischen Gesch√§ftsbereichen\n‚Ä¢ Crisis Management Team mit definierten Rollen f√ºr verschiedene St√∂rungsszenarien\n‚Ä¢ Recovery Teams f√ºr spezifische Gesch√§ftsfunktionen und Standorte\n‚Ä¢ RACI-Matrix definiert Verantwortlichkeiten, Zust√§ndigkeiten und Informationswege\n\nüéØ Policy-Framework und strategische Ausrichtung:\n‚Ä¢ BCM-Policy definiert Grunds√§tze, Ziele und Verpflichtungen der Organisation\n‚Ä¢ Strategische BCM-Ziele sind mit Unternehmenszielen und Risikotoleranz abgestimmt\n‚Ä¢ Standards und Richtlinien konkretisieren Policy-Vorgaben f√ºr operative Umsetzung\n‚Ä¢ Compliance-Framework gew√§hrleistet Einhaltung regulatorischer Anforderungen\n‚Ä¢ Regelm√§√üige Policy-Reviews ber√ºcksichtigen sich √§ndernde Gesch√§ftsanforderungen\n\nüìä Planungs- und Steuerungsprozesse:\n‚Ä¢ Strategische BCM-Planung definiert langfristige Ziele und Entwicklungsrichtung\n‚Ä¢ J√§hrliche BCM-Programme konkretisieren strategische Ziele in operative Ma√ünahmen\n‚Ä¢ Projektmanagement-Prozesse steuern BCM-Implementierung und -Verbesserung\n‚Ä¢ Budgetplanung und Ressourcenallokation f√ºr alle BCM-Aktivit√§ten\n‚Ä¢ Performance Management √ºberwacht Zielerreichung und identifiziert Verbesserungsbedarf\n\nüîç Risikomanagement und Entscheidungsprozesse:\n‚Ä¢ Risiko-Governance definiert Risikotoleranz und Entscheidungskriterien\n‚Ä¢ Risikobewertungsprozesse identifizieren und priorisieren BCM-relevante Risiken\n‚Ä¢ Entscheidungsmatrix f√ºr Risikobew√§ltigung und Strategieauswahl\n‚Ä¢ Eskalationsprozesse f√ºr kritische Risiken und Entscheidungen\n‚Ä¢ Dokumentation und Nachverfolgung aller Risiko-Entscheidungen\n\nüìà Performance Management und Kontrolle:\n‚Ä¢ KPI-Framework misst BCM-Effektivit√§t auf strategischer und operativer Ebene\n‚Ä¢ Regelm√§√üige BCM-Assessments bewerten Systemreife und Verbesserungspotenziale\n‚Ä¢ Management-Reporting informiert F√ºhrung √ºber BCM-Status und -Performance\n‚Ä¢ Audit-Programme gew√§hrleisten Compliance und identifizieren Schwachstellen\n‚Ä¢ Corrective Action Prozesse adressieren identifizierte M√§ngel systematisch\n\nüîÑ Kontinuierliche Verbesserung und Innovation:\n‚Ä¢ Lessons Learned Prozesse erfassen Erkenntnisse aus Tests, √úbungen und realen Ereignissen\n‚Ä¢ Best Practice Sharing f√∂rdert organisationsweites Lernen und Wissenstransfer\n‚Ä¢ Innovation Management identifiziert und implementiert neue BCM-Technologien und -Methoden\n‚Ä¢ Benchmarking gegen externe Standards und Branchenf√ºhrer\n‚Ä¢ Change Management f√ºr kontinuierliche BCMS-Evolution und -Anpassung\n\nü§ù Stakeholder-Management und Kommunikation:\n‚Ä¢ Stakeholder-Mapping identifiziert alle relevanten internen und externen Stakeholder\n‚Ä¢ Kommunikationsstrategien f√ºr verschiedene Stakeholder-Gruppen und Situationen\n‚Ä¢ Regelm√§√üige Stakeholder-Engagement-Programme\n‚Ä¢ Feedback-Mechanismen f√ºr kontinuierliche Stakeholder-Einbindung\n‚Ä¢ Externe Kommunikation und Reputation Management in Krisensituationen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie erfolgt die praktische Implementierung eines BCMS und welche Phasen sind dabei zu durchlaufen?',
        answer: "Die Implementierung eines BCMS erfolgt in strukturierten Phasen, die systematisch aufeinander aufbauen und eine nachhaltige Verankerung in der Organisation gew√§hrleisten. Ein phasenorientierter Ansatz minimiert Risiken, maximiert Akzeptanz und erm√∂glicht kontinuierliche Anpassung an organisationsspezifische Anforderungen.\n\nüîç Phase 1: Assessment und Grundlagenanalyse:\n‚Ä¢ Umfassende Analyse der aktuellen BCM-Reife und bestehender Kontinuit√§ts-Ma√ünahmen\n‚Ä¢ Gap-Analyse gegen ISO 22301 und andere relevante Standards\n‚Ä¢ Stakeholder-Analyse und Identifikation von Champions und Widerst√§nden\n‚Ä¢ Bewertung der Organisationskultur und Change-Bereitschaft\n‚Ä¢ Definition des Implementierungsumfangs und der Priorit√§ten\n\nüìã Phase 2: Strategieentwicklung und Planung:\n‚Ä¢ Entwicklung der BCM-Vision, Mission und strategischen Ziele\n‚Ä¢ Design der BCMS-Architektur und Governance-Strukturen\n‚Ä¢ Erstellung des Implementierungsplans mit Meilensteinen und Ressourcenplanung\n‚Ä¢ Definition von Success Criteria und Messkriterien\n‚Ä¢ Stakeholder-Engagement und Kommunikationsstrategie\n\nüèóÔ∏è Phase 3: Framework-Aufbau und Strukturierung:\n‚Ä¢ Etablierung der Governance-Strukturen und Managementprozesse\n‚Ä¢ Entwicklung von Policies, Standards und Verfahren\n‚Ä¢ Aufbau der organisatorischen Strukturen und Rollenverteilung\n‚Ä¢ Implementation der Technologie-Plattform und Tools\n‚Ä¢ Schulung der Kernteams und BCM-Verantwortlichen\n\nüîç Phase 4: Risikobewertung und Business Impact Analysis:\n‚Ä¢ Systematische Identifikation aller BCM-relevanten Risiken\n‚Ä¢ Durchf√ºhrung detaillierter Business Impact Analysen\n‚Ä¢ Bewertung von Abh√§ngigkeiten und Interdependenzen\n‚Ä¢ Bestimmung von Recovery Time und Recovery Point Objectives\n‚Ä¢ Priorisierung kritischer Gesch√§ftsfunktionen und Ressourcen\n\nüìä Phase 5: Strategieentwicklung und Planungserstellung:\n‚Ä¢ Entwicklung von Business Continuity Strategien f√ºr kritische Funktionen\n‚Ä¢ Erstellung detaillierter Business Continuity Pl√§ne\n‚Ä¢ Design alternativer Betriebsmodelle und Workaround-L√∂sungen\n‚Ä¢ Planung von Ressourcen, Standorten und Technologie-Alternativen\n‚Ä¢ Integration von Lieferanten und externen Partnern\n\nüß™ Phase 6: Testing und Validierung:\n‚Ä¢ Entwicklung umfassender Test- und √úbungsprogramme\n‚Ä¢ Durchf√ºhrung von Tabletop-√úbungen und Simulationen\n‚Ä¢ Validierung der Pl√§ne durch praktische Tests\n‚Ä¢ Bewertung der Effektivit√§t und Identifikation von Verbesserungsbedarfen\n‚Ä¢ Dokumentation von Lessons Learned und Anpassungen\n\nüìà Phase 7: Performance Management und Monitoring:\n‚Ä¢ Implementation von KPIs und Messsystemen\n‚Ä¢ Aufbau von Monitoring und Reporting-Strukturen\n‚Ä¢ Etablierung regelm√§√üiger Review-Zyklen\n‚Ä¢ Integration in bestehende Management-Systeme\n‚Ä¢ Kontinuierliche √úberwachung der BCMS-Performance\n\nüîÑ Phase 8: Kontinuierliche Verbesserung und Optimierung:\n‚Ä¢ Etablierung von Feedback-Mechanismen und Verbesserungsprozessen\n‚Ä¢ Regelm√§√üige Aktualisierung von Pl√§nen und Strategien\n‚Ä¢ Integration neuer Erkenntnisse und Best Practices\n‚Ä¢ Anpassung an sich √§ndernde Gesch√§ftsanforderungen\n‚Ä¢ Weiterentwicklung der BCMS-Reife und -F√§higkeiten\n\nüéØ Kritische Erfolgsfaktoren f√ºr die Implementierung:\n‚Ä¢ Starke F√ºhrungsunterst√ºtzung und sichtbares Management-Commitment\n‚Ä¢ Angemessene Ressourcenausstattung und Budgetierung\n‚Ä¢ Effektives Change Management und Kommunikation\n‚Ä¢ Schrittweise Implementierung mit Quick Wins und Erfolgsgeschichten\n‚Ä¢ Kontinuierliche Stakeholder-Einbindung und Feedback-Integration\n\n‚ö†Ô∏è H√§ufige Implementierungsfallen und deren Vermeidung:\n‚Ä¢ Untersch√§tzung des Change Management Aufwands\n‚Ä¢ Zu komplexe oder theoretische Ans√§tze ohne praktischen Nutzen\n‚Ä¢ Mangelnde Integration in bestehende Gesch√§ftsprozesse\n‚Ä¢ Unzureichende Schulung und Kompetenzentwicklung\n‚Ä¢ Fehlende kontinuierliche Pflege und Aktualisierung des Systems"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
