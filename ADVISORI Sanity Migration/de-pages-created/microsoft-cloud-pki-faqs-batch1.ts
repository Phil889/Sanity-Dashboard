import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Microsoft Cloud PKI page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'microsoft-cloud-pki' })
    
    if (!existingDoc) {
      throw new Error('Document "microsoft-cloud-pki" not found')
    }
    
    // Create new FAQs for Microsoft Cloud PKI fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was ist Microsoft Cloud PKI und welche Azure-Services bilden das Fundament f√ºr cloud-basierte Zertifikatsverwaltung?',
        answer: "Microsoft Cloud PKI repr√§sentiert eine moderne, cloud-native Herangehensweise an Public Key Infrastructure, die die umfassenden Sicherheits- und Verwaltungsfunktionen der Microsoft Azure-Plattform nutzt. Diese L√∂sung integriert nahtlos in bestehende Microsoft-√ñkosysteme und erm√∂glicht Organisationen, von den Vorteilen der Cloud-Skalierbarkeit, -Verf√ºgbarkeit und -Sicherheit f√ºr ihre kritischen Zertifikatsverwaltungsanforderungen zu profitieren.\n\nüîê Azure Key Vault als PKI-Herzst√ºck:\n‚Ä¢ Azure Key Vault Managed HSM bietet FIPS 140-2 Level 3 zertifizierten Hardware-Schutz f√ºr Root CA-Schl√ºssel und kritische kryptographische Operationen\n‚Ä¢ Certificate Authority Hierarchien k√∂nnen vollst√§ndig in Azure Key Vault implementiert werden, wodurch traditionelle Hardware-HSMs √ºberfl√ºssig werden\n‚Ä¢ Automatisierte Schl√ºsselrotation und -verwaltung reduzieren operative Komplexit√§t und menschliche Fehlerquellen\n‚Ä¢ Multi-Tenant-Isolation gew√§hrleistet sichere Trennung verschiedener Organisationseinheiten oder Kunden\n‚Ä¢ Global verteilte Verf√ºgbarkeit durch Azure-Regionen erm√∂glicht Disaster Recovery und Hochverf√ºgbarkeit\n\n‚òÅÔ∏è Azure Certificate Services Integration:\n‚Ä¢ Azure App Service Certificate Management automatisiert SSL/TLS-Zertifikate f√ºr Web-Anwendungen und APIs\n‚Ä¢ Azure Front Door und Application Gateway integrieren nahtlos mit Azure Key Vault f√ºr automatische Zertifikatserneuerung\n‚Ä¢ Azure Kubernetes Service (AKS) Certificate Management erm√∂glicht sichere Container-Kommunikation\n‚Ä¢ Azure Service Fabric Certificate Integration unterst√ºtzt Microservice-Architekturen\n‚Ä¢ Azure API Management Certificate Handling sichert API-Gateways und Developer Portals\n\nüè¢ Microsoft 365 und Office-Integration:\n‚Ä¢ Exchange Online S/MIME Certificate Deployment erm√∂glicht verschl√ºsselte E-Mail-Kommunikation f√ºr alle Benutzer\n‚Ä¢ SharePoint Online und OneDrive for Business Dokumentensignierung sch√ºtzt sensible Unternehmensdokumente\n‚Ä¢ Microsoft Teams Certificate Authentication unterst√ºtzt sichere Kommunikation und Compliance-Anforderungen\n‚Ä¢ Office-Anwendungen Code Signing gew√§hrleistet Integrit√§t von Makros und Add-Ins\n‚Ä¢ Power Platform Certificate Integration sichert Custom Connectors und Power Apps\n\nüîó Hybrid-Konnektivit√§t und Active Directory:\n‚Ä¢ Azure AD Connect Certificate Synchronisation verbindet On-Premises Active Directory Certificate Services mit Cloud-PKI\n‚Ä¢ Azure AD Certificate-Based Authentication erm√∂glicht starke Authentifizierung f√ºr Cloud-Services\n‚Ä¢ Conditional Access Policies k√∂nnen Certificate-basierte Zugriffsentscheidungen treffen\n‚Ä¢ Cross-Forest Certificate Trust Relationships erweitern Vertrauen zwischen verschiedenen Dom√§nen\n‚Ä¢ Azure AD Domain Services Certificate Integration unterst√ºtzt Legacy-Anwendungen in der Cloud\n\n‚ö° PowerShell und API-Automatisierung:\n‚Ä¢ Azure PowerShell Module f√ºr Key Vault erm√∂glichen umfassende Certificate Lifecycle Automation\n‚Ä¢ Microsoft Graph API Certificate Operations integrieren PKI-Management in moderne Anwendungen\n‚Ä¢ Azure Resource Manager Templates automatisieren PKI-Infrastruktur-Deployment\n‚Ä¢ Azure DevOps Pipeline Integration erm√∂glicht Certificate-as-Code-Ans√§tze\n‚Ä¢ Logic Apps und Power Automate Certificate Workflows automatisieren Gesch√§ftsprozesse\n\nüõ°Ô∏è Security und Compliance-Integration:\n‚Ä¢ Azure Security Center Certificate Health Monitoring √ºberwacht kontinuierlich Zertifikatsstatus und -sicherheit\n‚Ä¢ Azure Sentinel PKI Security Analytics erkennt anomale Certificate-Aktivit√§ten und potenzielle Bedrohungen\n‚Ä¢ Azure Policy Certificate Compliance gew√§hrleistet Einhaltung organisatorischer Richtlinien\n‚Ä¢ Microsoft Defender for Cloud Certificate Protection sch√ºtzt vor Certificate-basierten Angriffen\n‚Ä¢ Azure Monitor und Log Analytics Certificate Auditing dokumentieren alle PKI-Aktivit√§ten f√ºr Compliance"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie funktioniert Azure Key Vault Integration f√ºr PKI und welche Vorteile bietet Managed HSM gegen√ºber traditionellen Hardware-L√∂sungen?',
        answer: "Azure Key Vault Integration revolutioniert PKI-Implementierungen durch cloud-native Hardware Security Module-Funktionalit√§t, die traditionelle On-Premises-HSM-L√∂sungen in Bezug auf Skalierbarkeit, Verf√ºgbarkeit und Kosteneffizienz √ºbertrifft. Diese Integration erm√∂glicht es Organisationen, Enterprise-grade PKI-Sicherheit ohne die Komplexit√§t und Kosten traditioneller Hardware-Investitionen zu realisieren.\n\nüèóÔ∏è Azure Key Vault Managed HSM Architektur:\n‚Ä¢ Dedicated HSM Pools bieten isolierte, FIPS 140-2 Level 3 zertifizierte Hardware-Umgebungen f√ºr kritische PKI-Operationen\n‚Ä¢ Multi-Tenant-Isolation gew√§hrleistet vollst√§ndige Trennung zwischen verschiedenen Organisationen oder Gesch√§ftsbereichen\n‚Ä¢ Hardware-basierte Schl√ºsselgenerierung nutzt echte Zufallszahlengeneratoren f√ºr kryptographisch sichere Schl√ºsselerstellung\n‚Ä¢ Tamper-resistant Hardware sch√ºtzt vor physischen Manipulationsversuchen und unbefugtem Zugriff\n‚Ä¢ Secure Key Import erm√∂glicht Migration bestehender PKI-Schl√ºssel in die Cloud-Umgebung\n\n‚ö° Skalierbarkeit und Performance-Vorteile:\n‚Ä¢ Elastische Skalierung passt HSM-Kapazit√§ten automatisch an schwankende Workloads an\n‚Ä¢ Global verteilte HSM-Instanzen reduzieren Latenz und verbessern Performance f√ºr internationale Organisationen\n‚Ä¢ Load Balancing zwischen mehreren HSM-Instanzen gew√§hrleistet optimale Ressourcennutzung\n‚Ä¢ Burst-Kapazit√§ten erm√∂glichen Bew√§ltigung von Spitzenlasten ohne Infrastruktur-Investitionen\n‚Ä¢ Pay-per-Use-Modell optimiert Kosten basierend auf tats√§chlicher Nutzung\n\nüîê Certificate Authority Implementation:\n‚Ä¢ Root CA Key Protection in dedizierten HSM-Partitionen mit Air-Gap-Sicherheit\n‚Ä¢ Intermediate CA Hierarchien k√∂nnen flexibel in verschiedenen HSM-Instanzen implementiert werden\n‚Ä¢ Cross-Region CA Backup erm√∂glicht Disaster Recovery ohne Kompromittierung der Schl√ºsselsicherheit\n‚Ä¢ Automated Key Ceremony Procedures reduzieren menschliche Fehlerquellen bei kritischen Operationen\n‚Ä¢ Certificate Template Integration erm√∂glicht konsistente Zertifikatsausstellung\n\nüåê Integration in Azure-√ñkosystem:\n‚Ä¢ Azure RBAC (Role-Based Access Control) Integration erm√∂glicht granulare Zugriffskontrolle auf HSM-Operationen\n‚Ä¢ Azure Monitor Integration bietet umfassendes Logging und Alerting f√ºr alle HSM-Aktivit√§ten\n‚Ä¢ Azure Backup Integration sch√ºtzt HSM-Konfigurationen und Metadaten\n‚Ä¢ Virtual Network Integration isoliert HSM-Traffic in privaten Netzwerksegmenten\n‚Ä¢ Private Endpoint Connectivity gew√§hrleistet sichere Kommunikation ohne Internet-Exposition\n\nüí∞ Kostenvorteile gegen√ºber traditionellen HSMs:\n‚Ä¢ Eliminierung von Hardware-Anschaffungskosten und Wartungsvertr√§gen\n‚Ä¢ Reduzierung von Datacenter-Anforderungen und physischer Sicherheitsma√ünahmen\n‚Ä¢ Automatisierte Updates und Patches ohne Service-Unterbrechungen\n‚Ä¢ Shared Infrastructure reduziert Gesamtbetriebskosten durch Economies of Scale\n‚Ä¢ Flexible Lizenzierung erm√∂glicht Anpassung an sich √§ndernde Gesch√§ftsanforderungen\n\nüõ†Ô∏è Operational Excellence:\n‚Ä¢ Azure DevOps Integration erm√∂glicht Infrastructure-as-Code f√ºr HSM-Konfigurationen\n‚Ä¢ PowerShell und CLI-Tools automatisieren wiederkehrende HSM-Management-Aufgaben\n‚Ä¢ REST API Integration verbindet HSM-Funktionalit√§t mit Custom Applications\n‚Ä¢ Terraform und ARM Template Support erm√∂glicht deklarative Infrastruktur-Verwaltung\n‚Ä¢ GitOps-Workflows gew√§hrleisten Versionskontrolle und Audit-Trails f√ºr HSM-Konfigurationen\n\nüîÑ Migration und Hybrid-Szenarien:\n‚Ä¢ Secure Key Migration Tools erm√∂glichen nahtlose √úbertragung bestehender HSM-Schl√ºssel\n‚Ä¢ Hybrid PKI Architectures verbinden Cloud-HSMs mit On-Premises-Infrastrukturen\n‚Ä¢ Graduelle Migration Strategies minimieren Risiken und Ausfallzeiten\n‚Ä¢ Cross-Platform Compatibility gew√§hrleistet Interoperabilit√§t mit bestehenden PKI-Systemen\n‚Ä¢ Rollback-Mechanismen erm√∂glichen sichere R√ºckkehr zu vorherigen Konfigurationen bei Problemen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Microsoft 365 Certificate Integration-M√∂glichkeiten gibt es und wie wird S/MIME f√ºr sichere E-Mail-Kommunikation implementiert?',
        answer: "Microsoft 365 Certificate Integration erm√∂glicht nahtlose Implementierung von PKI-basierten Sicherheitsl√∂sungen across der gesamten Office-Suite und Cloud-Services. Diese Integration schafft ein einheitliches Sicherheitsframework, das von E-Mail-Verschl√ºsselung √ºber Dokumentensignierung bis hin zu Anwendungssicherheit reicht und dabei die nativen Microsoft-Technologien optimal nutzt.\n\nüìß Exchange Online S/MIME Implementation:\n‚Ä¢ Centralized Certificate Deployment √ºber Exchange Admin Center erm√∂glicht organisationsweite S/MIME-Aktivierung\n‚Ä¢ User Certificate Provisioning automatisiert Zertifikatsverteilung an alle Mailboxen basierend auf Active Directory-Attributen\n‚Ä¢ Certificate Template Mapping definiert verschiedene Zertifikatstypen f√ºr unterschiedliche Benutzergruppen und Sicherheitsanforderungen\n‚Ä¢ Automatic Certificate Renewal verhindert Service-Unterbrechungen durch abgelaufene Zertifikate\n‚Ä¢ Cross-Organization S/MIME Trust erm√∂glicht sichere Kommunikation mit externen Partnern und Kunden\n\nüîê Outlook Client Certificate Integration:\n‚Ä¢ Seamless Certificate Discovery erm√∂glicht automatische Lokalisierung verf√ºgbarer Zertifikate f√ºr Verschl√ºsselung und Signierung\n‚Ä¢ Certificate Store Integration verbindet Outlook mit Windows Certificate Store und Azure Key Vault\n‚Ä¢ Mobile Device Certificate Deployment unterst√ºtzt S/MIME auf iOS und Android-Ger√§ten\n‚Ä¢ Outlook Web App (OWA) S/MIME Support erm√∂glicht sichere E-Mail-Nutzung in Webbrowsern\n‚Ä¢ Certificate Validation Policies gew√§hrleisten Vertrauen in empfangene signierte E-Mails\n\nüìÑ SharePoint und OneDrive Document Signing:\n‚Ä¢ Digital Document Signatures sch√ºtzen wichtige Unternehmensdokumente vor Manipulation\n‚Ä¢ Workflow Integration erm√∂glicht automatische Dokumentensignierung in Approval-Prozessen\n‚Ä¢ Version Control mit Certificate Tracking dokumentiert alle Signierungsaktivit√§ten\n‚Ä¢ Document Library Certificate Policies definieren Signierungsanforderungen f√ºr verschiedene Dokumenttypen\n‚Ä¢ External Sharing Certificate Validation gew√§hrleistet Integrit√§t bei der Zusammenarbeit mit externen Partnern\n\nüíº Microsoft Teams Certificate Authentication:\n‚Ä¢ Certificate-based Authentication f√ºr Teams-Zugriff erh√∂ht Sicherheit f√ºr sensible Kommunikation\n‚Ä¢ Meeting Recording Signatures gew√§hrleisten Integrit√§t und Authentizit√§t von Aufzeichnungen\n‚Ä¢ Bot Framework Certificate Integration sichert Custom Bots und Automatisierungen\n‚Ä¢ Teams App Certificate Validation sch√ºtzt vor sch√§dlichen Third-Party-Anwendungen\n‚Ä¢ Compliance Recording Certificate Protection sichert regulatorische Aufzeichnungsanforderungen\n\nüñ•Ô∏è Office Applications Code Signing:\n‚Ä¢ Macro Security Certificate Validation verhindert Ausf√ºhrung unsignierter oder sch√§dlicher Makros\n‚Ä¢ Add-In Certificate Requirements gew√§hrleisten Vertrauen in Office-Erweiterungen\n‚Ä¢ Template Protection durch Certificate-basierte Zugriffskontrolle\n‚Ä¢ Document Protection Policies nutzen Zertifikate f√ºr granulare Berechtigungskontrolle\n‚Ä¢ Office 365 ProPlus Certificate Deployment automatisiert Zertifikatsverteilung in Enterprise-Umgebungen\n\n‚ö° Power Platform Certificate Integration:\n‚Ä¢ Power Apps Certificate Authentication sichert Custom Applications und Datenverbindungen\n‚Ä¢ Power Automate Certificate-based Connectors erm√∂glichen sichere Integration mit externen Systemen\n‚Ä¢ Power BI Certificate Validation sch√ºtzt Datenvisualisierungen und Reports\n‚Ä¢ Custom Connector Certificate Requirements gew√§hrleisten Sicherheit bei API-Integrationen\n‚Ä¢ Dataverse Certificate Encryption sch√ºtzt sensible Gesch√§ftsdaten\n\nüîß Administrative Tools und Management:\n‚Ä¢ Microsoft 365 Admin Center Certificate Management bietet zentrale Verwaltung aller Zertifikate\n‚Ä¢ PowerShell Certificate Automation erm√∂glicht Bulk-Operationen und Scripting\n‚Ä¢ Graph API Certificate Operations integrieren PKI-Management in Custom Applications\n‚Ä¢ Compliance Center Certificate Reporting dokumentiert alle Certificate-Aktivit√§ten f√ºr Audits\n‚Ä¢ Security & Compliance Center Certificate Policies definieren organisationsweite Sicherheitsrichtlinien\n\nüåê Hybrid und External Integration:\n‚Ä¢ Azure AD Certificate Synchronization verbindet On-Premises-Zertifikate mit Cloud-Services\n‚Ä¢ External Partner Certificate Trust erm√∂glicht sichere B2B-Kommunikation\n‚Ä¢ Certificate Authority Integration unterst√ºtzt Third-Party-CAs und Enterprise-PKI-Systeme\n‚Ä¢ Cross-Tenant Certificate Sharing erm√∂glicht sichere Multi-Organization-Szenarien\n‚Ä¢ Mobile Device Management (MDM) Certificate Deployment sichert BYOD-Umgebungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie werden Hybrid PKI-Szenarien mit Active Directory Certificate Services und Azure implementiert und welche Migrationsm√∂glichkeiten gibt es?',
        answer: "Hybrid PKI-Szenarien verbinden die bew√§hrten Funktionen von On-Premises Active Directory Certificate Services (ADCS) mit den modernen Cloud-Capabilities von Azure, um nahtlose √úberg√§nge und optimale Flexibilit√§t zu erm√∂glichen. Diese Architekturen unterst√ºtzen sowohl graduelle Cloud-Migration als auch langfristige Hybrid-Betriebsmodelle, die das Beste aus beiden Welten kombinieren.\n\nüîó Azure AD Connect Certificate Synchronization:\n‚Ä¢ Certificate Template Synchronization repliziert ADCS-Templates in Azure AD f√ºr konsistente Zertifikatsrichtlinien\n‚Ä¢ User Certificate Mapping verbindet On-Premises-Benutzerzertifikate mit Azure AD-Identit√§ten\n‚Ä¢ Group Policy Certificate Deployment erweitert bestehende GPO-basierte Zertifikatsverteilung auf Cloud-Services\n‚Ä¢ Certificate Revocation List (CRL) Synchronization gew√§hrleistet konsistente Widerrufsinformationen\n‚Ä¢ Cross-Forest Certificate Trust erm√∂glicht Vertrauen zwischen verschiedenen Active Directory-Dom√§nen und Azure AD\n\nüèóÔ∏è Hybrid Certificate Authority Architectures:\n‚Ä¢ Root CA On-Premises mit Subordinate CAs in Azure Key Vault kombiniert bew√§hrte Sicherheit mit Cloud-Skalierbarkeit\n‚Ä¢ Cross-Certification zwischen ADCS und Azure Certificate Services erm√∂glicht bidirektionales Vertrauen\n‚Ä¢ Certificate Chain Validation funktioniert nahtlos zwischen On-Premises und Cloud-Komponenten\n‚Ä¢ Disaster Recovery Scenarios nutzen Azure als Backup-Standort f√ºr kritische CA-Services\n‚Ä¢ Load Distribution zwischen On-Premises und Cloud-CAs optimiert Performance und Verf√ºgbarkeit\n\nüîÑ Migration Strategies und Approaches:\n‚Ä¢ Phased Migration Approach minimiert Risiken durch schrittweise Verlagerung von PKI-Komponenten\n‚Ä¢ Certificate Inventory und Discovery Tools identifizieren alle bestehenden Zertifikate und Abh√§ngigkeiten\n‚Ä¢ Migration Assessment Tools bewerten Kompatibilit√§t und Migrationskomplexit√§t\n‚Ä¢ Parallel Operation Periods erm√∂glichen ausgiebige Tests vor finaler Umstellung\n‚Ä¢ Rollback Procedures gew√§hrleisten sichere R√ºckkehr bei unvorhergesehenen Problemen\n\nüõ†Ô∏è Technical Implementation Details:\n‚Ä¢ Azure AD Application Proxy erm√∂glicht sichere Verbindung zu On-Premises-ADCS-Services\n‚Ä¢ VPN Gateway Integration verbindet Azure Virtual Networks mit Corporate Networks\n‚Ä¢ ExpressRoute Connectivity bietet dedizierte, hochperformante Verbindungen f√ºr PKI-Traffic\n‚Ä¢ Network Security Groups (NSGs) isolieren PKI-Traffic und implementieren Micro-Segmentation\n‚Ä¢ Azure Firewall Rules kontrollieren Zugriff auf Hybrid-PKI-Komponenten\n\nüì± Device Management Integration:\n‚Ä¢ Microsoft Intune Certificate Deployment verwaltet Zertifikate auf mobilen Ger√§ten und PCs\n‚Ä¢ SCEP (Simple Certificate Enrollment Protocol) Integration automatisiert Zertifikatsanforderungen\n‚Ä¢ Certificate-based VPN Authentication nutzt Hybrid-PKI f√ºr sichere Remote-Zugriffe\n‚Ä¢ Windows Hello for Business Integration kombiniert biometrische Authentifizierung mit PKI\n‚Ä¢ Conditional Access Policies nutzen Certificate-Status f√ºr Zugriffsentscheidungen\n\nüîê Security Considerations:\n‚Ä¢ Certificate Pinning Strategies gew√§hrleisten Vertrauen in Hybrid-Umgebungen\n‚Ä¢ Cross-Domain Certificate Validation implementiert strenge Sicherheitsrichtlinien\n‚Ä¢ Certificate Transparency Logging dokumentiert alle Certificate-Operationen\n‚Ä¢ Threat Detection Integration erkennt anomale PKI-Aktivit√§ten in Hybrid-Umgebungen\n‚Ä¢ Incident Response Procedures koordinieren Reaktionen auf Certificate-basierte Sicherheitsvorf√§lle\n\n‚ö° Automation und Orchestration:\n‚Ä¢ PowerShell DSC (Desired State Configuration) automatisiert Hybrid-PKI-Konfigurationen\n‚Ä¢ Azure Automation Runbooks orchestrieren komplexe PKI-Workflows\n‚Ä¢ Logic Apps Integration erm√∂glicht Event-driven PKI-Prozesse\n‚Ä¢ Azure Functions Certificate Processing automatisiert wiederkehrende Aufgaben\n‚Ä¢ System Center Orchestrator Integration verbindet Cloud-Automation mit On-Premises-Workflows\n\nüìä Monitoring und Compliance:\n‚Ä¢ Unified Logging across Hybrid-Umgebungen konsolidiert PKI-Audit-Trails\n‚Ä¢ Azure Monitor Integration sammelt Metriken von On-Premises und Cloud-Komponenten\n‚Ä¢ Compliance Reporting Tools generieren einheitliche Reports f√ºr Hybrid-PKI-Umgebungen\n‚Ä¢ Performance Monitoring identifiziert Bottlenecks in Hybrid-Architekturen\n‚Ä¢ Cost Optimization Tools analysieren TCO von Hybrid-PKI-Implementierungen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
