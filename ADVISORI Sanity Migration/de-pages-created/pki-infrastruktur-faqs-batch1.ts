import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating PKI Infrastructure page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'pki-infrastruktur' })
    
    if (!existingDoc) {
      throw new Error('Document "pki-infrastruktur" not found')
    }
    
    // Create new FAQs for PKI fundamentals and architecture
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was ist PKI-Infrastruktur und welche fundamentalen Komponenten umfasst sie?',
        answer: "PKI-Infrastruktur (Public Key Infrastructure) ist ein umfassendes Framework aus Hardware, Software, Richtlinien und Verfahren, das die Erstellung, Verwaltung, Verteilung, Nutzung, Speicherung und Widerrufung digitaler Zertifikate erm√∂glicht. Diese Infrastruktur bildet das technologische R√ºckgrat f√ºr sichere digitale Kommunikation und Authentifizierung in modernen Unternehmensumgebungen.\n\nüèóÔ∏è Certificate Authority (CA) Hierarchie:\n‚Ä¢ Root Certificate Authority bildet das Vertrauensanker der gesamten PKI-Infrastruktur mit h√∂chsten Sicherheitsanforderungen\n‚Ä¢ Intermediate Certificate Authorities fungieren als Vermittler zwischen Root CA und End-Entity-Zertifikaten f√ºr operative Flexibilit√§t\n‚Ä¢ Issuing Certificate Authorities stellen End-Entity-Zertifikate f√ºr Benutzer, Ger√§te und Anwendungen aus\n‚Ä¢ Cross-Certification erm√∂glicht Vertrauensbeziehungen zwischen verschiedenen PKI-Dom√§nen\n‚Ä¢ Policy Certificate Authorities definieren spezifische Zertifikatsrichtlinien f√ºr verschiedene Anwendungsbereiche\n\nüîê Kryptographische Schl√ºsselkomponenten:\n‚Ä¢ Asymmetrische Kryptographie mit √∂ffentlichen und privaten Schl√ºsselpaaren f√ºr sichere Kommunikation\n‚Ä¢ Hardware Security Modules sch√ºtzen kritische private Schl√ºssel durch tamper-resistant Hardware\n‚Ä¢ Schl√ºsselgenerierung erfolgt durch kryptographisch sichere Zufallszahlengeneratoren\n‚Ä¢ Schl√ºsselspeicherung in sicheren Repositories mit rollenbasiertem Zugriffskontrolle\n‚Ä¢ Schl√ºssel-Escrow-Mechanismen f√ºr Notfallzugriff und Compliance-Anforderungen\n\nüìã Certificate Management Infrastructure:\n‚Ä¢ Certificate Templates definieren Zertifikatstypen, G√ºltigkeitsdauern und Verwendungszwecke\n‚Ä¢ Certificate Enrollment Protocols wie SCEP, EST und CMC f√ºr automatisierte Zertifikatsanforderungen\n‚Ä¢ Certificate Stores verwalten Zertifikate in verschiedenen Formaten und Speicherorten\n‚Ä¢ Certificate Validation Services √ºberpr√ºfen Zertifikatsstatus und Vertrauensketten\n‚Ä¢ Certificate Lifecycle Management automatisiert Erneuerung, Widerruf und Archivierung\n\nüîÑ Revocation Infrastructure:\n‚Ä¢ Certificate Revocation Lists enthalten Informationen √ºber widerrufene Zertifikate mit regelm√§√üigen Updates\n‚Ä¢ Online Certificate Status Protocol erm√∂glicht Echtzeit-√úberpr√ºfung des Zertifikatsstatus\n‚Ä¢ Delta CRLs reduzieren Bandbreitenverbrauch durch inkrementelle Aktualisierungen\n‚Ä¢ Certificate Transparency Logs bieten √∂ffentliche Aufzeichnungen ausgestellter Zertifikate\n‚Ä¢ Revocation Checking Policies definieren Verhalten bei nicht erreichbaren Revocation Services\n\nüåê Directory Services und Repositories:\n‚Ä¢ LDAP-basierte Verzeichnisdienste speichern und verteilen Zertifikate und CRLs\n‚Ä¢ Certificate Repositories bieten HTTP-basierte Verteilung von Zertifikaten und Revocation-Informationen\n‚Ä¢ DNS-basierte Certificate Discovery erm√∂glicht automatische Zertifikatsfindung\n‚Ä¢ Certificate Transparency Logs bieten √∂ffentliche Aufzeichnungen f√ºr Monitoring und Compliance\n‚Ä¢ Backup und Recovery-Systeme gew√§hrleisten Verf√ºgbarkeit kritischer PKI-Daten\n\nüõ°Ô∏è Security und Compliance Framework:\n‚Ä¢ Certificate Practice Statements dokumentieren operative Verfahren und Sicherheitsma√ünahmen\n‚Ä¢ Certificate Policies definieren Vertrauensebenen und Verwendungszwecke verschiedener Zertifikatstypen\n‚Ä¢ Audit und Logging-Systeme protokollieren alle PKI-Operationen f√ºr Compliance und Forensik\n‚Ä¢ Role-based Access Control beschr√§nkt Zugriff auf PKI-Funktionen basierend auf Benutzerrollen\n‚Ä¢ Physical Security Measures sch√ºtzen kritische PKI-Komponenten vor unbefugtem Zugriff"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Welche Trust-Modelle und Hierarchien sind in PKI-Architekturen m√∂glich?',
        answer: "PKI-Trust-Modelle definieren die Struktur und Beziehungen zwischen verschiedenen Certificate Authorities und bestimmen, wie Vertrauen in einer PKI-Infrastruktur etabliert und verwaltet wird. Die Wahl des geeigneten Trust-Modells hat fundamentale Auswirkungen auf Sicherheit, Skalierbarkeit und operative Komplexit√§t der gesamten PKI-Implementierung.\n\nüèõÔ∏è Hierarchisches Trust-Modell:\n‚Ä¢ Root Certificate Authority steht an der Spitze der Vertrauenshierarchie und wird offline in hochsicherer Umgebung betrieben\n‚Ä¢ Subordinate Certificate Authorities erhalten ihre Berechtigung durch Zertifikate der √ºbergeordneten CA\n‚Ä¢ Multi-Level-Hierarchien erm√∂glichen granulare Kontrolle und Risikosegmentierung\n‚Ä¢ Policy-basierte Hierarchien definieren verschiedene Vertrauensebenen f√ºr unterschiedliche Anwendungsbereiche\n‚Ä¢ Geografische oder organisatorische Hierarchien spiegeln Unternehmensstrukturen wider\n\nüîó Cross-Certification Trust-Modell:\n‚Ä¢ Peer-to-Peer-Vertrauensbeziehungen zwischen gleichberechtigten Certificate Authorities\n‚Ä¢ Bidirektionale Cross-Zertifikate etablieren gegenseitiges Vertrauen zwischen PKI-Dom√§nen\n‚Ä¢ Bridge Certificate Authorities fungieren als zentrale Vermittler zwischen mehreren PKI-Dom√§nen\n‚Ä¢ Transitive Trust erm√∂glicht Vertrauensbeziehungen √ºber mehrere Zwischenstationen\n‚Ä¢ Policy Mapping definiert √Ñquivalenzen zwischen verschiedenen Zertifikatsrichtlinien\n\nüåê Federated Trust-Modell:\n‚Ä¢ Identity Federation erm√∂glicht Vertrauensbeziehungen zwischen verschiedenen Organisationen\n‚Ä¢ SAML-basierte Trust-Beziehungen f√ºr Single Sign-On und Identity Propagation\n‚Ä¢ OAuth und OpenID Connect f√ºr moderne API-basierte Trust-Beziehungen\n‚Ä¢ Attribute-based Trust ber√ºcksichtigt dynamische Eigenschaften und Kontextinformationen\n‚Ä¢ Zero Trust Architecture integriert PKI in kontinuierliche Verifikationsmodelle\n\nüè¢ Enterprise Trust-Architekturen:\n‚Ä¢ Internal Root CA f√ºr organisationsinterne Vertrauensbeziehungen mit vollst√§ndiger Kontrolle\n‚Ä¢ External Trust Anchors f√ºr Vertrauensbeziehungen zu √∂ffentlichen Certificate Authorities\n‚Ä¢ Hybrid Trust Models kombinieren interne und externe Vertrauensquellen\n‚Ä¢ Department-specific Sub-CAs f√ºr organisatorische Segmentierung und Delegation\n‚Ä¢ Application-specific Trust Stores f√ºr spezialisierte Anwendungsanforderungen\n\nüîÑ Dynamic Trust-Modelle:\n‚Ä¢ Contextual Trust ber√ºcksichtigt situative Faktoren bei Vertrauensentscheidungen\n‚Ä¢ Risk-based Trust passt Vertrauensebenen an aktuelle Bedrohungslagen an\n‚Ä¢ Temporal Trust definiert zeitlich begrenzte Vertrauensbeziehungen\n‚Ä¢ Conditional Trust erfordert zus√§tzliche Authentifizierungsfaktoren unter bestimmten Umst√§nden\n‚Ä¢ Adaptive Trust lernt aus Verhaltensmustern und passt Vertrauensebenen entsprechend an\n\n‚öñÔ∏è Trust-Modell-Bewertungskriterien:\n‚Ä¢ Skalierbarkeit der Trust-Architektur f√ºr wachsende Organisationen und Anwendungsbereiche\n‚Ä¢ Sicherheitsrisiken durch Single Points of Failure und Kompromittierungsszenarien\n‚Ä¢ Operative Komplexit√§t bei Verwaltung und Wartung der Trust-Beziehungen\n‚Ä¢ Compliance-Anforderungen verschiedener Regulierungsrahmen und Branchenstandards\n‚Ä¢ Interoperabilit√§t mit bestehenden Systemen und externen Partnern\n\nüõ†Ô∏è Trust-Modell-Implementierungsstrategien:\n‚Ä¢ Phased Rollout beginnt mit einfachen Hierarchien und erweitert schrittweise Komplexit√§t\n‚Ä¢ Pilot Programs testen Trust-Modelle in kontrollierten Umgebungen vor Vollimplementierung\n‚Ä¢ Migration Strategies f√ºr √úbergang zwischen verschiedenen Trust-Modellen\n‚Ä¢ Monitoring und Analytics √ºberwachen Trust-Beziehungen und identifizieren Anomalien\n‚Ä¢ Disaster Recovery Procedures gew√§hrleisten Kontinuit√§t bei Kompromittierung von Trust Anchors"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Wie funktioniert Certificate Lifecycle Management in modernen PKI-Systemen?',
        answer: "Certificate Lifecycle Management umfasst alle Phasen der Zertifikatsverwaltung von der initialen Erstellung bis zur finalen Archivierung und bildet das operative Herzst√ºck jeder PKI-Infrastruktur. Effizientes Lifecycle Management ist entscheidend f√ºr Sicherheit, Compliance und operative Effizienz der gesamten PKI-Implementierung.\n\nüöÄ Certificate Enrollment und Provisioning:\n‚Ä¢ Automated Certificate Enrollment eliminiert manuelle Prozesse durch Policy-basierte Automatisierung\n‚Ä¢ Self-Service Portals erm√∂glichen Benutzern eigenst√§ndige Zertifikatsanforderungen mit Workflow-Integration\n‚Ä¢ Bulk Enrollment Processes f√ºr Massenausstellung von Zertifikaten bei Ger√§temigrationen\n‚Ä¢ Just-in-Time Provisioning erstellt Zertifikate dynamisch bei Bedarf\n‚Ä¢ Template-based Enrollment gew√§hrleistet konsistente Zertifikatskonfigurationen\n\nüìä Certificate Inventory und Discovery:\n‚Ä¢ Automated Certificate Discovery identifiziert alle Zertifikate in der Infrastruktur\n‚Ä¢ Certificate Inventory Management verwaltet zentrale Datenbank aller ausgestellten Zertifikate\n‚Ä¢ Network Scanning Tools finden unbekannte oder nicht verwaltete Zertifikate\n‚Ä¢ Application Integration erm√∂glicht Zertifikatsverfolgung in Anwendungskontext\n‚Ä¢ Shadow IT Detection identifiziert nicht autorisierte Zertifikatsnutzung\n\n‚è∞ Proactive Certificate Renewal:\n‚Ä¢ Expiration Monitoring √ºberwacht Ablaufzeiten und sendet proaktive Benachrichtigungen\n‚Ä¢ Automated Renewal Workflows erneuern Zertifikate automatisch vor Ablauf\n‚Ä¢ Grace Period Management definiert Zeitfenster f√ºr Zertifikatserneuerung\n‚Ä¢ Renewal Policies ber√ºcksichtigen verschiedene Zertifikatstypen und Anwendungsanforderungen\n‚Ä¢ Rollback Mechanisms erm√∂glichen R√ºckkehr zu vorherigen Zertifikatsversionen bei Problemen\n\nüîÑ Certificate Deployment und Distribution:\n‚Ä¢ Automated Deployment Pipelines integrieren Zertifikatsmanagement in DevOps-Workflows\n‚Ä¢ Multi-Platform Distribution unterst√ºtzt verschiedene Betriebssysteme und Anwendungen\n‚Ä¢ Certificate Stores Management verwaltet Zertifikate in verschiedenen Speicherorten\n‚Ä¢ API-based Integration erm√∂glicht programmatische Zertifikatsverwaltung\n‚Ä¢ Configuration Management Tools automatisieren Zertifikatskonfiguration in Anwendungen\n\nüö® Certificate Revocation Management:\n‚Ä¢ Real-time Revocation erm√∂glicht sofortigen Widerruf kompromittierter Zertifikate\n‚Ä¢ Revocation Reason Codes dokumentieren Gr√ºnde f√ºr Zertifikatswiderruf\n‚Ä¢ Emergency Revocation Procedures f√ºr kritische Sicherheitsvorf√§lle\n‚Ä¢ Revocation Notification Systems informieren betroffene Systeme und Benutzer\n‚Ä¢ Post-Revocation Cleanup entfernt widerrufene Zertifikate aus allen Systemen\n\nüìà Certificate Analytics und Reporting:\n‚Ä¢ Usage Analytics analysieren Zertifikatsnutzung und identifizieren Optimierungspotenziale\n‚Ä¢ Compliance Reporting generiert Berichte f√ºr Audit und regulatorische Anforderungen\n‚Ä¢ Risk Assessment bewertet Sicherheitsrisiken basierend auf Zertifikatsstatus\n‚Ä¢ Performance Metrics √ºberwachen Effizienz von Lifecycle-Prozessen\n‚Ä¢ Trend Analysis identifiziert Muster und prognostiziert zuk√ºnftige Anforderungen\n\nüîß Lifecycle Automation und Orchestration:\n‚Ä¢ Workflow Engines orchestrieren komplexe Lifecycle-Prozesse\n‚Ä¢ Event-driven Architecture reagiert automatisch auf Lifecycle-Ereignisse\n‚Ä¢ Integration APIs verbinden Certificate Lifecycle Management mit anderen IT-Systemen\n‚Ä¢ Policy Engines durchsetzen organisatorische Richtlinien automatisch\n‚Ä¢ Exception Handling verwaltet Abweichungen von Standard-Lifecycle-Prozessen\n\nüõ°Ô∏è Security und Compliance Integration:\n‚Ä¢ Audit Trails dokumentieren alle Lifecycle-Aktivit√§ten f√ºr Compliance und Forensik\n‚Ä¢ Role-based Access Control beschr√§nkt Lifecycle-Operationen basierend auf Benutzerrollen\n‚Ä¢ Segregation of Duties verhindert Interessenkonflikte bei kritischen Operationen\n‚Ä¢ Compliance Validation √ºberpr√ºft Einhaltung regulatorischer Anforderungen\n‚Ä¢ Security Monitoring erkennt anomale Lifecycle-Aktivit√§ten und potenzielle Bedrohungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Welche Sicherheitsanforderungen und Best Practices gelten f√ºr PKI-Implementierungen?',
        answer: "PKI-Sicherheit erfordert einen mehrschichtigen Ansatz, der physische, technische und administrative Sicherheitsma√ünahmen kombiniert, um die Integrit√§t und Vertraulichkeit der gesamten Vertrauensinfrastruktur zu gew√§hrleisten. Die Sicherheit einer PKI ist nur so stark wie ihr schw√§chstes Glied, weshalb umfassende Sicherheitskonzepte unerl√§sslich sind.\n\nüè∞ Root CA Security und Air-Gap-Architektur:\n‚Ä¢ Offline Root Certificate Authorities werden physisch von Netzwerken getrennt betrieben\n‚Ä¢ Hardware Security Modules sch√ºtzen Root CA Private Keys durch tamper-resistant Hardware\n‚Ä¢ Dual Control und Split Knowledge erfordern mehrere Personen f√ºr kritische Operationen\n‚Ä¢ Secure Facilities mit biometrischen Zugangskontrollen und √úberwachungssystemen\n‚Ä¢ Ceremony-based Operations dokumentieren und kontrollieren alle Root CA Aktivit√§ten\n\nüîê Cryptographic Security Standards:\n‚Ä¢ Algorithm Agility erm√∂glicht Migration zu st√§rkeren kryptographischen Algorithmen\n‚Ä¢ Key Length Requirements folgen aktuellen NIST und BSI Empfehlungen\n‚Ä¢ Quantum-resistant Cryptography Vorbereitung f√ºr Post-Quantum-√Ñra\n‚Ä¢ Secure Random Number Generation f√ºr kryptographische Schl√ºsselerzeugung\n‚Ä¢ Perfect Forward Secrecy durch ephemere Schl√ºssel f√ºr Session-basierte Kommunikation\n\nüõ°Ô∏è Infrastructure Hardening und Defense in Depth:\n‚Ä¢ Network Segmentation isoliert PKI-Komponenten in dedizierten Sicherheitszonen\n‚Ä¢ Firewall Rules beschr√§nken Netzwerkzugriff auf notwendige Protokolle und Ports\n‚Ä¢ Intrusion Detection Systems √ºberwachen PKI-Infrastruktur auf Anomalien\n‚Ä¢ Vulnerability Management identifiziert und behebt Sicherheitsl√ºcken proaktiv\n‚Ä¢ Security Patching Procedures gew√§hrleisten zeitnahe Updates kritischer Komponenten\n\nüë• Identity und Access Management Integration:\n‚Ä¢ Multi-Factor Authentication f√ºr alle administrativen PKI-Zugriffe\n‚Ä¢ Privileged Access Management kontrolliert und √ºberwacht administrative Aktivit√§ten\n‚Ä¢ Role-based Access Control implementiert Principle of Least Privilege\n‚Ä¢ Just-in-Time Access gew√§hrt tempor√§re Berechtigungen f√ºr spezifische Aufgaben\n‚Ä¢ Regular Access Reviews validieren und aktualisieren Benutzerberechtigungen\n\nüìä Monitoring und Incident Response:\n‚Ä¢ Security Information and Event Management sammelt und analysiert PKI-Logs\n‚Ä¢ Real-time Alerting benachrichtigt bei kritischen Sicherheitsereignissen\n‚Ä¢ Behavioral Analytics erkennt anomale Aktivit√§tsmuster\n‚Ä¢ Incident Response Procedures definieren Reaktionen auf Sicherheitsvorf√§lle\n‚Ä¢ Forensic Capabilities erm√∂glichen detaillierte Analyse von Sicherheitsvorf√§llen\n\nüîÑ Business Continuity und Disaster Recovery:\n‚Ä¢ High Availability Architectures gew√§hrleisten kontinuierliche PKI-Verf√ºgbarkeit\n‚Ä¢ Backup und Recovery Procedures f√ºr alle kritischen PKI-Komponenten\n‚Ä¢ Geographic Redundancy sch√ºtzt vor lokalen Katastrophen\n‚Ä¢ Disaster Recovery Testing validiert Wiederherstellungsverfahren regelm√§√üig\n‚Ä¢ Emergency Procedures f√ºr Kompromittierungsszenarien\n\nüìã Compliance und Governance Framework:\n‚Ä¢ Certificate Practice Statements dokumentieren Sicherheitsverfahren transparent\n‚Ä¢ Regular Security Audits validieren Einhaltung von Sicherheitsstandards\n‚Ä¢ Compliance Monitoring √ºberwacht Einhaltung regulatorischer Anforderungen\n‚Ä¢ Risk Assessment bewertet und priorisiert Sicherheitsrisiken kontinuierlich\n‚Ä¢ Security Awareness Training f√ºr alle PKI-Stakeholder\n\nüîß Operational Security Practices:\n‚Ä¢ Change Management Procedures kontrollieren √Ñnderungen an PKI-Systemen\n‚Ä¢ Configuration Management gew√§hrleistet konsistente und sichere Konfigurationen\n‚Ä¢ Secure Development Lifecycle f√ºr PKI-Anwendungen und -Integrationen\n‚Ä¢ Third-Party Risk Management bewertet Sicherheitsrisiken von Lieferanten\n‚Ä¢ Continuous Security Improvement durch Lessons Learned und Best Practice Updates"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
