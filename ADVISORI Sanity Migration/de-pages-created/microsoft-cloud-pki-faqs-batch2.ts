import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Microsoft Cloud PKI page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'microsoft-cloud-pki' })
    
    if (!existingDoc) {
      throw new Error('Document "microsoft-cloud-pki" not found')
    }
    
    // Create new FAQs for PowerShell automation and API integration
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie funktioniert PowerShell Automatisierung f√ºr Microsoft Cloud PKI und welche Module sind f√ºr Certificate Lifecycle Management verf√ºgbar?',
        answer: "PowerShell Automatisierung bildet das R√ºckgrat moderner Microsoft Cloud PKI-Implementierungen und erm√∂glicht es Organisationen, komplexe Certificate Lifecycle Management-Prozesse zu standardisieren, zu automatisieren und zu skalieren. Die umfassenden PowerShell-Module f√ºr Azure Key Vault und Microsoft Graph bieten dabei eine m√§chtige Grundlage f√ºr Enterprise-grade PKI-Automatisierung.\n\n‚ö° Azure Key Vault PowerShell Module:\n‚Ä¢ Az.KeyVault Module bietet umfassende Cmdlets f√ºr Certificate Management, Key Operations und Vault Administration\n‚Ä¢ New-AzKeyVaultCertificate automatisiert Zertifikatserstellung mit konfigurierbaren Templates und Policies\n‚Ä¢ Get-AzKeyVaultCertificate erm√∂glicht Bulk-Abfragen und Monitoring von Zertifikatsstatus\n‚Ä¢ Update-AzKeyVaultCertificate automatisiert Certificate Renewal und Policy Updates\n‚Ä¢ Remove-AzKeyVaultCertificate implementiert sichere Certificate Revocation mit Audit Trails\n\nüîê Certificate Lifecycle Automation:\n‚Ä¢ Automated Certificate Enrollment nutzt PowerShell Workflows f√ºr Self-Service Certificate Requests\n‚Ä¢ Certificate Renewal Automation √ºberwacht Ablaufzeiten und initiiert automatische Erneuerungen\n‚Ä¢ Certificate Distribution Scripts verteilen Zertifikate an verschiedene Azure Services und On-Premises Systeme\n‚Ä¢ Certificate Validation Automation √ºberpr√ºft kontinuierlich Certificate Health und Compliance\n‚Ä¢ Certificate Revocation Workflows automatisieren Widerrufsprozesse bei Sicherheitsvorf√§llen\n\nüìä Microsoft Graph API Integration:\n‚Ä¢ Microsoft.Graph PowerShell Module erm√∂glicht Certificate Operations √ºber Graph API\n‚Ä¢ Certificate-based Authentication Automation konfiguriert App Registrations und Service Principals\n‚Ä¢ User Certificate Assignment automatisiert S/MIME Certificate Deployment f√ºr Exchange Online\n‚Ä¢ Device Certificate Management integriert mit Intune f√ºr Mobile Device Certificate Deployment\n‚Ä¢ Conditional Access Certificate Policies werden programmatisch konfiguriert und verwaltet\n\nüõ†Ô∏è Advanced Automation Scenarios:\n‚Ä¢ Certificate Template Management automatisiert Erstellung und Wartung von Certificate Templates\n‚Ä¢ Cross-Tenant Certificate Operations erm√∂glichen sichere Multi-Organization Certificate Sharing\n‚Ä¢ Certificate Backup and Recovery Automation implementiert Disaster Recovery Procedures\n‚Ä¢ Certificate Compliance Reporting generiert automatisierte Audit Reports und Dashboards\n‚Ä¢ Certificate Cost Optimization analysiert und optimiert Certificate Usage und Kosten\n\nüîÑ DevOps Pipeline Integration:\n‚Ä¢ Azure DevOps PowerShell Tasks integrieren Certificate Operations in CI/CD Pipelines\n‚Ä¢ Infrastructure as Code Templates definieren Certificate Infrastructure deklarativ\n‚Ä¢ GitOps Workflows erm√∂glichen Versionskontrolle und Change Management f√ºr Certificate Policies\n‚Ä¢ Automated Testing Frameworks validieren Certificate Configurations vor Deployment\n‚Ä¢ Blue-Green Certificate Deployment minimiert Risiken bei Certificate Updates\n\nüåê Hybrid Environment Automation:\n‚Ä¢ Cross-Platform PowerShell Core erm√∂glicht Certificate Automation auf Linux und macOS\n‚Ä¢ On-Premises Integration Scripts verbinden Cloud PKI mit lokalen Active Directory Certificate Services\n‚Ä¢ Certificate Synchronization Automation repliziert Certificates zwischen verschiedenen Umgebungen\n‚Ä¢ Hybrid Certificate Authority Management orchestriert komplexe Multi-CA Hierarchien\n‚Ä¢ Cross-Cloud Certificate Operations unterst√ºtzen Multi-Cloud PKI Architekturen\n\nüì± Monitoring und Alerting Automation:\n‚Ä¢ Certificate Health Monitoring Scripts √ºberwachen kontinuierlich Certificate Status\n‚Ä¢ Automated Alert Systems benachrichtigen bei Certificate Expiration oder Compliance Issues\n‚Ä¢ Performance Monitoring Automation sammelt Metriken f√ºr Certificate Operations\n‚Ä¢ Security Event Automation reagiert automatisch auf Certificate-basierte Sicherheitsereignisse\n‚Ä¢ Capacity Planning Automation prognostiziert Certificate Usage und Ressourcenbedarf\n\nüîß Custom Module Development:\n‚Ä¢ Custom PowerShell Modules kapseln organisationsspezifische Certificate Workflows\n‚Ä¢ Reusable Function Libraries standardisieren Certificate Operations across Teams\n‚Ä¢ Error Handling und Logging Frameworks gew√§hrleisten robuste Certificate Automation\n‚Ä¢ Configuration Management Modules verwalten Certificate Policies und Settings\n‚Ä¢ Integration Modules verbinden Certificate Automation mit Third-Party Systems"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Azure Security Center Integration-M√∂glichkeiten gibt es f√ºr PKI-Monitoring und wie wird Certificate Health Monitoring implementiert?',
        answer: "Azure Security Center Integration transformiert Microsoft Cloud PKI von einer isolierten Certificate Management-L√∂sung zu einem integralen Bestandteil der organisationsweiten Sicherheitsstrategie. Diese Integration erm√∂glicht proaktives Certificate Health Monitoring, automatisierte Threat Detection und umfassende Compliance-√úberwachung durch native Azure Security Services.\n\nüõ°Ô∏è Azure Security Center Certificate Monitoring:\n‚Ä¢ Certificate Health Assessments integrieren sich nahtlos in Security Center Recommendations\n‚Ä¢ Certificate Expiration Monitoring generiert automatische Security Alerts bei kritischen Ablaufzeiten\n‚Ä¢ Certificate Compliance Scoring bewertet PKI-Konfigurationen gegen Industry Standards und Best Practices\n‚Ä¢ Certificate Vulnerability Assessment identifiziert schwache Kryptographie und veraltete Certificate Policies\n‚Ä¢ Certificate Configuration Drift Detection erkennt ungenehmigte √Ñnderungen an PKI-Konfigurationen\n\nüîç Azure Sentinel PKI Security Analytics:\n‚Ä¢ Certificate-based Attack Detection nutzt Machine Learning f√ºr Anomaly Detection\n‚Ä¢ Certificate Abuse Monitoring identifiziert verd√§chtige Certificate Usage Patterns\n‚Ä¢ Certificate Lifecycle Analytics korreliert Certificate Events mit Security Incidents\n‚Ä¢ Certificate Threat Intelligence integriert externe Threat Feeds f√ºr Certificate-basierte Bedrohungen\n‚Ä¢ Certificate Incident Response Automation orchestriert Reaktionen auf Certificate Security Events\n\nüìä Comprehensive Certificate Dashboards:\n‚Ä¢ Real-time Certificate Health Dashboards visualisieren PKI Status across der gesamten Organisation\n‚Ä¢ Certificate Compliance Dashboards zeigen Adherence zu regulatorischen Anforderungen\n‚Ä¢ Certificate Performance Dashboards monitoren Certificate Operations und Service Level Agreements\n‚Ä¢ Certificate Cost Dashboards analysieren PKI-bezogene Ausgaben und Optimierungsm√∂glichkeiten\n‚Ä¢ Certificate Risk Dashboards bewerten und priorisieren Certificate-basierte Sicherheitsrisiken\n\n‚ö†Ô∏è Automated Threat Detection:\n‚Ä¢ Certificate Misuse Detection identifiziert unauthorized Certificate Usage\n‚Ä¢ Certificate Spoofing Detection erkennt gef√§lschte oder kompromittierte Certificates\n‚Ä¢ Certificate Chain Validation Monitoring √ºberwacht Trust Chain Integrity\n‚Ä¢ Certificate Revocation Monitoring verfolgt CRL und OCSP Response Anomalien\n‚Ä¢ Certificate-based Lateral Movement Detection identifiziert verd√§chtige Certificate-basierte Authentifizierung\n\nüîê Advanced Security Analytics:\n‚Ä¢ Certificate Behavioral Analytics lernt normale Certificate Usage Patterns\n‚Ä¢ Certificate Risk Scoring bewertet Certificates basierend auf verschiedenen Risikofaktoren\n‚Ä¢ Certificate Correlation Analysis verbindet Certificate Events mit anderen Security Telemetry\n‚Ä¢ Certificate Forensics Tools unterst√ºtzen Incident Investigation und Root Cause Analysis\n‚Ä¢ Certificate Threat Hunting Capabilities erm√∂glichen proaktive Security Research\n\nüìà Performance und Availability Monitoring:\n‚Ä¢ Certificate Service Availability Monitoring √ºberwacht PKI Service Health\n‚Ä¢ Certificate Response Time Monitoring misst Performance von Certificate Operations\n‚Ä¢ Certificate Throughput Analytics analysiert Certificate Issuance und Validation Volumes\n‚Ä¢ Certificate Error Rate Monitoring identifiziert Service Quality Issues\n‚Ä¢ Certificate Capacity Planning nutzt Historical Data f√ºr Ressourcenplanung\n\nüîÑ Integration mit Azure Monitor:\n‚Ä¢ Certificate Metrics Collection sammelt detaillierte PKI Performance Daten\n‚Ä¢ Certificate Log Analytics korreliert Certificate Events mit System Logs\n‚Ä¢ Certificate Custom Metrics erm√∂glichen organisationsspezifische Monitoring Requirements\n‚Ä¢ Certificate Alerting Rules automatisieren Notifications bei kritischen Events\n‚Ä¢ Certificate Workbooks bieten interaktive Certificate Analytics und Reporting\n\nüåê Multi-Cloud Security Integration:\n‚Ä¢ Cross-Cloud Certificate Monitoring erweitert Visibility auf Multi-Cloud Environments\n‚Ä¢ Hybrid Certificate Security Analytics korreliert On-Premises und Cloud Certificate Events\n‚Ä¢ Third-Party Security Tool Integration verbindet Certificate Monitoring mit bestehenden SIEM Systems\n‚Ä¢ Certificate Security Orchestration automatisiert Response Actions across verschiedene Platforms\n‚Ä¢ Certificate Compliance Reporting konsolidiert Multi-Environment Certificate Status"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie wird Cloud PKI Governance und Compliance Management in Microsoft-Umgebungen implementiert und welche Audit-Funktionen stehen zur Verf√ºgung?',
        answer: "Cloud PKI Governance und Compliance Management in Microsoft-Umgebungen erfordert einen systematischen Ansatz, der technische Controls mit organisatorischen Policies kombiniert. Microsoft bietet dabei eine umfassende Suite von Tools und Services, die es erm√∂glichen, PKI-Governance zu automatisieren, Compliance zu √ºberwachen und umfassende Audit-Trails zu erstellen.\n\nüìã Azure Policy Certificate Compliance:\n‚Ä¢ Certificate Policy Definitions implementieren organisationsweite PKI Standards und Richtlinien\n‚Ä¢ Certificate Compliance Assessment automatisiert regelm√§√üige √úberpr√ºfungen gegen definierte Policies\n‚Ä¢ Certificate Remediation Actions korrigieren automatisch Policy Violations\n‚Ä¢ Certificate Exception Management verwaltet genehmigte Abweichungen von Standard Policies\n‚Ä¢ Certificate Policy Inheritance erm√∂glicht hierarchische Policy Structures f√ºr komplexe Organisationen\n\nüîç Microsoft Purview Certificate Governance:\n‚Ä¢ Certificate Data Classification kategorisiert Certificates basierend auf Sensitivity und Business Impact\n‚Ä¢ Certificate Lifecycle Governance automatisiert Certificate Management basierend auf Data Classification\n‚Ä¢ Certificate Access Governance kontrolliert wer Certificates erstellen, verwenden und verwalten kann\n‚Ä¢ Certificate Retention Policies definieren Aufbewahrungszeiten f√ºr Certificate-bezogene Daten\n‚Ä¢ Certificate Privacy Impact Assessment bewertet Datenschutz-Implikationen von Certificate Usage\n\nüìä Comprehensive Audit und Reporting:\n‚Ä¢ Azure Monitor Certificate Auditing sammelt detaillierte Logs aller Certificate Operations\n‚Ä¢ Log Analytics Certificate Queries erm√∂glichen komplexe Audit Analysen und Reporting\n‚Ä¢ Certificate Audit Dashboards visualisieren Compliance Status und Audit Findings\n‚Ä¢ Certificate Compliance Reports generieren automatisierte Reports f√ºr regulatorische Anforderungen\n‚Ä¢ Certificate Audit Trail Preservation gew√§hrleistet langfristige Aufbewahrung von Audit Daten\n\nüèõÔ∏è Regulatory Compliance Frameworks:\n‚Ä¢ SOX Certificate Compliance implementiert Controls f√ºr Financial Reporting Requirements\n‚Ä¢ GDPR Certificate Privacy Controls gew√§hrleisten Datenschutz-konforme Certificate Handling\n‚Ä¢ HIPAA Certificate Security Controls sichern Healthcare-spezifische Certificate Requirements\n‚Ä¢ PCI DSS Certificate Requirements implementieren Payment Card Industry Standards\n‚Ä¢ ISO 27001 Certificate Controls unterst√ºtzen Information Security Management System Requirements\n\n‚öñÔ∏è Certificate Governance Frameworks:\n‚Ä¢ Certificate Authority Governance definiert Roles, Responsibilities und Approval Processes\n‚Ä¢ Certificate Policy Management implementiert Certificate Practice Statements und Certificate Policies\n‚Ä¢ Certificate Risk Management identifiziert, bewertet und mitigiert Certificate-bezogene Risiken\n‚Ä¢ Certificate Change Management kontrolliert √Ñnderungen an Certificate Infrastructure und Policies\n‚Ä¢ Certificate Incident Management definiert Prozesse f√ºr Certificate-bezogene Security Incidents\n\nüîê Access Control und Segregation of Duties:\n‚Ä¢ Role-Based Access Control (RBAC) implementiert granulare Berechtigungen f√ºr Certificate Operations\n‚Ä¢ Privileged Access Management (PAM) kontrolliert Administrative Access zu Certificate Infrastructure\n‚Ä¢ Segregation of Duties Controls trennen Certificate Request, Approval und Issuance Processes\n‚Ä¢ Certificate Approval Workflows implementieren Multi-Level Approval f√ºr kritische Certificate Operations\n‚Ä¢ Certificate Access Reviews √ºberpr√ºfen regelm√§√üig Berechtigungen und Access Rights\n\nüìà Continuous Compliance Monitoring:\n‚Ä¢ Real-time Compliance Monitoring √ºberwacht kontinuierlich Certificate Compliance Status\n‚Ä¢ Certificate Compliance Scoring bewertet Overall Compliance Posture\n‚Ä¢ Certificate Risk Indicators identifizieren potenzielle Compliance Issues\n‚Ä¢ Certificate Compliance Trends analysieren Compliance Performance √ºber Zeit\n‚Ä¢ Certificate Compliance Alerting benachrichtigt bei kritischen Compliance Violations\n\nüîÑ Certificate Lifecycle Governance:\n‚Ä¢ Certificate Request Governance kontrolliert wer Certificates anfordern kann und f√ºr welche Zwecke\n‚Ä¢ Certificate Issuance Governance implementiert Approval Workflows und Validation Processes\n‚Ä¢ Certificate Usage Governance √ºberwacht und kontrolliert Certificate Usage Patterns\n‚Ä¢ Certificate Renewal Governance automatisiert Renewal Processes unter Compliance Constraints\n‚Ä¢ Certificate Revocation Governance definiert Processes f√ºr Certificate Revocation und Incident Response\n\nüåê Multi-Tenant und Cross-Organization Governance:\n‚Ä¢ Multi-Tenant Certificate Governance isoliert Certificate Operations zwischen verschiedenen Tenants\n‚Ä¢ Cross-Organization Certificate Trust Management kontrolliert Certificate Trust Relationships\n‚Ä¢ Certificate Federation Governance regelt Certificate Usage in federated Environments\n‚Ä¢ Certificate Vendor Management √ºberwacht Third-Party Certificate Providers und Services\n‚Ä¢ Certificate Supply Chain Governance sichert Certificate Supply Chain Integrity"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Kostenoptimierung und Performance-Optimierung Strategien gibt es f√ºr Microsoft Cloud PKI und wie wird Cost Management implementiert?',
        answer: "Kostenoptimierung und Performance-Optimierung f√ºr Microsoft Cloud PKI erfordern einen strategischen Ansatz, der technische Effizienz mit wirtschaftlicher Verantwortung kombiniert. Microsoft Azure bietet dabei umfassende Tools und Methoden, um PKI-Kosten zu kontrollieren, Performance zu maximieren und Return on Investment zu optimieren.\n\nüí∞ Azure Cost Management f√ºr PKI:\n‚Ä¢ Certificate Cost Tracking kategorisiert und verfolgt alle PKI-bezogenen Ausgaben across verschiedene Azure Services\n‚Ä¢ Certificate Usage Analytics identifiziert Kostenverursacher und Optimierungsm√∂glichkeiten\n‚Ä¢ Certificate Budget Management implementiert Spending Limits und Cost Alerts f√ºr PKI Operations\n‚Ä¢ Certificate Cost Allocation verteilt PKI-Kosten auf verschiedene Business Units oder Projects\n‚Ä¢ Certificate ROI Analysis bewertet Return on Investment f√ºr PKI-Investitionen\n\n‚ö° Performance Optimization Strategies:\n‚Ä¢ Certificate Caching Strategies reduzieren Latency und verbessern Response Times f√ºr Certificate Operations\n‚Ä¢ Certificate Load Balancing verteilt Certificate Requests optimal across verf√ºgbare Resources\n‚Ä¢ Certificate Connection Pooling optimiert Database Connections f√ºr Certificate Storage\n‚Ä¢ Certificate Batch Processing konsolidiert Multiple Certificate Operations f√ºr bessere Effizienz\n‚Ä¢ Certificate Compression reduziert Storage und Network Overhead f√ºr Certificate Data\n\nüîß Resource Optimization Techniques:\n‚Ä¢ Right-Sizing Certificate Infrastructure passt Resources an tats√§chliche Usage Patterns an\n‚Ä¢ Certificate Auto-Scaling implementiert dynamische Resource Allocation basierend auf Demand\n‚Ä¢ Certificate Reserved Instances nutzen Azure Reserved Capacity f√ºr predictable Workloads\n‚Ä¢ Certificate Spot Instances verwenden kosteng√ºnstige Spot Pricing f√ºr non-critical Operations\n‚Ä¢ Certificate Resource Scheduling optimiert Resource Usage durch zeitbasierte Allocation\n\nüìä Certificate Lifecycle Cost Optimization:\n‚Ä¢ Certificate Lifecycle Analysis identifiziert kostenintensive Phasen im Certificate Lifecycle\n‚Ä¢ Certificate Renewal Optimization automatisiert Renewal Processes f√ºr Kosteneffizienz\n‚Ä¢ Certificate Consolidation reduziert Anzahl von Certificates durch intelligente Grouping\n‚Ä¢ Certificate Template Optimization standardisiert Certificate Types f√ºr bessere Economies of Scale\n‚Ä¢ Certificate Expiration Management vermeidet Emergency Renewals und damit verbundene Zusatzkosten\n\nüåê Multi-Region Cost Optimization:\n‚Ä¢ Certificate Geographic Distribution optimiert Costs durch strategische Regional Placement\n‚Ä¢ Certificate Data Transfer Optimization minimiert Cross-Region Data Transfer Costs\n‚Ä¢ Certificate Regional Failover implementiert Cost-Effective Disaster Recovery Strategies\n‚Ä¢ Certificate Edge Caching reduziert Latency und Bandwidth Costs\n‚Ä¢ Certificate CDN Integration optimiert Global Certificate Distribution Costs\n\nüîç Certificate Usage Optimization:\n‚Ä¢ Certificate Usage Analytics identifiziert underutilized oder redundante Certificates\n‚Ä¢ Certificate Decommissioning Processes entfernen unused Certificates und reduzieren Costs\n‚Ä¢ Certificate Sharing Strategies erm√∂glichen Certificate Reuse across verschiedene Applications\n‚Ä¢ Certificate Wildcard Optimization nutzt Wildcard Certificates f√ºr Cost-Effective Domain Coverage\n‚Ä¢ Certificate SAN Optimization maximiert Subject Alternative Name Usage f√ºr Multi-Domain Certificates\n\nüìà Performance Monitoring und Tuning:\n‚Ä¢ Certificate Performance Baselines etablieren Performance Standards und Benchmarks\n‚Ä¢ Certificate Bottleneck Analysis identifiziert Performance Constraints in PKI Infrastructure\n‚Ä¢ Certificate Query Optimization verbessert Database Performance f√ºr Certificate Lookups\n‚Ä¢ Certificate Index Optimization optimiert Database Indexes f√ºr h√§ufige Certificate Queries\n‚Ä¢ Certificate Archive Strategies implementieren Tiered Storage f√ºr Historical Certificate Data\n\nüõ†Ô∏è Automation f√ºr Cost und Performance:\n‚Ä¢ Certificate Automation Frameworks reduzieren Manual Overhead und damit verbundene Costs\n‚Ä¢ Certificate Self-Service Portals reduzieren Administrative Overhead durch User Self-Service\n‚Ä¢ Certificate Workflow Optimization streamlined Certificate Request und Approval Processes\n‚Ä¢ Certificate Integration Automation reduziert Integration Costs durch standardisierte APIs\n‚Ä¢ Certificate Monitoring Automation identifiziert proaktiv Performance und Cost Issues\n\nüîÑ Continuous Optimization Processes:\n‚Ä¢ Certificate Cost Review Cycles implementieren regelm√§√üige Cost Optimization Reviews\n‚Ä¢ Certificate Performance Tuning Cycles optimieren kontinuierlich PKI Performance\n‚Ä¢ Certificate Capacity Planning prognostiziert Future Resource Requirements und Costs\n‚Ä¢ Certificate Technology Refresh Cycles evaluieren neue Technologies f√ºr Cost und Performance Benefits\n‚Ä¢ Certificate Vendor Optimization bewertet Alternative Certificate Providers und Services f√ºr Cost Savings"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
