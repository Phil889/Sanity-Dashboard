import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating FRTB Gap-Analyse Daten & Prozesse page with FAQs batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'frtb-gap-analyse-daten-prozesse' })
    
    if (!existingDoc) {
      throw new Error('Document "frtb-gap-analyse-daten-prozesse" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Wie unterscheiden sich die Datenanforderungen zwischen dem Standardansatz (SA-TB) und dem internen Modellansatz (IMA) unter FRTB?",
        answer: "Die Datenanforderungen f√ºr den Standardansatz (SA-TB) und den internen Modellansatz (IMA) unter FRTB unterscheiden sich fundamental in ihrer Granularit√§t, Komplexit√§t und den damit verbundenen Prozessanforderungen. Diese Unterschiede haben weitreichende Implikationen f√ºr die Datenarchitektur und die strategischen Entscheidungen einer Bank bei der FRTB-Implementierung.\n\nüìä Datenanforderungen im Standardansatz (SA-TB):\n‚Ä¢ Sensitivit√§tsbasierte Berechnung: Erfassung und Speicherung tausender Delta-, Vega- und Curvature-Sensitivit√§ten f√ºr jede Position, gegliedert nach pr√§zise definierten Risikofaktoren und Buckets.\n‚Ä¢ Risikofaktor-Mapping: Detaillierte Zuordnung jeder Position zu standardisierten Risikofaktoren und Risikobuckets mit umfangreichen Attributen f√ºr die korrekte Klassifizierung.\n‚Ä¢ Default Risk Charge (DRC): Granulare Informationen zu Emittenten, Kreditqualit√§t, Laufzeiten und JTD-Betr√§gen (Jump-to-Default) f√ºr Anleihen, Kredite und Derivate.\n‚Ä¢ Residual Risk Add-On (RRAO): Identifizierung exotischer Instrumente und deren spezifischer Risikokomponenten, die nicht durch die Sensitivit√§tsanalyse abgedeckt sind.\n\nüìà Datenanforderungen im internen Modellansatz (IMA):\n‚Ä¢ Historische Zeitreihen: Umfassende Datenhistorien (10+ Jahre) f√ºr alle modellierbaren Risikofaktoren mit t√§glicher Granularit√§t f√ºr Backtesting und Expected Shortfall-Berechnung.\n‚Ä¢ Risikofaktor-Modellierbarkeit: Kontinuierliche √úberwachung der Modellierbarkeit jedes Risikofaktors anhand strenger regulatorischer Kriterien ('Real Price Observations') mit komplexen Dokumentationsanforderungen.\n‚Ä¢ P&L-Attribution: T√§gliche detaillierte Vergleichsdaten zwischen hypothetischem, tats√§chlichem und risikobasiertem P&L auf Trading-Desk-Ebene zur Validierung der Modellf√§higkeit.\n‚Ä¢ Stress-Periode-Identifikation: Daten zur Identifikation der relevanten Stress-Perioden f√ºr die Expected Shortfall-Berechnung, die kontinuierlich aktualisiert werden m√ºssen.\n‚Ä¢ Non-Modellable Risk Factors (NMRFs): Spezifische Daten zur Identifikation und Kapitalisierung nicht modellierbarer Risikofaktoren.\n\n‚öñÔ∏è Strategische Implikationen der unterschiedlichen Datenanforderungen:\n‚Ä¢ Ressourcen-Trade-off: Der Standardansatz erfordert weniger historische Daten und keine kontinuierliche Modellvalidierung, resultiert jedoch typischerweise in h√∂heren Kapitalanforderungen.\n‚Ä¢ Hybride Implementierungsstrategien: Viele Banken verfolgen einen hybriden Ansatz, bei dem nur ausgew√§hlte Trading Desks mit optimaler Datenverf√ºgbarkeit f√ºr den IMA qualifiziert werden.\n‚Ä¢ Investitionsplanung: Dateninfrastruktur-Investitionen sollten strategisch auf Basis einer Kosten-Nutzen-Analyse zwischen potenziellen Kapitaleinsparungen durch IMA und den h√∂heren Implementierungs- und Betriebskosten geplant werden.\n‚Ä¢ Flexibilit√§tsanforderungen: Die Datenarchitektur sollte flexibel genug sein, um einen reibungslosen √úbergang zwischen SA-TB und IMA zu erm√∂glichen, falls Trading Desks die IMA-Qualifikation verlieren.\n\nüõ†Ô∏è ADVISORI's ma√ügeschneiderte Unterst√ºtzung:\n‚Ä¢ Differentielle Gap-Analyse: Pr√§zise Bewertung der Datenl√ºcken f√ºr beide Ans√§tze mit detaillierter Aufwandssch√§tzung und Machbarkeitsanalyse.\n‚Ä¢ Quantitative Kapitalauswirkungsanalyse: Berechnung der Kapitalunterschiede zwischen SA-TB und IMA f√ºr jedes Trading Desk als Entscheidungsgrundlage.\n‚Ä¢ Implementierungspriorisierung: Entwicklung einer Roadmap, die strategisch wichtige Desks f√ºr den IMA-Ansatz priorisiert und einen kosteneffizienten Implementierungspfad sicherstellt."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Welche zentralen Prozessanpassungen erfordert FRTB im Vergleich zu Basel 2.5 im Marktrisikomanagement?",
        answer: "Der Fundamental Review of the Trading Book (FRTB) erfordert im Vergleich zu Basel 2.5 eine fundamentale Neugestaltung zahlreicher Kernprozesse im Marktrisikomanagement. Diese Prozessanpassungen gehen weit √ºber inkrementelle Ver√§nderungen hinaus und betreffen nahezu alle Aspekte der Handelsbuchsteuerung, Risikomessung und -berichterstattung.\n\nüîÑ Transformative Prozessanforderungen unter FRTB:\n‚Ä¢ Trading Book vs. Banking Book Zuordnung: Implementierung eines rigorosen, dokumentierten Prozesses zur Zuordnung von Instrumenten zum Handels- oder Bankbuch mit strengen Kriterien f√ºr Umwidmungen und aufsichtsrechtlicher Genehmigungspflicht.\n‚Ä¢ Trading Desk-Definition und -Management: Etablierung eines formalen Prozesses zur Definition, Dokumentation und √úberwachung von Trading Desks gem√§√ü den strengen regulatorischen Anforderungen, einschlie√ülich pr√§ziser Mandatsdefinition und P&L-Attribution.\n‚Ä¢ T√§gliche P&L-Erkl√§rung: Implementierung eines t√§glichen Prozesses zur detaillierten Erkl√§rung und Analyse der P&L-Komponenten auf Trading-Desk-Ebene mit direkter Verkn√ºpfung zwischen Front Office und Risikomanagement.\n‚Ä¢ Risikofaktor-Modellierbarkeitsbeurteilung: Etablierung eines kontinuierlichen Prozesses zur Bewertung und Dokumentation der Modellierbarkeit jedes Risikofaktors anhand der RFET-Kriterien (Risk Factor Eligibility Test) mit umfassender Nachweispflicht.\n‚Ä¢ Fallback-Mechanismen: Entwicklung robuster Prozesse f√ºr den √úbergang zwischen internen Modellen und Standardansatz, falls Trading Desks die strengen Anforderungen an P&L-Attribution oder Backtesting nicht erf√ºllen.\n\nüìã Prozessuale Herausforderungen im √úbergang von Basel 2.5 zu FRTB:\n‚Ä¢ H√∂here Governance-Anforderungen: Deutlich strengere Anforderungen an die Dokumentation, Validierung und das Senior Management Reporting mit formalen Eskalationspfaden und aufsichtsrechtlichen Meldepflichten.\n‚Ä¢ Erh√∂hte Komplexit√§t im Risikomanagement: Notwendigkeit zur parallelen Berechnung und Analyse von Risikokennzahlen nach verschiedenen Ans√§tzen (SA-TB und IMA) mit konsistenter Aggregation auf Institutsebene.\n‚Ä¢ Erweiterte Validierungsprozesse: Umfassendere und strengere Anforderungen an Modellvalidierung, Backtesting und Stresstesting mit detaillierten Dokumentations- und Nachweispflichten.\n‚Ä¢ Komplexere Datenmanagementprozesse: Notwendigkeit zur Etablierung stringenter Prozesse f√ºr Datenqualit√§tsmanagement, Datenabstimmung und Audit Trails √ºber verschiedene Systeme und Abteilungen hinweg.\n‚Ä¢ Intensivierte Zusammenarbeit zwischen Abteilungen: Erfordernis wesentlich engerer Abstimmungsprozesse zwischen Front Office, Risikomanagement, IT und Finanzen zur Gew√§hrleistung konsistenter Daten und Methodiken.\n\nüõ†Ô∏è ADVISORI's bew√§hrte Methodik zur Prozessanpassung:\n‚Ä¢ Process-Impact-Assessment: Systematische Analyse aller betroffenen Prozesse mit detaillierter Gap-Analyse und Priorisierung notwendiger Anpassungen.\n‚Ä¢ End-to-End-Prozessdesign: Entwicklung optimierter Prozessabl√§ufe unter Ber√ºcksichtigung regulatorischer Anforderungen, operativer Effizienz und bestehender Organisationsstrukturen.\n‚Ä¢ Governance-Framework-Integration: Einbettung der neuen Prozesse in ein umfassendes Governance-Framework mit klaren Verantwortlichkeiten, Kontrollen und Eskalationswegen.\n‚Ä¢ Prozessautomatisierung: Identifikation von Automatisierungspotentialen zur Effizienzsteigerung und Reduktion operationeller Risiken in den komplexeren FRTB-Prozessen.\n‚Ä¢ Change-Management-Unterst√ºtzung: Begleitung der Organisation bei der Implementierung der neuen Prozesse mit gezielten Schulungsma√ünahmen und Stakeholder-Management."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Welche technologischen Anforderungen stellt die FRTB-Implementierung an die IT-Infrastruktur und Systemlandschaft?",
        answer: "Die Implementierung des Fundamental Review of the Trading Book stellt au√üergew√∂hnlich hohe Anforderungen an die IT-Infrastruktur und Systemlandschaft von Finanzinstituten. Diese technologischen Herausforderungen erfordern in vielen F√§llen eine grundlegende Neubewertung und Transformation der bestehenden Architektur, um die regulatorischen Anforderungen effizient und nachhaltig erf√ºllen zu k√∂nnen.\n\nüíª Technologische Kernanforderungen f√ºr FRTB:\n‚Ä¢ Hochperformante Berechnungskapazit√§t: Exponentiell gestiegener Rechenaufwand f√ºr die t√§gliche Berechnung tausender Sensitivit√§ten oder umfangreicher Monte-Carlo-Simulationen f√ºr Expected Shortfall erfordert massive Skalierung der Berechnungsinfrastruktur.\n‚Ä¢ Erweiterte Datenhaltung: Notwendigkeit zur Speicherung und effizienten Verarbeitung enormer Datenmengen, einschlie√ülich 10+ Jahre historischer Marktdaten in t√§glicher Granularit√§t f√ºr alle Risikofaktoren.\n‚Ä¢ Flexible Aggregationsf√§higkeiten: F√§higkeit zur dynamischen Aggregation von Risikokennzahlen √ºber verschiedene Hierarchieebenen (Instrument, Trading Desk, Legal Entity, Konzern) mit unterschiedlichen regulatorischen Anforderungen.\n‚Ä¢ Erweiterte Analysef√§higkeiten: Tools zur detaillierten Analyse und Erkl√§rung von Risikotreibern, P&L-Komponenten und Abweichungen zwischen verschiedenen Berechnungsans√§tzen.\n‚Ä¢ Robuste Workflow-Management-Systeme: Technologische Unterst√ºtzung f√ºr die komplexen FRTB-Prozesse mit Workflow-Tracking, Genehmigungsmechanismen und Audit Trails.\n\nüîÑ Architektonische Transformationsanforderungen:\n‚Ä¢ Integration von Front-Office- und Risk-Systemen: Notwendigkeit einer engeren Integration oder Konsolidierung von Handelssystemen und Risikomanagementsystemen zur Sicherstellung konsistenter Bewertungen und Risikometriken.\n‚Ä¢ Datenarchitektur-Optimierung: Entwicklung einer zentralisierten Datenarchitektur mit einheitlichen Datenmodellen und klaren Datenfl√ºssen, die die konsistente Verwendung von Markt-, Positions- und Parameterdaten √ºber alle Systeme hinweg sicherstellt.\n‚Ä¢ Microservice-Architektur: Trend zu modularen, microservice-basierten Architekturen, die h√∂here Flexibilit√§t, bessere Skalierbarkeit und einfachere Wartbarkeit bieten als monolithische Legacy-Systeme.\n‚Ä¢ Cloud-Migration: Zunehmende Nutzung von Cloud-Technologien f√ºr die FRTB-Implementierung, um Skalierbarkeit, Kosteneffizienz und Flexibilit√§t bei Lastspitzen zu gew√§hrleisten.\n‚Ä¢ Real-time Datenverarbeitung: Ausbau der F√§higkeiten zur Echtzeit-Datenverarbeitung f√ºr zeitnahe Risikoeinsch√§tzungen, intraday Limit-Monitoring und P&L-Erkl√§rung.\n\nüõ†Ô∏è ADVISORI's technologische Unterst√ºtzungsans√§tze:\n‚Ä¢ IT-Architektur-Assessment: Umfassende Bewertung der bestehenden IT-Landschaft hinsichtlich ihrer FRTB-Readiness mit detaillierter Gap-Analyse und Transformationsempfehlungen.\n‚Ä¢ Make-vs-Buy-Analyse: Strukturierte Evaluierung verf√ºgbarer Vendor-L√∂sungen im Vergleich zu internen Entwicklungsoptionen unter Ber√ºcksichtigung spezifischer Anforderungen, Kosten und Implementierungsrisiken.\n‚Ä¢ Referenzarchitektur-Design: Entwicklung einer zukunftssicheren Zielarchitektur, die nicht nur FRTB-Anforderungen erf√ºllt, sondern auch f√ºr k√ºnftige regulatorische √Ñnderungen und Gesch√§ftsanforderungen flexibel genug ist.\n‚Ä¢ Datenmanagement-Optimierung: Konzeption optimierter Datenmodelle und Datenfl√ºsse f√ºr FRTB, die Datenredundanzen minimieren und konsistente Datendefinitionen √ºber alle Systeme hinweg sicherstellen.\n‚Ä¢ IT-Implementierungsroadmap: Entwicklung einer priorisierten, phasenweisen Implementierungsroadmap, die technische Abh√§ngigkeiten, regulatorische Fristen und Ressourcenverf√ºgbarkeit ber√ºcksichtigt."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie kann ADVISORI bei der Definition von KPIs und Monitoring-Frameworks f√ºr die FRTB-Implementierung unterst√ºtzen?",
        answer: "Eine erfolgreiche FRTB-Implementierung erfordert ein durchdachtes System von Leistungsindikatoren (KPIs) und Monitoring-Frameworks, um den Fortschritt zu messen, Risiken fr√ºhzeitig zu identifizieren und die Nachhaltigkeit der Compliance sicherzustellen. ADVISORI unterst√ºtzt Finanzinstitute bei der Entwicklung ma√ügeschneiderter KPI- und Monitoring-Systeme, die sowohl die Implementierungsphase als auch den laufenden Betrieb abdecken.\n\nüìä Mehrdimensionales KPI-Framework f√ºr FRTB:\n‚Ä¢ Implementierungs-KPIs: Messgr√∂√üen zur √úberwachung des Projektfortschritts, der Ressourcennutzung und der termingerechten Erf√ºllung regulatorischer Meilensteine w√§hrend der Implementierungsphase.\n‚Ä¢ Datenqualit√§ts-KPIs: Indikatoren zur kontinuierlichen √úberwachung der Vollst√§ndigkeit, Aktualit√§t, Konsistenz und Genauigkeit kritischer Daten f√ºr FRTB-Berechnungen und -Reporting.\n‚Ä¢ Prozesseffizienz-KPIs: Metriken zur Bewertung der Effizienz und Robustheit implementierter Prozesse, wie Durchlaufzeiten f√ºr Berechnungen, H√§ufigkeit manueller Eingriffe und Prozessfehlerquoten.\n‚Ä¢ Compliance-KPIs: Kennzahlen zur kontinuierlichen √úberwachung der Einhaltung regulatorischer Anforderungen, wie P&L-Attribution-Metriken, Backtesting-Ausnahmen und Risikofaktor-Modellierbarkeitsquoten.\n‚Ä¢ Kapitaleffizienz-KPIs: Indikatoren zur Messung der Kapitaleffizienz unter FRTB, wie die Entwicklung der Kapitalanforderungen im Zeitverlauf, Kapitalallokation nach Trading Desks und Diversifikationseffekte.\n\nüîç Komponenten eines robusten FRTB-Monitoring-Frameworks:\n‚Ä¢ Echtzeit-Dashboards: Entwicklung intuitiver, rollenspezifischer Dashboards zur Visualisierung kritischer KPIs f√ºr verschiedene Stakeholder, von H√§ndlern √ºber Risikomanager bis zum C-Level.\n‚Ä¢ Automatisierte Alerting-Mechanismen: Implementation automatisierter Fr√ºhwarnsysteme, die bei √úberschreitung definierter Schwellenwerte oder anomalem Verhalten kritischer Metriken Alarme ausl√∂sen.\n‚Ä¢ Hierarchisches Reporting-System: Etablierung eines mehrstufigen Reporting-Systems, das von detaillierten operativen Reports bis zu strategischen Executive Summaries f√ºr die F√ºhrungsebene reicht.\n‚Ä¢ Trend- und Musteranalyse: Integration analytischer F√§higkeiten zur Erkennung von Trends, Mustern und Anomalien in FRTB-relevanten Metriken √ºber l√§ngere Zeitr√§ume.\n‚Ä¢ Dokumentation und Audit Trail: Umfassende Dokumentation aller Monitoring-Aktivit√§ten, Ma√ünahmen und Entscheidungen zur Erf√ºllung der aufsichtsrechtlichen Nachweispflichten.\n\nüõ†Ô∏è ADVISORI's Ansatz zur KPI- und Monitoring-Framework-Entwicklung:\n‚Ä¢ Anforderungsanalyse: Detaillierte Erhebung der spezifischen √úberwachungsanforderungen verschiedener Stakeholder und regulatorischer Vorgaben als Basis f√ºr die Framework-Entwicklung.\n‚Ä¢ KPI-Katalog-Design: Entwicklung eines umfassenden, aber fokussierten Sets von KPIs, die alle kritischen Aspekte der FRTB-Implementierung und -Compliance abdecken.\n‚Ä¢ Schwellenwert-Definition: Erarbeitung sinnvoller Schwellenwerte und Eskalationskriterien f√ºr jede KPI basierend auf regulatorischen Anforderungen, Best Practices und institutsspezifischen Gegebenheiten.\n‚Ä¢ Governance-Integration: Einbettung des Monitoring-Frameworks in die bestehende Governance-Struktur mit klaren Verantwortlichkeiten, Eskalationswegen und Entscheidungsprozessen.\n‚Ä¢ Technische Umsetzungsunterst√ºtzung: Beratung bei der technischen Implementierung des Monitoring-Systems, von der Datenerfassung √ºber die Berechnung bis zur Visualisierung und Reporting."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
