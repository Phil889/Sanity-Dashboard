import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Training page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-training' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-training" not found')
    }
    
    // Create new FAQs for ISO 27001 training fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Why is comprehensive ISO 27001 training essential for successful implementation and long-term compliance?',
        answer: "Comprehensive ISO 27001 training forms the cornerstone of successful information security management system implementation and sustainable compliance. It transforms theoretical requirements into practical competencies that drive organizational security culture and operational excellence. Without proper training, even the most well-designed ISMS frameworks fail to deliver their intended protection and business value.\n\nüéØ Strategic Foundation for Success:\n‚Ä¢ Creates unified understanding of information security principles across all organizational levels, ensuring consistent interpretation and application of ISO 27001 requirements\n‚Ä¢ Develops security-conscious mindset that extends beyond technical controls to encompass behavioral and cultural transformation\n‚Ä¢ Enables informed decision-making by equipping stakeholders with knowledge to balance security requirements with business objectives\n‚Ä¢ Reduces implementation risks by preparing teams to anticipate challenges and apply proven methodologies\n‚Ä¢ Establishes competency baseline that supports continuous improvement and adaptation to evolving threats\n\nüõ°Ô∏è Risk Mitigation and Compliance Assurance:\n‚Ä¢ Prevents costly implementation errors through systematic knowledge transfer and practical skill development\n‚Ä¢ Ensures consistent application of controls across different departments and business units\n‚Ä¢ Reduces audit risks by preparing personnel to demonstrate competence and understanding during assessments\n‚Ä¢ Minimizes security incidents through enhanced awareness and proper execution of security procedures\n‚Ä¢ Supports regulatory compliance by ensuring staff understand their roles in maintaining information security standards\n\nüí° Organizational Capability Building:\n‚Ä¢ Develops internal expertise that reduces dependency on external consultants for ongoing ISMS management\n‚Ä¢ Creates network of trained professionals who can support implementation across different business areas\n‚Ä¢ Enables knowledge transfer and mentoring within the organization for sustainable competency development\n‚Ä¢ Builds confidence in handling complex security challenges and emerging threats\n‚Ä¢ Supports career development and professional growth for information security practitioners\n\nüîÑ Continuous Improvement and Adaptation:\n‚Ä¢ Provides foundation for ongoing learning and adaptation to new security challenges and regulatory requirements\n‚Ä¢ Enables effective participation in security communities and professional networks for knowledge sharing\n‚Ä¢ Supports innovation in security practices through deep understanding of underlying principles\n‚Ä¢ Facilitates integration of new technologies and methodologies within existing ISMS framework\n‚Ä¢ Creates culture of continuous learning that keeps pace with rapidly evolving cybersecurity landscape"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'What training delivery formats does ADVISORI offer to accommodate different learning preferences and organizational needs?',
        answer: "ADVISORI provides a comprehensive range of training delivery formats designed to maximize learning effectiveness while accommodating diverse organizational requirements, learning preferences, and operational constraints. Our flexible approach ensures that every participant can access high-quality ISO 27001 training regardless of their location, schedule, or preferred learning style.\n\nüè¢ In-Person Training Excellence:\n‚Ä¢ Traditional classroom-based training in state-of-the-art facilities with optimal learning environments and advanced presentation technology\n‚Ä¢ Maximum interaction between trainers and participants, enabling real-time clarification and deep discussion of complex concepts\n‚Ä¢ Hands-on workshops with physical materials and collaborative exercises that reinforce theoretical learning\n‚Ä¢ Networking opportunities with other professionals facing similar challenges and implementation requirements\n‚Ä¢ Immediate feedback and personalized coaching from expert trainers with extensive practical experience\n\nüíª Advanced Virtual Learning Platforms:\n‚Ä¢ Live online training sessions using cutting-edge virtual classroom technology with interactive features and engagement tools\n‚Ä¢ Breakout rooms for small group exercises and collaborative problem-solving activities\n‚Ä¢ Screen sharing and virtual whiteboards for dynamic presentations and interactive workshops\n‚Ä¢ Recording capabilities for session review and knowledge reinforcement\n‚Ä¢ Global accessibility enabling participation from multiple locations without travel requirements\n\nüè≠ Customized On-Site Training Programs:\n‚Ä¢ Tailored training delivered at client facilities, incorporating specific organizational context and real-world scenarios\n‚Ä¢ Integration of client systems, processes, and documentation into training exercises for immediate practical relevance\n‚Ä¢ Flexible scheduling that accommodates operational requirements and minimizes business disruption\n‚Ä¢ Cost-effective solution for training large groups while maintaining high-quality instruction\n‚Ä¢ Opportunity to address organization-specific challenges and implementation questions in real-time\n\nüéì Blended Learning Methodologies:\n‚Ä¢ Strategic combination of online self-paced modules with intensive face-to-face workshops for optimal knowledge retention\n‚Ä¢ Pre-training preparation materials and post-training reinforcement resources to extend learning impact\n‚Ä¢ Flexible pacing that allows participants to progress through foundational content at their own speed\n‚Ä¢ Concentrated practical sessions that build on self-directed learning for maximum efficiency\n‚Ä¢ Continuous support and mentoring throughout the blended learning journey\n\nüì± Innovative Digital Learning Solutions:\n‚Ä¢ Mobile-friendly learning platforms that enable training access from any device at any time\n‚Ä¢ Microlearning modules that deliver focused content in digestible segments for busy professionals\n‚Ä¢ Interactive simulations and gamification elements that enhance engagement and knowledge retention\n‚Ä¢ Adaptive learning systems that adjust content difficulty based on individual progress and competency levels\n‚Ä¢ Social learning features that enable peer interaction and knowledge sharing within secure learning communities"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'How does ADVISORI ensure that ISO 27001 training content remains current with evolving standards and industry best practices?',
        answer: "ADVISORI maintains training content currency through a systematic approach that combines continuous market intelligence, active participation in standards development, and direct feedback from ongoing implementation projects. Our commitment to delivering cutting-edge training ensures participants receive the most relevant and actionable knowledge available in the rapidly evolving information security landscape.\n\nüîÑ Continuous Content Evolution Process:\n‚Ä¢ Regular review and update cycles that incorporate latest ISO 27001 interpretations, guidance documents, and implementation best practices\n‚Ä¢ Integration of emerging regulatory requirements such as GDPR, DORA, NIS2, and sector-specific compliance frameworks\n‚Ä¢ Incorporation of new threat intelligence and cybersecurity trends that impact information security management practices\n‚Ä¢ Updates reflecting technological advances in security tools, cloud computing, artificial intelligence, and digital transformation\n‚Ä¢ Alignment with international best practices and frameworks from organizations like NIST, ENISA, and industry-specific bodies\n\nüë®‚Äçüíº Expert Practitioner Network:\n‚Ä¢ Training delivered by active consultants and auditors who work daily with ISO 27001 implementations across diverse industries\n‚Ä¢ Direct transfer of insights from current client engagements and real-world implementation challenges\n‚Ä¢ Access to global network of information security professionals and thought leaders\n‚Ä¢ Participation in professional associations, standards committees, and industry working groups\n‚Ä¢ Continuous professional development and certification maintenance for all training staff\n\nüè≠ Industry-Specific Adaptation:\n‚Ä¢ Specialized content development for different sectors including financial services, healthcare, manufacturing, and technology\n‚Ä¢ Integration of sector-specific regulatory requirements and compliance obligations\n‚Ä¢ Case studies and examples drawn from relevant industry contexts and organizational sizes\n‚Ä¢ Adaptation of training language and scenarios to match participant backgrounds and responsibilities\n‚Ä¢ Collaboration with industry experts and subject matter specialists for specialized content areas\n\nüí° Innovation in Training Methodology:\n‚Ä¢ Research and development of new training techniques based on adult learning principles and cognitive science\n‚Ä¢ Integration of virtual reality, augmented reality, and simulation technologies for immersive learning experiences\n‚Ä¢ Development of adaptive learning systems that personalize content delivery based on individual learning patterns\n‚Ä¢ Incorporation of artificial intelligence and machine learning tools for enhanced training effectiveness\n‚Ä¢ Experimentation with new assessment methods and competency validation approaches\n\nüîç Quality Assurance and Feedback Integration:\n‚Ä¢ Systematic collection and analysis of participant feedback to identify content gaps and improvement opportunities\n‚Ä¢ Regular benchmarking against international training standards and certification body requirements\n‚Ä¢ External review by independent subject matter experts and academic institutions\n‚Ä¢ Continuous monitoring of training effectiveness through follow-up assessments and implementation success metrics\n‚Ä¢ Integration of lessons learned from certification audits and compliance assessments into training content"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'What are the prerequisite requirements and recommended preparation for different levels of ISO 27001 training programs?',
        answer: "ADVISORI has developed a structured approach to training prerequisites that ensures participants can maximize their learning experience while building competencies systematically. Our tiered system accommodates professionals at different career stages and with varying levels of information security experience, providing clear pathways for professional development.\n\nüìö Foundation Level Requirements:\n‚Ä¢ No formal information security background required, making training accessible to all organizational stakeholders\n‚Ä¢ Basic understanding of business processes and organizational structures to contextualize security concepts\n‚Ä¢ Familiarity with common IT systems and applications used in typical business environments\n‚Ä¢ Willingness to engage actively in learning activities and apply security principles in daily work\n‚Ä¢ Commitment to supporting organizational information security objectives and culture development\n\nüîß Practitioner Level Preparation:\n‚Ä¢ Completion of foundation-level training or equivalent knowledge demonstrated through assessment\n‚Ä¢ Professional experience in project management, process improvement, or related analytical roles\n‚Ä¢ Understanding of risk management concepts and their application in business contexts\n‚Ä¢ Familiarity with management system frameworks such as ISO 9001, ISO 14001, or similar standards\n‚Ä¢ Basic knowledge of information technology infrastructure and common security challenges\n\nüë®‚Äçüíº Management Level Prerequisites:\n‚Ä¢ Senior leadership experience with responsibility for strategic decision-making and resource allocation\n‚Ä¢ Understanding of corporate governance principles and regulatory compliance requirements\n‚Ä¢ Experience in managing organizational change initiatives and stakeholder engagement\n‚Ä¢ Knowledge of business risk management and its integration with operational processes\n‚Ä¢ Familiarity with board-level reporting and executive communication requirements\n\nüîç Auditor Certification Requirements:\n‚Ä¢ Demonstrated competence in ISO 27001 implementation through practical experience or comprehensive training\n‚Ä¢ Understanding of audit principles and methodologies, preferably with experience in quality or compliance auditing\n‚Ä¢ Strong analytical and communication skills for conducting interviews and presenting findings\n‚Ä¢ Knowledge of evidence collection and documentation techniques for audit trail development\n‚Ä¢ Commitment to maintaining professional objectivity and independence in assessment activities\n\nüéì Advanced Specialist Preparation:\n‚Ä¢ Extensive experience in information security management or related technical disciplines\n‚Ä¢ Deep understanding of specific domains such as risk assessment, incident response, or business continuity\n‚Ä¢ Professional certifications in relevant areas such as CISSP, CISM, CRISC, or equivalent qualifications\n‚Ä¢ Experience in consulting, training, or mentoring other information security professionals\n‚Ä¢ Commitment to contributing to the broader information security community through knowledge sharing and thought leadership\n\nüîÑ Flexible Entry Points and Bridge Programs:\n‚Ä¢ Competency assessments to determine appropriate entry level for participants with diverse backgrounds\n‚Ä¢ Bridge programs for professionals transitioning from related fields such as IT audit, compliance, or risk management\n‚Ä¢ Recognition of prior learning and professional experience through portfolio assessment\n‚Ä¢ Customized preparation materials and pre-training support for participants requiring additional foundation knowledge\n‚Ä¢ Ongoing mentoring and coaching support to ensure successful progression through training levels"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
