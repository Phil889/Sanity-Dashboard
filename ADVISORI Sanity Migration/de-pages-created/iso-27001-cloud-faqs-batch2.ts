import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Cloud page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-cloud' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-cloud" not found')
    }
    
    // Create new FAQs for ISO 27001 Cloud implementation
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie sollten Organisationen Cloud Service Provider f√ºr ISO 27001 Compliance bewerten und ausw√§hlen?',
        answer: "Die Auswahl und Bewertung von Cloud Service Providern ist eine kritische Entscheidung f√ºr ISO 27001 Compliance, da sie direkt die Sicherheitslage und Compliance-F√§higkeit der Organisation beeinflusst. Ein systematischer Bewertungsansatz ber√ºcksichtigt technische, rechtliche und operative Aspekte sowie die langfristige strategische Ausrichtung.\n\nüîç Comprehensive Due Diligence Framework:\n‚Ä¢ Bewertung der Provider-Zertifizierungen wie SOC 2 Type II, ISO 27001, FedRAMP und branchenspezifische Standards\n‚Ä¢ Analyse der Shared Responsibility Matrix und klare Abgrenzung der Sicherheitsverantwortlichkeiten\n‚Ä¢ √úberpr√ºfung der Incident Response Capabilities und historischen Security Performance\n‚Ä¢ Assessment der Disaster Recovery und Business Continuity F√§higkeiten\n‚Ä¢ Evaluation der Compliance-Unterst√ºtzung f√ºr regulatorische Anforderungen wie GDPR, HIPAA oder branchenspezifische Vorschriften\n\nüìã Technical Security Assessment:\n‚Ä¢ Detaillierte Analyse der Verschl√ºsselungsstandards f√ºr Data at Rest und in Transit\n‚Ä¢ Bewertung der Identity and Access Management Capabilities und Integration mit bestehenden Systemen\n‚Ä¢ √úberpr√ºfung der Network Security Controls, Segmentation und Monitoring-F√§higkeiten\n‚Ä¢ Assessment der Vulnerability Management Prozesse und Patch Management Zyklen\n‚Ä¢ Evaluation der Logging, Monitoring und Audit Trail Capabilities\n\nüèõÔ∏è Governance und Compliance Evaluation:\n‚Ä¢ √úberpr√ºfung der Provider-Governance-Struktur und Security Leadership\n‚Ä¢ Analyse der Compliance-Reporting-F√§higkeiten und Audit-Unterst√ºtzung\n‚Ä¢ Bewertung der Transparenz bei Security Incidents und Breach Notifications\n‚Ä¢ Assessment der Subcontractor Management und Supply Chain Security\n‚Ä¢ Evaluation der Data Residency Controls und Cross-Border Data Transfer Compliance\n\nüìä Operational Excellence und Support:\n‚Ä¢ Bewertung der Service Level Agreements f√ºr Security-relevante Metriken\n‚Ä¢ Analyse der Support-Qualit√§t und Incident Response Zeiten\n‚Ä¢ √úberpr√ºfung der Change Management Prozesse und Customer Communication\n‚Ä¢ Assessment der Training und Awareness Programme f√ºr Provider-Personal\n‚Ä¢ Evaluation der Innovation Roadmap und Security Enhancement Pl√§ne\n\nüîí Contractual und Legal Considerations:\n‚Ä¢ Verhandlung spezifischer Security Requirements und Audit Rights\n‚Ä¢ Definition klarer Incident Response und Breach Notification Prozesse\n‚Ä¢ Etablierung von Data Protection und Privacy Safeguards\n‚Ä¢ Vereinbarung von Exit-Strategien und Data Portability Requirements\n‚Ä¢ Implementierung von Liability und Insurance Coverage f√ºr Security Incidents\n\nüöÄ Continuous Monitoring und Relationship Management:\n‚Ä¢ Etablierung regelm√§√üiger Security Reviews und Compliance Assessments\n‚Ä¢ Implementation von Performance Monitoring und KPI Tracking\n‚Ä¢ Aufbau strategischer Partnerschaften f√ºr langfristige Zusammenarbeit\n‚Ä¢ Entwicklung von Escalation Prozessen f√ºr Security und Compliance Issues\n‚Ä¢ Planung f√ºr Provider Diversification und Multi-Cloud Strategien zur Risikominimierung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Rolle spielt DevSecOps bei der Implementierung von ISO 27001 in Cloud-nativen Umgebungen?',
        answer: "DevSecOps ist fundamental f√ºr erfolgreiche ISO 27001 Implementierungen in Cloud-nativen Umgebungen, da es Sicherheit als integralen Bestandteil des gesamten Entwicklungs- und Deployment-Lebenszyklus etabliert. Diese Methodik erm√∂glicht kontinuierliche Compliance und automatisierte Sicherheitskontrollen in hochdynamischen Cloud-Architekturen.\n\nüîÑ Security by Design Integration:\n‚Ä¢ Einbettung von ISO 27001 Kontrollen direkt in Infrastructure as Code Templates und Deployment Pipelines\n‚Ä¢ Automatisierte Security Scanning und Compliance Checks in jeder Phase des Development Lifecycle\n‚Ä¢ Shift-Left Security Approach mit fr√ºher Identifikation und Behebung von Sicherheitsl√ºcken\n‚Ä¢ Security Requirements Integration in User Stories und Acceptance Criteria\n‚Ä¢ Threat Modeling als integraler Bestandteil des Design und Architecture Review Prozesses\n\nüõ†Ô∏è Automated Compliance und Policy Enforcement:\n‚Ä¢ Policy as Code Implementation f√ºr konsistente Durchsetzung von ISO 27001 Anforderungen\n‚Ä¢ Automated Compliance Scanning mit Tools wie Open Policy Agent oder Cloud Security Posture Management\n‚Ä¢ Continuous Configuration Monitoring und Drift Detection f√ºr Security Baselines\n‚Ä¢ Automated Remediation von Compliance-Abweichungen durch Infrastructure Automation\n‚Ä¢ Real-time Policy Violation Alerts und Automated Response Workflows\n\nüîê Secure CI/CD Pipeline Design:\n‚Ä¢ Integration von Security Gates in jeder Phase der Continuous Integration und Deployment Pipeline\n‚Ä¢ Automated Vulnerability Scanning f√ºr Container Images, Dependencies und Infrastructure Code\n‚Ä¢ Secret Management und Secure Credential Handling in Deployment Workflows\n‚Ä¢ Immutable Infrastructure Patterns f√ºr konsistente und sichere Deployments\n‚Ä¢ Automated Security Testing einschlie√ülich SAST, DAST und Interactive Application Security Testing\n\nüìä Continuous Monitoring und Observability:\n‚Ä¢ Implementation von Security Observability mit Distributed Tracing und Metrics Collection\n‚Ä¢ Real-time Security Event Correlation und Automated Incident Detection\n‚Ä¢ Behavioral Analytics f√ºr Anomaly Detection in Cloud-nativen Workloads\n‚Ä¢ Automated Log Aggregation und Security Information Event Management Integration\n‚Ä¢ Performance Monitoring f√ºr Security Controls ohne Beeintr√§chtigung der Application Performance\n\nüöÄ Cloud-Native Security Patterns:\n‚Ä¢ Microservices Security mit Service Mesh und Zero Trust Network Architecture\n‚Ä¢ Container Security mit Runtime Protection und Image Vulnerability Management\n‚Ä¢ Serverless Security mit Function-Level Access Controls und Event-driven Security\n‚Ä¢ API Security mit Rate Limiting, Authentication und Authorization Controls\n‚Ä¢ Data Protection mit Encryption, Tokenization und Data Loss Prevention Integration\n\nüéØ Cultural und Organizational Transformation:\n‚Ä¢ Cross-functional Team Collaboration zwischen Development, Security und Operations\n‚Ä¢ Security Champions Programme f√ºr Embedding Security Expertise in Development Teams\n‚Ä¢ Continuous Learning und Skills Development f√ºr Cloud Security und Compliance\n‚Ä¢ Metrics-driven Security Improvement mit KPIs f√ºr Security und Compliance Performance\n‚Ä¢ Incident Response Integration mit Development Teams f√ºr Rapid Security Issue Resolution\n\nüìã Documentation und Audit Readiness:\n‚Ä¢ Automated Documentation Generation f√ºr Security Controls und Compliance Evidence\n‚Ä¢ Version Control f√ºr Security Policies und Configuration Management\n‚Ä¢ Audit Trail Automation f√ºr Change Management und Access Control Documentation\n‚Ä¢ Compliance Reporting Automation mit Real-time Dashboards und Metrics\n‚Ä¢ Evidence Collection Automation f√ºr External Audits und Certification Processes"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie k√∂nnen Organisationen Incident Response und Forensik in Cloud-Umgebungen f√ºr ISO 27001 Compliance optimieren?',
        answer: "Incident Response und Forensik in Cloud-Umgebungen erfordern spezialisierte Ans√§tze, die die einzigartigen Charakteristika von Cloud-Infrastrukturen ber√ºcksichtigen. Erfolgreiche ISO 27001 Compliance h√§ngt von der F√§higkeit ab, Sicherheitsvorf√§lle schnell zu erkennen, zu analysieren und zu beheben, w√§hrend gleichzeitig forensische Integrit√§t gew√§hrleistet wird.\n\nüö® Cloud-Native Incident Detection und Response:\n‚Ä¢ Implementation von Cloud Security Information and Event Management mit nativer Cloud-Integration\n‚Ä¢ Automated Threat Detection durch Machine Learning und Behavioral Analytics\n‚Ä¢ Real-time Alert Correlation √ºber multiple Cloud Services und Provider hinweg\n‚Ä¢ Automated Incident Classification und Severity Assessment basierend auf Business Impact\n‚Ä¢ Integration von Threat Intelligence Feeds f√ºr proaktive Bedrohungserkennung\n\nüîç Forensic Readiness in Cloud-Umgebungen:\n‚Ä¢ Comprehensive Logging Strategy mit zentralisierter Log-Aggregation und Long-term Retention\n‚Ä¢ Immutable Log Storage mit Cryptographic Integrity Protection\n‚Ä¢ Network Flow Monitoring und Packet Capture Capabilities f√ºr Traffic Analysis\n‚Ä¢ Memory und Disk Image Acquisition Procedures f√ºr Cloud-basierte Virtual Machines\n‚Ä¢ Container und Serverless Forensics mit Specialized Tools und Techniques\n\n‚ö° Rapid Response und Containment:\n‚Ä¢ Automated Incident Response Playbooks mit Cloud-spezifischen Containment Strategies\n‚Ä¢ Network Isolation und Micro-Segmentation f√ºr Incident Containment\n‚Ä¢ Automated Backup und Snapshot Creation f√ºr Evidence Preservation\n‚Ä¢ Dynamic Security Group Modification f√ºr Traffic Blocking und Isolation\n‚Ä¢ Coordinated Response mit Cloud Service Provider Support Teams\n\nüîê Evidence Collection und Chain of Custody:\n‚Ä¢ Secure Evidence Collection Procedures mit Cryptographic Hashing und Digital Signatures\n‚Ä¢ Cloud-native Forensic Tools f√ºr Multi-Tenant Environment Analysis\n‚Ä¢ Cross-Cloud Evidence Correlation f√ºr Multi-Cloud Incident Investigation\n‚Ä¢ Legal Hold Procedures f√ºr Cloud-stored Data und Communications\n‚Ä¢ Documentation Standards f√ºr Court-admissible Evidence in Cloud Environments\n\nüìä Investigation und Analysis Capabilities:\n‚Ä¢ Cloud Forensic Workbenches mit Scalable Analysis Infrastructure\n‚Ä¢ Automated Malware Analysis und Reverse Engineering in Isolated Cloud Environments\n‚Ä¢ Timeline Analysis mit Correlation across Multiple Cloud Services und Data Sources\n‚Ä¢ Attribution Analysis mit Threat Actor Profiling und Campaign Tracking\n‚Ä¢ Impact Assessment mit Business Process und Data Flow Analysis\n\nüîÑ Recovery und Lessons Learned:\n‚Ä¢ Automated System Recovery mit Infrastructure as Code und Immutable Deployments\n‚Ä¢ Business Continuity Activation mit Multi-Region Failover Capabilities\n‚Ä¢ Post-Incident Review Processes mit Root Cause Analysis und Improvement Recommendations\n‚Ä¢ Threat Hunting Activities basierend auf Incident Findings und Indicators of Compromise\n‚Ä¢ Security Control Enhancement basierend auf Incident Response Lessons Learned\n\nüìã Compliance und Reporting:\n‚Ä¢ Automated Incident Reporting f√ºr Regulatory Requirements und Stakeholder Communication\n‚Ä¢ Metrics Collection f√ºr Incident Response Performance und Effectiveness Measurement\n‚Ä¢ Integration mit Risk Management Processes f√ºr Risk Assessment Updates\n‚Ä¢ Documentation Standards f√ºr ISO 27001 Audit Evidence und Compliance Demonstration\n‚Ä¢ Continuous Improvement Programme f√ºr Incident Response Capability Enhancement"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche spezifischen Herausforderungen und L√∂sungsans√§tze gibt es f√ºr ISO 27001 Compliance in Container- und Kubernetes-Umgebungen?',
        answer: "Container- und Kubernetes-Umgebungen bringen einzigartige Sicherheitsherausforderungen mit sich, die traditionelle ISO 27001 Implementierungsans√§tze erweitern und anpassen m√ºssen. Die ephemere Natur von Containern, die Komplexit√§t von Orchestrierung und die geteilten Kernel-Ressourcen erfordern spezialisierte Sicherheitsstrategien.\n\nüê≥ Container Security Fundamentals:\n‚Ä¢ Secure Container Image Management mit Vulnerability Scanning und Trusted Registry Implementation\n‚Ä¢ Base Image Hardening mit Minimal Attack Surface und Regular Security Updates\n‚Ä¢ Runtime Security Monitoring mit Behavioral Analysis und Anomaly Detection\n‚Ä¢ Container Isolation Enhancement mit Security Contexts und Namespace Separation\n‚Ä¢ Supply Chain Security f√ºr Container Images mit Signature Verification und Provenance Tracking\n\n‚ò∏Ô∏è Kubernetes Security Architecture:\n‚Ä¢ Role-Based Access Control Implementation mit Principle of Least Privilege\n‚Ä¢ Network Policies f√ºr Micro-Segmentation und Traffic Control zwischen Pods\n‚Ä¢ Pod Security Standards mit Security Contexts und Admission Controllers\n‚Ä¢ Secrets Management mit External Secret Stores und Encryption at Rest\n‚Ä¢ Service Mesh Integration f√ºr Mutual TLS und Traffic Encryption\n\nüîê Identity und Access Management:\n‚Ä¢ Kubernetes Service Account Management mit Token Rotation und Scope Limitation\n‚Ä¢ Integration mit External Identity Providers f√ºr Human User Authentication\n‚Ä¢ Workload Identity f√ºr Secure Service-to-Service Communication\n‚Ä¢ Audit Logging f√ºr All API Server Interactions und Access Patterns\n‚Ä¢ Multi-Tenancy Implementation mit Namespace Isolation und Resource Quotas\n\nüìä Monitoring und Compliance Automation:\n‚Ä¢ Kubernetes Security Posture Management mit Continuous Configuration Scanning\n‚Ä¢ Runtime Threat Detection mit Container Behavior Monitoring\n‚Ä¢ Compliance Policy Enforcement mit Open Policy Agent und Gatekeeper\n‚Ä¢ Automated Vulnerability Assessment f√ºr Running Containers und Images\n‚Ä¢ Security Metrics Collection f√ºr Compliance Reporting und Risk Assessment\n\nüõ°Ô∏è Data Protection in Container Environments:\n‚Ä¢ Persistent Volume Security mit Encryption und Access Controls\n‚Ä¢ Secrets Encryption with External Key Management Systems\n‚Ä¢ Data Loss Prevention f√ºr Containerized Applications\n‚Ä¢ Backup und Recovery Strategies f√ºr Stateful Container Workloads\n‚Ä¢ Cross-Cluster Data Replication mit Security Controls\n\nüöÄ DevSecOps Integration f√ºr Container Security:\n‚Ä¢ Shift-Left Security mit Container Image Scanning in CI/CD Pipelines\n‚Ä¢ Infrastructure as Code Security f√ºr Kubernetes Manifests und Helm Charts\n‚Ä¢ Automated Security Testing f√ºr Containerized Applications\n‚Ä¢ Security Gate Implementation in Deployment Pipelines\n‚Ä¢ Continuous Compliance Monitoring mit Automated Remediation\n\nüîÑ Incident Response f√ºr Container Environments:\n‚Ä¢ Container Forensics mit Image Analysis und Runtime Investigation\n‚Ä¢ Automated Incident Containment mit Pod Isolation und Network Segmentation\n‚Ä¢ Log Aggregation f√ºr Distributed Container Environments\n‚Ä¢ Threat Hunting in Kubernetes Clusters mit Specialized Tools\n‚Ä¢ Recovery Procedures mit Immutable Infrastructure und GitOps Practices\n\nüìã Governance und Risk Management:\n‚Ä¢ Container Security Policies mit Automated Enforcement\n‚Ä¢ Risk Assessment f√ºr Container Supply Chain und Dependencies\n‚Ä¢ Change Management f√ºr Container Images und Kubernetes Configurations\n‚Ä¢ Vendor Risk Management f√ºr Container Runtime und Orchestration Platforms\n‚Ä¢ Continuous Security Training f√ºr Development und Operations Teams"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
