import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA Schwachstellen-Scanning page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-schwachstellen-scanning' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-schwachstellen-scanning" not found')
    }
    
    // Create new FAQs for technical implementation and tools
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Welche technischen Tools und Plattformen sind f√ºr DORA-konformes Schwachstellen-Scanning am besten geeignet und wie evaluiere ich sie?',
        answer: "Die Auswahl geeigneter Tools f√ºr DORA-konformes Schwachstellen-Scanning erfordert eine strategische Bewertung, die sowohl technische Capabilities als auch regulatorische Compliance-Anforderungen ber√ºcksichtigt. Moderne Vulnerability-Management-Plattformen m√ºssen √ºber traditionelle Scanning-Funktionen hinausgehen und umfassende Governance-, Reporting- und Integration-Capabilities bieten.\n\nüîß Enterprise Vulnerability-Management-Plattformen:\n‚Ä¢ Qualys VMDR und Rapid7 InsightVM bieten umfassende Scanning-Capabilities mit starken Compliance-Reporting-Funktionen und API-Integration f√ºr DORA-konforme Workflows\n‚Ä¢ Tenable.io und Nessus Professional erm√∂glichen kontinuierliches Asset-Discovery und Vulnerability-Assessment mit detaillierter Risikobewertung\n‚Ä¢ OpenVAS als Open-Source-Alternative f√ºr Organisationen mit spezifischen Anpassungsanforderungen oder Budget-Constraints\n‚Ä¢ Greenbone Enterprise Appliances f√ºr Umgebungen mit hohen Sicherheitsanforderungen und Air-Gap-Szenarien\n‚Ä¢ Rapid7 Nexpose f√ºr integrierte Vulnerability-Management- und Incident-Response-Workflows\n\nüåê Cloud-native und Container-Scanning-L√∂sungen:\n‚Ä¢ Aqua Security und Twistlock f√ºr Container- und Kubernetes-Umgebungen mit DevSecOps-Integration\n‚Ä¢ AWS Inspector, Azure Security Center und Google Cloud Security Command Center f√ºr Cloud-native Workloads\n‚Ä¢ Prisma Cloud und CloudGuard f√ºr Multi-Cloud-Umgebungen mit einheitlicher Visibility\n‚Ä¢ Snyk und WhiteSource f√ºr Application-Security-Testing und Open-Source-Vulnerability-Management\n‚Ä¢ Docker Security Scanning und Harbor f√ºr Container-Registry-Security\n\n‚öôÔ∏è Spezialisierte Scanning-Tools und Integration:\n‚Ä¢ Nmap und Masscan f√ºr Netzwerk-Discovery und Port-Scanning in komplexen Infrastrukturen\n‚Ä¢ Burp Suite Professional und OWASP ZAP f√ºr Web-Application-Security-Testing\n‚Ä¢ Metasploit Pro f√ºr Penetration-Testing und Exploit-Validation\n‚Ä¢ Nuclei und OpenVAS f√ºr automatisierte Vulnerability-Detection mit Custom-Templates\n‚Ä¢ Shodan und Censys f√ºr External-Attack-Surface-Monitoring und Internet-facing Asset-Discovery\n\nüìä Tool-Evaluierung und Auswahlkriterien:\n‚Ä¢ Bewertung der DORA-Compliance-Features wie Audit-Trails, Reporting-Capabilities und regulatorische Templates\n‚Ä¢ Analyse der Integration-M√∂glichkeiten mit bestehenden SIEM-, SOAR- und IT-Service-Management-Systemen\n‚Ä¢ Pr√ºfung der Skalierbarkeit und Performance f√ºr gro√üe, komplexe Infrastrukturen\n‚Ä¢ Bewertung der Benutzerfreundlichkeit und Schulungsanforderungen f√ºr verschiedene Stakeholder-Gruppen\n‚Ä¢ Analyse der Total-Cost-of-Ownership einschlie√ülich Lizenzierung, Implementation und laufender Betriebskosten\n\nüîç Advanced Analytics und Intelligence-Integration:\n‚Ä¢ Evaluation von Machine-Learning-Capabilities f√ºr False-Positive-Reduktion und intelligente Priorisierung\n‚Ä¢ Bewertung der Threat-Intelligence-Integration und Feeds f√ºr kontextuelle Risikobewertung\n‚Ä¢ Pr√ºfung von Predictive-Analytics-Features f√ºr proaktive Schwachstellen-Identifikation\n‚Ä¢ Analyse der Behavioral-Analytics-Capabilities f√ºr Anomalie-Detection\n‚Ä¢ Bewertung der Integration mit Threat-Hunting-Plattformen und Security-Orchestration-Tools"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Wie implementiere ich effektive Remediation-Prozesse und Patch-Management-Systeme f√ºr DORA-Compliance?',
        answer: "Effektive Remediation-Prozesse und Patch-Management-Systeme sind entscheidend f√ºr DORA-Compliance, da sie die operative Umsetzung von Schwachstellen-Scanning in tats√§chliche Risikominderung transformieren. Diese Systeme m√ºssen sowohl technische Effizienz als auch regulatorische Nachverfolgbarkeit gew√§hrleisten, w√§hrend sie gleichzeitig Gesch√§ftskontinuit√§t und operative Stabilit√§t sicherstellen.\n\nüîÑ Strukturierte Remediation-Workflow-Entwicklung:\n‚Ä¢ Etablierung risikobasierter Remediation-Priorit√§ten mit klaren SLAs f√ºr verschiedene Schwachstellen-Kategorien basierend auf CVSS-Scores, Business-Impact und Exploit-Verf√ºgbarkeit\n‚Ä¢ Implementierung automatisierter Workflow-Engines, die Remediation-Tasks basierend auf Asset-Kritikalit√§t und Schwachstellen-Schwere automatisch zuweisen\n‚Ä¢ Entwicklung von Eskalationsprozessen f√ºr √ºberf√§llige oder blockierte Remediation-Aktivit√§ten mit Management-Visibility\n‚Ä¢ Integration von Change-Management-Prozessen zur Koordination von Patch-Deployments mit geplanten Wartungsfenstern\n‚Ä¢ Etablierung von Exception-Management-Workflows f√ºr F√§lle, in denen sofortige Remediation nicht m√∂glich ist\n\n‚öôÔ∏è Automatisierte Patch-Management-Systeme:\n‚Ä¢ Deployment von Enterprise-Patch-Management-L√∂sungen wie Microsoft WSUS, Red Hat Satellite oder SUSE Manager f√ºr Operating-System-Patches\n‚Ä¢ Implementierung von Application-Patch-Management-Tools wie Tanium Patch oder Automox f√ºr Third-Party-Software-Updates\n‚Ä¢ Integration von Container-Patch-Management mit Tools wie Aqua Security oder Twistlock f√ºr containerisierte Workloads\n‚Ä¢ Etablierung von Cloud-native Patch-Management mit AWS Systems Manager, Azure Update Management oder Google Cloud OS Patch Management\n‚Ä¢ Entwicklung von Custom-Automation-Scripts f√ºr Legacy-Systeme oder spezialisierte Anwendungen\n\nüéØ Risk-based Patch-Priorisierung und Testing:\n‚Ä¢ Implementierung intelligenter Priorisierungs-Algorithmen, die Schwachstellen-Schwere, Asset-Kritikalit√§t und aktuelle Bedrohungen ber√ºcksichtigen\n‚Ä¢ Etablierung von Patch-Testing-Frameworks mit Development-, Staging- und Production-Umgebungen f√ºr sichere Validierung\n‚Ä¢ Entwicklung von Rollback-Strategien und Contingency-Plans f√ºr fehlgeschlagene Patch-Deployments\n‚Ä¢ Integration von Performance-Monitoring zur √úberwachung der Auswirkungen von Patches auf System-Performance\n‚Ä¢ Implementierung von Compatibility-Testing zur Sicherstellung, dass Patches keine Gesch√§ftsanwendungen beeintr√§chtigen\n\nüìã DORA-konforme Dokumentation und Tracking:\n‚Ä¢ Aufbau umfassender Audit-Trails f√ºr alle Remediation-Aktivit√§ten mit Zeitstempeln, Verantwortlichen und Ergebnissen\n‚Ä¢ Implementierung von Compliance-Dashboards, die den Status aller Schwachstellen und Remediation-Fortschritte in Echtzeit anzeigen\n‚Ä¢ Entwicklung automatisierter Reporting-Systeme f√ºr regulatorische Berichterstattung und Management-Updates\n‚Ä¢ Etablierung von Metriken zur Messung der Remediation-Effektivit√§t wie Mean-Time-to-Patch und Patch-Success-Rates\n‚Ä¢ Integration mit ITSM-Systemen f√ºr vollst√§ndige Nachverfolgung von Remediation-Activities im Kontext des IT-Service-Managements\n\nüîß Integration und Orchestrierung:\n‚Ä¢ Entwicklung von API-basierten Integrationen zwischen Vulnerability-Scanning-Tools und Patch-Management-Systemen\n‚Ä¢ Implementierung von SOAR-Playbooks f√ºr automatisierte Remediation-Workflows bei Standard-Schwachstellen\n‚Ä¢ Integration mit Configuration-Management-Tools wie Ansible, Puppet oder Chef f√ºr konsistente Patch-Deployments\n‚Ä¢ Etablierung von Monitoring-Integration zur kontinuierlichen √úberwachung der Patch-Compliance\n‚Ä¢ Entwicklung von Notification-Systemen f√ºr Stakeholder-Updates √ºber kritische Remediation-Aktivit√§ten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie f√ºhre ich DORA-konforme Penetrationstests durch und wie integriere ich sie in mein Schwachstellen-Management?',
        answer: "DORA-konforme Penetrationstests gehen √ºber traditionelle Security-Assessments hinaus und erfordern eine systematische, dokumentierte Herangehensweise, die sowohl technische Tiefe als auch regulatorische Compliance gew√§hrleistet. Diese Tests m√ºssen strategisch in das Gesamtschwachstellen-Management integriert werden, um kontinuierliche Verbesserung und Validierung der Sicherheitskontrollen zu erm√∂glichen.\n\nüéØ DORA-spezifische Penetrationstest-Anforderungen:\n‚Ä¢ Durchf√ºhrung risikobasierter Penetrationstests, die kritische IKT-Systeme und -Services priorisieren, basierend auf Business-Impact und Bedrohungslandschaft\n‚Ä¢ Implementierung von Threat-Intelligence-driven Testing-Szenarien, die aktuelle Angreifer-TTPs und branchenspezifische Bedrohungen simulieren\n‚Ä¢ Etablierung regelm√§√üiger Testing-Zyklen mit angemessener Frequenz basierend auf System-Kritikalit√§t und √Ñnderungsrate\n‚Ä¢ Integration von Red-Team-Exercises zur Simulation fortgeschrittener, persistenter Bedrohungen\n‚Ä¢ Durchf√ºhrung von Purple-Team-Aktivit√§ten zur Verbesserung der Koordination zwischen Angriffs- und Verteidigungsteams\n\nüîç Umfassende Testing-Methodologien und -Scope:\n‚Ä¢ Implementierung von External-Penetration-Testing zur Bewertung der Internet-facing Attack-Surface\n‚Ä¢ Durchf√ºhrung von Internal-Network-Penetration-Testing zur Simulation von Insider-Bedrohungen und Lateral-Movement\n‚Ä¢ Execution von Web-Application-Penetration-Testing f√ºr alle kritischen Online-Services und Customer-facing Applications\n‚Ä¢ Deployment von Wireless-Network-Testing zur Bewertung der WLAN-Sicherheit und Rogue-Access-Point-Detection\n‚Ä¢ Implementierung von Social-Engineering-Tests zur Bewertung der Human-Factor-Vulnerabilities\n\n‚öôÔ∏è Technische Testing-Tools und -Plattformen:\n‚Ä¢ Nutzung professioneller Penetration-Testing-Frameworks wie Metasploit Pro, Core Impact oder Immunity Canvas\n‚Ä¢ Deployment spezialisierter Tools wie Burp Suite Professional, OWASP ZAP oder Acunetix f√ºr Web-Application-Testing\n‚Ä¢ Integration von Network-Scanning-Tools wie Nmap, Masscan und Zmap f√ºr Infrastructure-Assessment\n‚Ä¢ Verwendung von Exploitation-Frameworks und Custom-Exploits f√ºr realistische Attack-Simulation\n‚Ä¢ Implementierung von Post-Exploitation-Tools f√ºr Privilege-Escalation und Persistence-Testing\n\nüìä Integration in Vulnerability-Management-Prozesse:\n‚Ä¢ Entwicklung von Feedback-Loops zwischen Penetration-Testing-Ergebnissen und Vulnerability-Scanning-Konfigurationen\n‚Ä¢ Implementierung von Validation-Workflows, die Penetration-Tests zur Best√§tigung von Vulnerability-Scan-Ergebnissen nutzen\n‚Ä¢ Etablierung von Remediation-Validation-Prozessen, die Penetration-Tests zur Verifikation erfolgreicher Schwachstellen-Behebung einsetzen\n‚Ä¢ Integration von Penetration-Testing-Findings in Risk-Assessment-Prozesse f√ºr verbesserte Priorisierung\n‚Ä¢ Entwicklung von Continuous-Security-Testing-Pipelines, die automatisierte und manuelle Testing-Aktivit√§ten kombinieren\n\nüìã DORA-konforme Dokumentation und Berichterstattung:\n‚Ä¢ Erstellung umfassender Penetration-Testing-Reports mit Executive-Summaries, technischen Details und Remediation-Empfehlungen\n‚Ä¢ Implementierung standardisierter Reporting-Templates, die DORA-Anforderungen f√ºr Audit-Trails und regulatorische Berichterstattung erf√ºllen\n‚Ä¢ Entwicklung von Metrics-Dashboards zur Verfolgung von Testing-Coverage, Finding-Trends und Remediation-Progress\n‚Ä¢ Etablierung von Stakeholder-Communication-Prozessen f√ºr verschiedene Zielgruppen von technischen Teams bis zum Management\n‚Ä¢ Aufbau von Historical-Trend-Analysis zur Bewertung der Sicherheitsverbesserung √ºber Zeit"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Wie entwickle ich effektive Metriken und KPIs f√ºr mein DORA-Schwachstellen-Management-Programm?',
        answer: "Effektive Metriken und KPIs f√ºr DORA-Schwachstellen-Management-Programme m√ºssen sowohl operative Exzellenz als auch regulatorische Compliance messen, w√§hrend sie gleichzeitig actionable Insights f√ºr kontinuierliche Verbesserung liefern. Diese Metriken sollten verschiedene Stakeholder-Perspektiven ber√ºcksichtigen und sowohl technische als auch gesch√§ftsorientierte Kennzahlen umfassen.\n\nüìä Operative Effektivit√§ts-Metriken:\n‚Ä¢ Mean-Time-to-Detection f√ºr neue Schwachstellen, gemessen von der Verf√ºgbarkeit von Patches oder Vulnerability-Disclosures bis zur internen Identifikation\n‚Ä¢ Mean-Time-to-Remediation aufgeschl√ºsselt nach Schwachstellen-Schwere und Asset-Kritikalit√§t zur Bewertung der Response-Geschwindigkeit\n‚Ä¢ Vulnerability-Coverage-Ratio zur Messung des Anteils der Assets, die regelm√§√üig gescannt werden\n‚Ä¢ False-Positive-Rate zur Bewertung der Scanning-Genauigkeit und Tool-Konfiguration\n‚Ä¢ Patch-Success-Rate zur Messung der Effektivit√§t von Remediation-Aktivit√§ten\n\nüéØ Risikoorientierte Performance-Indikatoren:\n‚Ä¢ Risk-Exposure-Trends zur Verfolgung der Gesamtrisiko-Position √ºber Zeit\n‚Ä¢ Critical-Vulnerability-Backlog zur √úberwachung der Anzahl ungel√∂ster hochriskanter Schwachstellen\n‚Ä¢ Asset-Risk-Score-Distribution zur Bewertung der Risiko-Verteilung √ºber verschiedene Asset-Kategorien\n‚Ä¢ Threat-Intelligence-Integration-Rate zur Messung der Nutzung aktueller Bedrohungsinformationen\n‚Ä¢ Compensating-Controls-Effectiveness zur Bewertung tempor√§rer Risikominderungsma√ünahmen\n\nüìã DORA-Compliance und Governance-Metriken:\n‚Ä¢ Audit-Trail-Completeness zur Sicherstellung vollst√§ndiger Dokumentation aller Schwachstellen-Management-Aktivit√§ten\n‚Ä¢ Policy-Compliance-Rate zur Messung der Einhaltung interner Schwachstellen-Management-Richtlinien\n‚Ä¢ Regulatory-Reporting-Timeliness zur Bewertung der rechtzeitigen Erf√ºllung von Berichtspflichten\n‚Ä¢ Training-and-Awareness-Coverage zur Messung der Schulungsabdeckung f√ºr relevante Mitarbeiter\n‚Ä¢ Third-Party-Vulnerability-Assessment-Coverage zur Bewertung der Drittanbieter-Risikomanagement-Effektivit√§t\n\n‚ö° Proaktive und Predictive-Metriken:\n‚Ä¢ Vulnerability-Trend-Analysis zur Identifikation von Mustern und Vorhersage zuk√ºnftiger Risiken\n‚Ä¢ Zero-Day-Preparedness-Score zur Bewertung der Bereitschaft f√ºr unbekannte Bedrohungen\n‚Ä¢ Security-Debt-Accumulation zur Messung der Anh√§ufung ungel√∂ster Sicherheitsprobleme\n‚Ä¢ Threat-Landscape-Alignment zur Bewertung der Anpassung an sich √§ndernde Bedrohungen\n‚Ä¢ Continuous-Improvement-Index zur Messung der Fortschritte bei Prozess- und Tool-Optimierungen\n\nüîç Stakeholder-spezifische Dashboards und Reporting:\n‚Ä¢ Executive-Dashboards mit High-Level-Risk-Indicators und Business-Impact-Metriken\n‚Ä¢ Technical-Team-Dashboards mit detaillierten Operational-Metriken und Workflow-Status\n‚Ä¢ Compliance-Officer-Views mit Regulatory-Compliance-Status und Audit-Readiness-Indikatoren\n‚Ä¢ Business-Unit-Specific-Metrics zur Bewertung der Sicherheitsposition verschiedener Gesch√§ftsbereiche\n‚Ä¢ Trend-Analysis-Reports f√ºr strategische Planung und Budget-Allokation"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
