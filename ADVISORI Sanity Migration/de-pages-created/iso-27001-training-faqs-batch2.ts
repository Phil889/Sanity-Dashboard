import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Training page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-training' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-training" not found')
    }
    
    // Create new FAQs for implementation and practical training
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'How does ADVISORI incorporate hands-on practical exercises and real-world scenarios into ISO 27001 training programs?',
        answer: "ADVISORI's training methodology emphasizes experiential learning through carefully designed practical exercises that mirror real-world implementation challenges. Our approach transforms theoretical knowledge into actionable skills by immersing participants in authentic scenarios that reflect the complexities they will encounter in their professional environments.\n\nüõ†Ô∏è Interactive Workshop Methodologies:\n‚Ä¢ Structured case study analysis using anonymized real client scenarios from diverse industries and organizational contexts\n‚Ä¢ Role-playing exercises that simulate stakeholder interactions, audit situations, and crisis management scenarios\n‚Ä¢ Hands-on development of ISMS documentation including policies, procedures, and risk assessment templates\n‚Ä¢ Collaborative problem-solving sessions where participants work in teams to address complex implementation challenges\n‚Ä¢ Simulation of certification audit processes with realistic questioning and evidence review exercises\n\nüè≠ Industry-Specific Scenario Development:\n‚Ä¢ Customized scenarios that reflect specific regulatory environments and business contexts relevant to participant organizations\n‚Ä¢ Integration of current threat landscapes and emerging security challenges that organizations face today\n‚Ä¢ Realistic budget constraints and resource limitations that mirror actual implementation conditions\n‚Ä¢ Cross-functional stakeholder dynamics that participants must navigate in real organizational settings\n‚Ä¢ Time-pressured decision-making exercises that develop practical judgment and prioritization skills\n\nüíª Technology-Enhanced Learning Experiences:\n‚Ä¢ Virtual reality simulations of security incident response scenarios and crisis management situations\n‚Ä¢ Interactive digital platforms that allow participants to build and test ISMS frameworks in safe environments\n‚Ä¢ Gamification elements that create engaging competition while reinforcing learning objectives\n‚Ä¢ Real-time feedback systems that provide immediate guidance and correction during practical exercises\n‚Ä¢ Collaborative online workspaces where participants can continue working on projects between training sessions\n\nüìä Assessment and Validation Techniques:\n‚Ä¢ Practical competency demonstrations where participants must apply learned concepts to solve novel problems\n‚Ä¢ Peer review processes that encourage collaborative learning and knowledge sharing\n‚Ä¢ Progressive skill building exercises that increase in complexity as participants develop competence\n‚Ä¢ Real-world project assignments that participants can implement in their own organizations\n‚Ä¢ Continuous feedback loops that allow for immediate course correction and personalized guidance\n\nüîÑ Continuous Improvement Integration:\n‚Ä¢ Regular updates to scenarios based on emerging threats, regulatory changes, and industry developments\n‚Ä¢ Incorporation of lessons learned from recent client implementations and certification experiences\n‚Ä¢ Feedback integration from previous participants to enhance realism and relevance of exercises\n‚Ä¢ Collaboration with industry partners to ensure scenarios reflect current market conditions and challenges\n‚Ä¢ Research-based methodology updates that incorporate latest findings in adult learning and skill development"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'What methods does ADVISORI use to measure training effectiveness and ensure sustainable competency development?',
        answer: "ADVISORI employs a comprehensive measurement framework that evaluates both immediate learning outcomes and long-term competency retention. Our multi-dimensional approach ensures that training investments deliver measurable value and sustainable capability development within organizations.\n\nüìà Multi-Level Assessment Framework:\n‚Ä¢ Kirkpatrick Model implementation measuring reaction, learning, behavior change, and organizational results\n‚Ä¢ Pre-training competency assessments to establish baseline knowledge and skill levels\n‚Ä¢ Progressive knowledge checks throughout training programs to ensure comprehension and retention\n‚Ä¢ Post-training practical demonstrations where participants apply learned concepts to real scenarios\n‚Ä¢ Long-term follow-up assessments to measure knowledge retention and practical application success\n\nüéØ Competency-Based Evaluation Criteria:\n‚Ä¢ Detailed competency matrices that define specific skills and knowledge requirements for different roles\n‚Ä¢ Observable behavioral indicators that demonstrate practical application of ISO 27001 principles\n‚Ä¢ Performance-based assessments that require participants to solve complex, multi-faceted problems\n‚Ä¢ Peer evaluation components that assess collaboration and knowledge transfer capabilities\n‚Ä¢ Self-assessment tools that encourage reflective learning and continuous improvement mindset\n\nüìä Data-Driven Performance Tracking:\n‚Ä¢ Learning management systems that track individual progress and identify areas requiring additional support\n‚Ä¢ Analytics dashboards that provide real-time insights into training effectiveness and participant engagement\n‚Ä¢ Comparative analysis across different delivery methods to optimize training approaches\n‚Ä¢ Correlation studies linking training outcomes to organizational security performance improvements\n‚Ä¢ Predictive modeling to identify participants at risk of knowledge decay and proactively provide support\n\nüîÑ Continuous Reinforcement Strategies:\n‚Ä¢ Spaced repetition techniques that reinforce key concepts at optimal intervals for long-term retention\n‚Ä¢ Microlearning modules that provide ongoing skill development and knowledge updates\n‚Ä¢ Mentoring programs that pair experienced practitioners with newly trained professionals\n‚Ä¢ Communities of practice that enable ongoing knowledge sharing and peer support\n‚Ä¢ Regular refresher sessions that address knowledge gaps and introduce new developments\n\nüí° Organizational Impact Measurement:\n‚Ä¢ Implementation success metrics that track how effectively trained individuals apply their knowledge\n‚Ä¢ Security incident reduction rates in organizations with trained personnel\n‚Ä¢ Certification success rates and audit performance improvements\n‚Ä¢ Employee confidence and engagement surveys related to information security responsibilities\n‚Ä¢ Return on investment calculations that demonstrate the business value of training programs\n\nüéì Professional Development Integration:\n‚Ä¢ Continuing professional education credits that support career advancement and certification maintenance\n‚Ä¢ Career pathway guidance that helps participants plan their professional development journey\n‚Ä¢ Skills gap analysis that identifies areas for additional training and development\n‚Ä¢ Professional network building opportunities that extend learning beyond formal training periods\n‚Ä¢ Recognition programs that celebrate achievement and encourage continued learning engagement"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'How does ADVISORI customize ISO 27001 training content for different industries and organizational contexts?',
        answer: "ADVISORI recognizes that effective ISO 27001 training must address the unique challenges, regulatory requirements, and operational contexts of different industries. Our customization approach ensures that participants receive relevant, actionable training that directly applies to their specific professional environments and organizational needs.\n\nüè¶ Financial Services Specialization:\n‚Ä¢ Integration of banking regulations such as Basel III, PCI DSS, and DORA requirements with ISO 27001 frameworks\n‚Ä¢ Focus on financial crime prevention, fraud detection, and customer data protection specific to banking operations\n‚Ä¢ Emphasis on operational resilience and business continuity planning for critical financial infrastructure\n‚Ä¢ Case studies involving payment systems, trading platforms, and digital banking security challenges\n‚Ä¢ Regulatory reporting requirements and supervisory expectations specific to financial institutions\n\nüè• Healthcare Industry Adaptation:\n‚Ä¢ HIPAA compliance integration and patient data protection requirements within ISO 27001 context\n‚Ä¢ Medical device security considerations and FDA cybersecurity guidance alignment\n‚Ä¢ Clinical trial data integrity and pharmaceutical intellectual property protection strategies\n‚Ä¢ Telemedicine and digital health platform security requirements\n‚Ä¢ Emergency response procedures that maintain both patient safety and information security\n\nüè≠ Manufacturing and Industrial Focus:\n‚Ä¢ Industrial control systems security and operational technology protection strategies\n‚Ä¢ Supply chain security requirements and vendor management in manufacturing contexts\n‚Ä¢ Intellectual property protection for research and development activities\n‚Ä¢ Safety system integration with cybersecurity controls in industrial environments\n‚Ä¢ International trade compliance and export control considerations for technology companies\n\n‚òÅÔ∏è Technology and Cloud Services:\n‚Ä¢ Cloud security frameworks and shared responsibility models within ISO 27001 implementation\n‚Ä¢ Software development lifecycle security and DevSecOps integration approaches\n‚Ä¢ Data sovereignty and cross-border data transfer requirements for global technology companies\n‚Ä¢ Incident response procedures for software-as-a-service and platform providers\n‚Ä¢ Customer security requirements and third-party security assessment processes\n\nüèõÔ∏è Government and Public Sector:\n‚Ä¢ National security considerations and classified information handling requirements\n‚Ä¢ Public sector procurement regulations and security clearance requirements\n‚Ä¢ Citizen data protection and privacy requirements specific to government services\n‚Ä¢ Critical infrastructure protection and national cybersecurity framework alignment\n‚Ä¢ Transparency and accountability requirements balanced with security needs\n\nüéì Educational Institution Customization:\n‚Ä¢ Student data protection requirements under FERPA and similar educational privacy regulations\n‚Ä¢ Research data security and intellectual property protection in academic environments\n‚Ä¢ Campus network security challenges and bring-your-own-device policy implementation\n‚Ä¢ International collaboration security requirements for research partnerships\n‚Ä¢ Academic freedom considerations balanced with information security requirements\n\nüîß Organizational Size and Maturity Adaptation:\n‚Ä¢ Small and medium enterprise resource constraints and practical implementation approaches\n‚Ä¢ Large enterprise complexity management and multi-site coordination strategies\n‚Ä¢ Startup agility requirements and rapid growth security scaling approaches\n‚Ä¢ Legacy system integration challenges and modernization security considerations\n‚Ä¢ Cultural change management strategies appropriate for different organizational structures"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'What post-training support and continuing education opportunities does ADVISORI provide to ensure long-term success?',
        answer: "ADVISORI's commitment to participant success extends far beyond formal training completion through comprehensive post-training support and continuing education programs. Our holistic approach ensures that knowledge remains current, skills continue to develop, and participants have access to ongoing guidance as they navigate real-world implementation challenges.\n\nü§ù Ongoing Mentorship and Coaching:\n‚Ä¢ Dedicated mentor assignment for participants in advanced certification programs\n‚Ä¢ Regular one-on-one coaching sessions to address specific implementation challenges and career development goals\n‚Ä¢ Peer mentoring networks that connect participants with experienced practitioners in similar roles or industries\n‚Ä¢ Expert consultation availability for complex technical questions and implementation guidance\n‚Ä¢ Career pathway coaching that helps participants plan their professional development and advancement\n\nüìö Continuous Learning Resources:\n‚Ä¢ Access to comprehensive digital library of implementation guides, templates, and best practice documentation\n‚Ä¢ Regular webinar series covering emerging threats, regulatory updates, and advanced implementation techniques\n‚Ä¢ Quarterly newsletter with industry insights, case studies, and practical tips for ongoing improvement\n‚Ä¢ Online community platform where participants can share experiences, ask questions, and collaborate on challenges\n‚Ä¢ Mobile learning app with microlearning modules for convenient skill reinforcement and knowledge updates\n\nüîÑ Knowledge Update and Refresher Programs:\n‚Ä¢ Annual refresher sessions that address knowledge gaps and introduce new developments in ISO 27001\n‚Ä¢ Specialized workshops on emerging topics such as cloud security, artificial intelligence, and digital transformation\n‚Ä¢ Regulatory update briefings that explain new compliance requirements and their impact on ISMS implementation\n‚Ä¢ Advanced masterclasses for experienced practitioners seeking to deepen their expertise in specific areas\n‚Ä¢ Cross-training opportunities that expand competencies into related areas such as business continuity and risk management\n\nüèÜ Professional Recognition and Advancement:\n‚Ä¢ Continuing professional education credits that support certification maintenance and career advancement\n‚Ä¢ Alumni network events that provide networking opportunities and knowledge sharing with industry peers\n‚Ä¢ Speaking opportunities at conferences and industry events for participants who demonstrate exceptional expertise\n‚Ä¢ Contribution opportunities to thought leadership content and best practice development\n‚Ä¢ Recognition programs that celebrate implementation successes and professional achievements\n\nüíº Implementation Support Services:\n‚Ä¢ Project coaching for participants leading ISO 27001 implementations in their organizations\n‚Ä¢ Document review services that provide expert feedback on policies, procedures, and risk assessments\n‚Ä¢ Mock audit services that help organizations prepare for certification assessments\n‚Ä¢ Gap analysis support that identifies areas requiring additional attention or improvement\n‚Ä¢ Change management guidance that helps organizations navigate the cultural and operational aspects of ISMS implementation\n\nüåê Global Community Engagement:\n‚Ä¢ International user groups that enable knowledge sharing across different markets and regulatory environments\n‚Ä¢ Research collaboration opportunities that contribute to the advancement of information security management practices\n‚Ä¢ Industry working groups that address sector-specific challenges and develop specialized guidance\n‚Ä¢ Standards development participation opportunities for experienced practitioners\n‚Ä¢ Thought leadership platforms that enable participants to share their expertise and insights with the broader community"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
