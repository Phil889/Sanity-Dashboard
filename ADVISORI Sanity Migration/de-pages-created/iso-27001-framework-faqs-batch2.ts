import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Framework page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-framework' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-framework" not found')
    }
    
    // Create new FAQs for ISO 27001 Framework implementation
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie implementiert man ein ISO 27001 Framework systematisch und welche Phasen sind dabei zu beachten?',
        answer: "Die systematische Implementierung eines ISO 27001 Frameworks erfordert einen strukturierten, phasenorientierten Ansatz, der strategische Planung mit operativer Umsetzung verbindet. Dieser methodische Prozess gew√§hrleistet nachhaltige Framework-Integration und minimiert Implementierungsrisiken durch bew√§hrte Vorgehensweisen.\n\nüìã Strategische Planungsphase:\n‚Ä¢ Umfassende Analyse der aktuellen Informationssicherheitslandschaft und Identifikation von Verbesserungspotenzialen\n‚Ä¢ Definition klarer Framework-Ziele und Erfolgskriterien in Abstimmung mit Gesch√§ftszielen\n‚Ä¢ Entwicklung einer ma√ügeschneiderten Framework-Architektur entsprechend organisatorischer Anforderungen\n‚Ä¢ Ressourcenplanung und Budgetierung f√ºr alle Implementierungsphasen\n‚Ä¢ Etablierung von Projektstrukturen und Verantwortlichkeiten f√ºr erfolgreiche Framework-Umsetzung\n\nüèóÔ∏è Framework-Design und Architektur:\n‚Ä¢ Entwicklung der modularen Framework-Struktur mit skalierbaren Komponenten und Schnittstellen\n‚Ä¢ Design von Governance-Strukturen und Entscheidungsprozessen f√ºr effektive Framework-Steuerung\n‚Ä¢ Anpassung der ISO 27001 Kontrollziele an spezifische Organisationsanforderungen\n‚Ä¢ Integration bestehender Sicherheitsma√ünahmen und Managementsysteme in die neue Framework-Architektur\n‚Ä¢ Entwicklung von Dokumentationsstrukturen und Prozesslandschaften\n\nüîß Operative Implementierungsphase:\n‚Ä¢ Schrittweise Umsetzung der Framework-Komponenten beginnend mit kritischen Bereichen\n‚Ä¢ Implementierung von Risikomanagement-Prozessen und Kontrollma√ünahmen\n‚Ä¢ Aufbau von Incident Management und Business Continuity Capabilities\n‚Ä¢ Integration von Monitoring- und Reporting-Mechanismen f√ºr kontinuierliche Framework-√úberwachung\n‚Ä¢ Schulung und Kompetenzentwicklung f√ºr alle Framework-relevanten Rollen\n\nüîÑ Integration und Optimierung:\n‚Ä¢ Nahtlose Integration des Frameworks in bestehende Gesch√§ftsprozesse und IT-Systeme\n‚Ä¢ Automatisierung von Framework-Prozessen zur Effizienzsteigerung\n‚Ä¢ Etablierung von Feedback-Mechanismen f√ºr kontinuierliche Framework-Verbesserung\n‚Ä¢ Testing und Validierung aller Framework-Komponenten vor Produktivsetzung\n‚Ä¢ Change Management f√ºr erfolgreiche organisatorische Verankerung\n\nüìä Monitoring und kontinuierliche Verbesserung:\n‚Ä¢ Implementierung von KPIs und Metriken f√ºr Framework-Performance-Messung\n‚Ä¢ Regelm√§√üige Bewertung der Framework-Wirksamkeit durch interne Audits\n‚Ä¢ Kontinuierliche Anpassung an ver√§nderte Gesch√§ftsanforderungen und Bedrohungslandschaften\n‚Ä¢ Management Reviews f√ºr strategische Framework-Steuerung und -Weiterentwicklung\n‚Ä¢ Vorbereitung auf externe Zertifizierungsaudits und Compliance-Nachweise\n\nüéØ Erfolgsfaktoren f√ºr nachhaltige Implementierung:\n‚Ä¢ Starke F√ºhrungsunterst√ºtzung und klare Kommunikation der Framework-Vision\n‚Ä¢ Angemessene Ressourcenausstattung und realistische Zeitplanung\n‚Ä¢ Einbindung aller relevanten Stakeholder und Fachbereiche\n‚Ä¢ Fokus auf praktische Umsetzbarkeit und Nutzenorientierung\n‚Ä¢ Kontinuierliche Kompetenzentwicklung und Wissenstransfer"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Tools und Technologien unterst√ºtzen die effektive Umsetzung eines ISO 27001 Frameworks?',
        answer: "Die effektive Umsetzung eines ISO 27001 Frameworks wird durch moderne Tools und Technologien erheblich unterst√ºtzt, die Automatisierung, Effizienz und Transparenz in allen Framework-Bereichen erm√∂glichen. Eine strategische Tool-Auswahl optimiert nicht nur die operative Umsetzung, sondern schafft auch die Basis f√ºr skalierbare und nachhaltige Framework-Architektur.\n\nüñ•Ô∏è ISMS-Management-Plattformen:\n‚Ä¢ Integrierte Governance-Plattformen f√ºr zentrale Framework-Steuerung und -koordination\n‚Ä¢ Workflow-Management-Systeme f√ºr automatisierte Prozessabwicklung und Aufgabenverfolgung\n‚Ä¢ Dokumentenmanagement-L√∂sungen f√ºr strukturierte Verwaltung aller Framework-relevanten Informationen\n‚Ä¢ Compliance-Management-Tools f√ºr systematische √úberwachung regulatorischer Anforderungen\n‚Ä¢ Dashboard- und Reporting-Systeme f√ºr Echtzeit-Einblicke in Framework-Performance\n\nüîç Risikomanagement-Technologien:\n‚Ä¢ Risikobewertungs-Software f√ºr systematische Identifikation und Analyse von Informationssicherheitsrisiken\n‚Ä¢ Threat Intelligence Plattformen f√ºr aktuelle Bedrohungsanalysen und Risikolandschaft-Updates\n‚Ä¢ Vulnerability Management Tools f√ºr kontinuierliche Schwachstellenidentifikation und -behandlung\n‚Ä¢ Business Impact Analysis Software f√ºr Bewertung kritischer Gesch√§ftsprozesse\n‚Ä¢ Risiko-Monitoring-Systeme f√ºr kontinuierliche √úberwachung und Fr√ºherkennung\n\nüìä Monitoring und Analytics:\n‚Ä¢ SIEM-Systeme f√ºr umfassende Sicherheitsereignis-Korrelation und -analyse\n‚Ä¢ Log-Management-Plattformen f√ºr zentrale Sammlung und Auswertung von Sicherheitsdaten\n‚Ä¢ Performance-Monitoring-Tools f√ºr kontinuierliche Framework-Leistungsmessung\n‚Ä¢ Compliance-Dashboards f√ºr transparente Darstellung des Compliance-Status\n‚Ä¢ Predictive Analytics f√ºr proaktive Identifikation von Sicherheitsrisiken\n\nüîê Sicherheitstechnologie-Integration:\n‚Ä¢ Identity and Access Management Systeme f√ºr zentrale Benutzer- und Berechtigungsverwaltung\n‚Ä¢ Endpoint Protection Plattformen f√ºr umfassenden Schutz aller Endger√§te\n‚Ä¢ Network Security Tools f√ºr Netzwerksegmentierung und Verkehrs√ºberwachung\n‚Ä¢ Data Loss Prevention L√∂sungen f√ºr Schutz sensibler Informationen\n‚Ä¢ Backup und Disaster Recovery Systeme f√ºr Business Continuity\n\n‚òÅÔ∏è Cloud-basierte Framework-L√∂sungen:\n‚Ä¢ Software-as-a-Service ISMS-Plattformen f√ºr schnelle und skalierbare Implementierung\n‚Ä¢ Cloud-native Sicherheitstools f√ºr moderne, verteilte IT-Landschaften\n‚Ä¢ API-basierte Integrationen f√ºr nahtlose Verbindung verschiedener Systeme\n‚Ä¢ Mobile Apps f√ºr Framework-Management unterwegs\n‚Ä¢ Collaboration-Plattformen f√ºr team√ºbergreifende Framework-Zusammenarbeit\n\nü§ñ Automatisierung und KI-Integration:\n‚Ä¢ Robotic Process Automation f√ºr wiederkehrende Framework-Aufgaben\n‚Ä¢ Machine Learning Algorithmen f√ºr intelligente Anomalieerkennung\n‚Ä¢ Chatbots f√ºr Framework-Support und Mitarbeiter-Guidance\n‚Ä¢ Automated Compliance Checking f√ºr kontinuierliche Regelkonformit√§t\n‚Ä¢ Intelligent Document Processing f√ºr effiziente Dokumentenverwaltung\n\nüîó Integration und Interoperabilit√§t:\n‚Ä¢ Enterprise Service Bus f√ºr nahtlose Systemintegration\n‚Ä¢ API-Management-Plattformen f√ºr sichere Daten√ºbertragung\n‚Ä¢ Single Sign-On L√∂sungen f√ºr benutzerfreundlichen Zugang\n‚Ä¢ Data Warehouse und ETL-Tools f√ºr konsolidierte Datenanalyse\n‚Ä¢ Standardisierte Schnittstellen f√ºr Vendor-unabh√§ngige Flexibilit√§t"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie misst und bewertet man die Effektivit√§t eines implementierten ISO 27001 Frameworks?',
        answer: "Die Messung und Bewertung der Effektivit√§t eines ISO 27001 Frameworks erfordert ein systematisches Performance-Management-System, das quantitative Metriken mit qualitativen Bewertungen kombiniert. Diese kontinuierliche Evaluation erm√∂glicht datenbasierte Optimierungen und gew√§hrleistet nachhaltige Framework-Excellence.\n\nüìä Quantitative Performance-Indikatoren:\n‚Ä¢ Reduzierung von Sicherheitsvorf√§llen und deren Auswirkungen auf Gesch√§ftsprozesse\n‚Ä¢ Verbesserung der Mean Time to Detection und Mean Time to Response bei Sicherheitsereignissen\n‚Ä¢ Compliance-Rate bei internen und externen Audits sowie regulatorischen √úberpr√ºfungen\n‚Ä¢ Verf√ºgbarkeit kritischer Systeme und Services entsprechend definierter Service Level Agreements\n‚Ä¢ Kosteneffizienz der Sicherheitsinvestitionen im Verh√§ltnis zum erreichten Schutzlevel\n\nüéØ Framework-spezifische Metriken:\n‚Ä¢ Vollst√§ndigkeit der Kontrollimplementierung entsprechend ISO 27001 Anhang A\n‚Ä¢ Reifegrad der Framework-Komponenten basierend auf etablierten Maturity-Modellen\n‚Ä¢ Effektivit√§t der Risikomanagement-Prozesse durch Risikoreduktion und -behandlung\n‚Ä¢ Qualit√§t der Dokumentation und Prozessnachvollziehbarkeit\n‚Ä¢ Integration des Frameworks in Gesch√§ftsprozesse und strategische Entscheidungen\n\nüîç Qualitative Bewertungskriterien:\n‚Ä¢ Sicherheitskultur und Awareness-Level in der gesamten Organisation\n‚Ä¢ Stakeholder-Zufriedenheit mit Framework-Services und -unterst√ºtzung\n‚Ä¢ Flexibilit√§t und Anpassungsf√§higkeit des Frameworks an ver√§nderte Anforderungen\n‚Ä¢ Benutzerfreundlichkeit und Akzeptanz der Framework-Prozesse\n‚Ä¢ Strategische Ausrichtung des Frameworks an Gesch√§ftszielen und -priorit√§ten\n\nüìà Kontinuierliche Monitoring-Mechanismen:\n‚Ä¢ Real-time Dashboards f√ºr sofortige Einblicke in kritische Framework-Parameter\n‚Ä¢ Regelm√§√üige Management Reviews zur strategischen Bewertung der Framework-Performance\n‚Ä¢ Trend-Analysen f√ºr Identifikation von Verbesserungspotenzialen und Entwicklungsrichtungen\n‚Ä¢ Benchmarking mit Branchenstandards und Best Practices\n‚Ä¢ Stakeholder-Feedback-Zyklen f√ºr kontinuierliche Verbesserung\n\nüîÑ Audit und Assessment-Programme:\n‚Ä¢ Interne Audits zur systematischen √úberpr√ºfung der Framework-Wirksamkeit\n‚Ä¢ Externe Assessments f√ºr unabh√§ngige Bewertung und Zertifizierung\n‚Ä¢ Penetration Tests und Vulnerability Assessments f√ºr technische Validierung\n‚Ä¢ Business Continuity Tests f√ºr √úberpr√ºfung der Resilienz\n‚Ä¢ Compliance-Checks f√ºr regulatorische Konformit√§t\n\nüìã Reporting und Kommunikation:\n‚Ä¢ Executive Dashboards f√ºr F√ºhrungsebene mit strategischen KPIs\n‚Ä¢ Operative Reports f√ºr t√§gliches Framework-Management\n‚Ä¢ Compliance-Berichte f√ºr regulatorische und Audit-Zwecke\n‚Ä¢ Stakeholder-Kommunikation √ºber Framework-Erfolge und Herausforderungen\n‚Ä¢ Lessons Learned Dokumentation f√ºr kontinuierliche Verbesserung\n\nüöÄ Verbesserungs- und Optimierungszyklen:\n‚Ä¢ Systematische Analyse von Performance-Gaps und Verbesserungspotenzialen\n‚Ä¢ Entwicklung und Implementierung von Korrekturma√ünahmen\n‚Ä¢ Kontinuierliche Anpassung der Metriken an ver√§nderte Gesch√§ftsanforderungen\n‚Ä¢ Innovation und Evolution des Frameworks entsprechend neuer Technologien\n‚Ä¢ Aufbau einer lernenden Organisation im Bereich Informationssicherheit"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche h√§ufigen Herausforderungen treten bei der ISO 27001 Framework-Implementierung auf und wie l√∂st man sie?',
        answer: "Die ISO 27001 Framework-Implementierung bringt verschiedene Herausforderungen mit sich, die durch proaktive Planung, bew√§hrte L√∂sungsans√§tze und kontinuierliche Anpassung erfolgreich bew√§ltigt werden k√∂nnen. Ein systematisches Verst√§ndnis dieser Herausforderungen erm√∂glicht pr√§ventive Ma√ünahmen und effektive Probleml√∂sung.\n\nüè¢ Organisatorische Herausforderungen:\n‚Ä¢ Widerstand gegen Ver√§nderungen und mangelnde Akzeptanz neuer Prozesse in der Organisation\n‚Ä¢ Unzureichende F√ºhrungsunterst√ºtzung und fehlende strategische Ausrichtung des Frameworks\n‚Ä¢ Ressourcenknappheit und konkurrierende Priorit√§ten bei der Framework-Implementierung\n‚Ä¢ Komplexe Organisationsstrukturen und dezentrale Entscheidungsprozesse\n‚Ä¢ Kulturelle Barrieren und unterschiedliche Sicherheitsverst√§ndnisse in verschiedenen Bereichen\n\nüí° L√∂sungsans√§tze f√ºr organisatorische Herausforderungen:\n‚Ä¢ Entwicklung einer umfassenden Change-Management-Strategie mit klarer Kommunikation der Framework-Vorteile\n‚Ä¢ Aufbau von Framework-Champions in allen Organisationsbereichen f√ºr lokale Unterst√ºtzung\n‚Ä¢ Schrittweise Implementierung mit Quick Wins f√ºr fr√ºhe Erfolgserlebnisse\n‚Ä¢ Regelm√§√üige Stakeholder-Kommunikation und Einbindung in Entscheidungsprozesse\n‚Ä¢ Anpassung des Frameworks an bestehende Organisationskultur und -prozesse\n\nüîß Technische Implementierungsherausforderungen:\n‚Ä¢ Integration des Frameworks in komplexe, gewachsene IT-Landschaften\n‚Ä¢ Legacy-Systeme und veraltete Technologien ohne moderne Sicherheitsfeatures\n‚Ä¢ Datenqualit√§t und -konsistenz bei der Framework-Implementierung\n‚Ä¢ Skalierbarkeit der Framework-L√∂sungen f√ºr wachsende Organisationen\n‚Ä¢ Interoperabilit√§t zwischen verschiedenen Sicherheitstools und -plattformen\n\n‚öôÔ∏è Technische L√∂sungsstrategien:\n‚Ä¢ Entwicklung einer schrittweisen Modernisierungsstrategie f√ºr Legacy-Systeme\n‚Ä¢ Nutzung von API-basierten Integrationen f√ºr nahtlose Systemverbindungen\n‚Ä¢ Implementierung von Data Governance Prozessen f√ºr verbesserte Datenqualit√§t\n‚Ä¢ Cloud-basierte L√∂sungen f√ºr erh√∂hte Skalierbarkeit und Flexibilit√§t\n‚Ä¢ Standardisierte Schnittstellen und Protokolle f√ºr bessere Interoperabilit√§t\n\nüìã Compliance und Governance-Herausforderungen:\n‚Ä¢ Komplexit√§t der ISO 27001 Anforderungen und deren praktische Umsetzung\n‚Ä¢ Dokumentationsaufwand und Aufrechterhaltung aktueller Framework-Dokumentation\n‚Ä¢ Kontinuierliche √úberwachung und Nachweis der Compliance\n‚Ä¢ Integration verschiedener regulatorischer Anforderungen in ein koh√§rentes Framework\n‚Ä¢ Vorbereitung auf externe Audits und Zertifizierungsprozesse\n\nüìö Compliance-L√∂sungsans√§tze:\n‚Ä¢ Nutzung bew√§hrter Templates und Frameworks f√ºr effiziente Dokumentation\n‚Ä¢ Automatisierung von Compliance-Monitoring und -Reporting\n‚Ä¢ Regelm√§√üige interne Audits zur Vorbereitung auf externe Bewertungen\n‚Ä¢ Integration von Compliance-Anforderungen in t√§gliche Gesch√§ftsprozesse\n‚Ä¢ Kontinuierliche Weiterbildung und Kompetenzentwicklung im Compliance-Bereich\n\nüí∞ Ressourcen- und Budgetherausforderungen:\n‚Ä¢ Unklare oder unzureichende Budgetplanung f√ºr Framework-Implementierung\n‚Ä¢ Schwierigkeiten bei der ROI-Bewertung von Sicherheitsinvestitionen\n‚Ä¢ Mangel an qualifizierten Fachkr√§ften f√ºr Framework-Implementierung\n‚Ä¢ Zeitdruck und unrealistische Implementierungszeitpl√§ne\n‚Ä¢ Unvorhergesehene Kosten und Scope-Erweiterungen w√§hrend der Implementierung\n\nüí° Ressourcen-Optimierungsstrategien:\n‚Ä¢ Entwicklung detaillierter Business Cases mit klaren Nutzen-Argumentationen\n‚Ä¢ Phasenweise Implementierung zur Verteilung der Investitionen √ºber Zeit\n‚Ä¢ Nutzung externer Expertise f√ºr Wissenstransfer und Beschleunigung\n‚Ä¢ Automatisierung wiederkehrender Aufgaben zur Ressourcenoptimierung\n‚Ä¢ Kontinuierliche √úberwachung und Anpassung von Budget und Zeitpl√§nen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
