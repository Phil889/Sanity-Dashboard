import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating PKI Infrastructure page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'pki-infrastruktur' })
    
    if (!existingDoc) {
      throw new Error('Document "pki-infrastruktur" not found')
    }
    
    // Create new FAQs for certificate management and authorities
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie wird eine Certificate Authority sicher implementiert und betrieben?',
        answer: "Die sichere Implementierung und der Betrieb einer Certificate Authority bilden das Fundament jeder vertrauensw√ºrdigen PKI-Infrastruktur. Eine CA ist nicht nur ein technisches System, sondern ein kritischer Vertrauensanker, dessen Kompromittierung die gesamte PKI-Sicherheit gef√§hrden w√ºrde. Daher erfordert CA-Management h√∂chste Sicherheitsstandards und operative Exzellenz.\n\nüè∞ Root CA Security Architecture:\n‚Ä¢ Offline Root Certificate Authorities werden physisch von allen Netzwerken getrennt und nur f√ºr kritische Operationen aktiviert\n‚Ä¢ Air-Gap-Architektur verhindert jegliche Netzwerkverbindungen zur Root CA au√üerhalb kontrollierter Zeremonien\n‚Ä¢ Hardware Security Modules der h√∂chsten Sicherheitsstufe sch√ºtzen Root CA Private Keys vor physischen und logischen Angriffen\n‚Ä¢ Secure Facilities mit mehrstufigen Zugangskontrollen, biometrischen Systemen und kontinuierlicher √úberwachung\n‚Ä¢ Dual Control und Split Knowledge erfordern mindestens zwei autorisierte Personen f√ºr alle kritischen Root CA Operationen\n\nüîê Hardware Security Module Integration:\n‚Ä¢ FIPS 140-2 Level 3 oder Common Criteria EAL4+ zertifizierte HSMs f√ºr h√∂chste Sicherheitsanforderungen\n‚Ä¢ Tamper-resistant und tamper-evident Hardware sch√ºtzt vor physischen Manipulationsversuchen\n‚Ä¢ Secure Key Generation innerhalb des HSM gew√§hrleistet kryptographische Qualit√§t der Schl√ºssel\n‚Ä¢ Role-based Authentication mit Smart Cards oder anderen starken Authentifizierungsmethoden\n‚Ä¢ Backup und Recovery Procedures f√ºr HSM-Schl√ºssel mit sicherer Schl√ºssel-Escrow-Verwaltung\n\n‚ö° Subordinate CA Operational Security:\n‚Ä¢ Online Subordinate CAs handhaben operative Zertifikatsausstellung mit angemessenen Sicherheitsma√ünahmen\n‚Ä¢ Network Segmentation isoliert CA-Systeme in dedizierten Sicherheitszonen mit strikten Firewall-Regeln\n‚Ä¢ Intrusion Detection und Prevention Systems √ºberwachen CA-Infrastruktur kontinuierlich\n‚Ä¢ Regular Security Updates und Patch Management gew√§hrleisten aktuelle Sicherheitsstandards\n‚Ä¢ Automated Backup Systems sichern CA-Datenbanken und Konfigurationen regelm√§√üig\n\nüìã Certificate Practice Statement Implementation:\n‚Ä¢ Detaillierte Dokumentation aller CA-Verfahren und Sicherheitsma√ünahmen f√ºr Transparenz und Compliance\n‚Ä¢ Policy Framework definiert verschiedene Zertifikatsklassen und deren Verwendungszwecke\n‚Ä¢ Audit Requirements spezifizieren interne und externe √úberpr√ºfungsverfahren\n‚Ä¢ Incident Response Procedures f√ºr CA-Kompromittierung und andere Sicherheitsvorf√§lle\n‚Ä¢ Change Management Processes kontrollieren √Ñnderungen an CA-Systemen und -Verfahren\n\nüîÑ Certificate Lifecycle Automation:\n‚Ä¢ Automated Certificate Enrollment reduziert manuelle Fehler und verbessert Effizienz\n‚Ä¢ Template-based Certificate Issuance gew√§hrleistet konsistente Zertifikatskonfigurationen\n‚Ä¢ Automated Renewal Processes verhindern unbeabsichtigte Zertifikatsabl√§ufe\n‚Ä¢ Real-time Certificate Status Checking durch OCSP und CRL Distribution Points\n‚Ä¢ Certificate Inventory Management verfolgt alle ausgestellten Zertifikate zentral\n\nüõ°Ô∏è Monitoring und Incident Response:\n‚Ä¢ Security Information and Event Management sammelt und analysiert alle CA-Logs\n‚Ä¢ Real-time Alerting bei anomalen Aktivit√§ten oder Sicherheitsereignissen\n‚Ä¢ Forensic Logging erm√∂glicht detaillierte Nachverfolgung aller CA-Operationen\n‚Ä¢ Emergency Response Teams f√ºr schnelle Reaktion auf CA-Sicherheitsvorf√§lle\n‚Ä¢ Business Continuity Planning gew√§hrleistet CA-Verf√ºgbarkeit auch bei St√∂rungen\n\nüîß Operational Excellence Practices:\n‚Ä¢ Regular Security Assessments und Penetration Testing validieren CA-Sicherheit\n‚Ä¢ Staff Training und Zertifizierung f√ºr alle CA-Administratoren und -Operatoren\n‚Ä¢ Segregation of Duties verhindert Interessenkonflikte bei kritischen CA-Operationen\n‚Ä¢ Vendor Management f√ºr CA-Software und Hardware-Lieferanten\n‚Ä¢ Continuous Improvement durch Lessons Learned und Best Practice Updates\n\nüìä Compliance und Audit Management:\n‚Ä¢ Regular Internal Audits √ºberpr√ºfen Einhaltung von CA-Richtlinien und -Verfahren\n‚Ä¢ External Audit Support f√ºr Compliance-Validierung durch unabh√§ngige Pr√ºfer\n‚Ä¢ Regulatory Compliance Monitoring f√ºr branchenspezifische Anforderungen\n‚Ä¢ Documentation Management gew√§hrleistet aktuelle und vollst√§ndige CA-Dokumentation\n‚Ä¢ Risk Assessment und Management identifiziert und behandelt CA-spezifische Risiken"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Rolle spielen Hardware Security Modules in PKI-Systemen?',
        answer: "Hardware Security Modules sind spezialisierte, tamper-resistant Hardware-Ger√§te, die als sichere Krypto-Prozessoren fungieren und das Herzst√ºck jeder hochsicheren PKI-Infrastruktur bilden. HSMs bieten nicht nur √ºberlegenen Schutz f√ºr kryptographische Schl√ºssel, sondern auch leistungsstarke kryptographische Verarbeitungskapazit√§ten, die f√ºr Enterprise-PKI-Umgebungen unerl√§sslich sind.\n\nüîê Kryptographische Schl√ºsselsicherheit:\n‚Ä¢ Tamper-resistant Hardware sch√ºtzt private Schl√ºssel vor physischen Extraktionsversuchen\n‚Ä¢ Secure Key Generation verwendet echte Hardware-Zufallszahlengeneratoren f√ºr h√∂chste Entropie\n‚Ä¢ Key Storage erfolgt in sicheren, verschl√ºsselten Speicherbereichen innerhalb des HSM\n‚Ä¢ Key Lifecycle Management automatisiert Schl√ºsselerstellung, -rotation und -archivierung\n‚Ä¢ Secure Key Backup und Recovery Mechanismen gew√§hrleisten Gesch√§ftskontinuit√§t\n\n‚ö° High-Performance Cryptographic Processing:\n‚Ä¢ Dedicated Cryptographic Processors beschleunigen RSA, ECC und symmetrische Kryptographie erheblich\n‚Ä¢ Parallel Processing Capabilities erm√∂glichen gleichzeitige Verarbeitung multipler kryptographischer Operationen\n‚Ä¢ Hardware-accelerated Certificate Signing reduziert Latenz bei Massenausstellung von Zertifikaten\n‚Ä¢ Optimized Algorithms nutzen spezialisierte Hardware f√ºr maximale Leistung\n‚Ä¢ Load Balancing zwischen mehreren HSMs f√ºr Skalierbarkeit und Redundanz\n\nüõ°Ô∏è Compliance und Zertifizierungsstandards:\n‚Ä¢ FIPS 140-2 Level 3 und Level 4 Zertifizierungen gew√§hrleisten h√∂chste Sicherheitsstandards\n‚Ä¢ Common Criteria EAL4+ Evaluierungen validieren Sicherheitsarchitektur und -implementierung\n‚Ä¢ Industry-specific Certifications f√ºr Finanzdienstleistungen, Gesundheitswesen und Regierungsanwendungen\n‚Ä¢ Regulatory Compliance Support f√ºr PCI DSS, HIPAA, SOX und andere Vorschriften\n‚Ä¢ Audit Trail Capabilities dokumentieren alle HSM-Operationen f√ºr Compliance-Nachweise\n\nüîÑ PKI Integration und API Support:\n‚Ä¢ PKCS#11 Standard Interface erm√∂glicht nahtlose Integration in PKI-Anwendungen\n‚Ä¢ Microsoft CAPI und CNG Support f√ºr Windows-basierte PKI-Systeme\n‚Ä¢ Java Cryptography Architecture Integration f√ºr Java-basierte Anwendungen\n‚Ä¢ RESTful APIs f√ºr moderne, cloud-native PKI-Implementierungen\n‚Ä¢ Custom Integration Support f√ºr spezialisierte PKI-Anwendungen\n\nüåê Network-Attached HSM Capabilities:\n‚Ä¢ Centralized HSM Services f√ºr verteilte PKI-Infrastrukturen\n‚Ä¢ Secure Network Protocols f√ºr HSM-Kommunikation √ºber Netzwerke\n‚Ä¢ Load Balancing und Failover f√ºr hochverf√ºgbare HSM-Cluster\n‚Ä¢ Remote Management Capabilities f√ºr geografisch verteilte HSM-Deployments\n‚Ä¢ Secure Partitioning erm√∂glicht Multi-Tenant HSM-Nutzung\n\nüîß Operational Management Features:\n‚Ä¢ Role-based Access Control mit Multi-Factor Authentication f√ºr HSM-Zugriff\n‚Ä¢ Secure Administration Tools f√ºr HSM-Konfiguration und -Wartung\n‚Ä¢ Monitoring und Alerting f√ºr HSM-Status und -Performance\n‚Ä¢ Automated Backup und Recovery Procedures f√ºr HSM-Konfigurationen\n‚Ä¢ Firmware Update Management mit sicheren Update-Verfahren\n\nüìä Performance und Skalierbarkeit:\n‚Ä¢ High-throughput Certificate Signing f√ºr Enterprise-Anforderungen\n‚Ä¢ Concurrent Session Support f√ºr multiple gleichzeitige PKI-Anwendungen\n‚Ä¢ Scalable Architecture f√ºr wachsende PKI-Infrastrukturen\n‚Ä¢ Performance Monitoring und Optimization f√ºr maximale Effizienz\n‚Ä¢ Capacity Planning Tools f√ºr zuk√ºnftige HSM-Anforderungen\n\nüõ†Ô∏è Disaster Recovery und Business Continuity:\n‚Ä¢ HSM Clustering f√ºr automatisches Failover bei Hardware-Ausf√§llen\n‚Ä¢ Geographic Redundancy f√ºr Schutz vor lokalen Katastrophen\n‚Ä¢ Secure Key Replication zwischen HSM-Standorten\n‚Ä¢ Recovery Time Objectives und Recovery Point Objectives f√ºr kritische PKI-Services\n‚Ä¢ Regular Disaster Recovery Testing validiert Wiederherstellungsverfahren"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie funktioniert automatisiertes Certificate Enrollment und Self-Service?',
        answer: "Automatisiertes Certificate Enrollment und Self-Service-Funktionalit√§ten transformieren traditionelle, manuelle Zertifikatsverwaltung in effiziente, skalierbare Prozesse, die sowohl Benutzerfreundlichkeit als auch Sicherheit maximieren. Diese Systeme reduzieren administrative Overhead erheblich und erm√∂glichen es Organisationen, PKI-Services f√ºr gro√üe Benutzerbasen bereitzustellen.\n\nüöÄ Automated Enrollment Protocols:\n‚Ä¢ Simple Certificate Enrollment Protocol erm√∂glicht automatische Zertifikatsanforderungen √ºber HTTP/HTTPS\n‚Ä¢ Enrollment over Secure Transport bietet moderne, RESTful API-basierte Enrollment-Services\n‚Ä¢ Certificate Management Protocol unterst√ºtzt komplexe Enrollment-Workflows mit erweiterten Funktionen\n‚Ä¢ Microsoft Autoenrollment f√ºr nahtlose Integration in Active Directory-Umgebungen\n‚Ä¢ Custom Enrollment APIs f√ºr spezialisierte Anwendungsanforderungen\n\nüñ•Ô∏è Self-Service Portal Architecture:\n‚Ä¢ Web-based User Interfaces erm√∂glichen intuitive Zertifikatsanforderungen ohne technische Expertise\n‚Ä¢ Mobile-responsive Design unterst√ºtzt Zertifikatsmanagement auf verschiedenen Ger√§ten\n‚Ä¢ Multi-language Support f√ºr internationale Organisationen\n‚Ä¢ Customizable Branding und User Experience f√ºr organisationsspezifische Anforderungen\n‚Ä¢ Accessibility Features gew√§hrleisten Nutzbarkeit f√ºr alle Benutzergruppen\n\nüîê Authentication und Authorization:\n‚Ä¢ Multi-Factor Authentication f√ºr sichere Benutzeridentifikation bei Zertifikatsanforderungen\n‚Ä¢ Active Directory Integration nutzt bestehende Identit√§tssysteme f√ºr nahtlose Authentifizierung\n‚Ä¢ LDAP und SAML Support f√ºr Integration in verschiedene Identity Provider\n‚Ä¢ Role-based Access Control definiert, welche Zertifikatstypen Benutzer anfordern k√∂nnen\n‚Ä¢ Delegated Administration erm√∂glicht dezentrale Zertifikatsverwaltung\n\nüìã Template-based Certificate Management:\n‚Ä¢ Certificate Templates definieren Zertifikatstypen, G√ºltigkeitsdauern und Verwendungszwecke\n‚Ä¢ Policy-driven Enrollment gew√§hrleistet konsistente Zertifikatskonfigurationen\n‚Ä¢ Automated Validation Rules √ºberpr√ºfen Zertifikatsanforderungen gegen organisatorische Richtlinien\n‚Ä¢ Custom Fields und Extensions f√ºr spezielle Anwendungsanforderungen\n‚Ä¢ Version Control f√ºr Certificate Templates erm√∂glicht kontrollierte √Ñnderungen\n\n‚ö° Workflow und Approval Processes:\n‚Ä¢ Automated Approval f√ºr Standard-Zertifikatsanforderungen basierend auf vordefinierten Kriterien\n‚Ä¢ Multi-stage Approval Workflows f√ºr kritische oder hochwertige Zertifikate\n‚Ä¢ Email Notifications und Dashboard Alerts f√ºr Approval-Manager\n‚Ä¢ Escalation Procedures f√ºr √ºberf√§llige Approval-Anfragen\n‚Ä¢ Audit Trails dokumentieren alle Approval-Entscheidungen und -Begr√ºndungen\n\nüîÑ Certificate Lifecycle Automation:\n‚Ä¢ Automated Renewal Notifications warnen Benutzer vor Zertifikatsabl√§ufen\n‚Ä¢ Self-Service Renewal erm√∂glicht Benutzern eigenst√§ndige Zertifikatserneuerung\n‚Ä¢ Bulk Renewal Processes f√ºr Massenaktualisierung von Zertifikaten\n‚Ä¢ Automated Deployment nach erfolgreicher Zertifikatserneuerung\n‚Ä¢ Grace Period Management f√ºr nahtlose Zertifikats√ºberg√§nge\n\nüì± Device und Application Integration:\n‚Ä¢ Mobile Device Management Integration f√ºr automatische Zertifikatsverteilung\n‚Ä¢ Application-specific Enrollment f√ºr spezialisierte Software-Anforderungen\n‚Ä¢ API Integration erm√∂glicht programmatische Zertifikatsanforderungen\n‚Ä¢ Container und Kubernetes Support f√ºr moderne Anwendungsarchitekturen\n‚Ä¢ IoT Device Enrollment f√ºr Internet of Things-Ger√§te\n\nüìä Monitoring und Analytics:\n‚Ä¢ Real-time Dashboard zeigt Enrollment-Status und -Metriken\n‚Ä¢ Usage Analytics identifizieren Trends und Optimierungsm√∂glichkeiten\n‚Ä¢ Performance Monitoring √ºberwacht Enrollment-Service-Verf√ºgbarkeit\n‚Ä¢ Error Tracking und Troubleshooting f√ºr schnelle Probleml√∂sung\n‚Ä¢ Capacity Planning basierend auf historischen Enrollment-Daten\n\nüõ†Ô∏è Administrative Tools und Management:\n‚Ä¢ Centralized Management Console f√ºr Administratoren\n‚Ä¢ Bulk Operations f√ºr Massenverarbeitung von Zertifikatsanforderungen\n‚Ä¢ Reporting Tools f√ºr Compliance und Audit-Zwecke\n‚Ä¢ Configuration Management f√ºr Enrollment-Service-Einstellungen\n‚Ä¢ Backup und Recovery f√ºr Enrollment-Datenbanken und -Konfigurationen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Standards und Protokolle sind f√ºr PKI-Interoperabilit√§t entscheidend?',
        answer: "PKI-Interoperabilit√§t basiert auf einem robusten Fundament internationaler Standards und Protokolle, die nahtlose Zusammenarbeit zwischen verschiedenen PKI-Implementierungen, Herstellern und Organisationen erm√∂glichen. Diese Standards gew√§hrleisten nicht nur technische Kompatibilit√§t, sondern auch Vertrauen und Sicherheit in heterogenen PKI-Umgebungen.\n\nüìú X.509 Certificate Standards:\n‚Ä¢ X.509 v3 Certificate Format definiert Struktur und Inhalt digitaler Zertifikate weltweit\n‚Ä¢ Certificate Extensions erm√∂glichen anwendungsspezifische Informationen und Verwendungsbeschr√§nkungen\n‚Ä¢ Certificate Policies und Certificate Practice Statements dokumentieren Vertrauensebenen und operative Verfahren\n‚Ä¢ Name Constraints und Path Length Constraints kontrollieren Zertifizierungspfade\n‚Ä¢ Subject Alternative Names unterst√ºtzen moderne Identifikationsanforderungen\n\nüîê Cryptographic Standards und Algorithms:\n‚Ä¢ PKCS Standards Familie definiert kryptographische Verfahren und Datenformate\n‚Ä¢ RSA, ECDSA und EdDSA Signature Algorithms f√ºr verschiedene Sicherheits- und Performance-Anforderungen\n‚Ä¢ SHA-256, SHA-384 und SHA-512 Hash Functions f√ºr kryptographische Integrit√§t\n‚Ä¢ AES Encryption Standards f√ºr symmetrische Verschl√ºsselung in PKI-Anwendungen\n‚Ä¢ Post-Quantum Cryptography Standards f√ºr zuk√ºnftige Quantencomputer-Resistenz\n\nüåê Certificate Enrollment Protocols:\n‚Ä¢ Simple Certificate Enrollment Protocol f√ºr automatisierte Zertifikatsanforderungen\n‚Ä¢ Enrollment over Secure Transport als moderne Alternative zu SCEP\n‚Ä¢ Certificate Management Protocol f√ºr erweiterte Enrollment-Funktionalit√§ten\n‚Ä¢ Automatic Certificate Management Environment f√ºr vollautomatisierte Zertifikatsverwaltung\n‚Ä¢ Certificate Request Message Format f√ºr strukturierte Zertifikatsanforderungen\n\nüîÑ Certificate Validation und Revocation:\n‚Ä¢ Online Certificate Status Protocol f√ºr Echtzeit-Zertifikatsstatus-√úberpr√ºfung\n‚Ä¢ Certificate Revocation Lists f√ºr periodische Revocation-Informationen\n‚Ä¢ OCSP Stapling reduziert Latenz bei Zertifikatsvalidierung\n‚Ä¢ Certificate Transparency Framework f√ºr √∂ffentliche Zertifikats-Logs\n‚Ä¢ Path Validation Algorithms nach RFC 5280 f√ºr sichere Vertrauensketten-√úberpr√ºfung\n\nüèóÔ∏è PKI Architecture Standards:\n‚Ä¢ Internet X.509 Public Key Infrastructure Certificate und CRL Profile\n‚Ä¢ Certificate Policy und Certification Practice Framework\n‚Ä¢ Cross-Certification und Bridge CA Standards f√ºr PKI-Interoperabilit√§t\n‚Ä¢ Qualified Certificates Standards f√ºr rechtlich bindende digitale Signaturen\n‚Ä¢ Time-Stamping Protocol f√ºr beweiskr√§ftige Zeitstempel\n\nüîß Hardware und Software Integration:\n‚Ä¢ PKCS#11 Cryptographic Token Interface f√ºr Hardware Security Module Integration\n‚Ä¢ Microsoft Cryptography API und Cryptography Next Generation f√ºr Windows-Integration\n‚Ä¢ Java Cryptography Architecture f√ºr plattform√ºbergreifende Kryptographie\n‚Ä¢ OpenSSL und BouncyCastle Libraries f√ºr Open-Source PKI-Implementierungen\n‚Ä¢ Hardware Security Module Standards f√ºr sichere Schl√ºsselverwaltung\n\nüåç International und Regional Standards:\n‚Ä¢ European Telecommunications Standards Institute f√ºr europ√§ische PKI-Standards\n‚Ä¢ Federal Information Processing Standards f√ºr US-Regierungsanwendungen\n‚Ä¢ Common Criteria f√ºr Sicherheitsevaluierung von PKI-Produkten\n‚Ä¢ ISO/IEC 27001 f√ºr Information Security Management in PKI-Umgebungen\n‚Ä¢ eIDAS Regulation f√ºr europ√§ische elektronische Identifizierung und Vertrauensdienste\n\nüìã Directory Services und Certificate Distribution:\n‚Ä¢ Lightweight Directory Access Protocol f√ºr Zertifikats- und CRL-Verteilung\n‚Ä¢ HTTP Certificate Repository Standards f√ºr web-basierte Zertifikatsverteilung\n‚Ä¢ DNS-based Authentication of Named Entities f√ºr DNS-integrierte PKI\n‚Ä¢ Certificate Transparency Log Standards f√ºr √∂ffentliche Zertifikats-Aufzeichnungen\n‚Ä¢ Secure/Multipurpose Internet Mail Extensions f√ºr E-Mail-basierte PKI-Anwendungen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
