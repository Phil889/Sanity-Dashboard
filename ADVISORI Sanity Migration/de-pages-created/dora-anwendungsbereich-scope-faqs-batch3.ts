import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA Anwendungsbereich page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-anwendungsbereich-scope' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-anwendungsbereich-scope" not found')
    }
    
    // Create new FAQs for cross-border applications and subsidiaries
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'Wie wirkt sich DORA auf Zweigstellen und Tochtergesellschaften au√üerhalb der EU aus?',
        answer: "DORA hat bedeutende extraterritoriale Auswirkungen, die weit √ºber die Grenzen der Europ√§ischen Union hinausreichen. F√ºr internationale Finanzgruppen entstehen komplexe Compliance-Herausforderungen, die eine sorgf√§ltige Koordination zwischen verschiedenen Jurisdiktionen erfordern.\n\nüåç Extraterritoriale Anwendung von DORA:\n‚Ä¢ EU-Tochtergesellschaften internationaler Konzerne unterliegen vollst√§ndig den DORA-Anforderungen, unabh√§ngig vom Sitz der Muttergesellschaft\n‚Ä¢ Zweigstellen von EU-Finanzinstituten in Drittl√§ndern k√∂nnen indirekt durch konzernweite DORA-Compliance-Standards betroffen sein\n‚Ä¢ Drittland-Tochtergesellschaften europ√§ischer Finanzgruppen m√ºssen m√∂glicherweise DORA-konforme Prozesse implementieren\n‚Ä¢ IKT-Services, die von Drittland-Entit√§ten f√ºr EU-Finanzinstitute erbracht werden, unterliegen DORA-Anforderungen\n‚Ä¢ Grenz√ºberschreitende Datenfl√ºsse und -verarbeitung m√ºssen DORA-Compliance-Standards erf√ºllen\n\nüè¢ Konzernweite Governance-Herausforderungen:\n‚Ä¢ Harmonisierung von DORA-Anforderungen mit lokalen regulatorischen Frameworks in verschiedenen Jurisdiktionen\n‚Ä¢ Entwicklung einheitlicher IKT-Risikomanagement-Standards, die sowohl DORA als auch lokale Anforderungen erf√ºllen\n‚Ä¢ Koordination von Incident-Response-Prozessen zwischen EU- und Nicht-EU-Entit√§ten\n‚Ä¢ Management unterschiedlicher Datenschutz- und Datenlokalisierungsanforderungen\n‚Ä¢ Etablierung konsistenter Audit- und √úberwachungsstandards konzernweit\n\nüìã Compliance-Koordination und -Management:\n‚Ä¢ Entwicklung von Mapping-Dokumenten, die DORA-Anforderungen mit lokalen regulatorischen Anforderungen vergleichen\n‚Ä¢ Implementierung von Governance-Strukturen, die sowohl zentrale Koordination als auch lokale Compliance erm√∂glichen\n‚Ä¢ Etablierung von Berichtswegen, die sowohl EU-Aufsichtsbeh√∂rden als auch lokale Regulatoren ber√ºcksichtigen\n‚Ä¢ Koordination von Penetrationstests und Resilienz-Assessments √ºber Jurisdiktionsgrenzen hinweg\n‚Ä¢ Management von Interessenkonflikten zwischen verschiedenen regulatorischen Anforderungen\n\nüîí Datenschutz und Datensouver√§nit√§t:\n‚Ä¢ Ber√ºcksichtigung von Datenlokalisierungsanforderungen verschiedener Jurisdiktionen bei der Implementierung von DORA-konformen Systemen\n‚Ä¢ Management von Datentransfers zwischen EU- und Drittland-Entit√§ten unter Ber√ºcksichtigung von DSGVO und lokalen Datenschutzgesetzen\n‚Ä¢ Implementierung von Verschl√ºsselungs- und Sicherheitsstandards, die sowohl DORA als auch lokale Anforderungen erf√ºllen\n‚Ä¢ Koordination von Datenaufbewahrung und -l√∂schung gem√§√ü verschiedenen regulatorischen Frameworks\n‚Ä¢ Etablierung von Prozessen f√ºr grenz√ºberschreitende Incident-Meldungen unter Ber√ºcksichtigung verschiedener Meldepflichten\n\n‚öñÔ∏è Rechtliche und regulatorische Koordination:\n‚Ä¢ Analyse potenzieller Konflikte zwischen DORA-Anforderungen und lokalen Gesetzen in Drittl√§ndern\n‚Ä¢ Entwicklung von Strategien zur Bew√§ltigung widerspr√ºchlicher regulatorischer Anforderungen\n‚Ä¢ Koordination mit lokalen Aufsichtsbeh√∂rden zur Vermeidung von Doppelregulierung\n‚Ä¢ Ber√ºcksichtigung politischer und wirtschaftlicher Risiken in verschiedenen Jurisdiktionen\n‚Ä¢ Etablierung von Notfallpl√§nen f√ºr Situationen, in denen lokale Gesetze DORA-Compliance verhindern k√∂nnten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'Welche besonderen √úberlegungen gelten f√ºr Fintech-Unternehmen und neue Marktteilnehmer unter DORA?',
        answer: "Fintech-Unternehmen und neue Marktteilnehmer stehen vor einzigartigen Herausforderungen bei der DORA-Compliance, da sie oft innovative Gesch√§ftsmodelle und Technologien einsetzen, die nicht vollst√§ndig in traditionelle regulatorische Frameworks passen. Gleichzeitig bietet DORA auch Chancen f√ºr diese Unternehmen, sich durch √ºberlegene digitale Resilienz zu differenzieren.\n\nüöÄ Fintech-spezifische DORA-Herausforderungen:\n‚Ä¢ Viele Fintech-Unternehmen sind stark von Cloud-Services und Drittanbieter-APIs abh√§ngig, was komplexe Drittanbieter-Risikomanagement-Anforderungen schafft\n‚Ä¢ Agile Entwicklungsmethoden und kontinuierliche Deployment-Praktiken m√ºssen mit DORA-Compliance-Anforderungen harmonisiert werden\n‚Ä¢ Begrenzte Ressourcen f√ºr Compliance-Funktionen erfordern effiziente und kostenwirksame Implementierungsstrategien\n‚Ä¢ Innovative Technologien wie Blockchain, KI und maschinelles Lernen k√∂nnen neue Risikokategorien schaffen\n‚Ä¢ Schnelles Wachstum und sich √§ndernde Gesch√§ftsmodelle erfordern flexible und anpassungsf√§hige Compliance-Frameworks\n\nüí° Chancen durch DORA-Compliance:\n‚Ä¢ DORA-Compliance kann als Wettbewerbsvorteil und Vertrauensbildungsma√ünahme gegen√ºber traditionellen Finanzinstituten genutzt werden\n‚Ä¢ Fr√ºhe Implementierung robuster IKT-Risikomanagement-Praktiken kann langfristige operative Vorteile schaffen\n‚Ä¢ Compliance kann die Glaubw√ºrdigkeit bei Investoren, Partnern und Aufsichtsbeh√∂rden erh√∂hen\n‚Ä¢ Systematische Risikobewertung kann zur Identifikation und Behebung operationeller Schwachstellen beitragen\n‚Ä¢ DORA-konforme Prozesse k√∂nnen die Skalierbarkeit und internationale Expansion erleichtern\n\nüîß Praktische Implementierungsstrategien:\n‚Ä¢ Entwicklung schlanker, aber effektiver Governance-Strukturen, die sowohl Agilit√§t als auch Compliance gew√§hrleisten\n‚Ä¢ Nutzung von Automatisierung und Technologie zur Reduzierung des manuellen Compliance-Aufwands\n‚Ä¢ Implementierung von Security-by-Design-Prinzipien in alle Entwicklungsprozesse\n‚Ä¢ Aufbau strategischer Partnerschaften mit DORA-konformen Service-Providern\n‚Ä¢ Entwicklung von Compliance-as-Code-Ans√§tzen zur Integration von Compliance in DevOps-Prozesse\n\nüìä Proportionalit√§tsprinzip und ma√ügeschneiderte Ans√§tze:\n‚Ä¢ DORA erkennt das Proportionalit√§tsprinzip an, das kleineren und weniger komplexen Instituten angemessene Flexibilit√§t bietet\n‚Ä¢ Fintech-Unternehmen k√∂nnen risikobasierte Ans√§tze entwickeln, die ihre spezifischen Gesch√§ftsmodelle und Risikoprofile ber√ºcksichtigen\n‚Ä¢ Fokussierung auf die kritischsten Risiken und Services kann eine effiziente Ressourcenallokation erm√∂glichen\n‚Ä¢ Nutzung branchenspezifischer Guidance und Best Practices kann die Implementierung beschleunigen\n‚Ä¢ Kontinuierliche Anpassung der Compliance-Strategie basierend auf Gesch√§ftsentwicklung und regulatorischen Entwicklungen\n\nü§ù Kollaboration und √ñkosystem-Ans√§tze:\n‚Ä¢ Zusammenarbeit mit anderen Fintech-Unternehmen zur Entwicklung gemeinsamer Compliance-L√∂sungen\n‚Ä¢ Nutzung von Branchenverb√§nden und regulatorischen Sandboxes zur Kl√§rung von Compliance-Anforderungen\n‚Ä¢ Aufbau von Beziehungen zu Aufsichtsbeh√∂rden f√ºr proaktive Kommunikation und Guidance\n‚Ä¢ Teilnahme an Brancheninitiativen zur Entwicklung von Standards und Best Practices\n‚Ä¢ Leveraging von Technologie-Partnerschaften zur Beschleunigung der Compliance-Implementierung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'Wie koordiniere ich DORA-Compliance mit anderen internationalen Cybersecurity-Regulierungen?',
        answer: "Die Koordination von DORA-Compliance mit anderen internationalen Cybersecurity-Regulierungen ist eine komplexe Aufgabe, die strategische Planung und systematisches Management erfordert. Globale Finanzinstitute m√ºssen ein koh√§rentes Framework entwickeln, das verschiedene regulatorische Anforderungen effizient integriert.\n\nüåê Internationale Regulierungslandschaft:\n‚Ä¢ US-amerikanische Frameworks wie NIST Cybersecurity Framework, FFIEC Guidance und staatsspezifische Regulierungen\n‚Ä¢ Asiatische Regulierungen wie Singapurs Technology Risk Management Guidelines und Hongkongs Cybersecurity Fortification Initiative\n‚Ä¢ Andere europ√§ische Regulierungen wie NIS2, GDPR und nationale Cybersecurity-Gesetze\n‚Ä¢ Sektorspezifische internationale Standards wie ISO 27001, SWIFT Customer Security Programme und PCI DSS\n‚Ä¢ Emerging Regulierungen in Entwicklungsm√§rkten und deren potenzielle Auswirkungen\n\nüîÑ Harmonisierung und Integration:\n‚Ä¢ Entwicklung einer Master-Compliance-Matrix, die alle anwendbaren Regulierungen und deren Anforderungen mappt\n‚Ä¢ Identifikation von √úberschneidungen und Synergien zwischen verschiedenen regulatorischen Frameworks\n‚Ä¢ Entwicklung einheitlicher Policies und Prozeduren, die multiple regulatorische Anforderungen erf√ºllen\n‚Ä¢ Implementierung von Governance-Strukturen, die sowohl lokale als auch internationale Compliance koordinieren\n‚Ä¢ Etablierung von Berichtsmechanismen, die verschiedene Aufsichtsbeh√∂rden effizient bedienen\n\nüìã Praktische Koordinationsstrategien:\n‚Ä¢ Implementierung eines zentralen GRC-Systems, das alle regulatorischen Anforderungen verwaltet\n‚Ä¢ Entwicklung standardisierter Risikobewertungs- und Kontrollframeworks, die f√ºr multiple Jurisdiktionen anwendbar sind\n‚Ä¢ Etablierung regionaler Compliance-Teams mit Expertise in lokalen Regulierungen\n‚Ä¢ Koordination von Audit- und Assessment-Zyklen zur Maximierung der Effizienz\n‚Ä¢ Entwicklung von Incident-Response-Prozessen, die alle anwendbaren Meldepflichten ber√ºcksichtigen\n\n‚öñÔ∏è Management regulatorischer Konflikte:\n‚Ä¢ Systematische Analyse potenzieller Konflikte zwischen verschiedenen regulatorischen Anforderungen\n‚Ä¢ Entwicklung von Eskalationsprozessen f√ºr Situationen mit widerspr√ºchlichen Anforderungen\n‚Ä¢ Proaktive Kommunikation mit Aufsichtsbeh√∂rden zur Kl√§rung von Interpretationsfragen\n‚Ä¢ Implementierung von Flexibilit√§tsmechanismen, die schnelle Anpassungen an sich √§ndernde Anforderungen erm√∂glichen\n‚Ä¢ Dokumentation von Compliance-Entscheidungen und deren Begr√ºndung f√ºr Audit-Zwecke\n\nüîß Technologische Unterst√ºtzung:\n‚Ä¢ Nutzung von RegTech-L√∂sungen zur Automatisierung von Compliance-Monitoring und -Reporting\n‚Ä¢ Implementierung von AI-gest√ºtzten Systemen zur Identifikation regulatorischer √Ñnderungen und deren Auswirkungen\n‚Ä¢ Entwicklung von Dashboard-L√∂sungen f√ºr Echtzeit-√úbersicht √ºber den Compliance-Status in verschiedenen Jurisdiktionen\n‚Ä¢ Automatisierung von Datensammlung und -aufbereitung f√ºr verschiedene regulatorische Berichte\n‚Ä¢ Integration von Compliance-Monitoring in bestehende Risikomanagement-Systeme\n\nüìà Kontinuierliche Optimierung:\n‚Ä¢ Regelm√§√üige √úberpr√ºfung und Aktualisierung der Compliance-Strategie basierend auf regulatorischen Entwicklungen\n‚Ä¢ Benchmarking gegen Branchenstandards und Best Practices\n‚Ä¢ Implementierung von Lessons-Learned-Prozessen aus Compliance-Herausforderungen\n‚Ä¢ Aufbau von Expertise durch Schulungen und Zertifizierungen in verschiedenen regulatorischen Frameworks\n‚Ä¢ Entwicklung von Zukunftsszenarien und Contingency-Pl√§nen f√ºr regulatorische √Ñnderungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'Welche Auswirkungen hat DORA auf Outsourcing-Arrangements und Service-Provider-Vertr√§ge?',
        answer: "DORA hat weitreichende Auswirkungen auf bestehende und zuk√ºnftige Outsourcing-Arrangements und erfordert eine umfassende √úberpr√ºfung und Anpassung von Service-Provider-Vertr√§gen. Die Regulierung stellt neue Anforderungen an die Vertragsgestaltung, das Risikomanagement und die √úberwachung von Outsourcing-Beziehungen.\n\nüìÑ Vertragliche Anpassungsanforderungen:\n‚Ä¢ Integration spezifischer DORA-Compliance-Klauseln in alle bestehenden und neuen Outsourcing-Vertr√§ge\n‚Ä¢ Aufnahme detaillierter Service-Level-Agreements mit messbaren Sicherheits- und Resilienz-Kennzahlen\n‚Ä¢ Implementierung umfassender Audit-Rechte und Zugangsberechtigungen f√ºr Compliance-Pr√ºfungen\n‚Ä¢ Definition klarer Incident-Reporting-Verpflichtungen und Eskalationsprozeduren\n‚Ä¢ Etablierung von Exit-Klauseln und Datenr√ºckgabe-Vereinbarungen f√ºr verschiedene Szenarien\n\nüîç Erweiterte Due-Diligence-Anforderungen:\n‚Ä¢ Umfassende Bewertung der IKT-Sicherheitsma√ünahmen und Risikomanagement-Praktiken aller Service-Provider\n‚Ä¢ Analyse der finanziellen Stabilit√§t und Gesch√§ftskontinuit√§tsf√§higkeiten der Anbieter\n‚Ä¢ Bewertung der Governance-Strukturen und Compliance-Kultur der Service-Provider\n‚Ä¢ Detaillierte Pr√ºfung der Subunternehmer-Ketten und deren potenzielle Risiken\n‚Ä¢ Bewertung der geografischen Verteilung und Konzentration der Anbieter-Infrastruktur\n\nüéØ Kritikalit√§tsbewertung und Klassifizierung:\n‚Ä¢ Systematische Neubewertung aller Outsourcing-Arrangements hinsichtlich ihrer Kritikalit√§t f√ºr Gesch√§ftsfunktionen\n‚Ä¢ Implementierung differenzierter Anforderungen basierend auf der Kritikalit√§t der ausgelagerten Services\n‚Ä¢ Entwicklung von Kriterien zur Bestimmung, wann ein Service-Provider als kritisch einzustufen ist\n‚Ä¢ Regelm√§√üige √úberpr√ºfung der Kritikalit√§tseinstufung basierend auf sich √§ndernden Gesch√§ftsanforderungen\n‚Ä¢ Koordination mit anderen Finanzinstituten zur Bewertung systemischer Anbieter-Risiken\n\nüîê Verst√§rkte √úberwachung und Kontrolle:\n‚Ä¢ Implementierung kontinuierlicher Monitoring-Systeme f√ºr alle kritischen Outsourcing-Arrangements\n‚Ä¢ Etablierung regelm√§√üiger Risikobewertungen und Performance-Reviews\n‚Ä¢ Durchf√ºhrung von Penetrationstests und Vulnerability-Assessments bei Service-Providern\n‚Ä¢ √úberwachung der Compliance der Service-Provider mit vereinbarten Sicherheitsstandards\n‚Ä¢ Tracking von √Ñnderungen in der Anbieter-Infrastruktur und deren Risikoimplikationen\n\nüö® Business-Continuity und Notfallplanung:\n‚Ä¢ Entwicklung gemeinsamer Business-Continuity-Pl√§ne mit allen kritischen Service-Providern\n‚Ä¢ Etablierung direkter Kommunikationskan√§le und Eskalationsprozesse f√ºr Notfallsituationen\n‚Ä¢ Regelm√§√üige Tests der Kontinuit√§tspl√§ne unter Einbeziehung aller relevanten Service-Provider\n‚Ä¢ Koordination von Disaster-Recovery-√úbungen mit kritischen Anbietern\n‚Ä¢ Entwicklung alternativer Service-Arrangements und Exit-Strategien f√ºr kritische Funktionen\n\nüíº Governance und Risikomanagement:\n‚Ä¢ Integration von Outsourcing-Risiken in das √ºbergeordnete IKT-Risikomanagement-Framework\n‚Ä¢ Etablierung spezialisierter Governance-Strukturen f√ºr das Management kritischer Outsourcing-Beziehungen\n‚Ä¢ Implementierung von Konzentrations-Limits und Diversifikationsstrategien\n‚Ä¢ Entwicklung von Metriken und KPIs zur √úberwachung der Outsourcing-Performance\n‚Ä¢ Regelm√§√üige Berichterstattung an die Gesch√§ftsleitung √ºber Outsourcing-Risiken und -Performance"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
