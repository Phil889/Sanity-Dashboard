import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating FRTB Implementation page with FAQs batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'frtb-implementation' })
    
    if (!existingDoc) {
      throw new Error('Document "frtb-implementation" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Wie unterst√ºtzt ADVISORI Finanzinstitute bei der strategischen Entscheidung zwischen FRTB-Standardansatz und internen Modellen?",
        answer: "Die Entscheidung zwischen dem FRTB-Standardansatz und internen Modellen ist eine der fundamentalsten strategischen Weichenstellungen im FRTB-Implementierungsprozess mit weitreichenden Auswirkungen auf Kapitalanforderungen, Ressourceneinsatz und operationelle Komplexit√§t. ADVISORI unterst√ºtzt Finanzinstitute mit einem umfassenden, faktenbasierten Entscheidungsframework, das alle relevanten Dimensionen ber√ºcksichtigt.\n\nüß© Ganzheitlicher Entscheidungsansatz von ADVISORI:\n‚Ä¢ Quantitative Kapitalimpaktanalyse: Durchf√ºhrung detaillierter Simulationen zur Berechnung der Kapitalanforderungen unter beiden Ans√§tzen auf Basis historischer Portfoliodaten und Stressszenarien, mit Ber√ºcksichtigung von Diversifikationseffekten und NMRF-Aufschl√§gen.\n‚Ä¢ Kosten-Nutzen-Analyse: Umfassende Bewertung der Implementierungs- und Betriebskosten beider Ans√§tze im Verh√§ltnis zu den potenziellen Kapitalvorteilen, unter Ber√ºcksichtigung bestehender Systemlandschaften und Ressourcenkapazit√§ten.\n‚Ä¢ Trading Desk-Optimierung: Entwicklung optimaler Desk-Strukturierungskonzepte, die regulatorische Anforderungen erf√ºllen und gleichzeitig die Kapitaleffizienz maximieren, mit Identifikation von Desks, die sich besonders f√ºr interne Modelle eignen.\n‚Ä¢ Zukunftsorientierte Szenarioanalyse: Bewertung der langfristigen Implikationen beider Ans√§tze unter Ber√ºcksichtigung zuk√ºnftiger Gesch√§ftsstrategien, Portfolioentwicklungen und potenzieller regulatorischer √Ñnderungen.\n\nüìä Tiefgreifende Analysekomponenten:\n‚Ä¢ FRTB-Kapitalberechnungstool: Einsatz unseres propriet√§ren Berechnungstools zur detaillierten Modellierung der Kapitalanforderungen unter verschiedenen Szenarien und Portfoliokonfigurationen.\n‚Ä¢ Risk Factor Modellability Assessment: Systematische Analyse der Modellierbarkeit aller relevanten Risikofaktoren anhand regulatorischer RFET-Kriterien mit Identifikation von Datenl√ºcken und Modellierbarkeitsherausforderungen.\n‚Ä¢ P&L Attribution Testanalyse: Vorab-Bewertung der Erfolgschancen des P&L Attribution Tests f√ºr relevante Desks mit Identifikation kritischer Faktoren und Optimierungspotenziale.\n‚Ä¢ Systemanforderungsanalyse: Bewertung der technischen Implementierungsanforderungen beider Ans√§tze im Kontext der bestehenden Systemlandschaft und IT-Strategie.\n\nüîç Entscheidungsunterst√ºtzung auf mehreren Ebenen:\n‚Ä¢ Trading Desk-Ebene: Detaillierte Analyse f√ºr jeden Trading Desk mit spezifischen Empfehlungen f√ºr den optimalen Ansatz basierend auf Portfoliozusammensetzung, Handelsstrategien und Datenqualit√§t.\n‚Ä¢ Institutsebene: Ganzheitliche Bewertung und Roadmap-Entwicklung unter Ber√ºcksichtigung √ºbergreifender Faktoren wie Ressourcenverf√ºgbarkeit, Risikomanagementphilosophie und strategischer Positionierung.\n‚Ä¢ Zeitliche Dimension: Entwicklung eines phasenbasierten Implementierungsansatzes, der schrittweise √úberg√§nge zwischen Standardansatz und internen Modellen f√ºr bestimmte Desks erm√∂glicht, abh√§ngig von Implementierungsfortschritt und regulatorischen Genehmigungen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Welche kritischen Erfolgsfaktoren m√ºssen Banken bei der Implementierung des FRTB-Standardansatzes ber√ºcksichtigen?",
        answer: "Der FRTB-Standardansatz (SA) stellt trotz seiner vermeintlichen Einfachheit im Vergleich zu internen Modellen erhebliche Implementierungsherausforderungen dar. Seine komplexe Berechnungsmethodik, die umfangreichen Datenanforderungen und die Notwendigkeit effizienter Berechnungsprozesse erfordern eine strukturierte Herangehensweise mit Fokus auf spezifische Erfolgsfaktoren.\n\nüîë Kritische Erfolgsfaktoren f√ºr die FRTB-SA-Implementierung:\n‚Ä¢ Datenmanagement-Exzellenz: Die Implementierung eines robusten Datenmanagement-Frameworks ist fundamental f√ºr den FRTB-SA. Dies umfasst die Sicherstellung vollst√§ndiger Markt- und Positionsdaten, konsistente Risikofaktor-Mappings und eine durchg√§ngige Datenlineage f√ºr Pr√ºfungs- und Validierungszwecke.\n‚Ä¢ Effiziente Sensitivit√§tsberechnung: Die Entwicklung performanter und akkurater Prozesse zur Berechnung tausender Sensitivit√§ten (Delta, Vega, Curvature) f√ºr das gesamte Handelsbuch ist entscheidend f√ºr die t√§gliche Kapitalberechnung unter dem Standardansatz.\n‚Ä¢ Optimierte Aggregationslogik: Die korrekte Implementierung der komplexen Aggregationsregeln mit unterschiedlichen Korrelationsszenarien und Diversifikationseffekten erfordert sowohl methodisches Verst√§ndnis als auch effiziente Berechnungsalgorithmen.\n‚Ä¢ Flexible Reporting-Infrastruktur: Aufbau einer anpassungsf√§higen Reporting-Architektur, die sowohl interne Management-Informationen als auch regulatorische Anforderungen erf√ºllt und granulare Analysen auf verschiedenen Ebenen erm√∂glicht.\n\n‚öôÔ∏è Technische und prozessuale Erfolgsfaktoren:\n‚Ä¢ Skalierbare Berechnungsarchitektur: Implementierung einer hochperformanten Berechnungsinfrastruktur, die gro√üe Datenmengen verarbeiten kann und die t√§gliche Berechnung innerhalb der regulatorischen Zeitvorgaben erm√∂glicht, idealerweise mit Parallelverarbeitungsf√§higkeiten.\n‚Ä¢ Integrierte Validierungsmechanismen: Einbettung automatisierter Kontrollen und Plausibilit√§tspr√ºfungen in den Berechnungsprozess zur fr√ºhzeitigen Erkennung von Datenfehlern oder Berechnungsanomalien.\n‚Ä¢ Flexible Parametrisierung: Entwicklung eines Systems, das einfache Anpassungen an Risikofaktor-Mappings, Korrelationsparametern und Risikogewichten erm√∂glicht, um auf regulatorische √Ñnderungen oder interne Anforderungen reagieren zu k√∂nnen.\n‚Ä¢ End-to-End-Prozessautomatisierung: Etablierung eines hochautomatisierten Prozesses von der Datenerfassung √ºber die Berechnung bis zum Reporting, um manuelle Eingriffe zu minimieren und die Prozessstabilit√§t zu maximieren.\n\nüìã Governance und organisatorische Erfolgsfaktoren:\n‚Ä¢ Klare methodische Dokumentation: Erstellung umfassender und pr√§ziser Methodendokumente, die alle Aspekte der FRTB-SA-Implementierung abdecken und den regulatorischen Dokumentationsanforderungen entsprechen.\n‚Ä¢ Effektive Cross-Funktionale Zusammenarbeit: Etablierung effizienter Kooperationsstrukturen zwischen Handel, Risikomanagement, IT und Finanzen, um ein gemeinsames Verst√§ndnis und konsistente Implementierung sicherzustellen.\n‚Ä¢ Robustes Change Management: Implementierung eines strukturierten Prozesses f√ºr die Verwaltung von √Ñnderungen an Methodiken, Modellen und Systemen, mit klaren Genehmigungsverfahren und Auswirkungsanalysen.\n‚Ä¢ Proaktives regulatorisches Engagement: Kontinuierlicher Dialog mit Aufsichtsbeh√∂rden zur Kl√§rung von Interpretationsfragen und fr√ºhzeitigen Adressierung potenzieller Compliance-Herausforderungen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Wie gestaltet ADVISORI die erfolgreiche Implementierung des P&L Attribution Tests f√ºr FRTB interne Modelle?",
        answer: "Der P&L Attribution Test (PLAT) stellt eine der anspruchsvollsten Komponenten und h√§ufigsten Fallstricke bei der Implementierung interner Modelle unter FRTB dar. Seine strengen Anforderungen an die Erkl√§rung der Unterschiede zwischen Front-Office- und Risiko-P&L erfordern tiefgreifende methodische, datentechnische und prozessuale Anpassungen. ADVISORI hat einen spezialisierten Ansatz entwickelt, der auf zahlreichen erfolgreichen PLAT-Implementierungen basiert.\n\nüîÑ Integrierter PLAT-Implementierungsansatz:\n‚Ä¢ Ganzheitliche Analyse der P&L-Quellen: Systematische Identifikation und Kategorisierung aller P&L-Komponenten in Front-Office- und Risikosystemen, mit detaillierter Analyse der Bewertungsmethoden, Marktdatenverwendung und Risikofaktormodellierung.\n‚Ä¢ End-to-End-Prozessdesign: Entwicklung eines robusten, automatisierten Prozesses f√ºr die t√§gliche P&L-Berechnung, Attribution und Testdurchf√ºhrung, mit klaren Verantwortlichkeiten, Zeitpl√§nen und Qualit√§tssicherungsma√ünahmen.\n‚Ä¢ Methodische Harmonisierung: Gezielte Angleichung der Bewertungsmethoden zwischen Front Office und Risikomanagement unter Ber√ºcksichtigung der spezifischen Desk-Eigenschaften und Produktkomplexit√§t.\n‚Ä¢ Technische Integration: Implementierung einer integrierten technischen L√∂sung, die Front-Office- und Risikosysteme verbindet und eine konsistente, granulare P&L-Berechnung und -Attribution erm√∂glicht.\n\nüìä Spezialisierte Komponenten f√ºr PLAT-Exzellenz:\n‚Ä¢ Advanced P&L Vector Analysis: Einsatz fortschrittlicher Analysemethoden zur detaillierten Untersuchung der P&L-Vektoren und pr√§zisen Identifikation der Ursachen f√ºr Diskrepanzen zwischen Front-Office- und Risiko-P&L.\n‚Ä¢ Dynamic Risk Factor Mapping: Entwicklung dynamischer Mappings zwischen Front-Office- und Risikomodell-Risikofaktoren, die √Ñnderungen in Marktbedingungen, Produktspektrum und Modellierungsans√§tzen ber√ºcksichtigen.\n‚Ä¢ Statistical Test Optimization: Kontinuierliche Analyse und Optimierung der statistischen Testeigenschaften zur Maximierung der Erfolgswahrscheinlichkeit unter Einhaltung regulatorischer Anforderungen.\n‚Ä¢ Outlier Analysis Framework: Implementierung eines systematischen Ansatzes zur Identifikation und Erkl√§rung von Ausrei√üern in den t√§glichen PLAT-Ergebnissen, mit klaren Eskalations- und Ma√ünahmenprozessen.\n\nüõ†Ô∏è Praktische Implementierungstools:\n‚Ä¢ PLAT-Simulationstool: Einsatz unseres propriet√§ren Tools zur Simulation des P&L Attribution Tests unter verschiedenen Szenarien und Konfigurationen, zur Identifikation optimaler Einstellungen und Schwachstellen.\n‚Ä¢ Gap-Priorisierungs-Framework: Systematische Bewertung und Priorisierung identifizierter Diskrepanzen basierend auf ihren Auswirkungen auf die PLAT-Ergebnisse, Implementierungskomplexit√§t und Ressourcenaufwand.\n‚Ä¢ Performance Tracking Dashboard: Implementierung eines umfassenden Monitoring-Systems zur kontinuierlichen √úberwachung der PLAT-Performance, mit automatischen Alerts und Trendanalysen.\n‚Ä¢ Root Cause Analysis Template: Strukturierte Methodik zur tiefgehenden Analyse von PLAT-Fehlschl√§gen und systematischen Identifikation von Grundursachen und L√∂sungsans√§tzen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Welche Herausforderungen stellen Non-Modellable Risk Factors (NMRFs) bei der FRTB-Implementierung dar und wie k√∂nnen diese effizient adressiert werden?",
        answer: "Non-Modellable Risk Factors (NMRFs) repr√§sentieren eine der komplexesten und potenziell kostspieligsten Komponenten der FRTB-Implementierung f√ºr interne Modelle. Die strengen regulatorischen Anforderungen an die Verf√ºgbarkeit 'echter' Marktdaten und die signifikanten Kapitalaufschl√§ge f√ºr nicht-modellierbare Risikofaktoren erfordern einen strategischen und methodisch fundierten Ansatz zur NMRF-Behandlung.\n\nüîç Zentrale Herausforderungen im NMRF-Kontext:\n‚Ä¢ Datenqualit√§t und -verf√ºgbarkeit: Die regulatorischen Kriterien f√ºr Modellierbarkeit (RFET - Risk Factor Eligibility Test) erfordern mindestens 24 'echte' Preisbeobachtungen pro Jahr mit maximalen L√ºcken von einem Monat, was f√ºr viele Risikofaktoren in illiquiden M√§rkten oder f√ºr exotische Produkte kaum erreichbar ist.\n‚Ä¢ Komplexe Identifikations- und Mappingprozesse: Die pr√§zise Identifikation aller relevanten Risikofaktoren und ihr konsistentes Mapping zwischen Handelspositionen, Marktdaten und Risikomodellen stellt eine methodische und technische Herausforderung dar.\n‚Ä¢ Aufw√§ndige Kapitalberechnung: Die Berechnung des Stresstestzuschlags f√ºr NMRFs erfordert komplexe Kalibrierungsmethoden und rechenintensive Stresstests f√ºr jeden nicht-modellierbaren Risikofaktor.\n‚Ä¢ Dynamisches Modellierbarkeitsmanagement: Der Modellierbarkeits-Status von Risikofaktoren kann sich im Zeitverlauf √§ndern, was ein kontinuierliches Monitoring und flexible Anpassungsmechanismen erfordert.\n\nüí° ADVISORI's strategischer NMRF-Ansatz:\n‚Ä¢ Ganzheitliche NMRF-Strategie: Entwicklung einer integrierten Strategie zur NMRF-Behandlung, die Datenmanagement, methodische Aspekte, IT-Implementierung und organisatorische Faktoren umfasst und auf Kapitaloptimierung ausgerichtet ist.\n‚Ä¢ Systematisches Daten-Sourcing: Etablierung eines strukturierten Prozesses zur Identifikation und Integration zus√§tzlicher Datenquellen f√ºr kritische Risikofaktoren, einschlie√ülich Datenvendoren, Broker-Quotes und Pooling-Initiativen.\n‚Ä¢ Optimierte Risikofaktor-Taxonomie: Entwicklung einer granularen, regulatorisch konformen Risikofaktor-Taxonomie, die Modellierbarkeit maximiert und gleichzeitig die methodische Integrit√§t des Risikomodells wahrt.\n‚Ä¢ Automatisierte Modellierbarkeits-Assessment-Prozesse: Implementierung effizienter, automatisierter Prozesse zur kontinuierlichen Bewertung und Dokumentation der Risikofaktor-Modellierbarkeit gem√§√ü RFET-Kriterien.\n\n‚öôÔ∏è Operative Effizienzkomponenten:\n‚Ä¢ NMRF-Optimierungstool: Einsatz unseres spezialisierten Tools zur Simulation verschiedener Risikofaktor-Taxonomien und Mapping-Strategien, um die optimale Konfiguration zur Minimierung von NMRFs zu identifizieren.\n‚Ä¢ Proxying-Framework: Entwicklung einer robusten Methodik zur regulatorisch konformen Ableitung nicht beobachtbarer Risikofaktoren aus modellierbaren Faktoren, mit transparenten Validierungs- und Dokumentationsprozessen.\n‚Ä¢ Integrierte Kapitalsimulation: Implementierung eines End-to-End-Prozesses zur Berechnung der NMRF-Kapitalaufschl√§ge und deren Integration in die Gesamt-FRTB-Kapitalberechnung, mit What-If-Analysef√§higkeiten.\n‚Ä¢ Risikofaktor-Monitoring-Dashboard: Etablierung eines umfassenden Monitoring-Systems zur kontinuierlichen √úberwachung des Modellierbarkeits-Status aller Risikofaktoren, mit Fr√ºhwarnindikatoren und automatisierten Alerts bei kritischen √Ñnderungen."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
