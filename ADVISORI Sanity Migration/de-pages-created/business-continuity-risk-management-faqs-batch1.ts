import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Business Continuity Risk Management page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'business-continuity-risk-management' })
    
    if (!existingDoc) {
      throw new Error('Document "business-continuity-risk-management" not found')
    }
    
    // Create new FAQs for BC Risk Management fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Wie identifiziert und bewertet man systematisch Kontinuit√§tsrisiken in komplexen Gesch√§ftsumgebungen?',
        answer: "Die systematische Identifikation und Bewertung von Kontinuit√§tsrisiken bildet das Fundament f√ºr effektives Business Continuity Risk Management. In komplexen Gesch√§ftsumgebungen erfordert dies einen strukturierten, mehrdimensionalen Ansatz, der sowohl traditionelle als auch emerging risks erfasst und deren potenzielle Auswirkungen auf die Gesch√§ftskontinuit√§t pr√§zise bewertet.\n\nüîç Comprehensive Risk Identification:\n‚Ä¢ Beginnen Sie mit einer ganzheitlichen Bestandsaufnahme aller kritischen Gesch√§ftsprozesse, Systeme und Abh√§ngigkeiten\n‚Ä¢ Nutzen Sie strukturierte Workshops mit Cross-funktionalen Teams zur Identifikation von Risikoquellen aus verschiedenen Perspektiven\n‚Ä¢ Implementieren Sie systematische Threat Intelligence Prozesse zur Erfassung externer Bedrohungen und Marktver√§nderungen\n‚Ä¢ Analysieren Sie historische St√∂rungsereignisse und deren Ursachen f√ºr Pattern Recognition\n‚Ä¢ Ber√ºcksichtigen Sie Interdependenzen zwischen verschiedenen Gesch√§ftsbereichen und externen Partnern\n\nüìä Multi-dimensionale Risikobewertung:\n‚Ä¢ Entwickeln Sie quantitative Bewertungsmodelle, die sowohl Eintrittswahrscheinlichkeit als auch potenzielle Auswirkungen ber√ºcksichtigen\n‚Ä¢ Nutzen Sie Business Impact Analysis Techniken zur Bewertung finanzieller, operationeller und reputationaler Konsequenzen\n‚Ä¢ Implementieren Sie Szenario-basierte Bewertungsans√§tze f√ºr verschiedene St√∂rungsintensit√§ten und Dauern\n‚Ä¢ Ber√ºcksichtigen Sie zeitliche Dimensionen wie Recovery Time Objectives und Maximum Tolerable Downtime\n‚Ä¢ Integrieren Sie qualitative Faktoren wie Stakeholder-Reaktionen und regulatorische Konsequenzen\n\nüéØ Risk Prioritization und Heat Mapping:\n‚Ä¢ Erstellen Sie Risk Heat Maps zur visuellen Darstellung der Risikolandschaft und Priorisierung von Ma√ünahmen\n‚Ä¢ Entwickeln Sie gewichtete Scoring-Systeme, die branchenspezifische Faktoren und Unternehmensstrategien ber√ºcksichtigen\n‚Ä¢ Implementieren Sie dynamische Bewertungsmodelle, die sich an ver√§ndernde Gesch√§ftsbedingungen anpassen\n‚Ä¢ Nutzen Sie Monte Carlo Simulationen f√ºr komplexe Risikointeraktionen und Unsicherheitsanalysen\n‚Ä¢ Etablieren Sie klare Risikotoleranz-Schwellenwerte f√ºr verschiedene Gesch√§ftsbereiche\n\nüîÑ Kontinuierliche Risiko-√úberwachung:\n‚Ä¢ Implementieren Sie automatisierte Monitoring-Systeme f√ºr Fr√ºherkennung sich ver√§ndernder Risikoprofile\n‚Ä¢ Etablieren Sie regelm√§√üige Risiko-Reviews mit strukturierten Bewertungszyklen\n‚Ä¢ Nutzen Sie Key Risk Indicators f√ºr proaktive Risikosteuerung und Trendanalyse\n‚Ä¢ Integrieren Sie externe Datenquellen wie Marktindikatoren und geopolitische Entwicklungen\n‚Ä¢ Entwickeln Sie adaptive Bewertungsmodelle, die aus neuen Erkenntnissen und Erfahrungen lernen\n\nüåê Emerging Risk Considerations:\n‚Ä¢ Ber√ºcksichtigen Sie Cyber-Risiken und digitale Bedrohungen als kritische Kontinuit√§tsfaktoren\n‚Ä¢ Analysieren Sie Klimarisiken und deren langfristige Auswirkungen auf Gesch√§ftsoperationen\n‚Ä¢ Bewerten Sie Risiken aus technologischen Disruptions und Marktver√§nderungen\n‚Ä¢ Integrieren Sie ESG-Faktoren und Nachhaltigkeitsrisiken in die Bewertungsmodelle\n‚Ä¢ Ber√ºcksichtigen Sie regulatorische √Ñnderungen und Compliance-Risiken als Kontinuit√§tsbedrohungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Welche pr√§ventiven Risikominimierungs-Strategien sind am effektivsten f√ºr verschiedene Arten von Kontinuit√§tsrisiken?',
        answer: "Effektive Risikominimierung im Business Continuity Management erfordert einen differenzierten Ansatz, der verschiedene Strategien je nach Risikoart, Eintrittswahrscheinlichkeit und potenzieller Auswirkung kombiniert. Die Auswahl der optimalen Pr√§ventionsma√ünahmen h√§ngt von spezifischen Gesch√§ftsanforderungen, verf√ºgbaren Ressourcen und strategischen Priorit√§ten ab.\n\nüõ°Ô∏è Risk Avoidance Strategien:\n‚Ä¢ Eliminieren Sie Risikoquellen durch Prozessredesign und alternative Gesch√§ftsmodelle wo m√∂glich\n‚Ä¢ Implementieren Sie geografische Diversifikation zur Reduzierung standortspezifischer Risiken\n‚Ä¢ Nutzen Sie Technologie-Redundanzen und Multi-Vendor-Strategien zur Vermeidung Single Points of Failure\n‚Ä¢ Entwickeln Sie robuste Supplier-Diversifikation zur Reduzierung Lieferkettenrisiken\n‚Ä¢ Implementieren Sie pr√§ventive Sicherheitsma√ünahmen zur Vermeidung von Cyber-Bedrohungen\n\n‚öñÔ∏è Risk Mitigation und Control Measures:\n‚Ä¢ Entwickeln Sie mehrstufige Kontrollsysteme mit automatisierten √úberwachungs- und Alarmfunktionen\n‚Ä¢ Implementieren Sie pr√§ventive Wartungsprogramme f√ºr kritische Infrastrukturen und Systeme\n‚Ä¢ Etablieren Sie robuste Backup- und Recovery-Systeme mit regelm√§√üigen Tests und Updates\n‚Ä¢ Nutzen Sie Predictive Analytics zur Fr√ºherkennung potenzieller St√∂rungen\n‚Ä¢ Implementieren Sie Access Controls und Segregation of Duties zur Reduzierung operationeller Risiken\n\nüîÑ Risk Transfer Mechanismen:\n‚Ä¢ Entwickeln Sie comprehensive Versicherungsstrategien, die verschiedene Risikokategorien abdecken\n‚Ä¢ Nutzen Sie vertragliche Risikotransfer-Mechanismen mit Lieferanten und Partnern\n‚Ä¢ Implementieren Sie Hedging-Strategien f√ºr Finanz- und Marktrisiken\n‚Ä¢ Etablieren Sie Service Level Agreements mit klaren Haftungs- und Kompensationsregelungen\n‚Ä¢ Nutzen Sie Captive Insurance und Risk Pooling f√ºr spezifische Branchenrisiken\n\nüèóÔ∏è Resilience Building Ma√ünahmen:\n‚Ä¢ Investieren Sie in robuste Infrastrukturen mit Built-in Redundanzen und Failover-Kapazit√§ten\n‚Ä¢ Entwickeln Sie flexible Organisationsstrukturen, die sich schnell an ver√§nderte Bedingungen anpassen k√∂nnen\n‚Ä¢ Implementieren Sie Cross-Training Programme zur Reduzierung Key Person Risks\n‚Ä¢ Etablieren Sie alternative Arbeitsmodelle und Remote-Work-Kapazit√§ten\n‚Ä¢ Nutzen Sie Cloud-basierte L√∂sungen f√ºr erh√∂hte Skalierbarkeit und Verf√ºgbarkeit\n\nüìã Contingency Planning und Preparedness:\n‚Ä¢ Entwickeln Sie detaillierte Notfallpl√§ne f√ºr verschiedene St√∂rungsszenarien\n‚Ä¢ Implementieren Sie regelm√§√üige √úbungen und Simulationen zur Validierung der Preparedness\n‚Ä¢ Etablieren Sie Crisis Communication Protokolle und Stakeholder Management Prozesse\n‚Ä¢ Nutzen Sie Scenario Planning f√ºr proaktive Vorbereitung auf verschiedene Risikomanifestationen\n‚Ä¢ Entwickeln Sie adaptive Response-Strategien, die sich an die St√∂rungsintensit√§t anpassen\n\nüéØ Risk-specific Mitigation Approaches:\n‚Ä¢ Cyber-Risiken: Multi-layered Security Architecture, Employee Training, Incident Response Capabilities\n‚Ä¢ Lieferkettenrisiken: Supplier Diversification, Alternative Sourcing, Inventory Buffers\n‚Ä¢ Personalrisiken: Succession Planning, Knowledge Management, Flexible Staffing Models\n‚Ä¢ Technologierisiken: System Redundancy, Regular Updates, Disaster Recovery Sites\n‚Ä¢ Regulatorische Risiken: Compliance Monitoring, Regulatory Intelligence, Proactive Adaptation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Wie implementiert man effektive Risk Monitoring Systeme f√ºr kontinuierliche Risiko√ºberwachung und fr√ºhzeitige Warnung?',
        answer: "Effektive Risk Monitoring Systeme bilden das Nervensystem des Business Continuity Risk Managements und erm√∂glichen proaktive Risikosteuerung durch kontinuierliche √úberwachung, fr√ºhzeitige Erkennung von Ver√§nderungen und automatisierte Alarmierung bei kritischen Entwicklungen. Die Implementierung erfordert eine durchdachte Kombination aus Technologie, Prozessen und organisatorischen Strukturen.\n\nüìä Real-time Risk Dashboard Development:\n‚Ä¢ Entwickeln Sie integrierte Dashboards, die alle kritischen Risikoindikatoren in Echtzeit visualisieren\n‚Ä¢ Implementieren Sie customizable Views f√ºr verschiedene Stakeholder-Gruppen und Verantwortungsebenen\n‚Ä¢ Nutzen Sie Advanced Analytics und Machine Learning f√ºr Pattern Recognition und Trendanalyse\n‚Ä¢ Integrieren Sie externe Datenquellen wie Marktindikatoren, Wetterdaten und geopolitische Intelligence\n‚Ä¢ Etablieren Sie Mobile-friendly Interfaces f√ºr Management-Zugriff von √ºberall\n\nüö® Automated Alert und Escalation Systems:\n‚Ä¢ Implementieren Sie intelligente Alerting-Systeme mit konfigurierbaren Schwellenwerten und Eskalationsstufen\n‚Ä¢ Entwickeln Sie Risk-based Notification Protocols, die Dringlichkeit und Auswirkungspotenzial ber√ºcksichtigen\n‚Ä¢ Nutzen Sie Multi-Channel Communication f√ºr kritische Alerts √ºber verschiedene Medien\n‚Ä¢ Etablieren Sie automatisierte Workflow-Trigger f√ºr vordefinierte Response-Aktionen\n‚Ä¢ Implementieren Sie Alert Fatigue Prevention durch intelligente Filterung und Priorisierung\n\nüìà Key Risk Indicator Framework:\n‚Ä¢ Definieren Sie Leading und Lagging Indicators f√ºr verschiedene Risikokategorien\n‚Ä¢ Entwickeln Sie quantitative Metriken mit klaren Benchmark-Werten und Toleranzbereichen\n‚Ä¢ Implementieren Sie Composite Risk Scores, die multiple Indikatoren zu Gesamtbewertungen aggregieren\n‚Ä¢ Nutzen Sie Predictive Indicators zur Fr√ºherkennung sich entwickelnder Risiken\n‚Ä¢ Etablieren Sie regelm√§√üige KRI-Reviews und Anpassungen basierend auf Erfahrungen\n\nüîÑ Continuous Data Integration:\n‚Ä¢ Implementieren Sie APIs und Data Connectors f√ºr nahtlose Integration verschiedener Datenquellen\n‚Ä¢ Nutzen Sie IoT-Sensoren und Monitoring-Tools f√ºr Real-time Operational Intelligence\n‚Ä¢ Integrieren Sie Financial Systems f√ºr automatische √úberwachung von Liquidit√§ts- und Kreditrisiken\n‚Ä¢ Etablieren Sie Supplier Monitoring durch Integration von Third-Party Risk Platforms\n‚Ä¢ Implementieren Sie Social Media und News Monitoring f√ºr Reputations- und Marktrisiken\n\nüéØ Risk Scenario Monitoring:\n‚Ä¢ Entwickeln Sie Scenario-based Monitoring f√ºr verschiedene St√∂rungstypen und Intensit√§ten\n‚Ä¢ Implementieren Sie Stress Testing Capabilities f√ºr regelm√§√üige Resilience-Bewertungen\n‚Ä¢ Nutzen Sie Monte Carlo Simulationen f√ºr komplexe Risikointeraktionen\n‚Ä¢ Etablieren Sie What-if Analysis Tools f√ºr proaktive Szenario-Planung\n‚Ä¢ Implementieren Sie Dynamic Risk Modeling, das sich an ver√§ndernde Bedingungen anpasst\n\nüè¢ Organizational Integration:\n‚Ä¢ Etablieren Sie Risk Monitoring Centers mit dedizierten √úberwachungskapazit√§ten\n‚Ä¢ Implementieren Sie Role-based Access Controls f√ºr verschiedene Monitoring-Funktionen\n‚Ä¢ Entwickeln Sie Standard Operating Procedures f√ºr Monitoring-Aktivit√§ten und Response-Protokolle\n‚Ä¢ Nutzen Sie Regular Risk Reviews und Management Reporting f√ºr strategische Entscheidungsunterst√ºtzung\n‚Ä¢ Etablieren Sie Continuous Improvement Prozesse basierend auf Monitoring-Erkenntnissen und Lessons Learned"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Welche Rolle spielt Risk Governance in der strategischen Unternehmensf√ºhrung und wie integriert man sie in bestehende Management-Strukturen?',
        answer: "Risk Governance bildet das strategische Fundament f√ºr nachhaltiges Business Continuity Risk Management und stellt sicher, dass Risikomanagement-Aktivit√§ten mit Unternehmenszielen, regulatorischen Anforderungen und Stakeholder-Erwartungen aligned sind. Die Integration in bestehende Management-Strukturen erfordert einen systematischen Ansatz, der Governance-Prinzipien mit operationeller Effektivit√§t verbindet.\n\nüèõÔ∏è Strategic Risk Governance Framework:\n‚Ä¢ Etablieren Sie ein Board-Level Risk Committee mit klaren Mandaten und Verantwortlichkeiten\n‚Ä¢ Entwickeln Sie Risk Governance Charters, die Rollen, Verantwortlichkeiten und Entscheidungsbefugnisse definieren\n‚Ä¢ Implementieren Sie Three Lines of Defense Modelle f√ºr strukturierte Risikokontrolle und Oversight\n‚Ä¢ Nutzen Sie Risk Appetite Statements zur strategischen Ausrichtung von Risikomanagement-Aktivit√§ten\n‚Ä¢ Etablieren Sie Risk Culture Initiatives zur F√∂rderung risikobewussten Verhaltens auf allen Organisationsebenen\n\nüìã Integration in Management-Strukturen:\n‚Ä¢ Integrieren Sie Risikobewertungen in strategische Planungsprozesse und Investitionsentscheidungen\n‚Ä¢ Entwickeln Sie Risk-adjusted Performance Metrics f√ºr Management-Bewertung und Incentivierung\n‚Ä¢ Implementieren Sie Risk-based Budgeting und Resource Allocation Prozesse\n‚Ä¢ Nutzen Sie Risk Intelligence f√ºr strategische Entscheidungsunterst√ºtzung und Opportunity Identification\n‚Ä¢ Etablieren Sie Risk-informed Decision Making Frameworks f√ºr alle kritischen Gesch√§ftsentscheidungen\n\nüë• Organizational Risk Roles und Responsibilities:\n‚Ä¢ Definieren Sie klare Risk Owner Strukturen mit Accountability f√ºr spezifische Risikobereiche\n‚Ä¢ Etablieren Sie Risk Champion Networks zur F√∂rderung von Risk Awareness in allen Gesch√§ftsbereichen\n‚Ä¢ Implementieren Sie Risk Management Office Funktionen f√ºr zentrale Koordination und Support\n‚Ä¢ Nutzen Sie Cross-functional Risk Committees f√ºr integrierte Risikobewertung und Response\n‚Ä¢ Entwickeln Sie Risk Competency Frameworks und Training Programme f√ºr alle Mitarbeiter\n\nüìä Risk Reporting und Communication:\n‚Ä¢ Implementieren Sie strukturierte Risk Reporting Hierarchien vom operationellen Level bis zum Board\n‚Ä¢ Entwickeln Sie Executive Risk Dashboards mit Key Risk Indicators und Trend-Analysen\n‚Ä¢ Nutzen Sie Risk Heat Maps und Scenario Analyses f√ºr strategische Risk Communication\n‚Ä¢ Etablieren Sie Regular Risk Reviews mit Management und Board f√ºr kontinuierliche Oversight\n‚Ä¢ Implementieren Sie Stakeholder-specific Risk Communication Strategien f√ºr verschiedene Zielgruppen\n\nüîÑ Continuous Governance Improvement:\n‚Ä¢ Etablieren Sie Risk Governance Maturity Assessments f√ºr kontinuierliche Verbesserung\n‚Ä¢ Implementieren Sie Benchmarking gegen Industry Best Practices und Regulatory Expectations\n‚Ä¢ Nutzen Sie Internal Audit und External Reviews f√ºr objektive Governance-Bewertung\n‚Ä¢ Entwickeln Sie Adaptive Governance Modelle, die sich an ver√§ndernde Gesch√§ftsanforderungen anpassen\n‚Ä¢ Etablieren Sie Lessons Learned Prozesse aus Risk Events f√ºr kontinuierliche Governance-Evolution\n\n‚öñÔ∏è Regulatory und Compliance Integration:\n‚Ä¢ Integrieren Sie regulatorische Anforderungen in Risk Governance Frameworks\n‚Ä¢ Implementieren Sie Compliance Monitoring und Reporting als integralen Bestandteil der Risk Governance\n‚Ä¢ Nutzen Sie Regulatory Intelligence f√ºr proaktive Anpassung an sich √§ndernde Anforderungen\n‚Ä¢ Etablieren Sie Risk-based Compliance Programmes mit fokussierten Kontrollma√ünahmen\n‚Ä¢ Entwickeln Sie Audit-ready Documentation und Evidence Management f√ºr Regulatory Reviews"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
