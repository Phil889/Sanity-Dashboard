import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Implementation page with FAQ batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-implementation' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-implementation" not found')
    }
    
    // Create new FAQs for continuous improvement and operational aspects
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 13),
        question: 'Wie etabliert man kontinuierliche Verbesserung im ISMS nach der ISO 27001 Implementierung?',
        answer: "Die Etablierung kontinuierlicher Verbesserung ist ein zentraler Aspekt des ISMS und gewÃ¤hrleistet dessen langfristige Wirksamkeit und AnpassungsfÃ¤higkeit. Ein systematischer Ansatz zur kontinuierlichen Verbesserung transformiert das ISMS von einem statischen Framework zu einem dynamischen, lernenden System.\n\nğŸ”„ PDCA-Zyklus und Verbesserungskultur:\nâ€¢ Systematische Anwendung des Plan-Do-Check-Act-Zyklus in allen ISMS-Prozessen\nâ€¢ Etablierung einer organisationsweiten Kultur der kontinuierlichen Verbesserung\nâ€¢ Integration von VerbesserungsaktivitÃ¤ten in tÃ¤gliche ArbeitsablÃ¤ufe\nâ€¢ Aufbau von Feedback-Mechanismen auf allen Organisationsebenen\nâ€¢ Schaffung von Anreizsystemen fÃ¼r VerbesserungsvorschlÃ¤ge und Innovation\n\nğŸ“Š Performance-Monitoring und Metriken:\nâ€¢ Entwicklung aussagekrÃ¤ftiger KPIs fÃ¼r alle kritischen ISMS-Bereiche\nâ€¢ Implementierung automatisierter Monitoring- und Alerting-Systeme\nâ€¢ RegelmÃ¤ÃŸige Trend-Analysen und Performance-Reviews\nâ€¢ Benchmarking gegen interne Ziele und externe Standards\nâ€¢ Aufbau von Dashboards fÃ¼r Echtzeit-Einblicke in ISMS-Performance\n\nğŸ” Systematische Datensammlung und Analyse:\nâ€¢ Kontinuierliche Sammlung von Sicherheitsdaten aus allen relevanten Quellen\nâ€¢ Statistische Analyse von Incident-Trends und Mustern\nâ€¢ Auswertung von Audit-Ergebnissen und Management Reviews\nâ€¢ Analyse von Stakeholder-Feedback und Kundenzufriedenheit\nâ€¢ Integration von Threat Intelligence und Marktentwicklungen\n\nğŸ¯ Identifikation von Verbesserungspotenzialen:\nâ€¢ Systematische Gap-Analysen gegen aktuelle Best Practices\nâ€¢ Root Cause-Analysen fÃ¼r wiederkehrende Probleme\nâ€¢ Bewertung neuer Technologien und MethodenansÃ¤tze\nâ€¢ Analyse von Compliance-Anforderungen und regulatorischen Ã„nderungen\nâ€¢ BerÃ¼cksichtigung von GeschÃ¤ftsentwicklungen und strategischen Zielen\n\nğŸ“ˆ Verbesserungsprojekte und Umsetzung:\nâ€¢ Priorisierung von VerbesserungsmaÃŸnahmen basierend auf Risiko und Impact\nâ€¢ Strukturierte Projektplanung mit klaren Zielen und ZeitplÃ¤nen\nâ€¢ Ressourcenallokation und Budgetierung fÃ¼r Verbesserungsinitiativen\nâ€¢ Change Management fÃ¼r die Umsetzung von Verbesserungen\nâ€¢ Erfolgsmessung und Validierung implementierter Verbesserungen\n\nğŸ”„ Management Review und Governance:\nâ€¢ RegelmÃ¤ÃŸige Management Reviews mit Fokus auf kontinuierliche Verbesserung\nâ€¢ Strategische Bewertung der ISMS-Ausrichtung an GeschÃ¤ftszielen\nâ€¢ Entscheidungsfindung fÃ¼r grÃ¶ÃŸere Verbesserungsinvestitionen\nâ€¢ Kommunikation von Verbesserungserfolgen an alle Stakeholder\nâ€¢ Integration von Verbesserungszielen in Organisationsstrategie\n\nğŸ“ Lernen und Wissensmanagement:\nâ€¢ Dokumentation und Sharing von Lessons Learned\nâ€¢ Aufbau von Wissensdatenbanken und Best Practice Repositories\nâ€¢ Externe Weiterbildung und Konferenzteilnahmen\nâ€¢ Netzwerking mit anderen Organisationen und Branchenexperten\nâ€¢ Integration neuer Erkenntnisse in ISMS-Prozesse und Schulungen\n\nğŸš€ Innovation und Zukunftsorientierung:\nâ€¢ Exploration neuer Sicherheitstechnologien und AnsÃ¤tze\nâ€¢ Pilotprojekte fÃ¼r innovative LÃ¶sungen und Methoden\nâ€¢ Antizipation zukÃ¼nftiger Bedrohungen und Herausforderungen\nâ€¢ Aufbau von KapazitÃ¤ten fÃ¼r agile Anpassung an VerÃ¤nderungen\nâ€¢ Strategische Planung fÃ¼r ISMS-Evolution und Transformation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 14),
        question: 'Welche Kostenaspekte mÃ¼ssen bei der ISO 27001 Implementierung berÃ¼cksichtigt werden?',
        answer: "Eine umfassende Kostenplanung ist entscheidend fÃ¼r den Erfolg einer ISO 27001 Implementierung und erfordert die BerÃ¼cksichtigung aller direkten und indirekten Kostenfaktoren. Eine strukturierte Kostenanalyse ermÃ¶glicht realistische Budgetierung und ROI-Bewertung.\n\nğŸ’° Direkte Implementierungskosten:\nâ€¢ Externe Beratungsleistungen fÃ¼r Strategieentwicklung, Implementierung und Audit-Vorbereitung\nâ€¢ Zertifizierungskosten einschlieÃŸlich Initial-Audit, Surveillance-Audits und Rezertifizierung\nâ€¢ Technologie-Investitionen fÃ¼r Sicherheitstools, Software und Infrastructure-Upgrades\nâ€¢ Schulungs- und Zertifizierungskosten fÃ¼r interne Mitarbeiter\nâ€¢ Dokumentationssysteme und ISMS-Management-Plattformen\n\nğŸ‘¥ Personalkosten und Ressourcenaufwand:\nâ€¢ Dedizierte ISMS-Rollen wie Informationssicherheitsbeauftragte und ISMS-Manager\nâ€¢ Zeitaufwand bestehender Mitarbeiter fÃ¼r ISMS-AktivitÃ¤ten und Schulungen\nâ€¢ Projektmanagement-Ressourcen fÃ¼r Implementierung und Change Management\nâ€¢ Interne Audit-Teams und Compliance-Funktionen\nâ€¢ Opportunity Costs durch Ressourcenumverteilung von anderen Projekten\n\nğŸ”§ Technische Infrastruktur und Tools:\nâ€¢ Sicherheitstechnologien wie Firewalls, Intrusion Detection, Endpoint Protection\nâ€¢ Monitoring- und SIEM-Systeme fÃ¼r kontinuierliche Ãœberwachung\nâ€¢ Backup- und Disaster Recovery-LÃ¶sungen\nâ€¢ VerschlÃ¼sselungstechnologien und PKI-Infrastruktur\nâ€¢ Identity und Access Management-Systeme\n\nğŸ“Š Operative Betriebskosten:\nâ€¢ Laufende Lizenzkosten fÃ¼r Sicherheitssoftware und Tools\nâ€¢ Wartung und Support fÃ¼r implementierte Systeme\nâ€¢ RegelmÃ¤ÃŸige Penetration Tests und Vulnerability Assessments\nâ€¢ Kontinuierliche Schulungen und Awareness-Programme\nâ€¢ Incident Response und Forensik-KapazitÃ¤ten\n\nğŸ”„ Compliance und Audit-Kosten:\nâ€¢ JÃ¤hrliche Surveillance-Audits durch Zertifizierungsstellen\nâ€¢ Interne Audit-Programme und Ressourcen\nâ€¢ Compliance-Monitoring und Reporting-Systeme\nâ€¢ Rechtliche Beratung fÃ¼r regulatorische Anforderungen\nâ€¢ Dokumentations-Updates und Versionskontrolle\n\nğŸ“ˆ ROI und Business Value:\nâ€¢ Reduzierung von Cyber-Risiken und potenziellen Schadenkosten\nâ€¢ Vermeidung von Compliance-Strafen und regulatorischen Sanktionen\nâ€¢ Verbesserung der Kundenvertrauen und Marktpositionierung\nâ€¢ Effizienzsteigerungen durch standardisierte Sicherheitsprozesse\nâ€¢ Wettbewerbsvorteile durch Zertifizierung und Vertrauensbildung\n\nğŸ’¡ Kostenoptimierungsstrategien:\nâ€¢ Phasenweise Implementierung zur Verteilung der Investitionen\nâ€¢ Nutzung bestehender Systeme und Integration statt Neubeschaffung\nâ€¢ Aufbau interner Kompetenzen zur Reduzierung externer AbhÃ¤ngigkeiten\nâ€¢ Automatisierung wiederkehrender Aufgaben zur Senkung operativer Kosten\nâ€¢ Shared Services und Skaleneffekte in grÃ¶ÃŸeren Organisationen\n\nğŸ¯ Budgetplanung und Kontrolle:\nâ€¢ Detaillierte KostenaufschlÃ¼sselung nach Kategorien und ZeitrÃ¤umen\nâ€¢ Contingency-Planung fÃ¼r unvorhergesehene Kosten\nâ€¢ RegelmÃ¤ÃŸige Budget-Reviews und Anpassungen\nâ€¢ Tracking von Actual vs. Planned Costs\nâ€¢ Langfristige Finanzplanung fÃ¼r ISMS-Aufrechterhaltung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 15),
        question: 'Wie misst man den Erfolg einer ISO 27001 Implementierung?',
        answer: "Die Erfolgsmessung einer ISO 27001 Implementierung erfordert ein mehrdimensionales Bewertungssystem, das sowohl quantitative als auch qualitative Aspekte berÃ¼cksichtigt. Ein strukturiertes Measurement-Framework ermÃ¶glicht objektive Bewertung und kontinuierliche Optimierung.\n\nğŸ“Š Quantitative Erfolgsindikatoren:\nâ€¢ Reduzierung der Anzahl und Schwere von SicherheitsvorfÃ¤llen\nâ€¢ Verbesserung der Mean Time to Detection und Mean Time to Response\nâ€¢ ErhÃ¶hung der VerfÃ¼gbarkeit kritischer Systeme und Services\nâ€¢ Reduzierung von Compliance-VerstÃ¶ÃŸen und regulatorischen Findings\nâ€¢ Kosteneinsparungen durch Effizienzsteigerungen und Risikominimierung\n\nğŸ¯ Compliance und Zertifizierungsmetriken:\nâ€¢ Erfolgreiche Erstzerifizierung ohne Major Non-Conformities\nâ€¢ Bestehen von Surveillance-Audits mit minimalen Findings\nâ€¢ Einhaltung aller regulatorischen Anforderungen und Standards\nâ€¢ VollstÃ¤ndige Implementierung aller anwendbaren Annex A Kontrollen\nâ€¢ Termingerechte Umsetzung aller KorrekturmaÃŸnahmen\n\nğŸ” Risikomanagement-Kennzahlen:\nâ€¢ Reduzierung des Gesamtrisiko-Scores der Organisation\nâ€¢ Verbesserung der Risiko-Identifikation und -bewertung\nâ€¢ ErhÃ¶hung der Anzahl behandelter Risiken\nâ€¢ Verbesserung der Risiko-Kommunikation und -transparenz\nâ€¢ Reduzierung der Anzahl unbehandelter High-Risk-Findings\n\nğŸ‘¥ Organisatorische Reife-Indikatoren:\nâ€¢ Steigerung des Sicherheitsbewusstseins in der Organisation\nâ€¢ Verbesserung der Incident-Reporting-Kultur\nâ€¢ ErhÃ¶hung der Mitarbeiterzufriedenheit mit Sicherheitsprozessen\nâ€¢ Aufbau interner ISMS-Kompetenzen und Expertise\nâ€¢ Integration von Sicherheit in GeschÃ¤ftsprozesse\n\nğŸ’¼ Business Value und ROI-Metriken:\nâ€¢ Return on Investment der ISMS-Implementierung\nâ€¢ Verbesserung der Kundenvertrauen und -zufriedenheit\nâ€¢ ErhÃ¶hung der Marktchancen durch Zertifizierung\nâ€¢ Reduzierung von VersicherungsprÃ¤mien und Haftungsrisiken\nâ€¢ Steigerung der Operational Excellence und Prozesseffizienz\n\nğŸ”„ Prozess-Performance-Indikatoren:\nâ€¢ Verbesserung der Durchlaufzeiten fÃ¼r Sicherheitsprozesse\nâ€¢ ErhÃ¶hung der Automatisierungsgrade in kritischen Bereichen\nâ€¢ Reduzierung manueller AufwÃ¤nde durch Standardisierung\nâ€¢ Verbesserung der DatenqualitÃ¤t und Reporting-Genauigkeit\nâ€¢ Steigerung der Prozess-Compliance und -konsistenz\n\nğŸ“ˆ Kontinuierliche Verbesserungs-Metriken:\nâ€¢ Anzahl und QualitÃ¤t implementierter VerbesserungsmaÃŸnahmen\nâ€¢ Reduzierung wiederkehrender Probleme und Root Causes\nâ€¢ Verbesserung der Lessons Learned-Integration\nâ€¢ Steigerung der Innovation und Best Practice-Adoption\nâ€¢ ErhÃ¶hung der organisatorischen LernfÃ¤higkeit\n\nğŸ“ Stakeholder-Zufriedenheit:\nâ€¢ Management-Zufriedenheit mit ISMS-Performance\nâ€¢ Mitarbeiter-Feedback zu Sicherheitsprozessen\nâ€¢ Kunden-Vertrauen in SicherheitsmaÃŸnahmen\nâ€¢ Auditor-Bewertungen und Feedback\nâ€¢ Regulatoren-Zufriedenheit mit Compliance-Status\n\nğŸ”§ Technische Leistungsindikatoren:\nâ€¢ Verbesserung der SystemverfÃ¼gbarkeit und -performance\nâ€¢ Reduzierung von False Positives in Monitoring-Systemen\nâ€¢ ErhÃ¶hung der Threat Detection-Raten\nâ€¢ Verbesserung der Backup- und Recovery-Zeiten\nâ€¢ Steigerung der Patch-Management-Effizienz"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 16),
        question: 'Welche hÃ¤ufigen Fallstricke sollten bei der ISO 27001 Implementierung vermieden werden?',
        answer: "Die Vermeidung hÃ¤ufiger Fallstricke ist entscheidend fÃ¼r den Erfolg einer ISO 27001 Implementierung. Ein Bewusstsein fÃ¼r typische Herausforderungen und bewÃ¤hrte LÃ¶sungsansÃ¤tze kann kostspielige Fehler verhindern und die Implementierungseffizienz erheblich steigern.\n\nğŸ¯ Strategische und Planungsfehler:\nâ€¢ Unzureichende Management-UnterstÃ¼tzung und fehlendes Leadership-Commitment\nâ€¢ Unrealistische ZeitplÃ¤ne und BudgetschÃ¤tzungen ohne ausreichende Pufferplanung\nâ€¢ Mangelnde Stakeholder-Einbindung und unklare Kommunikationsstrategie\nâ€¢ Fehlende Integration mit bestehenden GeschÃ¤ftsprozessen und Managementsystemen\nâ€¢ UnvollstÃ¤ndige Gap-Analyse und UnterschÃ¤tzung des Implementierungsaufwands\n\nğŸ“‹ Dokumentations- und Prozessfehler:\nâ€¢ Ãœberdokumentation ohne praktischen Nutzen oder Anwendbarkeit\nâ€¢ Inkonsistente Dokumentationsstrukturen und fehlende Versionskontrolle\nâ€¢ Kopieren von Templates ohne organisationsspezifische Anpassung\nâ€¢ Fehlende VerknÃ¼pfung zwischen Policies, Prozessen und technischen Implementierungen\nâ€¢ Unzureichende Dokumentation von Entscheidungen und BegrÃ¼ndungen\n\nğŸ”§ Technische Implementierungsfehler:\nâ€¢ Fokus auf Tools statt auf Prozesse und organisatorische Aspekte\nâ€¢ Unzureichende Integration verschiedener Sicherheitssysteme\nâ€¢ Fehlende BerÃ¼cksichtigung von Legacy-Systemen und technischen Schulden\nâ€¢ Ãœberkomplexe technische LÃ¶sungen ohne klaren Business Value\nâ€¢ Mangelnde Skalierbarkeit und ZukunftsfÃ¤higkeit der gewÃ¤hlten LÃ¶sungen\n\nğŸ‘¥ Organisatorische und kulturelle Herausforderungen:\nâ€¢ Unzureichendes Change Management und Widerstandsbehandlung\nâ€¢ Fehlende Schulungen und Awareness-Programme fÃ¼r Mitarbeiter\nâ€¢ Unklare Rollen und Verantwortlichkeiten im ISMS\nâ€¢ Mangelnde Integration von Sicherheit in die Unternehmenskultur\nâ€¢ Fehlende BerÃ¼cksichtigung verschiedener Organisationsebenen und Standorte\n\nğŸ” Risikomanagement-SchwÃ¤chen:\nâ€¢ OberflÃ¤chliche Risikoanalysen ohne tiefgreifende Bedrohungsmodellierung\nâ€¢ Fehlende BerÃ¼cksichtigung von Business Context und Auswirkungen\nâ€¢ Unzureichende Risiko-Kommunikation und -transparenz\nâ€¢ Statische Risikobewertungen ohne regelmÃ¤ÃŸige Updates\nâ€¢ Mangelnde Integration von Cyber Threat Intelligence\n\nğŸ“Š Monitoring und Messung-Defizite:\nâ€¢ Fehlende oder ungeeignete KPIs und Erfolgsmessungen\nâ€¢ Unzureichende Monitoring-Systeme und Alerting-Mechanismen\nâ€¢ Mangelnde DatenqualitÃ¤t und Reporting-Genauigkeit\nâ€¢ Fehlende Trend-Analysen und Predictive Analytics\nâ€¢ Unzureichende Management-Dashboards und Visualisierungen\n\nğŸ”„ Audit und Compliance-Probleme:\nâ€¢ Unzureichende Vorbereitung auf Zertifizierungsaudits\nâ€¢ Fehlende interne Audit-Programme und Selbstbewertungen\nâ€¢ Mangelnde Evidenz-Sammlung und Dokumentation\nâ€¢ Unzureichende Behandlung von Audit-Findings\nâ€¢ Fehlende kontinuierliche Compliance-Ãœberwachung\n\nğŸ’° Ressourcen- und Budgetfehler:\nâ€¢ UnterschÃ¤tzung der Total Cost of Ownership\nâ€¢ Fehlende BerÃ¼cksichtigung von Folgekosten und Maintenance\nâ€¢ Unzureichende Ressourcenplanung fÃ¼r kontinuierlichen Betrieb\nâ€¢ Mangelnde ROI-Bewertung und Business Case-Entwicklung\nâ€¢ Fehlende Contingency-Planung fÃ¼r unvorhergesehene Kosten\n\nğŸš€ Vermeidungsstrategien und Best Practices:\nâ€¢ FrÃ¼hzeitige und kontinuierliche Stakeholder-Einbindung\nâ€¢ Realistische Planung mit ausreichenden Puffern und FlexibilitÃ¤t\nâ€¢ Fokus auf praktische Umsetzbarkeit und Business Value\nâ€¢ Systematisches Change Management und Kommunikation\nâ€¢ Kontinuierliche Validierung und Anpassung des Implementierungsansatzes"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('âœ… FAQ batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
