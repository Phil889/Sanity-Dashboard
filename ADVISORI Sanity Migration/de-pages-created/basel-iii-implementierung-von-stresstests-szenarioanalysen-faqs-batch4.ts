import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Basel III Implementierung von Stresstests & Szenarioanalysen page with FAQs batch 4 (German)...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'basel-iii-implementierung-von-stresstests-szenarioanalysen' })
    
    if (!existingDoc) {
      throw new Error('Document "basel-iii-implementierung-von-stresstests-szenarioanalysen" not found')
    }
    
    // Create new FAQs in German
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Wie kann ein effizientes und aussagekr√§ftiges Stresstest-Reporting f√ºr verschiedene Stakeholder-Gruppen gestaltet werden?",
        answer: "Ein effektives Stresstest-Reporting bildet die Br√ºcke zwischen komplexen technischen Analysen und entscheidungsrelevanten Erkenntnissen. Es muss die Bed√ºrfnisse unterschiedlicher Stakeholder bedienen und sowohl detaillierte Einblicke als auch pr√§gnante Handlungsempfehlungen bieten. Eine durchdachte Reportingstruktur ist entscheidend, um den vollen Wert von Stresstests zu realisieren.\n\nüìã Stakeholder-spezifische Reportingans√§tze:\n‚Ä¢ Vorstand und Gesch√§ftsleitung: Fokus auf strategische Implikationen, Kapitalad√§quanz und wesentliche Vulnerabilit√§ten mit klaren Handlungsoptionen in einem pr√§gnanten Executive Summary ohne technische Details.\n‚Ä¢ Aufsichtsbeh√∂rden: Detaillierte methodische Dokumentation, Compliance-Nachweise und umfassende Ergebnisdarstellung mit Fokus auf regulatorische Kennzahlen und deren Entwicklung unter Stress.\n‚Ä¢ Risikomanagement: Granulare Analysen der Risikotreiber, Sensitivit√§ten und Modellierungsdetails mit detaillierten Breakdowns nach Portfolios, Gesch√§ftsbereichen und Risikoarten.\n‚Ä¢ Gesch√§ftsbereiche: Spezifische Auswirkungen auf das jeweilige Gesch√§ftsfeld, Produktlinien und Kundengruppen mit konkreten Handlungsempfehlungen f√ºr die operative Umsetzung.\n\nüìä Effektive Visualisierungskonzepte:\n‚Ä¢ Dashboard-Ansatz: Entwicklung von interaktiven Dashboards mit Key Performance Indicators (KPIs) und Drill-down-Funktionalit√§t f√ºr verschiedene Detaillierungsebenen.\n‚Ä¢ Heatmaps und Matrixdarstellungen: Visualisierung von Risikoclustern und -konzentrationen durch farbcodierte Darstellungen der Stressauswirkungen nach Gesch√§ftsbereichen und Risikoarten.\n‚Ä¢ Waterfall-Charts: Darstellung der Auswirkungen einzelner Risikofaktoren auf zentrale Kennzahlen wie Kapitalquoten oder Liquidit√§tskennziffern.\n‚Ä¢ Szenario-Vergleichsgrafiken: Gegen√ºberstellung verschiedener Stressszenarien und ihrer Auswirkungen in leicht verst√§ndlichen, vergleichenden Visualisierungen.\n\nüîÑ Integrierte Reportingstrukturen:\n‚Ä¢ Modularisierter Aufbau: Entwicklung eines Baukastensystems aus Reportingmodulen, die flexibel zu zielgruppenspezifischen Berichten kombiniert werden k√∂nnen.\n‚Ä¢ Abstufung der Informationsdichte: Strukturierung der Berichte nach dem Prinzip der Informationspyramide ‚Äì von aggregierten Kennzahlen zu detaillierten Analysen.\n‚Ä¢ Narrative Einordnung: Erg√§nzung quantitativer Ergebnisse durch qualitative Einordnungen, Interpretationen und Handlungsempfehlungen.\n‚Ä¢ Integrierte Zeitreihen: Einbettung aktueller Stresstestergebnisse in historische Entwicklungen und Trends f√ºr eine bessere Kontextualisierung.\n\nüîÑ Prozessuale Aspekte des Reportings:\n‚Ä¢ Automatisierung: Implementierung automatisierter Reportingl√∂sungen zur Reduzierung manueller Eingriffe, Fehleranf√§lligkeit und Durchlaufzeiten.\n‚Ä¢ Qualit√§tssicherung: Etablierung systematischer Pr√ºfprozesse f√ºr die Konsistenz, Plausibilit√§t und Vollst√§ndigkeit der Berichte vor ihrer Verteilung.\n‚Ä¢ Feedback-Zyklen: Regelm√§√üige Einholung von Feedback der verschiedenen Stakeholder zur kontinuierlichen Verbesserung des Reportings.\n‚Ä¢ Agile Anpassungsf√§higkeit: Flexibilit√§t, um auf Ad-hoc-Anfragen und neue Anforderungen mit ma√ügeschneiderten Analysen reagieren zu k√∂nnen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Welche Herausforderungen bestehen bei der Modellierung von Marktrisiken in Stresstests und wie k√∂nnen diese bew√§ltigt werden?",
        answer: "Die Modellierung von Marktrisiken in Stresstests stellt besondere Herausforderungen dar, da sie komplexe nicht-lineare Zusammenh√§nge, Korrelationsver√§nderungen unter Stress und emergente Marktdynamiken abbilden muss. Eine pr√§zise und robuste Marktrisiko-Modellierung ist entscheidend f√ºr aussagekr√§ftige Stresstests und erfordert fortgeschrittene Methoden und sorgf√§ltige Kalibrierung.\n\nüìâ Zentrale Herausforderungen der Marktrisiko-Modellierung:\n‚Ä¢ Nichtlineare Instrumentenbewertung: Viele Finanzinstrumente, insbesondere Derivate, weisen nichtlineare Bewertungsfunktionen auf, die unter Stressbedingungen zu unerwarteten Verlusten f√ºhren k√∂nnen.\n‚Ä¢ Dynamische Korrelationen: Marktkorrelationen ver√§ndern sich typischerweise in Stresssituationen signifikant, wobei Diversifikationseffekte oft abnehmen und gemeinsame Bewegungen zunehmen (Korrelations-Breakdown).\n‚Ä¢ Liquidit√§tseffekte: Marktliquidit√§t kann in Stressszenarien drastisch abnehmen, was zu zus√§tzlichen Bewertungsabschl√§gen, h√∂heren Geld-Brief-Spannen und erschwerter Portfolioanpassung f√ºhrt.\n‚Ä¢ Tail-Risiken: Extremereignisse treten in der Realit√§t h√§ufiger auf als von klassischen Normalverteilungsmodellen vorhergesagt, was zu einer Untersch√§tzung von Tail-Risiken f√ºhren kann.\n\nüî® Methodische L√∂sungsans√§tze:\n‚Ä¢ Fortgeschrittene Verteilungsmodelle: Verwendung von Verteilungsfunktionen mit \"fat tails\" wie t-Verteilungen oder generalisierten hyperbolischen Verteilungen, die Extremereignisse besser abbilden k√∂nnen.\n‚Ä¢ Copula-Ans√§tze: Einsatz von Copula-Funktionen zur flexiblen Modellierung von Abh√§ngigkeitsstrukturen zwischen verschiedenen Risikofaktoren, die auch nicht-lineare Zusammenh√§nge und asymmetrische Abh√§ngigkeiten erfassen k√∂nnen.\n‚Ä¢ Regime-Switching-Modelle: Implementierung von Modellen, die explizit zwischen verschiedenen Marktregimen (normal, gestresst) unterscheiden und unterschiedliche Parametersets f√ºr diese Regime verwenden.\n‚Ä¢ Historische Simulationen mit Overlay: Kombination historischer Szenarien mit hypothetischen Anpassungen, um aktuelle Marktstrukturen und neuartige Risikofaktoren zu ber√ºcksichtigen.\n\nüß™ Praktische Implementierungsstrategien:\n‚Ä¢ Multi-Level-Ansatz: Kombination verschiedener Modellierungsebenen von aggregierten Makromodellen bis hin zu detaillierten Einzelpositionsbewertungen je nach Relevanz und Komplexit√§t.\n‚Ä¢ Sensitivit√§tsbasierte Approximationen: Nutzung von Taylor-Reihenentwicklungen h√∂herer Ordnung (Delta-Gamma-Vega-Ansatz) f√ºr eine effiziente Approximation nichtlinearer Bewertungsfunktionen.\n‚Ä¢ Hybrid-Modelle: Integration mehrerer Modellierungsans√§tze, die unterschiedliche Aspekte wie Makro√∂konomie, Assetpreise und institutsspezifische Faktoren abdecken.\n‚Ä¢ Expert Overlay: Erg√§nzung quantitativer Modelle durch qualitative Experteneinsch√§tzungen, insbesondere f√ºr neuartige Risiken oder extreme Marktbedingungen ohne historische Pr√§zedenzf√§lle.\n\nüîé Validierung und Qualit√§tssicherung:\n‚Ä¢ Backtesting gegen historische Krisen: √úberpr√ºfung der Modellperformance anhand historischer Stressepisoden wie der Finanzkrise 2008 oder der COVID-19-Marktturbulenzen.\n‚Ä¢ Benchmarking gegen alternative Modelle: Vergleich der Ergebnisse verschiedener Modellans√§tze zur Identifikation von Modellrisiken und blinden Flecken.\n‚Ä¢ Plausibilit√§tschecks: Systematische √úberpr√ºfung der Ergebnisse auf √∂konomische Plausibilit√§t und Konsistenz mit fundamentalen Marktmechanismen.\n‚Ä¢ Stresstests f√ºr die Stresstests: Durchf√ºhrung von Sensitivit√§tsanalysen f√ºr die Modellparameter selbst, um die Robustheit der Stressergebnisse gegen√ºber Modellunsicherheiten zu bewerten."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Wie unterscheiden sich die Anforderungen an Stresstests f√ºr verschiedene Institutstypen und Gesch√§ftsmodelle im Rahmen von Basel III?",
        answer: "Basel III ber√ºcksichtigt das Proportionalit√§tsprinzip, demzufolge die aufsichtlichen Anforderungen an Stresstests entsprechend der Gr√∂√üe, Komplexit√§t und des Risikoprofils eines Instituts differenziert werden sollten. Die effektive Implementierung von Stresstests erfordert daher eine ma√ügeschneiderte Herangehensweise, die die spezifischen Charakteristika des jeweiligen Gesch√§ftsmodells ber√ºcksichtigt.\n\nüè¶ Institutstypspezifische Anforderungen und Fokusthemen:\n‚Ä¢ Gro√üe, international t√§tige Banken (G-SIBs): Umfassende, integrierte Stresstests mit besonderem Fokus auf systemische Risiken, grenz√ºberschreitende Ansteckungseffekte und komplexe Wechselwirkungen zwischen verschiedenen Risikoarten und Jurisdiktionen.\n‚Ä¢ Mittelgro√üe Universalbanken: Balance zwischen Proportionalit√§t und angemessener Risikoabdeckung mit Schwerpunkt auf den institutstypischen Hauptrisiken (oft Kreditrisiko) und moderatem Detaillierungsgrad bei sekund√§ren Risiken.\n‚Ä¢ Spezialinstitute (z.B. Bausparkassen, Autobanken): Fokussierte Stresstests mit besonderer Ber√ºcksichtigung gesch√§ftsmodellspezifischer Risikotreiber und Vulnerabilit√§ten, wie etwa Immobilienmarktentwicklungen oder sektorale Wirtschaftseinbr√ºche.\n‚Ä¢ Kleine, regional t√§tige Institute: Vereinfachte Stresstest-Ans√§tze mit Fokus auf lokale Wirtschaftsfaktoren und spezifische regionale Risiken, oft mit st√§rkerer Betonung qualitativer Elemente.\n\nüìä Gesch√§ftsmodellspezifische Risikoschwerpunkte:\n‚Ä¢ Retail-orientierte Gesch√§ftsmodelle: Besondere Beachtung von Zins√§nderungs-, Immobilien- und Konsumkreditrisiken, sowie verhaltensbasierten Faktoren wie Einlagenabz√ºgen oder vorzeitigen Kreditr√ºckzahlungen.\n‚Ä¢ Wholesale- und Investment Banking: Verst√§rkter Fokus auf Marktrisiken, Counterparty Credit Risk, komplexe Derivatebewertungen und Liquidit√§tsrisiken in Stresssituationen.\n‚Ä¢ Asset Management und Depotbanken: Schwerpunkt auf indirekten Risiken wie Reputationsrisiken, operationellen Risiken und Verhaltens√§nderungen institutioneller Anleger in Krisenzeiten.\n‚Ä¢ Hypothekenbanken: Detaillierte Analyse von Immobilienmarktszenarien, regionalen Preiskorrekturen und deren Auswirkungen auf Sicherheitenwerte und Refinanzierungskosten.\n\n‚öñÔ∏è Proportionalit√§tsaspekte in der praktischen Umsetzung:\n‚Ä¢ Modellkomplexit√§t: Anpassung der methodischen Komplexit√§t an die Institutscharakteristika, von fortgeschrittenen statistischen Modellen f√ºr komplexe Institute bis hin zu vereinfachten Ans√§tzen f√ºr kleinere Einheiten.\n‚Ä¢ Szenariovielfalt: Abstufung der Anzahl und Komplexit√§t der zu analysierenden Szenarien, wobei gr√∂√üere Institute ein breiteres Spektrum an Szenarien inklusive komplexer Multi-Faktor-Szenarien abdecken sollten.\n‚Ä¢ Granularit√§t: Anpassung des Detaillierungsgrades der Analyse an die Portfoliokomplexit√§t, von Einzelpositionsebene bei komplexen Instituten bis zu aggregierten Portfoliobetrachtungen bei kleineren Banken.\n‚Ä¢ Durchf√ºhrungsfrequenz: Differenzierung der H√§ufigkeit umfassender Stresstests von quartalsweise bei gro√üen, komplexen Instituten bis zu j√§hrlich bei kleineren Instituten mit einfacheren Risikoprofilen.\n\nüõ†Ô∏è Implementierungsstrategien f√ºr verschiedene Institutstypen:\n‚Ä¢ Verbundl√∂sungen f√ºr kleinere Institute: Nutzung zentraler Ressourcen und Kompetenzen innerhalb von Bankverb√ºnden oder Genossenschaftssektoren zur Entwicklung gemeinsamer Stresstest-Frameworks.\n‚Ä¢ Modulare Ans√§tze f√ºr mittelgro√üe Institute: Entwicklung flexibler, modularer Stresstest-Architekturen, die je nach Bedarf und Ressourcenverf√ºgbarkeit skaliert werden k√∂nnen.\n‚Ä¢ Integrierte Enterprise-L√∂sungen f√ºr komplexe Institute: Implementierung umfassender, integrierter Stresstest-Plattformen, die alle Risikodimensionen und Gesch√§ftsbereiche abdecken und in die strategische Steuerung eingebunden sind.\n‚Ä¢ Hybride Modellans√§tze: Kombination quantitativer und qualitativer Elemente in einem ausgewogenen Mix, der an die jeweiligen Ressourcen, Datenlagen und Risikoprofile angepasst ist."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Welche Best Practices haben sich f√ºr die erfolgreiche Validierung von Stresstest-Modellen und -Ergebnissen etabliert?",
        answer: "Die Validierung von Stresstest-Modellen und -Ergebnissen ist ein kritischer Erfolgsfaktor f√ºr glaubw√ºrdige und entscheidungsrelevante Stresstests. Eine robuste Validierung st√§rkt das Vertrauen in die Ergebnisse, identifiziert Verbesserungspotenziale und erf√ºllt aufsichtliche Anforderungen. Etablierte Best Practices kombinieren quantitative Techniken mit qualitativen Beurteilungen in einem strukturierten Rahmenwerk.\n\nüîç Grundprinzipien der Stresstest-Validierung:\n‚Ä¢ Unabh√§ngigkeit: Durchf√ºhrung der Validierung durch ein von der Modellentwicklung und -anwendung unabh√§ngiges Team, um Objektivit√§t und kritische Distanz zu gew√§hrleisten.\n‚Ä¢ Proportionalit√§t: Anpassung des Validierungsumfangs und der -tiefe an die Komplexit√§t, Materialit√§t und das inh√§rente Risiko der Stresstest-Modelle und -Annahmen.\n‚Ä¢ Ganzheitlichkeit: Umfassende Betrachtung aller Komponenten des Stresstest-Frameworks, von den Szenarien √ºber die Modelle bis hin zu den Interpretationen und abgeleiteten Ma√ünahmen.\n‚Ä¢ Kontinuit√§t: Gestaltung der Validierung als kontinuierlichen Prozess statt als einmalige √úbung, mit regelm√§√üigen √úberpr√ºfungen und anlassbezogenen Tiefenanalysen.\n\n‚öôÔ∏è Methodische Validierungsans√§tze:\n‚Ä¢ Backtesting: Vergleich der Modellprognosen mit tats√§chlichen historischen Ergebnissen unter Stressbedingungen, soweit entsprechende Daten verf√ºgbar sind.\n‚Ä¢ Benchmarking: Vergleich der Modelle und Ergebnisse mit alternativen Ans√§tzen, Industriestandards oder Peer-Group-Ergebnissen.\n‚Ä¢ Sensitivit√§tsanalysen: Systematische Variation von Modellparametern und Annahmen zur Bewertung der Robustheit und Identifikation kritischer Einflussfaktoren.\n‚Ä¢ Out-of-Sample-Tests: Anwendung der Modelle auf Datens√§tze, die nicht f√ºr die Kalibrierung verwendet wurden, um √úberanpassung zu identifizieren.\n\nüìã Validierungsdimensionen und Pr√ºfkriterien:\n‚Ä¢ Konzeptionelle Solidit√§t: Beurteilung der theoretischen Fundierung, der Modellauswahl und der Angemessenheit der gew√§hlten Methoden f√ºr den jeweiligen Risikobereich.\n‚Ä¢ Datenqualit√§t und -angemessenheit: √úberpr√ºfung der Qualit√§t, Vollst√§ndigkeit und Repr√§sentativit√§t der verwendeten Daten sowie der Behandlung von Datenl√ºcken.\n‚Ä¢ Implementierungsgenauigkeit: Verifizierung der korrekten technischen Umsetzung der Modelle in IT-Systemen, inklusive Code-Reviews und reproduzierbarer Testf√§lle.\n‚Ä¢ Kalibrierung und Parametrisierung: Beurteilung der Angemessenheit der Modellparameter und ihrer Ableitung aus historischen Daten oder Expertensch√§tzungen.\n\nüìù Dokumentationsstandards und Berichterstattung:\n‚Ä¢ Methodendokumentation: Detaillierte Beschreibung aller verwendeten Modelle, Annahmen, Parameter und deren Herleitung in einer nachvollziehbaren Form.\n‚Ä¢ Validierungsberichte: Erstellung strukturierter Berichte mit klaren Schlussfolgerungen, identifizierten Schwachstellen und konkreten Empfehlungen zur Modellverbesserung.\n‚Ä¢ Entscheidungspfade: Dokumentation der Entscheidungsprozesse bei der Modellentwicklung und -validierung, inklusive verworfener Alternativen und deren Begr√ºndung.\n‚Ä¢ Ma√ünahmen-Tracking: Systematische Verfolgung der Umsetzung von Verbesserungsma√ünahmen, die aus der Validierung abgeleitet wurden.\n\nüë• Governance-Aspekte der Validierung:\n‚Ä¢ Rollenklarheit: Eindeutige Definition der Rollen und Verantwortlichkeiten im Validierungsprozess, von der operativen Durchf√ºhrung bis zur Managementeinbindung.\n‚Ä¢ Eskalationsprozesse: Etablierung klarer Prozesse f√ºr den Umgang mit kritischen Validierungsergebnissen und deren Eskalation an die zust√§ndigen Entscheidungsgremien.\n‚Ä¢ Qualifikationssicherung: Gew√§hrleistung ausreichender fachlicher Expertise im Validierungsteam durch gezielte Rekrutierung und kontinuierliche Weiterbildung.\n‚Ä¢ Aufsichtlicher Dialog: Proaktive Kommunikation mit Aufsichtsbeh√∂rden √ºber den Validierungsansatz und die Adressierung identifizierter Schwachstellen."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs (German) to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 4 (German) added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
