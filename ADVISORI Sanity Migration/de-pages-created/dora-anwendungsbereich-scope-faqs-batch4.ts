import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA Anwendungsbereich page with FAQ batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-anwendungsbereich-scope' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-anwendungsbereich-scope" not found')
    }
    
    // Create new FAQs for implementation timelines and scope phases
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 13),
        question: 'Welche zeitlichen Phasen und Meilensteine sind bei der DORA-Scope-Implementierung zu beachten?',
        answer: "Die DORA-Implementierung folgt einem strukturierten zeitlichen Rahmen mit spezifischen Meilensteinen und Phasen. Eine strategische Planung dieser Zeitlinien ist entscheidend f√ºr eine erfolgreiche und rechtzeitige Compliance-Umsetzung, die sowohl regulatorische Anforderungen erf√ºllt als auch operative Effizienz gew√§hrleistet.\n\nüìÖ Kritische DORA-Zeitlinien und Meilensteine:\n‚Ä¢ Januar 2025: Vollst√§ndige Anwendbarkeit von DORA f√ºr alle erfassten Finanzinstitute\n‚Ä¢ Laufende Fristen f√ºr Incident-Reporting: Sofortige Meldung kritischer IKT-Incidents innerhalb von vier Stunden\n‚Ä¢ J√§hrliche Penetrationstests f√ºr bedeutende Finanzinstitute ab dem ersten vollst√§ndigen Kalenderjahr\n‚Ä¢ Kontinuierliche √úberwachung und Bewertung kritischer IKT-Drittanbieter-Arrangements\n‚Ä¢ Regelm√§√üige √úberpr√ºfung und Aktualisierung der IKT-Risikomanagement-Frameworks\n\nüéØ Phasenweise Implementierungsstrategie:\n‚Ä¢ Phase 1 - Scope-Assessment und Gap-Analyse: Umfassende Bewertung der aktuellen Position und Identifikation aller DORA-relevanten Entit√§ten und Services\n‚Ä¢ Phase 2 - Framework-Entwicklung: Aufbau der erforderlichen Governance-Strukturen, Policies und Prozeduren\n‚Ä¢ Phase 3 - Systemimplementierung: Technische Umsetzung von Monitoring-, Reporting- und Kontrollsystemen\n‚Ä¢ Phase 4 - Testing und Validierung: Durchf√ºhrung umfassender Tests aller implementierten Systeme und Prozesse\n‚Ä¢ Phase 5 - Go-Live und kontinuierliche Optimierung: Vollst√§ndige Aktivierung und laufende Verbesserung der DORA-Compliance\n\n‚è∞ Kritische Vorlaufzeiten und Planungs√ºberlegungen:\n‚Ä¢ Drittanbieter-Vertragsanpassungen k√∂nnen sechs bis zw√∂lf Monate Vorlaufzeit erfordern\n‚Ä¢ Systemimplementierungen und -integrationen ben√∂tigen typischerweise drei bis neun Monate\n‚Ä¢ Personalschulung und Change-Management sollten mindestens drei Monate vor Go-Live beginnen\n‚Ä¢ Penetrationstest-Programme erfordern mehrere Monate Vorbereitung und Koordination\n‚Ä¢ Incident-Response-Prozesse m√ºssen vor der vollst√§ndigen DORA-Anwendbarkeit vollst√§ndig operativ sein\n\nüìä Priorisierung und Ressourcenallokation:\n‚Ä¢ Kritische IKT-Services und -Systeme sollten h√∂chste Priorit√§t in der Implementierungsreihenfolge erhalten\n‚Ä¢ Drittanbieter-Management-Frameworks m√ºssen fr√ºhzeitig implementiert werden, um Vertragsverhandlungen zu erm√∂glichen\n‚Ä¢ Governance-Strukturen und Berichtswege sollten zu den ersten implementierten Elementen geh√∂ren\n‚Ä¢ Monitoring- und √úberwachungssysteme erfordern ausreichende Testzeit vor der produktiven Nutzung\n‚Ä¢ Kontinuierliche Schulung und Awareness-Programme sollten parallel zu allen anderen Implementierungsphasen laufen\n\nüîÑ Kontinuierliche Compliance und Anpassung:\n‚Ä¢ Etablierung regelm√§√üiger Review-Zyklen zur Bewertung der Scope-Aktualit√§t und -Vollst√§ndigkeit\n‚Ä¢ Implementierung von Change-Management-Prozessen f√ºr Gesch√§fts- und System√§nderungen\n‚Ä¢ Entwicklung von Mechanismen zur schnellen Anpassung an regulatorische Updates und Guidance\n‚Ä¢ Aufbau von Kapazit√§ten f√ºr kontinuierliche Verbesserung und Optimierung der DORA-Compliance\n‚Ä¢ Integration von DORA-Compliance in die regul√§ren Gesch√§fts- und Risikomanagement-Zyklen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 14),
        question: 'Wie entwickle ich eine effektive Roadmap f√ºr die schrittweise Erweiterung meines DORA-Scope-Managements?',
        answer: "Eine strategische Roadmap f√ºr die schrittweise Erweiterung des DORA-Scope-Managements erm√∂glicht es Organisationen, ihre Compliance-F√§higkeiten systematisch aufzubauen und gleichzeitig operative Kontinuit√§t zu gew√§hrleisten. Diese Roadmap sollte sowohl kurzfristige Compliance-Ziele als auch langfristige strategische Verbesserungen ber√ºcksichtigen.\n\nüó∫Ô∏è Strategische Roadmap-Entwicklung:\n‚Ä¢ Baseline-Assessment: Umfassende Bewertung der aktuellen IKT-Risikomanagement-F√§higkeiten und Identifikation von Ausgangspunkten\n‚Ä¢ Zielzustand-Definition: Klare Artikulation der gew√ºnschten DORA-Compliance-Position und strategischen Ziele\n‚Ä¢ Gap-Analyse und Priorisierung: Systematische Identifikation von L√ºcken und deren Priorisierung basierend auf Risiko und Gesch√§ftsauswirkungen\n‚Ä¢ Meilenstein-Planung: Definition spezifischer, messbarer Zwischenziele mit klaren Zeitrahmen und Erfolgskriterien\n‚Ä¢ Ressourcen- und Budgetplanung: Realistische Einsch√§tzung der erforderlichen Investitionen und Kapazit√§ten\n\nüìà Schrittweise Erweiterungsstrategie:\n‚Ä¢ Stufe 1 - Grundlagen: Etablierung grundlegender Governance-Strukturen und kritischer Compliance-Prozesse\n‚Ä¢ Stufe 2 - Kernfunktionen: Implementierung umfassender Drittanbieter-Management und Incident-Response-F√§higkeiten\n‚Ä¢ Stufe 3 - Erweiterte Funktionen: Aufbau fortgeschrittener Monitoring-, Analytics- und Automatisierungsf√§higkeiten\n‚Ä¢ Stufe 4 - Optimierung: Kontinuierliche Verbesserung und Integration mit strategischen Gesch√§ftszielen\n‚Ä¢ Stufe 5 - Innovation: Nutzung von DORA-Compliance als Wettbewerbsvorteil und Enabler f√ºr digitale Transformation\n\nüéØ Kritische Erfolgsfaktoren:\n‚Ä¢ Starke F√ºhrungsunterst√ºtzung und klare Verantwortlichkeiten auf allen Organisationsebenen\n‚Ä¢ Angemessene Ressourcenallokation und realistische Zeitplanung f√ºr alle Implementierungsphasen\n‚Ä¢ Effektive Change-Management-Strategien zur Sicherstellung der Organisationsakzeptanz\n‚Ä¢ Kontinuierliche Kommunikation und Stakeholder-Engagement w√§hrend des gesamten Implementierungsprozesses\n‚Ä¢ Flexibilit√§t zur Anpassung der Roadmap basierend auf sich √§ndernden Anforderungen und Erkenntnissen\n\nüîß Technologie- und Systemintegration:\n‚Ä¢ Bewertung bestehender Technologie-Infrastruktur und deren DORA-Compliance-F√§higkeiten\n‚Ä¢ Entwicklung einer Technologie-Roadmap, die sowohl kurzfristige Compliance als auch langfristige strategische Ziele unterst√ºtzt\n‚Ä¢ Integration von DORA-Anforderungen in bestehende IT-Governance und -Architektur-Frameworks\n‚Ä¢ Implementierung von Automatisierung und Analytics zur Verbesserung der Effizienz und Effektivit√§t\n‚Ä¢ Aufbau von F√§higkeiten f√ºr kontinuierliche Technologie-Evolution und -Anpassung\n\nüìä Monitoring und Anpassung:\n‚Ä¢ Etablierung von KPIs und Metriken zur √úberwachung des Roadmap-Fortschritts\n‚Ä¢ Regelm√§√üige Review-Zyklen zur Bewertung der Roadmap-Effektivit√§t und -Relevanz\n‚Ä¢ Implementierung von Feedback-Mechanismen zur kontinuierlichen Verbesserung\n‚Ä¢ Anpassung der Roadmap basierend auf regulatorischen Entwicklungen und Branchentrends\n‚Ä¢ Integration von Lessons Learned und Best Practices in zuk√ºnftige Planungszyklen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 15),
        question: 'Welche Rolle spielt die Proportionalit√§t bei der DORA-Scope-Bestimmung und wie nutze ich sie strategisch?',
        answer: "Das Proportionalit√§tsprinzip ist ein zentraler Aspekt von DORA, der es Finanzinstituten erm√∂glicht, ihre Compliance-Ans√§tze an ihre spezifische Gr√∂√üe, Komplexit√§t und ihr Risikoprofil anzupassen. Die strategische Nutzung dieses Prinzips kann erhebliche Effizienzgewinne erm√∂glichen, ohne die Compliance-Qualit√§t zu beeintr√§chtigen.\n\n‚öñÔ∏è Grundlagen des Proportionalit√§tsprinzips:\n‚Ä¢ DORA erkennt an, dass unterschiedliche Finanzinstitute verschiedene Risikoprofile und operative Komplexit√§ten aufweisen\n‚Ä¢ Kleinere und weniger komplexe Institute k√∂nnen vereinfachte Ans√§tze f√ºr bestimmte DORA-Anforderungen verwenden\n‚Ä¢ Die Proportionalit√§t bezieht sich sowohl auf die Intensit√§t als auch auf die Sophistication der implementierten Ma√ünahmen\n‚Ä¢ Das Prinzip gilt f√ºr alle DORA-S√§ulen: IKT-Risikomanagement, Incident-Reporting, Resilienz-Testing und Drittanbieter-Management\n‚Ä¢ Proportionalit√§t bedeutet nicht Befreiung von Anforderungen, sondern angemessene Anpassung der Umsetzung\n\nüìä Faktoren f√ºr Proportionalit√§tsbewertung:\n‚Ä¢ Gr√∂√üe des Instituts: Bilanzsumme, Anzahl der Mitarbeiter, Kundenanzahl und geografische Pr√§senz\n‚Ä¢ Komplexit√§t der Gesch√§ftst√§tigkeiten: Anzahl und Art der angebotenen Services, Technologie-Sophistication und Marktposition\n‚Ä¢ Risikoprofil: Abh√§ngigkeit von IKT-Systemen, Kritikalit√§t f√ºr das Finanzsystem und historische Incident-H√§ufigkeit\n‚Ä¢ Systemrelevanz: Bedeutung f√ºr die Finanzstabilit√§t und Interconnectedness mit anderen Finanzinstituten\n‚Ä¢ Regulatorische Klassifizierung: Bestehende Kategorisierungen unter anderen EU-Regulierungen\n\nüéØ Strategische Anwendung der Proportionalit√§t:\n‚Ä¢ Risikobasierte Priorisierung: Fokussierung der Ressourcen auf die kritischsten Risiken und Services\n‚Ä¢ Phasenweise Implementierung: Schrittweiser Aufbau von F√§higkeiten entsprechend der Organisationsentwicklung\n‚Ä¢ Kostenoptimierung: Vermeidung von Over-Engineering bei gleichzeitiger Sicherstellung angemessener Kontrollen\n‚Ä¢ Flexibilit√§t f√ºr Wachstum: Entwicklung skalierbarer L√∂sungen, die mit der Organisationsentwicklung mitwachsen k√∂nnen\n‚Ä¢ Wettbewerbsvorteile: Nutzung effizienter Compliance-Ans√§tze als Differenzierungsmerkmal\n\nüîß Praktische Umsetzungsstrategien:\n‚Ä¢ Entwicklung ma√ügeschneiderter Frameworks, die sowohl Compliance als auch operative Effizienz gew√§hrleisten\n‚Ä¢ Nutzung von Branchenstandards und Best Practices als Ausgangspunkt f√ºr proportionale Anpassungen\n‚Ä¢ Implementierung von Automatisierung zur Reduzierung des manuellen Aufwands bei kleineren Instituten\n‚Ä¢ Aufbau von Kooperationen und Shared-Service-Modellen zur Kostenverteilung\n‚Ä¢ Kontinuierliche Bewertung und Anpassung der Proportionalit√§tsans√§tze basierend auf Organisationsentwicklung\n\nüìã Dokumentation und Rechtfertigung:\n‚Ä¢ Klare Dokumentation der Proportionalit√§tsentscheidungen und deren Begr√ºndung\n‚Ä¢ Regelm√§√üige √úberpr√ºfung der Angemessenheit der gew√§hlten Ans√§tze\n‚Ä¢ Nachweis der Wirksamkeit proportionaler Ma√ünahmen durch Monitoring und Testing\n‚Ä¢ Vorbereitung auf Aufsichtsdialoge √ºber Proportionalit√§tsentscheidungen\n‚Ä¢ Integration von Proportionalit√§ts√ºberlegungen in die Governance- und Risikomanagement-Frameworks"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 16),
        question: 'Wie bereite ich meine Organisation auf zuk√ºnftige Erweiterungen des DORA-Scope vor?',
        answer: "Die Vorbereitung auf zuk√ºnftige Erweiterungen des DORA-Scope erfordert eine vorausschauende Strategie, die sowohl regulatorische Entwicklungen als auch technologische und gesch√§ftliche Ver√§nderungen ber√ºcksichtigt. Eine adaptive und zukunftsorientierte Herangehensweise kann Organisationen dabei helfen, proaktiv auf Scope-Erweiterungen zu reagieren.\n\nüîÆ Antizipation regulatorischer Entwicklungen:\n‚Ä¢ Kontinuierliche √úberwachung der Aktivit√§ten europ√§ischer Aufsichtsbeh√∂rden und deren Guidance-Entwicklung\n‚Ä¢ Analyse von Konsultationspapieren und Entw√ºrfen f√ºr potenzielle Scope-Erweiterungen\n‚Ä¢ Teilnahme an Branchendialogen und regulatorischen Konsultationsprozessen\n‚Ä¢ Bewertung der Auswirkungen verwandter Regulierungen wie NIS2, AI Act und Digital Services Act\n‚Ä¢ Monitoring internationaler regulatorischer Trends, die EU-Entwicklungen beeinflussen k√∂nnten\n\nüèóÔ∏è Aufbau adaptiver Compliance-Infrastrukturen:\n‚Ä¢ Entwicklung modularer und skalierbarer Compliance-Frameworks, die leicht erweitert werden k√∂nnen\n‚Ä¢ Implementierung flexibler Technologie-Architekturen, die neue Anforderungen schnell integrieren k√∂nnen\n‚Ä¢ Aufbau von Governance-Strukturen, die sowohl aktuelle als auch zuk√ºnftige Scope-Bereiche abdecken k√∂nnen\n‚Ä¢ Etablierung von Change-Management-Prozessen f√ºr schnelle Anpassungen an neue Anforderungen\n‚Ä¢ Entwicklung von Scenario-Planning-F√§higkeiten f√ºr verschiedene Scope-Erweiterungs-Szenarien\n\nüìà Strategische Kapazit√§tsentwicklung:\n‚Ä¢ Aufbau interner Expertise in emerging Technologies und deren regulatorischen Implikationen\n‚Ä¢ Entwicklung von Partnerschaften mit Technologie-Anbietern und Beratungsunternehmen\n‚Ä¢ Investition in Schulung und Entwicklung von Compliance- und Risikomanagement-Teams\n‚Ä¢ Etablierung von Innovation Labs oder Centers of Excellence f√ºr regulatorische Technologie\n‚Ä¢ Aufbau von Netzwerken mit anderen Finanzinstituten f√ºr Wissensaustausch und Kollaboration\n\nüîß Technologische Vorbereitung:\n‚Ä¢ Implementierung von RegTech-L√∂sungen, die automatische Updates und Erweiterungen unterst√ºtzen\n‚Ä¢ Aufbau von Data-Analytics-F√§higkeiten zur schnellen Bewertung neuer Scope-Bereiche\n‚Ä¢ Entwicklung von API-basierten Architekturen f√ºr einfache Integration neuer Compliance-Module\n‚Ä¢ Investition in Cloud-basierte L√∂sungen f√ºr Skalierbarkeit und Flexibilit√§t\n‚Ä¢ Etablierung von DevOps-Praktiken f√ºr schnelle Deployment neuer Compliance-Features\n\nü§ù Stakeholder-Engagement und Kommunikation:\n‚Ä¢ Aufbau proaktiver Beziehungen zu Aufsichtsbeh√∂rden f√ºr fr√ºhzeitige Einblicke in regulatorische Entwicklungen\n‚Ä¢ Engagement in Branchenverb√§nden und Working Groups zu DORA-Entwicklungen\n‚Ä¢ Etablierung regelm√§√üiger Kommunikation mit kritischen Drittanbietern √ºber potenzielle Scope-√Ñnderungen\n‚Ä¢ Entwicklung von Kommunikationsstrategien f√ºr interne Stakeholder bei Scope-Erweiterungen\n‚Ä¢ Aufbau von Expertise in regulatorischem Lobbying und Policy-Entwicklung\n\nüìä Kontinuierliches Monitoring und Assessment:\n‚Ä¢ Implementierung von Fr√ºhwarnsystemen f√ºr regulatorische √Ñnderungen und deren Auswirkungen\n‚Ä¢ Regelm√§√üige Bewertung der Scope-Readiness und Identifikation von Verbesserungsbereichen\n‚Ä¢ Entwicklung von Stress-Testing-Szenarien f√ºr verschiedene Scope-Erweiterungs-M√∂glichkeiten\n‚Ä¢ Etablierung von Feedback-Loops aus operativen Erfahrungen f√ºr kontinuierliche Verbesserung\n‚Ä¢ Integration von Scope-Vorbereitung in strategische Planungs- und Budgetierungsprozesse"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
