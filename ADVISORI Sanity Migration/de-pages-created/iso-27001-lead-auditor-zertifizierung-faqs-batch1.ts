import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Lead Auditor Zertifizierung page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-lead-auditor-zertifizierung' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-lead-auditor-zertifizierung" not found')
    }
    
    // Create new FAQs for ISO 27001 Lead Auditor certification fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was sind die wesentlichen Voraussetzungen und Qualifikationen f√ºr eine erfolgreiche ISO 27001 Lead Auditor Zertifizierung?',
        answer: "Die ISO 27001 Lead Auditor Zertifizierung erfordert eine systematische Vorbereitung und spezifische Qualifikationen, die √ºber grundlegende Informationssicherheitskenntnisse hinausgehen. Eine erfolgreiche Zertifizierung baut auf einer soliden Grundlage aus technischem Verst√§ndnis, praktischer Erfahrung und professionellen Kompetenzen auf, die f√ºr die Durchf√ºhrung glaubw√ºrdiger und wertsch√∂pfender Audits erforderlich sind.\n\nüéì Bildungsvoraussetzungen und Fachkenntnisse:\n‚Ä¢ Abgeschlossene Hochschulausbildung in relevanten Bereichen wie Informatik, Wirtschaftsinformatik, Betriebswirtschaft oder vergleichbare Qualifikationen durch umfassende Berufserfahrung\n‚Ä¢ Fundierte Kenntnisse der ISO 27001 Anforderungen und des Informationssicherheits-Managementsystem-Frameworks\n‚Ä¢ Verst√§ndnis von Risikomanagement-Prinzipien und deren praktische Anwendung in organisatorischen Kontexten\n‚Ä¢ Grundlegendes Wissen √ºber Audit-Prinzipien nach ISO 19011 und Qualit√§tsmanagement-Systeme\n‚Ä¢ Kenntnisse relevanter regulatorischer Frameworks wie GDPR, DORA, NIS2 und branchenspezifischer Compliance-Anforderungen\n\nüíº Berufserfahrung und praktische Kompetenz:\n‚Ä¢ Mindestens drei Jahre Berufserfahrung in informationssicherheitsrelevanten Bereichen oder verwandten Disziplinen wie IT-Audit, Compliance oder Risikomanagement\n‚Ä¢ Nachweisbare Erfahrung in der Implementierung oder Bewertung von Managementsystemen, vorzugsweise im Bereich Informationssicherheit\n‚Ä¢ Praktische Kenntnisse in der Durchf√ºhrung von Assessments, Bewertungen oder internen Audits\n‚Ä¢ Erfahrung in Projektmanagement und der Leitung von Teams oder Arbeitsgruppen\n‚Ä¢ Verst√§ndnis f√ºr organisatorische Strukturen und Gesch√§ftsprozesse in verschiedenen Branchen und Unternehmensgr√∂√üen\n\nüîç Pers√∂nliche und professionelle Eigenschaften:\n‚Ä¢ Ausgepr√§gte analytische F√§higkeiten und systematisches Denkverm√∂gen f√ºr die Bewertung komplexer Informationssicherheits-Architekturen\n‚Ä¢ Exzellente Kommunikationsf√§higkeiten f√ºr die Interaktion mit verschiedenen Stakeholder-Gruppen von technischen Experten bis hin zu F√ºhrungskr√§ften\n‚Ä¢ Hohe Integrit√§t und Objektivit√§t f√ºr die unabh√§ngige Bewertung von Managementsystemen\n‚Ä¢ Kulturelle Sensibilit√§t und Anpassungsf√§higkeit f√ºr Audits in verschiedenen organisatorischen und geografischen Kontexten\n‚Ä¢ Kontinuierliche Lernbereitschaft zur Anpassung an sich entwickelnde Bedrohungslandschaften und regulatorische Anforderungen\n\nüìö Vorbereitende Ausbildung und Zertifizierungen:\n‚Ä¢ Erfolgreiche Teilnahme an akkreditierten ISO 27001 Lead Auditor Trainingsprogrammen mit praktischen √úbungen und Simulationen\n‚Ä¢ Empfohlene Zusatzzertifizierungen wie CISSP, CISM, CRISC oder vergleichbare Qualifikationen im Bereich Informationssicherheit\n‚Ä¢ Teilnahme an Continuing Professional Development Programmen zur Aufrechterhaltung aktueller Kenntnisse\n‚Ä¢ Praktische Erfahrung durch Teilnahme an Audits als Beobachter oder Junior-Auditor unter Anleitung erfahrener Lead Auditoren\n‚Ä¢ Vertiefende Kenntnisse in spezialisierten Bereichen wie Cloud Security, Industrial Control Systems oder Emerging Technologies je nach Spezialisierungsrichtung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie unterscheidet sich die Lead Auditor Zertifizierung von anderen ISO 27001 Qualifikationen und welche Karrierem√∂glichkeiten er√∂ffnet sie?',
        answer: "Die ISO 27001 Lead Auditor Zertifizierung repr√§sentiert die h√∂chste Stufe der professionellen Qualifikation im Bereich ISO 27001 Auditing und unterscheidet sich fundamental von anderen Zertifizierungen durch ihren Fokus auf F√ºhrungsverantwortung, strategische Bewertung und die F√§higkeit zur unabh√§ngigen Leitung komplexer Audit-Projekte. Diese Qualifikation positioniert Inhaber als anerkannte Experten mit umfassenden Karrierem√∂glichkeiten.\n\nüéØ Abgrenzung zu anderen ISO 27001 Qualifikationen:\n‚Ä¢ Lead Auditor Zertifizierung bef√§higt zur eigenst√§ndigen Leitung von Zertifizierungs- und √úberwachungsaudits, w√§hrend Internal Auditor Qualifikationen auf organisationsinterne Bewertungen beschr√§nkt sind\n‚Ä¢ Umfasst erweiterte Kompetenzen in Audit-Team-Management, Stakeholder-Kommunikation und strategischer Bewertung von Managementsystemen\n‚Ä¢ Erfordert nachgewiesene F√§higkeiten in der Bewertung von Managementsystem-Effektivit√§t auf organisatorischer Ebene, nicht nur technischer Kontrollen\n‚Ä¢ Beinhaltet Verantwortung f√ºr Audit-Qualit√§t, Berichterstattung an Zertifizierungsstellen und Entscheidungsfindung bez√ºglich Zertifizierungsempfehlungen\n‚Ä¢ Qualifiziert f√ºr die Durchf√ºhrung von Multi-Site-Audits und komplexen organisatorischen Bewertungen mit verschiedenen Gesch√§ftsbereichen\n\nüöÄ Karrierem√∂glichkeiten in der Beratungsbranche:\n‚Ä¢ Lead Consultant Positionen bei renommierten Beratungsunternehmen mit Fokus auf Informationssicherheit und Compliance\n‚Ä¢ Spezialisierung auf bestimmte Branchen wie Finanzdienstleistungen, Gesundheitswesen, kritische Infrastrukturen oder Technologieunternehmen\n‚Ä¢ Entwicklung von Expertise in emerging Technologies wie Cloud Computing, IoT, Artificial Intelligence und deren Sicherheitsimplikationen\n‚Ä¢ Aufbau eigener Beratungspraxis oder Partnerschaft in etablierten Consulting-Firmen\n‚Ä¢ Internationale Karrierem√∂glichkeiten durch anerkannte Qualifikation in globalen M√§rkten\n\nüè¢ F√ºhrungspositionen in Unternehmen:\n‚Ä¢ Chief Information Security Officer oder Information Security Manager Rollen mit strategischer Verantwortung\n‚Ä¢ Compliance Officer Positionen mit Fokus auf regulatorische Anforderungen und Audit-Koordination\n‚Ä¢ Risk Management F√ºhrungsrollen mit Verantwortung f√ºr Enterprise Risk Assessment und Mitigation\n‚Ä¢ Quality Assurance und Governance Positionen mit Oversight-Verantwortung f√ºr Managementsysteme\n‚Ä¢ Business Continuity und Crisis Management F√ºhrungsrollen in kritischen Infrastrukturen\n\nüéì Akademische und Trainingskarrieren:\n‚Ä¢ Entwicklung und Durchf√ºhrung von ISO 27001 Trainingsprogrammen f√ºr Bildungseinrichtungen und Trainingsanbieter\n‚Ä¢ Gastdozenturen an Universit√§ten und Fachhochschulen f√ºr Informationssicherheit und Compliance\n‚Ä¢ Entwicklung von Curriculum und Lernmaterialien f√ºr professionelle Zertifizierungsprogramme\n‚Ä¢ Mentoring und Coaching von Junior-Auditoren und Nachwuchskr√§ften in der Informationssicherheit\n‚Ä¢ Thought Leadership durch Publikationen, Konferenzbeitr√§ge und Forschungsaktivit√§ten\n\nüí∞ Verdienstm√∂glichkeiten und Marktposition:\n‚Ä¢ √úberdurchschnittliche Verg√ºtung aufgrund der hohen Nachfrage nach qualifizierten Lead Auditoren\n‚Ä¢ M√∂glichkeiten f√ºr projektbasierte Arbeit mit attraktiven Tagess√§tzen in der freiberuflichen Beratung\n‚Ä¢ Internationale Eins√§tze mit entsprechenden Zulagen und Karriereentwicklungsm√∂glichkeiten\n‚Ä¢ Langfristige Karrieresicherheit durch kontinuierlich wachsende Bedeutung von Informationssicherheit und Compliance\n‚Ä¢ Potenzial f√ºr Equity-Beteiligungen bei Beratungsunternehmen oder eigenen Unternehmensgr√ºndungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche praktischen Audit-F√§higkeiten und Methodologien werden in der Lead Auditor Ausbildung vermittelt und wie werden diese angewendet?',
        answer: "Die Lead Auditor Ausbildung entwickelt umfassende praktische Kompetenzen, die weit √ºber theoretisches Wissen hinausgehen und Auditoren bef√§higen, komplexe Informationssicherheits-Managementsysteme systematisch und effektiv zu bewerten. Der Fokus liegt auf der Entwicklung von Audit-Urteilsverm√∂gen, methodischer Herangehensweise und der F√§higkeit zur F√ºhrung erfolgreicher Audit-Teams in verschiedenen organisatorischen Kontexten.\n\nüîç Systematische Audit-Planung und Vorbereitung:\n‚Ä¢ Entwicklung risiko-basierter Audit-Strategien durch Analyse organisatorischer Kontexte, Gesch√§ftsmodelle und spezifischer Bedrohungslandschaften\n‚Ä¢ Erstellung detaillierter Audit-Pl√§ne mit angemessener Ressourcenallokation, Zeitplanung und Stakeholder-Koordination\n‚Ä¢ Durchf√ºhrung umfassender Dokumentenreviews zur Bewertung von Richtlinien, Verfahren und Managementsystem-Dokumentation\n‚Ä¢ Entwicklung ma√ügeschneiderter Audit-Checklisten und Bewertungskriterien basierend auf organisatorischen Besonderheiten\n‚Ä¢ Koordination mit Auditees zur Sicherstellung optimaler Audit-Bedingungen und Minimierung von Gesch√§ftsst√∂rungen\n\nüéØ Fortgeschrittene Interview- und Bewertungstechniken:\n‚Ä¢ Anwendung strukturierter Interview-Methodologien zur Erhebung objektiver Evidenz von verschiedenen Stakeholder-Gruppen\n‚Ä¢ Entwicklung von Fragetechniken, die sowohl Compliance-Aspekte als auch Managementsystem-Effektivit√§t bewerten\n‚Ä¢ Durchf√ºhrung von Beobachtungen und Walkthroughs zur Validierung dokumentierter Prozesse und Kontrollen\n‚Ä¢ Anwendung von Sampling-Techniken zur effizienten Bewertung gro√üer Datenmengen und komplexer Systeme\n‚Ä¢ Integration von technischen Assessments mit organisatorischen Bewertungen f√ºr ganzheitliche Audit-Ergebnisse\n\nüìä Evidenz-Management und Dokumentation:\n‚Ä¢ Systematische Sammlung, Bewertung und Dokumentation von Audit-Evidenz nach anerkannten Standards\n‚Ä¢ Entwicklung von Audit-Trails, die nachvollziehbare Verbindungen zwischen Befunden und zugrunde liegenden Evidenzen schaffen\n‚Ä¢ Anwendung von Bewertungskriterien zur objektiven Klassifizierung von Nonkonformit√§ten und Verbesserungsm√∂glichkeiten\n‚Ä¢ Erstellung pr√§ziser und actionable Audit-Berichte mit klaren Empfehlungen und Priorit√§ten\n‚Ä¢ Implementierung von Qualit√§tssicherungsverfahren zur Gew√§hrleistung von Audit-Konsistenz und Objektivit√§t\n\nüë• Audit-Team-F√ºhrung und Stakeholder-Management:\n‚Ä¢ Entwicklung von F√ºhrungskompetenzen f√ºr die effektive Leitung multidisziplin√§rer Audit-Teams\n‚Ä¢ Anwendung von Konfliktl√∂sungsstrategien bei unterschiedlichen Meinungen oder Widerstand von Auditees\n‚Ä¢ Koordination komplexer Multi-Site-Audits mit verschiedenen geografischen und kulturellen Kontexten\n‚Ä¢ Kommunikation von Audit-Ergebnissen an verschiedene Zielgruppen von technischen Teams bis hin zu Vorstandsebene\n‚Ä¢ Mentoring und Entwicklung von Junior-Auditoren durch praktische Anleitung und Feedback\n\nüîÑ Kontinuierliche Verbesserung und Follow-up:\n‚Ä¢ Entwicklung von Follow-up-Strategien zur √úberwachung der Implementierung von Korrekturma√ünahmen\n‚Ä¢ Bewertung der Effektivit√§t von Managementsystem-Verbesserungen durch systematische Nachverfolgung\n‚Ä¢ Integration von Lessons Learned in zuk√ºnftige Audit-Ans√§tze und Methodologien\n‚Ä¢ Beitrag zur Weiterentwicklung von Audit-Standards und Best Practices durch praktische Erfahrungen\n‚Ä¢ Aufbau langfristiger Beziehungen mit Auditees zur Unterst√ºtzung kontinuierlicher Compliance und Verbesserung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie bereitet die Ausbildung auf internationale Zertifizierungspr√ºfungen vor und welche Unterst√ºtzung wird w√§hrend des Zertifizierungsprozesses geboten?',
        answer: "Die Vorbereitung auf internationale Lead Auditor Zertifizierungspr√ºfungen erfordert eine systematische und umfassende Herangehensweise, die sowohl theoretisches Wissen als auch praktische Anwendungskompetenzen entwickelt. Unsere Ausbildungsprogramme sind speziell darauf ausgelegt, Kandidaten optimal auf die anspruchsvollen Anforderungen internationaler Zertifizierungsstellen vorzubereiten und w√§hrend des gesamten Prozesses kontinuierliche Unterst√ºtzung zu bieten.\n\nüìö Strukturierte Pr√ºfungsvorbereitung:\n‚Ä¢ Umfassende Abdeckung aller Pr√ºfungsdom√§nen basierend auf aktuellen Zertifizierungsstandards und Lehrpl√§nen internationaler Akkreditierungsstellen\n‚Ä¢ Systematische Durcharbeitung von ISO 19011 Audit-Prinzipien, ISO 27001 Anforderungen und relevanten Compliance-Frameworks\n‚Ä¢ Intensive Bearbeitung von Praxisszenarien und Fallstudien, die typische Pr√ºfungssituationen simulieren\n‚Ä¢ Regelm√§√üige Wissens√ºberpr√ºfungen durch Mock-Exams und Zwischentests zur Identifikation von Wissensl√ºcken\n‚Ä¢ Bereitstellung umfangreicher Lernmaterialien, Referenzdokumente und aktueller Standards f√ºr selbstst√§ndiges Studium\n\nüéØ Praktische Kompetenzentwicklung:\n‚Ä¢ Durchf√ºhrung realistischer Audit-Simulationen, die alle Phasen eines vollst√§ndigen Audit-Zyklus abdecken\n‚Ä¢ Rollenspiele und Szenario-basierte √úbungen zur Entwicklung von Audit-Urteilsverm√∂gen und Entscheidungsfindung\n‚Ä¢ Praktische Anwendung von Audit-Techniken unter Anleitung erfahrener Lead Auditoren\n‚Ä¢ Entwicklung von Kommunikations- und Pr√§sentationsf√§higkeiten durch strukturierte Feedback-Sessions\n‚Ä¢ Training in der Erstellung professioneller Audit-Berichte und Dokumentation nach internationalen Standards\n\nüèÜ Zertifizierungspartner und Akkreditierung:\n‚Ä¢ Zusammenarbeit mit renommierten internationalen Zertifizierungsstellen und Akkreditierungsorganisationen\n‚Ä¢ Direkte Vorbereitung auf Pr√ºfungen f√ºhrender Anbieter wie IRCA, PECB, BSI oder vergleichbarer Organisationen\n‚Ä¢ Bereitstellung aktueller Informationen √ºber Pr√ºfungsformate, Bewertungskriterien und Zertifizierungsanforderungen\n‚Ä¢ Unterst√ºtzung bei der Auswahl der optimalen Zertifizierungsroute basierend auf individuellen Karrierezielen\n‚Ä¢ Koordination von Pr√ºfungsterminen und administrativen Aspekten des Zertifizierungsprozesses\n\nü§ù Kontinuierliche Unterst√ºtzung und Mentoring:\n‚Ä¢ Individuelle Betreuung durch erfahrene Lead Auditoren w√§hrend der gesamten Ausbildungs- und Zertifizierungsphase\n‚Ä¢ Regelm√§√üige Fortschrittsbewertungen und personalisierte Entwicklungspl√§ne zur Optimierung der Lerneffizienz\n‚Ä¢ Zugang zu Expertenberatung bei spezifischen Fragen oder Herausforderungen w√§hrend der Vorbereitung\n‚Ä¢ Peer-Learning-Gruppen und Studienkreise f√ºr kollaboratives Lernen und Erfahrungsaustausch\n‚Ä¢ Post-Training-Support f√ºr Fragen, die nach Abschluss der formalen Ausbildung auftreten\n\nüîÑ Nachzertifizierungs-Unterst√ºtzung:\n‚Ä¢ Unterst√ºtzung bei der Erf√ºllung von Continuing Professional Development Anforderungen\n‚Ä¢ Bereitstellung von Updates zu √Ñnderungen in Standards, Regulierungen und Best Practices\n‚Ä¢ Zugang zu Advanced Training Modulen f√ºr Spezialisierungen und Kompetenz-Erweiterung\n‚Ä¢ Networking-M√∂glichkeiten mit anderen zertifizierten Lead Auditoren und Branchenexperten\n‚Ä¢ Karriereberatung und Unterst√ºtzung bei der Positionierung als Lead Auditor im Markt"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
