import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating BCBS-239 page with C-Level FAQs batch 3 (German)...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'bcbs-239' })
    
    if (!existingDoc) {
      throw new Error('Document "bcbs-239" not found')
    }
    
    // Create new C-Level FAQs in German
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Wie k√∂nnen wir den Spagat zwischen gruppenweiter BCBS-239 Standardisierung und lokalen regulatorischen Besonderheiten in internationalen Bankengruppen meistern?",
        answer: "Die Balance zwischen globaler Harmonisierung und lokaler Compliance stellt eine der gr√∂√üten Herausforderungen bei der BCBS-239 Umsetzung in internationalen Bankengruppen dar. ADVISORI entwickelt ma√ügeschneiderte Governance-Modelle, die konzernweite Effizienz mit der Ber√ºcksichtigung lokaler Besonderheiten vereinen und regulatorische Anforderungen auf allen Ebenen erf√ºllen.\n\nüåç Prinzipien einer effektiven Multi-Jurisdiktions-Governance:\n‚Ä¢ Globale Prinzipien, lokale Umsetzung: Entwicklung eines zweistufigen Governance-Frameworks mit verbindlichen gruppenweiten Prinzipien und Standards f√ºr Datenqualit√§t und -governance, aber flexiblen Implementierungsmodalit√§ten f√ºr lokale Einheiten.\n‚Ä¢ Regulatorische Taxonomie-Abbildung: Systematische Kartierung und Harmonisierung unterschiedlicher regulatorischer Anforderungen (EZB, Fed, FCA, FINMA etc.) in einem integrierten Regulatory Mapping Framework, das Gemeinsamkeiten identifiziert und Widerspr√ºche aufl√∂st.\n‚Ä¢ Modulare Steuerungsstruktur: Schaffung flexibler Governance-Mechanismen, die sowohl der operativen Integration in der Gruppe als auch den lokalen aufsichtsrechtlichen Anforderungen gerecht werden.\n‚Ä¢ Proportionalit√§tsprinzip: Differenzierte Implementierungstiefe in Abh√§ngigkeit von der systemischen Relevanz und Gr√∂√üe der lokalen Einheit bei gleichzeitiger Einhaltung globaler Mindeststandards.\n\nüîÑ Operative Umsetzungsmodelle f√ºr internationale Bankengruppen:\n‚Ä¢ Hub-and-Spoke Data Governance: Zentrale Definition von Datenstandards, Methoden und Tools durch ein Group Data Office, kombiniert mit lokalen Data-Governance-Funktionen, die die Umsetzung und regulatorische Compliance vor Ort sicherstellen.\n‚Ä¢ Federated Data Architecture: Implementation einer f√∂deralen Datenarchitektur, die lokale Datenhoheit mit zentraler Aggregationsf√§higkeit verbindet und dabei regulatorische Datenlokalisierungsanforderungen ber√ºcksichtigt.\n‚Ä¢ Matrix-Verantwortungsmodell: Etablierung einer dualen Berichtsstruktur f√ºr lokale Datenverantwortliche, die sowohl an lokale Gesch√§ftsf√ºhrungen als auch an zentrale Group Data Governance berichten.\n‚Ä¢ Global-Local Alignment Process: Strukturierter Prozess zur Abstimmung und kontinuierlichen Harmonisierung zwischen globalen Standards und lokalen Anforderungen mit klaren Eskalationsmechanismen bei Konflikten.\n\nüõ†Ô∏è Technologische Enabler f√ºr globale Harmonisierung:\n‚Ä¢ Globales Datenlexikon mit lokalen Erweiterungen: Implementierung eines zentralen Business Glossary mit der M√∂glichkeit lokaler Anpassungen und regulatorischer Erweiterungen bei gleichzeitiger Sicherstellung der R√ºckf√ºhrbarkeit auf globale Definitionen.\n‚Ä¢ Multi-jurisdiktionale Lineage-Plattform: Aufbau einer √ºbergreifenden Datenlineage-L√∂sung, die sowohl lokale als auch globale Datenfl√ºsse transparent macht und regulatorische Anforderungen verschiedener Jurisdiktionen nachvollziehbar verkn√ºpft.\n‚Ä¢ Harmonisierte Datenqualit√§tsregeln: Entwicklung einer mehrschichtigen Datenqualit√§tsarchitektur, die globale Regeln mit lokalen Erweiterungen kombiniert und automatisiert √ºberwacht.\n‚Ä¢ Flexible Reporting-Layer: Implementation eines adaptiven Reporting-Frameworks, das unterschiedliche regulatorische Formate aus einer konsolidierten Datenbasis generieren kann."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Wie sieht eine erfolgreiche Zusammenarbeit zwischen Business und IT bei der BCBS-239 Implementierung aus, um Silodenken zu √ºberwinden?",
        answer: "Die erfolgreiche BCBS-239 Implementierung erfordert eine fundamentale Transformation der Zusammenarbeit zwischen Fachbereichen und IT. ADVISORI unterst√ºtzt Finanzinstitute dabei, traditionelle Silos aufzubrechen und eine neue Kultur der kollaborativen Datenverantwortung zu etablieren, die regulatorische Compliance mit operativer Exzellenz verbindet.\n\nü§ù Neue Paradigmen der Business-IT-Kollaboration:\n‚Ä¢ Shared Accountability Model: Etablierung geteilter Verantwortlichkeiten f√ºr Datenqualit√§t und BCBS-239 Compliance zwischen Fachbereichen als Dateneigent√ºmern und IT als technischen Enablern, mit klar definierten Rollen und gemeinsamen KPIs.\n‚Ä¢ Data as a Product, nicht als IT-Asset: Neupositionierung von Risikodaten als strategische Gesch√§ftsprodukte mit definierten Qualit√§tsmerkmalen, Service Levels und Kundensegmenten, f√ºr die Business und IT gemeinsam verantwortlich sind.\n‚Ä¢ DevRegOps als Organisationsprinzip: Integration von Entwicklung, Betrieb und Regulatory Compliance in einem durchg√§ngigen Prozess, der Geschwindigkeit mit regulatorischer Sicherheit verbindet.\n‚Ä¢ Datenzentrisches Operating Model: Transformation des Betriebsmodells weg von funktionalen Silos hin zu datenzentrischen, cross-funktionalen Teams mit End-to-End-Verantwortung f√ºr Risikodatenprodukte.\n\nüîÑ Organisatorische Br√ºckenstrukturen:\n‚Ä¢ Data Product Owner als Schl√ºsselrolle: Etablierung einer neuen Hybrid-Rolle an der Schnittstelle von Business und IT, die sowohl tiefes Fachverst√§ndnis als auch technisches Know-how verbindet und die End-to-End-Qualit√§t von Risikodatenprodukten verantwortet.\n‚Ä¢ Federated Center of Excellence: Aufbau eines verteilten BCBS-239 Kompetenzzentrums mit Vertretern aus Business und IT, das Standards entwickelt, Best Practices verbreitet und als Katalysator f√ºr die organisatorische Transformation wirkt.\n‚Ä¢ Collaborative Governance Boards: Implementierung gemeinsamer Governance-Gremien, in denen Business und IT auf Augenh√∂he √ºber Datenstandards, -prozesse und -architekturen entscheiden.\n‚Ä¢ Cross-functional Squads: Bildung permanenter oder tempor√§rer cross-funktionaler Teams f√ºr spezifische Datendom√§nen oder BCBS-239 Implementierungsaufgaben, die direkt zusammenarbeiten statt √ºber funktionale Grenzen hinweg zu kommunizieren.\n\nüß† F√∂rderung einer gemeinsamen Datenkultur:\n‚Ä¢ Business Data Literacy Program: Systematische St√§rkung der Datenkompetenz in Fachbereichen, insbesondere in Risikomanagement und Finance, um technische Konzepte zu verstehen und die Bedeutung von Datenqualit√§t zu verinnerlichen.\n‚Ä¢ IT Business Acumen Development: Gezielte F√∂rderung des Verst√§ndnisses von Gesch√§ftsprozessen und Risikomanagement-Konzepten in der IT, um Technologieentscheidungen an gesch√§ftlichen Anforderungen auszurichten.\n‚Ä¢ Gemeinsame OKRs und Incentives: Entwicklung bereichs√ºbergreifender Objectives and Key Results (OKRs) f√ºr BCBS-239 Compliance, die in die Leistungsbewertung sowohl von Business- als auch IT-F√ºhrungskr√§ften einflie√üen.\n‚Ä¢ Collaborative Innovation Workshops: Regelm√§√üige gemeinsame Workshops zur Entwicklung innovativer L√∂sungen f√ºr BCBS-239 Herausforderungen, die technologische M√∂glichkeiten und fachliche Anforderungen zusammenf√ºhren."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Welche Cloud-Strategien erm√∂glichen eine kosteneffiziente BCBS-239 Compliance bei gleichzeitiger Ber√ºcksichtigung der besonderen Sicherheitsanforderungen f√ºr Risikodaten?",
        answer: "Die Cloud-Transformation bietet Finanzinstituten einzigartige Chancen, BCBS-239 Compliance kosteneffizienter und skalierbarer zu gestalten. Gleichzeitig erfordert der Umgang mit sensiblen Risikodaten besondere Sicherheitskonzepte. ADVISORI unterst√ºtzt bei der Entwicklung zukunftssicherer Cloud-Strategien, die regulatorische Anforderungen erf√ºllen und gleichzeitig die Vorteile moderner Cloud-Technologien nutzen.\n\n‚òÅÔ∏è Strategische Cloud-Ans√§tze f√ºr BCBS-239 Compliance:\n‚Ä¢ Hybrid-Cloud-Strategie mit Risikodatenklassifizierung: Entwicklung eines differenzierten Modells, das basierend auf Datenklassifizierung und regulatorischen Anforderungen entscheidet, welche Risikodaten in Public Cloud, Private Cloud oder On-Premises verarbeitet werden.\n‚Ä¢ Cloud-native Risikodatenplattformen: Nutzung von Cloud-nativen Plattformen f√ºr Risikodatenaggregation und -reporting, die inh√§rente Skalierbarkeit, Elastizit√§t und Pay-per-Use-Modelle bieten und so Kosten mit dem tats√§chlichen Bedarf synchronisieren.\n‚Ä¢ Multi-Cloud-Ansatz f√ºr Resilienz: Vermeidung von Vendor Lock-in und Erh√∂hung der Ausfallsicherheit durch gezielte Verteilung von Risikodatenworkloads auf mehrere Cloud-Provider bei gleichzeitiger Wahrung eines einheitlichen Governance-Frameworks.\n‚Ä¢ Containerisierung von Risikodatenprozessen: Nutzung von Containerisierung und Kubernetes f√ºr die Standardisierung, Portabilit√§t und konsistente Ausf√ºhrung von Risikodatenprozessen √ºber verschiedene Umgebungen hinweg.\n\nüîí Cloud-Sicherheit f√ºr Risikodaten und regulatorische Compliance:\n‚Ä¢ Defense-in-Depth f√ºr Cloud-Risikodaten: Implementation eines mehrstufigen Sicherheitsmodells mit Ma√ünahmen auf Netzwerk-, Identit√§ts-, Daten- und Anwendungsebene, das den besonderen Schutzbedarf von Risikodaten ber√ºcksichtigt.\n‚Ä¢ Zero-Trust-Architektur: Konsequente Anwendung des Zero-Trust-Prinzips mit kontinuierlicher Authentifizierung und Autorisierung, granularen Zugriffsrechten und vollst√§ndiger Verschl√ºsselung f√ºr alle Risikodaten.\n‚Ä¢ Sovereign Cloud Services: Nutzung von Sovereign Cloud Services f√ºr besonders sensible Risikodaten, die spezifische rechtliche Anforderungen an Datenlokalisierung, Zugriffskontrolle und beh√∂rdlichen Zugriff erf√ºllen.\n‚Ä¢ Continuous Security Testing: Implementierung automatisierter, kontinuierlicher Sicherheitstests f√ºr Cloud-basierte Risikodateninfrastrukturen, um Schwachstellen fr√ºhzeitig zu erkennen und zu beheben.\n\nüìä Cloud-spezifische Governance f√ºr BCBS-239:\n‚Ä¢ Cloud Data Lineage: Erweiterung bestehender Datenlineage-L√∂sungen um Cloud-spezifische Komponenten, die Transparenz √ºber Datenfl√ºsse zwischen On-Premises und verschiedenen Cloud-Umgebungen schaffen.\n‚Ä¢ API-basierte Governance: Nutzung von API-Management-Plattformen zur Kontrolle und √úberwachung des Datenaustausches zwischen verschiedenen Cloud-Services und On-Premises-Systemen.\n‚Ä¢ Cloud FinOps f√ºr Risikodaten: Implementierung von FinOps-Prozessen, die die Kosten der Cloud-basierten BCBS-239 Compliance transparent machen und optimieren, mit klarer Zuordnung zu Gesch√§ftsfunktionen.\n‚Ä¢ Regulatory-Compliance-as-Code: Automatisierte √úberwachung und Dokumentation der BCBS-239 Compliance in Cloud-Umgebungen durch Policy-as-Code und kontinuierliche Compliance-Checks in der CI/CD-Pipeline."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie k√∂nnen wir BCBS-239 Compliance als Ausgangspunkt f√ºr eine umfassende ESG-Datenstrategie nutzen?",
        answer: "Die zunehmende Bedeutung von Environmental, Social und Governance (ESG) Faktoren f√ºr das Risikomanagement von Finanzinstituten schafft Synergien mit bestehenden BCBS-239 Initiativen. Eine integrierte Strategie erm√∂glicht es, die f√ºr BCBS-239 entwickelten Datenkapazit√§ten als Grundlage f√ºr eine robuste ESG-Datenstrategie zu nutzen und so regulatorische Compliance mit nachhaltiger Wettbewerbsf√§higkeit zu verbinden.\n\nüîÑ Synergien zwischen BCBS-239 und ESG-Datenanforderungen:\n‚Ä¢ Gemeinsame Governance-Prinzipien: Die BCBS-239 Governance-Prinzipien f√ºr Risikodaten ‚Äì wie klare Eigent√ºmerschaft, Qualit√§tskontrollen und End-to-End-Lineage ‚Äì sind direkt auf ESG-Datenmanagement √ºbertragbar und bilden eine solide Basis f√ºr die Integration.\n‚Ä¢ Parallele Aggregationsherausforderungen: ESG-Daten erfordern √§hnlich wie traditionelle Risikodaten die Aggregation heterogener, oft externer Datenquellen mit unterschiedlicher Qualit√§t und Granularit√§t ‚Äì Kapazit√§ten, die f√ºr BCBS-239 bereits entwickelt wurden.\n‚Ä¢ Komplement√§re Reporting-Anforderungen: Sowohl BCBS-239 als auch ESG-Reporting erfordern die F√§higkeit, granulare Daten f√ºr verschiedene Stakeholder zu aggregieren und in unterschiedlichen Zeitintervallen zu berichten.\n‚Ä¢ Integrierte Risikobetrachtung: Die zunehmende Integration von ESG-Faktoren in traditionelle Risikokategorien (Kredit-, Markt-, operationelle Risiken) erfordert eine Konsolidierung der Datenbasis, die von einer existierenden BCBS-239 Infrastruktur profitieren kann.\n\nüìä Erweiterung der BCBS-239 Architektur f√ºr ESG-Daten:\n‚Ä¢ Erweiterte Datenmodelle: Anreicherung bestehender Risikodatenmodelle um ESG-spezifische Attribute und Entit√§ten, die eine integrierte Betrachtung von traditionellen und nachhaltigkeitsbezogenen Risiken erm√∂glichen.\n‚Ä¢ Alternative Datenintegration: Erweiterung der Datenarchitektur um F√§higkeiten zur Integration alternativer Datenquellen (Satellitendaten, Social Media, NGO-Berichte), die f√ºr ESG-Bewertungen relevant sind.\n‚Ä¢ Advanced Analytics Layer: Implementierung spezialisierter Analysefunktionen f√ºr ESG-Daten, die auf der grundlegenden BCBS-239 Datenaggregation aufbauen und komplexe Nachhaltigkeitszusammenh√§nge erfassen k√∂nnen.\n‚Ä¢ Unified Reporting Framework: Entwicklung eines integrierten Reporting-Frameworks, das sowohl traditionelle Risikometriken als auch ESG-KPIs in konsolidierten Dashboards f√ºr verschiedene Entscheidungsebenen darstellt.\n\nüå± Strategische Vorteile einer integrierten BCBS-239/ESG-Datenstrategie:\n‚Ä¢ Regulatorische Synergien: Vorbereitung auf kommende ESG-bezogene Regulierungen (z.B. EU-Taxonomie, SFDR, erweiterte Stresstests) durch Nutzung bestehender BCBS-239 Compliance-Kapazit√§ten.\n‚Ä¢ Effizienzgewinne: Vermeidung paralleler Dateninfrastrukturen und -prozesse durch Integration von ESG-Datenmanagement in bestehende BCBS-239 Frameworks, was zu signifikanten Kosteneinsparungen f√ºhrt.\n‚Ä¢ Verbesserte Entscheidungsfindung: Schaffung einer ganzheitlichen Sicht auf Risiken durch Integration von traditionellen und ESG-bezogenen Risikofaktoren in einem einheitlichen Datenmodell.\n‚Ä¢ Wettbewerbsdifferenzierung: Positionierung als Vorreiter im Bereich nachhaltiger Finanzierung durch √ºberlegene F√§higkeiten in der ESG-Datenanalyse, aufbauend auf einer robusten BCBS-239 Grundlage."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new C-Level FAQs (German) to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ C-Level FAQs batch 3 (German) added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
