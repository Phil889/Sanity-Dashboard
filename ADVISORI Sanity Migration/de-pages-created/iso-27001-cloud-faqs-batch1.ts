import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Cloud page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-cloud' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-cloud" not found')
    }
    
    // Create new FAQs for ISO 27001 Cloud fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was sind die spezifischen Herausforderungen bei der Implementierung von ISO 27001 in Cloud-Umgebungen?',
        answer: "Die Implementierung von ISO 27001 in Cloud-Umgebungen bringt einzigartige Komplexit√§ten mit sich, die √ºber traditionelle On-Premises-Sicherheitsans√§tze hinausgehen. Cloud-Architekturen erfordern eine fundamentale Neuausrichtung der Informationssicherheitsstrategie, da sie dynamische, verteilte und geteilte Infrastrukturen umfassen.\n\n‚òÅÔ∏è Shared Responsibility Model Komplexit√§t:\n‚Ä¢ Die Verantwortlichkeiten zwischen Cloud Service Provider und Kunde sind nicht immer eindeutig definiert und variieren je nach Service-Modell\n‚Ä¢ Infrastructure as a Service erfordert umfassende Eigenverantwortung f√ºr Betriebssystem, Anwendungen und Daten\n‚Ä¢ Platform as a Service verschiebt Verantwortlichkeiten, erfordert aber weiterhin detaillierte Sicherheitskontrollen\n‚Ä¢ Software as a Service minimiert technische Verantwortung, erh√∂ht aber Anforderungen an Vendor Management\n‚Ä¢ Multi-Cloud-Strategien multiplizieren diese Komplexit√§t durch unterschiedliche Verantwortungsmodelle\n\nüåê Dynamische und skalierbare Infrastrukturen:\n‚Ä¢ Traditionelle Asset-Inventarisierung wird durch ephemere und automatisch skalierte Ressourcen herausgefordert\n‚Ä¢ Container und Serverless-Architekturen erfordern neue Ans√§tze f√ºr Sicherheitskontrollen\n‚Ä¢ Infrastructure as Code ver√§ndert Change Management und Konfigurationskontrolle fundamental\n‚Ä¢ Auto-Scaling und Load Balancing erschweren kontinuierliche √úberwachung und Compliance-Nachweis\n‚Ä¢ Edge Computing und Content Delivery Networks erweitern die Angriffsfl√§che geografisch\n\nüîê Datenschutz und Compliance in globalen Umgebungen:\n‚Ä¢ Datenresidenz und grenz√ºberschreitende Daten√ºbertragungen erfordern komplexe rechtliche Bewertungen\n‚Ä¢ Verschiedene Jurisdiktionen haben unterschiedliche Datenschutzanforderungen und Compliance-Standards\n‚Ä¢ Verschl√ºsselung in Transit und at Rest muss √ºber multiple Cloud-Services hinweg konsistent implementiert werden\n‚Ä¢ Key Management wird durch verteilte Architekturen und verschiedene Cloud-Provider komplexer\n‚Ä¢ Data Loss Prevention muss in hochdynamischen und verteilten Umgebungen funktionieren\n\nüîç Monitoring und Audit-Herausforderungen:\n‚Ä¢ Traditionelle Audit-Trails sind in Cloud-nativen Umgebungen oft fragmentiert und schwer nachvollziehbar\n‚Ä¢ Log-Aggregation √ºber multiple Services und Provider erfordert sophisticated Monitoring-Strategien\n‚Ä¢ Incident Response muss in Umgebungen funktionieren, in denen physischer Zugang nicht m√∂glich ist\n‚Ä¢ Forensische Untersuchungen werden durch geteilte und virtuelle Infrastrukturen erschwert\n‚Ä¢ Kontinuierliche Compliance-√úberwachung erfordert automatisierte Tools und Prozesse\n\nü§ù Vendor Risk Management und Third-Party-Abh√§ngigkeiten:\n‚Ä¢ Cloud Service Provider Assessment erfordert tiefgreifende technische und rechtliche Expertise\n‚Ä¢ Supply Chain Security wird durch komplexe Cloud-√ñkosysteme mit multiplen Subcontractors herausgefordert\n‚Ä¢ Service Level Agreements m√ºssen Sicherheitsanforderungen und Incident Response Zeiten spezifizieren\n‚Ä¢ Vendor Lock-in Risiken m√ºssen gegen Sicherheitsvorteile abgewogen werden\n‚Ä¢ Exit-Strategien und Datenportabilit√§t erfordern vorausschauende Planung und vertragliche Absicherung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie unterscheidet sich das Shared Responsibility Model zwischen verschiedenen Cloud-Service-Modellen und wie wirkt sich das auf ISO 27001 Compliance aus?',
        answer: "Das Shared Responsibility Model ist das Fundament der Cloud-Sicherheit und definiert, welche Sicherheitsaspekte vom Cloud Service Provider und welche vom Kunden verantwortet werden. F√ºr ISO 27001 Compliance ist ein pr√§zises Verst√§ndnis dieser Verantwortlichkeiten entscheidend, da sie direkt bestimmen, welche Kontrollen implementiert und auditiert werden m√ºssen.\n\nüèóÔ∏è Infrastructure as a Service Verantwortlichkeiten:\n‚Ä¢ Cloud Provider verantwortet physische Sicherheit, Netzwerk-Infrastructure, Hypervisor und Host-Betriebssystem\n‚Ä¢ Kunde tr√§gt vollst√§ndige Verantwortung f√ºr Gastbetriebssysteme, Anwendungen, Daten und Netzwerkkonfiguration\n‚Ä¢ Patch Management f√ºr Betriebssysteme und Anwendungen liegt vollst√§ndig beim Kunden\n‚Ä¢ Identity and Access Management muss vom Kunden implementiert und verwaltet werden\n‚Ä¢ Backup und Disaster Recovery Strategien m√ºssen vom Kunden entwickelt und umgesetzt werden\n\nüõ†Ô∏è Platform as a Service Komplexit√§ten:\n‚Ä¢ Cloud Provider √ºbernimmt zus√§tzlich Verantwortung f√ºr Betriebssystem, Runtime und Middleware\n‚Ä¢ Kunde fokussiert sich auf Anwendungssicherheit, Datenklassifikation und Access Controls\n‚Ä¢ Konfigurationssicherheit der Plattform-Services erfordert geteilte Verantwortung\n‚Ä¢ API-Sicherheit und Service-Integration bleiben prim√§r in Kundenverantwortung\n‚Ä¢ Monitoring und Logging erfordern Koordination zwischen Provider und Kunde\n\nüíº Software as a Service Herausforderungen:\n‚Ä¢ Cloud Provider tr√§gt Verantwortung f√ºr nahezu alle technischen Sicherheitsaspekte\n‚Ä¢ Kunde konzentriert sich auf Datenklassifikation, User Access Management und Konfiguration\n‚Ä¢ Business Continuity und Incident Response erfordern enge Zusammenarbeit mit dem Provider\n‚Ä¢ Compliance-Nachweise sind stark abh√§ngig von Provider-Zertifizierungen und Attestierungen\n‚Ä¢ Data Governance und Privacy Controls bleiben in prim√§rer Kundenverantwortung\n\nüìã ISO 27001 Kontroll-Mapping Strategien:\n‚Ä¢ Jede ISO 27001 Kontrolle muss explizit einer Verantwortlichkeitsebene zugeordnet werden\n‚Ä¢ Geteilte Kontrollen erfordern detaillierte Dokumentation der Schnittstellen und Abh√§ngigkeiten\n‚Ä¢ Provider-implementierte Kontrollen m√ºssen durch Third-Party-Attestierungen oder Audits validiert werden\n‚Ä¢ Kunde-implementierte Kontrollen m√ºssen an Cloud-spezifische Gegebenheiten angepasst werden\n‚Ä¢ Kontinuierliche √úberwachung muss beide Verantwortlichkeitsbereiche abdecken\n\nüîÑ Multi-Cloud Verantwortlichkeits-Management:\n‚Ä¢ Verschiedene Provider haben unterschiedliche Interpretationen des Shared Responsibility Models\n‚Ä¢ Einheitliche Sicherheitsstandards m√ºssen √ºber verschiedene Cloud-Plattformen hinweg implementiert werden\n‚Ä¢ Cross-Cloud-Datenfl√ºsse erfordern Ende-zu-Ende-Verantwortlichkeits-Mapping\n‚Ä¢ Incident Response muss koordiniert √ºber multiple Provider-Beziehungen funktionieren\n‚Ä¢ Audit-Strategien m√ºssen die Komplexit√§t multipler Verantwortlichkeitsmodelle ber√ºcksichtigen\n\nüìä Dokumentations- und Audit-Anforderungen:\n‚Ä¢ Verantwortlichkeitsmatrizen m√ºssen f√ºr jede Cloud-Service-Kombination erstellt werden\n‚Ä¢ Provider-Compliance-Berichte m√ºssen regelm√§√üig √ºberpr√ºft und in eigene Compliance-Nachweise integriert werden\n‚Ä¢ Gap-Analysen m√ºssen kontinuierlich durchgef√ºhrt werden, um Ver√§nderungen in Provider-Services zu ber√ºcksichtigen\n‚Ä¢ Vertragsverhandlungen m√ºssen spezifische Sicherheitsanforderungen und Audit-Rechte einschlie√üen\n‚Ä¢ Change Management Prozesse m√ºssen Auswirkungen auf Verantwortlichkeitsverteilung bewerten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Cloud-spezifischen Sicherheitskontrollen sind f√ºr ISO 27001 Compliance besonders kritisch?',
        answer: "Cloud-spezifische Sicherheitskontrollen f√ºr ISO 27001 gehen weit √ºber traditionelle IT-Sicherheitsma√ünahmen hinaus und adressieren die einzigartigen Risiken und M√∂glichkeiten von Cloud-Architekturen. Diese Kontrollen m√ºssen sowohl die dynamische Natur der Cloud als auch die geteilten Verantwortlichkeiten ber√ºcksichtigen.\n\nüîê Cloud-native Identity and Access Management:\n‚Ä¢ Multi-Factor Authentication muss f√ºr alle privilegierten und Remote-Zugriffe implementiert werden\n‚Ä¢ Role-Based Access Control erfordert granulare Berechtigungen f√ºr Cloud-Services und -Ressourcen\n‚Ä¢ Privileged Access Management muss tempor√§re und Just-in-Time-Zugriffe unterst√ºtzen\n‚Ä¢ Service-to-Service-Authentifizierung durch API-Keys, Service Accounts und Certificate-based Authentication\n‚Ä¢ Cross-Cloud Identity Federation f√ºr einheitliche Benutzerverwaltung √ºber multiple Provider\n\nüõ°Ô∏è Data Protection und Encryption Controls:\n‚Ä¢ End-to-End-Verschl√ºsselung f√ºr Daten in Transit zwischen Cloud-Services und On-Premises-Systemen\n‚Ä¢ Encryption at Rest f√ºr alle gespeicherten Daten mit Customer-Managed oder Customer-Provided Keys\n‚Ä¢ Key Management Services mit Hardware Security Modules f√ºr h√∂chste Sicherheitsanforderungen\n‚Ä¢ Data Loss Prevention Systeme, die Cloud-native APIs und Datenfl√ºsse √ºberwachen\n‚Ä¢ Data Classification und Labeling f√ºr automatisierte Schutzma√ünahmen basierend auf Datensensitivit√§t\n\nüåê Network Security und Segmentation:\n‚Ä¢ Virtual Private Clouds mit strikter Netzwerksegmentierung und Micro-Segmentation\n‚Ä¢ Web Application Firewalls f√ºr Schutz vor OWASP Top 10 und Cloud-spezifischen Bedrohungen\n‚Ä¢ DDoS Protection Services f√ºr Verf√ºgbarkeitsschutz und Business Continuity\n‚Ä¢ Network Access Control Lists und Security Groups f√ºr granulare Traffic-Kontrolle\n‚Ä¢ VPN und Private Connectivity f√ºr sichere Hybrid-Cloud-Verbindungen\n\nüìä Continuous Monitoring und Compliance Automation:\n‚Ä¢ Cloud Security Posture Management f√ºr kontinuierliche Konfigurations√ºberwachung\n‚Ä¢ Security Information and Event Management mit Cloud-nativen Log-Quellen\n‚Ä¢ Vulnerability Assessment und Penetration Testing f√ºr Cloud-Workloads\n‚Ä¢ Compliance-as-Code f√ºr automatisierte Policy-Durchsetzung und Audit-Vorbereitung\n‚Ä¢ Real-time Alerting f√ºr Sicherheitsvorf√§lle und Compliance-Abweichungen\n\nüîÑ DevSecOps und Infrastructure Security:\n‚Ä¢ Infrastructure as Code Security Scanning f√ºr Terraform, CloudFormation und √§hnliche Tools\n‚Ä¢ Container Security mit Image Scanning, Runtime Protection und Kubernetes Security Policies\n‚Ä¢ Serverless Security f√ºr Function-Level Access Controls und Event-driven Security\n‚Ä¢ CI/CD Pipeline Security mit automatisierten Security Tests und Vulnerability Scanning\n‚Ä¢ Configuration Drift Detection f√ºr Abweichungen von Security Baselines\n\n‚òÅÔ∏è Cloud Service Provider Integration:\n‚Ä¢ Shared Security Responsibility Matrix mit klarer Abgrenzung der Verantwortlichkeiten\n‚Ä¢ Third-Party Risk Assessment f√ºr Cloud Provider und deren Subcontractors\n‚Ä¢ Service Level Agreement Monitoring f√ºr Security-relevante Metriken\n‚Ä¢ Incident Response Coordination mit Cloud Provider Support und Security Teams\n‚Ä¢ Regular Security Reviews und Compliance Attestierungen von Cloud Providern\n\nüö® Incident Response und Business Continuity:\n‚Ä¢ Cloud-native Incident Response Playbooks f√ºr verschiedene Bedrohungsszenarien\n‚Ä¢ Automated Incident Detection und Response durch Cloud Security Services\n‚Ä¢ Multi-Region Backup und Disaster Recovery Strategien\n‚Ä¢ Forensic Readiness in Cloud-Umgebungen mit Log-Retention und Evidence Collection\n‚Ä¢ Business Impact Analysis f√ºr Cloud-Service-Ausf√§lle und Mitigation-Strategien"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie kann eine Organisation Multi-Cloud und Hybrid-Cloud-Umgebungen effektiv in ihr ISO 27001 ISMS integrieren?',
        answer: "Die Integration von Multi-Cloud und Hybrid-Cloud-Umgebungen in ein ISO 27001 ISMS erfordert einen strategischen, architektonischen Ansatz, der Komplexit√§t reduziert und gleichzeitig umfassende Sicherheit gew√§hrleistet. Erfolgreiche Integration basiert auf einheitlichen Standards, zentralisierter Governance und automatisierten Kontrollen.\n\nüèóÔ∏è Unified Security Architecture Design:\n‚Ä¢ Entwicklung einer √ºbergreifenden Security Reference Architecture, die alle Cloud-Umgebungen abdeckt\n‚Ä¢ Standardisierte Security Baselines f√ºr jede Cloud-Plattform mit einheitlichen Mindestanforderungen\n‚Ä¢ Common Control Framework, das ISO 27001 Anforderungen auf verschiedene Cloud-Services mappt\n‚Ä¢ Interoperability Standards f√ºr sichere Daten√ºbertragung und Service-Integration zwischen Clouds\n‚Ä¢ Centralized Policy Management f√ºr konsistente Sicherheitsrichtlinien √ºber alle Umgebungen\n\nüéØ Centralized Governance und Management:\n‚Ä¢ Cloud Center of Excellence als zentrale Steuerungsinstanz f√ºr alle Cloud-Aktivit√§ten\n‚Ä¢ Unified Identity Management mit Single Sign-On und Federation √ºber alle Cloud-Provider\n‚Ä¢ Centralized Logging und Monitoring f√ºr einheitliche Sichtbarkeit √ºber alle Umgebungen\n‚Ä¢ Standardisierte Change Management Prozesse f√ºr Cloud-Konfigurationen und -Services\n‚Ä¢ Cross-Cloud Compliance Dashboard f√ºr Real-time √úbersicht √ºber Compliance-Status\n\nüîÑ Automated Compliance und Orchestration:\n‚Ä¢ Infrastructure as Code Templates mit eingebauten Security Controls f√ºr alle Cloud-Plattformen\n‚Ä¢ Automated Compliance Scanning und Remediation √ºber alle Cloud-Umgebungen\n‚Ä¢ Policy as Code Implementation f√ºr konsistente Durchsetzung von Sicherheitsrichtlinien\n‚Ä¢ Orchestrated Incident Response mit automatisierten Workflows √ºber Cloud-Grenzen hinweg\n‚Ä¢ Continuous Integration und Deployment mit Security Gates f√ºr alle Cloud-Deployments\n\nüìä Risk Management und Assessment:\n‚Ä¢ Unified Risk Register mit Cloud-spezifischen Risiken f√ºr alle Umgebungen\n‚Ä¢ Cross-Cloud Threat Modeling f√ºr Angriffsvektoren, die multiple Clouds betreffen\n‚Ä¢ Vendor Risk Assessment Framework f√ºr alle Cloud Service Provider\n‚Ä¢ Data Flow Mapping f√ºr Verst√§ndnis von Datenfl√ºssen zwischen verschiedenen Cloud-Umgebungen\n‚Ä¢ Regular Security Assessments mit Cloud-spezifischen Penetration Tests\n\nüõ°Ô∏è Data Protection und Privacy Controls:\n‚Ä¢ Data Classification Schema mit automatischer Anwendung √ºber alle Cloud-Umgebungen\n‚Ä¢ Encryption Key Management mit einheitlichen Standards f√ºr alle Cloud-Provider\n‚Ä¢ Data Residency und Sovereignty Controls f√ºr compliance-kritische Daten\n‚Ä¢ Cross-Border Data Transfer Agreements und Technical Safeguards\n‚Ä¢ Privacy Impact Assessments f√ºr Multi-Cloud-Datenverarbeitungen\n\nüìã Documentation und Audit Readiness:\n‚Ä¢ Comprehensive Asset Inventory mit Real-time Discovery √ºber alle Cloud-Umgebungen\n‚Ä¢ Standardized Documentation Templates f√ºr Cloud-spezifische Kontrollen\n‚Ä¢ Audit Trail Aggregation f√ºr einheitliche Nachweisf√ºhrung\n‚Ä¢ Regular Internal Audits mit Cloud-spezifischen Audit-Programmen\n‚Ä¢ External Audit Coordination mit Cloud Provider Attestierungen\n\nüöÄ Continuous Improvement und Optimization:\n‚Ä¢ Regular Architecture Reviews f√ºr Optimierung der Multi-Cloud-Strategie\n‚Ä¢ Cost-Security Optimization f√ºr Balance zwischen Sicherheit und Effizienz\n‚Ä¢ Technology Roadmap Alignment mit Cloud Provider Innovation und Security Enhancements\n‚Ä¢ Skills Development Programme f√ºr Cloud Security Expertise\n‚Ä¢ Lessons Learned Integration aus Incidents und Audit-Findings √ºber alle Cloud-Umgebungen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
