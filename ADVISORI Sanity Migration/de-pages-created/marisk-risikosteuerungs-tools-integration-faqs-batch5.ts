import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating MaRisk Risikosteuerungs-Tools Integration page with FAQs batch 5...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'marisk-risikosteuerungs-tools-integration' })
    
    if (!existingDoc) {
      throw new Error('Document "marisk-risikosteuerungs-tools-integration" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 17),
        question: "Wie unterst√ºtzt ADVISORI bei der Integration von Risikosteuerungs-Tools in ein √ºbergreifendes Data-Governance-Konzept unter Ber√ºcksichtigung der MaRisk-Anforderungen?",
        answer: "Risikodaten geh√∂ren zu den gesch√§ftskritischsten Informationen eines Finanzinstituts und unterliegen besonderen regulatorischen Anforderungen gem√§√ü MaRisk AT 4.3.4. Eine effektive Integration von Risikosteuerungs-Tools erfordert daher ein durchdachtes Data-Governance-Konzept, das Datenqualit√§t, -verf√ºgbarkeit und -integrit√§t sicherstellt. ADVISORI unterst√ºtzt Sie bei der Entwicklung und Implementierung einer risikodatenspezifischen Data Governance, die sowohl regulatorische Anforderungen erf√ºllt als auch den Gesch√§ftswert Ihrer Risikodaten maximiert.\n\nüîÑ Integration von Risiko-Data-Governance in √ºbergreifende Datenstrategien:\n‚Ä¢ Risk Data Ownership Matrix: Entwicklung einer klaren Verantwortungsstruktur f√ºr Risikodaten mit definierten Rollen (Data Owner, Data Steward, Data Custodian) und deren Verankerung in der Gesamtorganisation.\n‚Ä¢ Risikodatenklassifizierung: Etablierung eines spezifischen Klassifizierungsmodells f√ºr Risikodaten, das deren regulatorische Relevanz, Sensitivit√§t und gesch√§ftliche Bedeutung ber√ºcksichtigt.\n‚Ä¢ Integriertes Data-Quality-Management: Einbindung von Risikosteuerungs-Tools in das institutsweite Datenqualit√§tsmanagement mit spezifischen Kontrollmechanismen f√ºr risikorelevante Daten.\n‚Ä¢ Data-Lineage f√ºr Risikoinformationen: Implementierung durchg√§ngiger Nachvollziehbarkeit des Datenflusses von der Quelle bis zur Risikokennzahl, die MaRisk-konform dokumentiert und √ºberpr√ºfbar ist.\n\nüìä Spezifische Governance-Mechanismen f√ºr Risikodaten:\n‚Ä¢ Risikodaten-Glossar und -Taxonomie: Aufbau eines einheitlichen Verst√§ndnisses und einer konsistenten Terminologie f√ºr Risikodaten √ºber verschiedene Tools und Abteilungen hinweg.\n‚Ä¢ Master Data Management f√ºr Risikofaktoren: Etablierung zentraler Stammdaten f√ºr kritische Risikoparameter und -faktoren mit definierten Golden Sources.\n‚Ä¢ Regulatorisches Metadata Management: Anreicherung von Risikodaten mit regulatorischen Metadaten zur Unterst√ºtzung aufsichtsrechtlicher Anforderungen und Nachweise.\n‚Ä¢ Data-Quality-KPIs f√ºr Risikodaten: Entwicklung spezifischer Kennzahlen zur kontinuierlichen Messung und Steuerung der Qualit√§t Ihrer Risikodaten entsprechend ihrer kritischen Bedeutung.\n\nüõ°Ô∏è Sicherheit und Compliance f√ºr Risikodaten:\n‚Ä¢ Data-Protection-by-Design f√ºr Risikoinformationen: Integration von Datenschutz- und Datensicherheitsanforderungen bereits in der Konzeption der Risikosteuerungs-Tool-Landschaft.\n‚Ä¢ MaRisk-konforme Zugriffssteuerung: Implementierung granularer Berechtigungskonzepte f√ºr den Zugriff auf Risikodaten, die das Need-to-Know-Prinzip und regulatorische Anforderungen ber√ºcksichtigen.\n‚Ä¢ Audit-Trail und Nachverfolgbarkeit: Etablierung l√ºckenloser Protokollierung aller √Ñnderungen an kritischen Risikodaten f√ºr Pr√ºfungs- und Nachweiszwecke.\n‚Ä¢ Historisierungskonzept: Entwicklung einer regulatorisch konformen Strategie f√ºr die Versionierung und Archivierung von Risikodaten unter Ber√ºcksichtigung der Aufbewahrungsfristen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 18),
        question: "Wie k√∂nnen wir unsere Risikosteuerungs-Tools optimal f√ºr regulatorische Pr√ºfungen vorbereiten und dokumentieren?",
        answer: "Regulatorische Pr√ºfungen der Risikosteuerungs-Tools sind ein fester Bestandteil des aufsichtsrechtlichen √úberwachungsprozesses und k√∂nnen erhebliche Ressourcen binden. Eine durchdachte Vorbereitung und strukturierte Dokumentation sind entscheidend, um Pr√ºfungen effizient zu gestalten und erfolgreiche Ergebnisse zu erzielen. ADVISORI unterst√ºtzt Sie mit einem ganzheitlichen Ansatz, der Ihre Risikosteuerungs-Tools pr√ºfungssicher macht und den Pr√ºfungsprozess selbst optimiert.\n\nüìù Pr√ºfungsgerechte Dokumentation der Toollandschaft:\n‚Ä¢ MaRisk-Mapping-Dokumentation: Erstellung einer strukturierten Dokumentation, die transparent nachweist, wie Ihre Tool-Landschaft die spezifischen Anforderungen der MaRisk (insbesondere AT 4.3.2, AT 7.2, BTR) erf√ºllt.\n‚Ä¢ Methodendokumentation: Detaillierte Beschreibung der in den Tools implementierten Risikobewertungs- und -steuerungsmethoden mit mathematischen Grundlagen, Annahmen und Limitationen.\n‚Ä¢ Architektur- und Schnittstellendokumentation: Umfassende Darstellung der Systemarchitektur, Datenfl√ºsse und Schnittstellenfunktionen zwischen den verschiedenen Risikosteuerungs-Tools.\n‚Ä¢ √Ñnderungshistorie: L√ºckenlose Dokumentation aller wesentlichen √Ñnderungen an Tools, Methoden und Parametern mit Begr√ºndungen, Genehmigungen und Validierungsma√ünahmen.\n\nüß™ Validierungs- und Testnachweise:\n‚Ä¢ Validierungsberichte: Erstellung umfassender Berichte √ºber die durchgef√ºhrten Validierungsma√ünahmen, deren Ergebnisse und abgeleitete Ma√ünahmen gem√§√ü AT 4.3.2.\n‚Ä¢ Test Case Library: Aufbau einer Bibliothek von Testf√§llen, die die korrekte Funktion der Tools in verschiedenen Szenarien nachweisen und f√ºr Pr√ºfungen reproduzierbar sind.\n‚Ä¢ Benchmark-Analysen: Dokumentation von Vergleichsrechnungen, die die Ergebnisse der Tools mit alternativen Methoden oder Marktdaten abgleichen.\n‚Ä¢ Limitdokumentationen: Nachweise zur regelkonformen Implementierung, √úberwachung und Eskalation von Risikolimiten in den Tools.\n\nüîç Pr√ºfungseffiziente Prozesse und Strukturen:\n‚Ä¢ Pr√ºfungsleitfaden f√ºr Risikosteuerungs-Tools: Entwicklung eines spezifischen Leitfadens, der typische Pr√ºfungsfragen adressiert und relevante Nachweise strukturiert zug√§nglich macht.\n‚Ä¢ Single Point of Contact: Etablierung klarer Zust√§ndigkeiten und Ansprechpartner f√ºr toolbezogene Pr√ºfungsfragen, die fachliche und technische Aspekte abdecken k√∂nnen.\n‚Ä¢ Pr√ºfungsdatenbank: Implementierung eines zentralen Repositories f√ºr alle pr√ºfungsrelevanten Dokumente, Nachweise und Anfragen mit strukturiertem Zugriff.\n‚Ä¢ Self-Assessment-Framework: Entwicklung eines internen √úberpr√ºfungsmechanismus, der die Pr√ºfungsbereitschaft der Tool-Landschaft kontinuierlich bewertet.\n\nüöÄ Kontinuierliche Verbesserung des Pr√ºfungsprozesses:\n‚Ä¢ Lessons-Learned-Management: Systematische Auswertung abgeschlossener Pr√ºfungen und Integration der Erkenntnisse in die Weiterentwicklung der Tool-Landschaft.\n‚Ä¢ Regelm√§√üige Mock-Audits: Durchf√ºhrung simulierter Pr√ºfungen zur Identifikation von Schwachstellen und zur Verbesserung der Pr√ºfungseffizienz.\n‚Ä¢ Aufsichtsrechtliches Radar: Kontinuierliche Beobachtung pr√ºfungsrelevanter regulatorischer Entwicklungen und proaktive Anpassung der Dokumentation und Nachweise.\n‚Ä¢ Automatisierte Nachweisf√ºhrung: Integration von Audit-Trail- und Reporting-Funktionen in die Tools, die pr√ºfungsrelevante Informationen automatisch erzeugen und konsolidieren."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 19),
        question: "Wie kann ADVISORI bei der Integration neuer regulatorischer Anforderungen wie ESG-Risiken in bestehende Risikosteuerungs-Tools unterst√ºtzen?",
        answer: "Die Integration neuer regulatorischer Anforderungen wie ESG-Risiken in bestehende Risikosteuerungs-Tools stellt Institute vor besondere Herausforderungen. Diese neuen Risikoarten erfordern h√§ufig andere Datenquellen, Methoden und Steuerungsans√§tze als traditionelle Finanzrisiken. ADVISORI unterst√ºtzt Sie mit einem ganzheitlichen Ansatz, der Ihre bestehende Toollandschaft evolution√§r erweitert, statt isolierte Parallelsysteme zu schaffen.\n\nüîÑ Strategische Integration neuer Risikoarten in bestehende Architekturen:\n‚Ä¢ Gap-Analyse bestehender Tools: Strukturierte Bewertung Ihrer aktuellen Risikosteuerungs-Tools hinsichtlich ihrer F√§higkeit, neue regulatorische Anforderungen wie ESG-Risiken abzubilden.\n‚Ä¢ Erweiterungsstrategien statt Silos: Entwicklung von Integrationskonzepten, die neue Risikoarten in Ihre bestehende Toollandschaft einbinden, statt isolierte Speziall√∂sungen zu schaffen.\n‚Ä¢ Dual-Use-Ansatz f√ºr Datenplattformen: Erweiterung bestehender Risikodatenplattformen um Kapazit√§ten f√ºr neue Datentypen wie ESG-Faktoren, um eine einheitliche Datenbasis zu gew√§hrleisten.\n‚Ä¢ Modulare Methodenimplementierung: Integration neuer quantitativer und qualitativer Methoden f√ºr ESG-Risikobewertung als erweiterbare Module in bestehenden Tools.\n\nüìä Datenmanagement f√ºr neue regulatorische Anforderungen:\n‚Ä¢ Externe Datenquellen-Integration: Anbindung spezialisierter Datenprovider f√ºr ESG-Daten an Ihre bestehende Risikodateninfrastruktur mit entsprechenden Qualit√§tssicherungsmechanismen.\n‚Ä¢ Datenmodell-Erweiterung: Anpassung Ihrer Risikodatenmodelle zur Aufnahme neuer Dimensionen, Kennzahlen und Attribute f√ºr ESG- und andere neue Risikoarten.\n‚Ä¢ Proxy-Ans√§tze und Sch√§tzverfahren: Entwicklung von Methoden zum Umgang mit initial l√ºckenhaften Daten f√ºr neue Risikoarten, die schrittweise verfeinert werden k√∂nnen.\n‚Ä¢ Metadatenmanagement f√ºr regulatorische Zuordnung: Implementierung eines Metadatenkonzepts, das die Verbindung zwischen traditionellen Risikodaten und neuen Risikoarten transparent dokumentiert.\n\nüì± Reporting- und Steuerungsfunktionen f√ºr neue Anforderungen:\n‚Ä¢ Integrierte Cockpit-L√∂sungen: Erweiterung bestehender Risikodashboards um ESG- und andere neue Risikokomponenten f√ºr eine ganzheitliche Sicht auf das Risikoprofil.\n‚Ä¢ Szenariobasierte Stresstests: Integration von Szenarien f√ºr Klima- und Transitionsrisiken in Ihre bestehenden Stresstesting-Tools mit konsistenten Schockparametern.\n‚Ä¢ Erweiterte Limitstrukturen: Implementierung von ESG-spezifischen Limitkomponenten in bestehende Limitmanagement-Systeme mit entsprechenden √úberwachungs- und Eskalationsmechanismen.\n‚Ä¢ Impact-Analyse-Tools: Entwicklung von Funktionen zur Bewertung von ESG-Auswirkungen auf traditionelle Risikokategorien wie Kredit-, Markt- und operationelle Risiken.\n\n‚úÖ Validierung und Compliance f√ºr neue Risikoarten:\n‚Ä¢ Spezifische Validierungsmethoden: Entwicklung angepasster Validierungsans√§tze f√ºr neue Risikomodelle, die deren besondere Eigenschaften (z.B. l√§ngere Zeithorizonte, qualitative Faktoren) ber√ºcksichtigen.\n‚Ä¢ Regulatorisches Mapping-Framework: Erstellung einer strukturierten Zuordnung von Tool-Funktionen zu den spezifischen neuen regulatorischen Anforderungen f√ºr Transparenz und Nachweisbarkeit.\n‚Ä¢ Evolution√§re Validierung: Implementierung eines gestuften Validierungsansatzes, der die kontinuierliche Weiterentwicklung der Methoden und Daten f√ºr neue Risikoarten ber√ºcksichtigt.\n‚Ä¢ Integrierter Dokumentationsansatz: Erweiterung der bestehenden Methodendokumentation um spezifische Elemente f√ºr neue Risikoarten, die deren besondere Eigenschaften und Limitationen transparent darstellen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 20),
        question: "Welche Erfolgsfaktoren sind bei Projekten zur Integration von Risikosteuerungs-Tools besonders kritisch, und wie stellt ADVISORI deren Beachtung sicher?",
        answer: "Die Integration von Risikosteuerungs-Tools ist ein komplexes Vorhaben mit strategischer Bedeutung f√ºr Ihr Institut. Der Erfolg solcher Projekte h√§ngt von einer Vielzahl von Faktoren ab, die √ºber rein technische Aspekte hinausgehen. ADVISORI verf√ºgt √ºber umfangreiche Erfahrung mit erfolgreichen Integrationsprojekten und hat einen strukturierten Ansatz entwickelt, um die kritischen Erfolgsfaktoren systematisch zu adressieren.\n\nüéØ Kritische Erfolgsfaktoren und deren Umsetzung:\n‚Ä¢ Strategisches Alignment: Wir stellen durch regelm√§√üige Business-IT-Alignment-Workshops sicher, dass die Tool-Integration konsequent an Ihren √ºbergeordneten strategischen Zielen und der Risikostrategie ausgerichtet bleibt.\n‚Ä¢ Stakeholder-Management: Fr√ºhzeitige Identifikation und kontinuierliche Einbindung aller relevanten Stakeholder ‚Äì vom Vorstand √ºber Fachbereiche bis hin zu IT und Compliance ‚Äì durch strukturierte Beteiligungsformate.\n‚Ä¢ Realistische Ressourcenplanung: Detaillierte Planung der erforderlichen Ressourcen mit ausreichenden Puffern f√ºr unvorhergesehene Herausforderungen, insbesondere bei der Bereitstellung von Fachexpertise.\n‚Ä¢ Kultureller Wandel: Aktive Gestaltung des notwendigen Kulturwandels durch gezielte Change-Management-Ma√ünahmen, die auf die spezifische Situation Ihres Instituts zugeschnitten sind.\n\nüõ£Ô∏è Projektmethodische Erfolgstreiber:\n‚Ä¢ Iteratives Vorgehen: Implementierung in klar definierten, √ºberschaubaren Iterationen mit schnellen Feedback-Zyklen und kontinuierlicher Anpassung statt monolithischer Big-Bang-Ans√§tze.\n‚Ä¢ Agiles MaRisk-Projektmanagement: Kombination agiler Methoden mit spezifischen Governance-Elementen f√ºr regulatorische Projekte, die Flexibilit√§t mit Compliance-Anforderungen in Einklang bringen.\n‚Ä¢ Dual-Track-Ansatz: Parallele Verfolgung technischer Implementierung und fachlicher Konzeption mit kontinuierlicher Synchronisation zur Vermeidung von Divergenzen.\n‚Ä¢ Integriertes Risikomanagement: Etablierung eines projektspezifischen Risikomanagements, das potenzielle H√ºrden fr√ºhzeitig identifiziert und proaktiv adressiert.\n\nüîÑ Operational Excellence in der Umsetzung:\n‚Ä¢ Standardisierte Methodik: Einsatz bew√§hrter Vorgehensmodelle, Templates und Checklistenverfahren, die auf unseren Erfahrungen aus zahlreichen erfolgreichen Implementierungsprojekten basieren.\n‚Ä¢ Qualit√§tssicherung und Testing: Implementierung eines mehrstufigen Qualit√§tssicherungsprozesses mit definierten Quality Gates und umfassenden Testverfahren, die fachliche und technische Aspekte abdecken.\n‚Ä¢ Wissenstransfer und Dokumentation: Kontinuierlicher Wissenstransfer und Aufbau einer umfassenden, praxisorientierten Dokumentation, die die langfristige Wartbarkeit und Weiterentwicklung der integrierten Toollandschaft sicherstellt.\n‚Ä¢ Hypercare-Phase: Intensive Betreuung nach der Implementierung mit schnellen Reaktionszeiten und proaktivem Monitoring, um einen reibungslosen √úbergang in den Regelbetrieb zu gew√§hrleisten.\n\nüíº Umsetzungsbeispiel aus der Praxis:\n‚Ä¢ Integriertes Implementierungsframework: Wir setzen ein bew√§hrtes Framework ein, das alle relevanten Dimensionen des Integrationsprojekts ‚Äì von der technischen Architektur √ºber fachliche Methoden bis hin zu organisatorischen Aspekten ‚Äì ganzheitlich adressiert und deren Wechselwirkungen ber√ºcksichtigt.\n‚Ä¢ Collaborative Alignment Workshops: Regelm√§√üige, strukturierte Workshops bringen alle Stakeholder zusammen, um ein gemeinsames Verst√§ndnis zu entwickeln, Priorit√§ten abzustimmen und Entscheidungen transparent zu treffen.\n‚Ä¢ Balanced Scorecard f√ºr Tool-Integration: Implementierung eines ausgewogenen Kennzahlensystems, das den Projektfortschritt kontinuierlich misst und transparent kommuniziert ‚Äì nicht nur hinsichtlich Zeit und Budget, sondern auch bez√ºglich qualitativer Aspekte wie Benutzerakzeptanz und regulatorischer Compliance."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 5 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
