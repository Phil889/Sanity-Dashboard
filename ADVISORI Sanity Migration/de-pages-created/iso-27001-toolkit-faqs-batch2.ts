import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Toolkit page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-toolkit' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-toolkit" not found')
    }
    
    // Create new FAQs for implementation tools and frameworks
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie unterst√ºtzen automatisierte Assessment-Tools bei der pr√§zisen Gap-Analyse und Compliance-Bewertung?',
        answer: "Automatisierte Assessment-Tools revolutionieren die traditionelle Gap-Analyse durch systematische, datengetriebene Bewertungsans√§tze, die menschliche Fehlerquellen minimieren und gleichzeitig umfassende Transparenz √ºber den aktuellen Compliance-Status schaffen. Diese Tools erm√∂glichen eine pr√§zise, nachvollziehbare und kontinuierliche Bewertung aller ISO 27001 Anforderungen.\n\nüîç Systematische Compliance-Mapping und Bewertung:\n‚Ä¢ Vollst√§ndige Abdeckung aller 114 ISO 27001 Kontrollen mit detailliertem Mapping zu spezifischen Unternehmensaktivit√§ten\n‚Ä¢ Automatisierte Evidenz-Sammlung durch Integration mit bestehenden Systemen und Dokumentenmanagement-Plattformen\n‚Ä¢ Intelligente Bewertungsalgorithmen, die Implementierungsgrad und Wirksamkeit von Kontrollma√ünahmen objektiv bewerten\n‚Ä¢ Kontinuierliche √úberwachung von Compliance-√Ñnderungen durch Echtzeit-Integration mit operativen Systemen\n‚Ä¢ Strukturierte Dokumentation aller Bewertungsergebnisse f√ºr Audit-Trail und Nachvollziehbarkeit\n\nüìä Datengetriebene Risikoidentifikation:\n‚Ä¢ Automatisierte Analyse von Systemkonfigurationen, Zugriffsrechten und Sicherheitseinstellungen\n‚Ä¢ Integration von Vulnerability-Scans und Penetrationstestergebnissen f√ºr umfassende Schwachstellenbewertung\n‚Ä¢ Korrelation verschiedener Datenquellen zur Identifikation versteckter Risiken und Abh√§ngigkeiten\n‚Ä¢ Priorisierung von Findings basierend auf Risikobewertung und Business Impact\n‚Ä¢ Trend-Analyse zur Identifikation sich entwickelnder Risikobereiche und Compliance-Verschlechterungen\n\nüéØ Pr√§zise Handlungsempfehlungen:\n‚Ä¢ Automatische Generierung spezifischer, umsetzbarer Empfehlungen f√ºr identifizierte Compliance-L√ºcken\n‚Ä¢ Priorisierung von Ma√ünahmen basierend auf Risikobewertung, Implementierungsaufwand und regulatorischen Anforderungen\n‚Ä¢ Integration von Best-Practice-Bibliotheken f√ºr bew√§hrte L√∂sungsans√§tze\n‚Ä¢ Kostensch√§tzungen und Ressourcenplanung f√ºr empfohlene Implementierungsma√ünahmen\n‚Ä¢ Zeitplanung und Roadmap-Entwicklung f√ºr systematische Gap-Schlie√üung\n\n‚ö° Effizienzsteigerung und Zeitersparnis:\n‚Ä¢ Reduzierung der Assessment-Zeit von Wochen auf Tage durch automatisierte Datensammlung und Analyse\n‚Ä¢ Eliminierung manueller Fehlerquellen und Inkonsistenzen in der Bewertung\n‚Ä¢ Standardisierte Bewertungskriterien f√ºr objektive und vergleichbare Ergebnisse\n‚Ä¢ Automatisierte Berichtsgenerierung mit Executive Summaries und detaillierten technischen Analysen\n‚Ä¢ Kontinuierliche Updates und Re-Assessments ohne zus√§tzlichen manuellen Aufwand\n\nüîÑ Kontinuierliche Compliance-√úberwachung:\n‚Ä¢ Echtzeit-Monitoring von Compliance-Status und automatische Alerts bei Abweichungen\n‚Ä¢ Integration in bestehende Security Operations Center und Monitoring-Infrastrukturen\n‚Ä¢ Automatisierte Compliance-Dashboards f√ºr Management-Reporting und Stakeholder-Kommunikation\n‚Ä¢ Historische Trend-Analyse f√ºr Compliance-Entwicklung und Verbesserungsmessung\n‚Ä¢ Proaktive Identifikation potenzieller Compliance-Risiken vor deren Manifestation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Rolle spielen vorkonfigurierte Templates bei der Beschleunigung der ISMS-Dokumentation?',
        answer: "Vorkonfigurierte Templates sind das R√ºckgrat einer effizienten ISMS-Dokumentation und fungieren als bew√§hrte Grundlage f√ºr standardkonforme, qualitativ hochwertige Dokumentationsstrukturen. Sie eliminieren den Aufwand der Neuentwicklung und gew√§hrleisten gleichzeitig Konsistenz, Vollst√§ndigkeit und Audit-Readiness aller ISMS-Dokumente.\n\nüìã Umfassende Dokumentationsabdeckung:\n‚Ä¢ Vollst√§ndige Template-Bibliothek f√ºr alle erforderlichen ISMS-Dokumente: Richtlinien, Verfahren, Arbeitsanweisungen und Formulare\n‚Ä¢ Standardkonforme Strukturierung entsprechend ISO 27001 Anforderungen und Audit-Erwartungen\n‚Ä¢ Branchenspezifische Anpassungen f√ºr Finanzdienstleister, Gesundheitswesen, Industrie und √∂ffentlichen Sektor\n‚Ä¢ Integration regulatorischer Anforderungen wie DORA, NIS2, GDPR in einheitliche Dokumentationsstrukturen\n‚Ä¢ Mehrsprachige Templates f√ºr internationale Organisationen und Compliance-Anforderungen\n\n‚ö° Dramatische Zeitersparnis bei der Dokumentenerstellung:\n‚Ä¢ Reduzierung der Dokumentationserstellung um bis zu 80% durch vorkonfigurierte Inhalte und Strukturen\n‚Ä¢ Sofortige Verf√ºgbarkeit audit-ready Dokumentationsframeworks ohne Entwicklungsaufwand\n‚Ä¢ Automatisierte Querverweise und Konsistenzpr√ºfungen zwischen verschiedenen Dokumenten\n‚Ä¢ Integrierte Versionskontrolle und Change-Management-Workflows\n‚Ä¢ Standardisierte Freigabeprozesse mit automatisierten Approval-Workflows\n\nüéØ Qualit√§tssicherung und Standardkonformit√§t:\n‚Ä¢ Entwicklung durch ISO 27001 Experten mit jahrelanger Implementierungserfahrung\n‚Ä¢ Kontinuierliche Aktualisierung basierend auf Standard-Updates und regulatorischen √Ñnderungen\n‚Ä¢ Integrierte Qualit√§tskontrollmechanismen und Konsistenzpr√ºfungen\n‚Ä¢ Bew√§hrte Formulierungen und Strukturen, die Audit-Anforderungen optimal erf√ºllen\n‚Ä¢ Compliance-Mapping zu spezifischen ISO 27001 Kontrollen und Anforderungen\n\nüîß Anpassbarkeit und Individualisierung:\n‚Ä¢ Flexible Template-Strukturen, die an spezifische Unternehmensanforderungen angepasst werden k√∂nnen\n‚Ä¢ Modularer Aufbau erm√∂glicht selektive Nutzung und Kombination verschiedener Template-Komponenten\n‚Ä¢ Integrierte Anpassungsleitf√§den f√ºr unternehmensspezifische Modifikationen\n‚Ä¢ Automatisierte Personalisierung mit Unternehmensdaten und Corporate Design\n‚Ä¢ Skalierbare Strukturen f√ºr verschiedene Unternehmensgr√∂√üen und Komplexit√§tsgrade\n\nüìà Kontinuierliche Verbesserung und Updates:\n‚Ä¢ Regelm√§√üige Updates basierend auf neuen Standards, Regulierungen und Best Practices\n‚Ä¢ Integration von Lessons Learned aus realen Implementierungsprojekten\n‚Ä¢ Community-Feedback und kontinuierliche Optimierung basierend auf Nutzererfahrungen\n‚Ä¢ Proaktive Anpassung an emerging Technologies und neue Bedrohungslandschaften\n‚Ä¢ Automatische Benachrichtigungen √ºber verf√ºgbare Updates und Verbesserungen\n\nüîÑ Integration und Workflow-Optimierung:\n‚Ä¢ Nahtlose Integration in bestehende Dokumentenmanagement-Systeme und Collaboration-Plattformen\n‚Ä¢ Automatisierte Workflow-Integration f√ºr Review, Approval und Publikationsprozesse\n‚Ä¢ API-Integration f√ºr automatisierte Dokumentengenerierung und -aktualisierung\n‚Ä¢ Integration mit Projektmanagement-Tools f√ºr koordinierte Implementierungsaktivit√§ten\n‚Ä¢ Zentrale Template-Verwaltung mit Rollen- und Rechtemanagement f√ºr verschiedene Nutzergruppen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie erm√∂glichen integrierte Risikomanagement-Frameworks eine systematische und effiziente Risikosteuerung?',
        answer: "Integrierte Risikomanagement-Frameworks bilden das strategische Herzst√ºck eines effektiven ISMS und erm√∂glichen eine systematische, datengetriebene Herangehensweise an Informationssicherheitsrisiken. Diese Frameworks transformieren traditionelle, oft subjektive Risikobewertungen in objektive, nachvollziehbare und kontinuierlich optimierbare Prozesse.\n\nüéØ Systematische Risikoidentifikation und Klassifizierung:\n‚Ä¢ Strukturierte Methodiken f√ºr umfassende Risikoidentifikation unter Ber√ºcksichtigung aller Bedrohungsquellen und Vulnerabilities\n‚Ä¢ Automatisierte Asset-Inventarisierung mit Bewertung von Informationswerten und Kritikalit√§t\n‚Ä¢ Integration von Threat-Intelligence-Feeds f√ºr aktuelle Bedrohungslandschaften und emerging Risks\n‚Ä¢ Systematische Analyse von Gesch√§ftsprozessen und deren Abh√§ngigkeiten f√ºr ganzheitliche Risikosicht\n‚Ä¢ Ber√ºcksichtigung regulatorischer Risiken und Compliance-Anforderungen in der Risikobewertung\n\nüìä Quantitative und qualitative Risikobewertung:\n‚Ä¢ Hybride Bewertungsans√§tze, die sowohl quantitative Metriken als auch qualitative Expertenbewertungen integrieren\n‚Ä¢ Standardisierte Bewertungsmatrizen mit konsistenten Kriterien f√ºr Eintrittswahrscheinlichkeit und Schadensausma√ü\n‚Ä¢ Monte-Carlo-Simulationen und statistische Modelle f√ºr pr√§zise Risikoquantifizierung\n‚Ä¢ Integration von historischen Incident-Daten und Branchenbenchmarks\n‚Ä¢ Dynamische Risikobewertung mit Echtzeit-Updates basierend auf sich √§ndernden Bedrohungslagen\n\nüõ°Ô∏è Strategische Risikotreament-Planung:\n‚Ä¢ Umfassende Kontrollma√ünahmen-Bibliothek mit bew√§hrten Sicherheitskontrollen und deren Wirksamkeitsbewertung\n‚Ä¢ Automatisierte Treatment-Plan-Generierung basierend auf Risikobewertung und verf√ºgbaren Ressourcen\n‚Ä¢ Kosten-Nutzen-Analysen f√ºr verschiedene Risikotreament-Optionen\n‚Ä¢ Integration von Residualrisiko-Bewertung und Akzeptanzkriterien\n‚Ä¢ Ber√ºcksichtigung von Risikotransfer-Optionen wie Cyber-Versicherungen und Outsourcing\n\nüîÑ Kontinuierliches Risiko-Monitoring und -Management:\n‚Ä¢ Echtzeit-Risiko-Dashboards mit automatisierten Alerts bei kritischen Risikover√§nderungen\n‚Ä¢ Integration mit Security Information and Event Management Systemen f√ºr operative Risiko√ºberwachung\n‚Ä¢ Automatisierte KRI-√úberwachung mit Trend-Analyse und Fr√ºhwarnsystemen\n‚Ä¢ Regelm√§√üige Risikoreassessments mit automatisierten Workflows und Erinnerungsfunktionen\n‚Ä¢ Management-Reporting mit Executive-Level-Risikokommunikation und Entscheidungsunterst√ºtzung\n\nüåê Enterprise-weite Risikointegration:\n‚Ä¢ Nahtlose Integration in bestehende Enterprise Risk Management Frameworks und Governance-Strukturen\n‚Ä¢ Korrelation von Informationssicherheitsrisiken mit operationellen, finanziellen und strategischen Risiken\n‚Ä¢ Einheitliche Risikotaxonomie und -klassifizierung f√ºr organisationsweite Konsistenz\n‚Ä¢ Integration in Business Continuity Management und Disaster Recovery Planning\n‚Ä¢ Ber√ºcksichtigung von Supply Chain Risks und Third-Party-Risiken\n\nüìà Datengetriebene Risikointelligenz:\n‚Ä¢ Advanced Analytics f√ºr Risikotrendanalyse und pr√§diktive Risikobewertung\n‚Ä¢ Machine Learning Algorithmen f√ºr automatisierte Anomalieerkennung und Risikosignale\n‚Ä¢ Integration externer Risikodatenquellen und Threat-Intelligence-Plattformen\n‚Ä¢ Benchmarking gegen Branchenstandards und Peer-Organisationen\n‚Ä¢ Kontinuierliche Verbesserung der Risikobewertungsmodelle basierend auf Erfahrungsdaten und Feedback"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Vorteile bieten automatisierte Projektmanagement-Tools f√ºr die ISMS-Implementierung?',
        answer: "Automatisierte Projektmanagement-Tools transformieren die ISMS-Implementierung von einem komplexen, schwer √ºberschaubaren Unterfangen in einen strukturierten, transparenten und effizient steuerbaren Prozess. Diese Tools integrieren bew√§hrte Projektmanagement-Methoden mit ISMS-spezifischen Anforderungen und schaffen eine solide Grundlage f√ºr erfolgreiche, termingerechte Implementierungen.\n\nüìÖ Strukturierte Projektplanung und Roadmap-Entwicklung:\n‚Ä¢ Vorkonfigurierte ISMS-Implementierungsroadmaps mit bew√§hrten Phasen, Meilensteinen und Abh√§ngigkeiten\n‚Ä¢ Automatisierte Aufgabenzerlegung komplexer ISO 27001 Anforderungen in manageable Work Packages\n‚Ä¢ Intelligente Ressourcenplanung mit Kapazit√§tsmanagement und Skill-Matching\n‚Ä¢ Integration von Risikofaktoren und Puffern f√ºr realistische Zeitplanung\n‚Ä¢ Szenario-Planung f√ºr verschiedene Implementierungsans√§tze und Ressourcenverf√ºgbarkeiten\n\n‚ö° Echtzeit-Fortschrittsverfolgung und Transparenz:\n‚Ä¢ Live-Dashboards mit aktuellen Implementierungsfortschritten und KPI-√úberwachung\n‚Ä¢ Automatisierte Meilenstein-Tracking mit Ampelsystemen f√ºr kritische Pfade\n‚Ä¢ Integrierte Zeiterfassung und Aufwandsdokumentation f√ºr pr√§zise Projektcontrolling\n‚Ä¢ Automatische Benachrichtigungen bei Terminabweichungen oder kritischen Verz√∂gerungen\n‚Ä¢ Stakeholder-spezifische Reporting-Views f√ºr verschiedene Organisationsebenen\n\nüéØ Optimierte Ressourcenallokation und Teamkoordination:\n‚Ä¢ Intelligente Ressourcenzuteilung basierend auf Verf√ºgbarkeiten, Kompetenzen und Priorit√§ten\n‚Ä¢ Automatisierte Workload-Balancing zur Vermeidung von √úberlastungen und Engp√§ssen\n‚Ä¢ Integration von Skill-Matrizen f√ºr optimale Aufgabenverteilung\n‚Ä¢ Cross-funktionale Teamkoordination mit automatisierten Kommunikations-Workflows\n‚Ä¢ Eskalationsmanagement mit automatisierten Alerts bei kritischen Situationen\n\nüìã Integriertes Aufgaben- und Abh√§ngigkeitsmanagement:\n‚Ä¢ Automatisierte Abh√§ngigkeitsverfolgung zwischen verschiedenen Implementierungsaktivit√§ten\n‚Ä¢ Kritischer Pfad-Analyse mit automatischer Identifikation von Bottlenecks und Risiken\n‚Ä¢ Intelligente Aufgabenpriorisierung basierend auf Business Impact und Abh√§ngigkeiten\n‚Ä¢ Automatisierte Workflow-Orchestrierung f√ºr sequenzielle und parallele Aktivit√§ten\n‚Ä¢ Integration von Change-Management-Prozessen f√ºr Scope-√Ñnderungen und Anpassungen\n\nüîÑ Kontinuierliche Qualit√§tssicherung und Compliance-Tracking:\n‚Ä¢ Integrierte Quality Gates mit automatisierten Compliance-Checks an kritischen Meilensteinen\n‚Ä¢ Dokumentations-Tracking mit automatischer Validierung von Deliverable-Vollst√§ndigkeit\n‚Ä¢ Audit-Trail-Funktionalit√§t f√ºr vollst√§ndige Nachvollziehbarkeit aller Projektaktivit√§ten\n‚Ä¢ Automatisierte Risikobewertung und Mitigation-Tracking\n‚Ä¢ Integration von Lessons Learned und kontinuierlicher Prozessverbesserung\n\nüìä Datengetriebene Entscheidungsunterst√ºtzung:\n‚Ä¢ Advanced Analytics f√ºr Projektperformance-Analyse und Trend-Identifikation\n‚Ä¢ Pr√§diktive Modelle f√ºr Terminprognosen und Ressourcenbedarfsplanung\n‚Ä¢ Automatisierte What-If-Analysen f√ºr verschiedene Projektszenarien\n‚Ä¢ Benchmark-Vergleiche mit √§hnlichen Implementierungsprojekten\n‚Ä¢ KPI-basierte Performance-Messung mit automatisierten Management-Reports\n\nüåê Nahtlose Tool-Integration und Automatisierung:\n‚Ä¢ API-Integration mit bestehenden Unternehmenssystemen und Collaboration-Plattformen\n‚Ä¢ Automatisierte Synchronisation mit Dokumentenmanagement-Systemen\n‚Ä¢ Integration mit Risikomanagement-Tools und Compliance-Plattformen\n‚Ä¢ Workflow-Automatisierung f√ºr wiederkehrende Projektaktivit√§ten\n‚Ä¢ Mobile Zug√§nglichkeit f√ºr flexible Projektsteuerung und Statusupdates"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
