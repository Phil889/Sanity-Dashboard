import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating CRR/CRD Gap Analyse Prozesse Systeme page with FAQs batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'crr-crd-gap-analyse-prozesse-systeme' })
    
    if (!existingDoc) {
      throw new Error('Document "crr-crd-gap-analyse-prozesse-systeme" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Welche Vorteile bietet eine strukturierte Gap-Analyse der Prozesse und Systeme f√ºr die CRR/CRD-Compliance gegen√ºber einem inkrementellen Anpassungsansatz?",
        answer: "Eine strukturierte Gap-Analyse der Prozesse und Systeme bietet gegen√ºber inkrementellen Anpassungen fundamentale strategische und operative Vorteile, die weit √ºber eine reine Compliance-Erf√ºllung hinausgehen. W√§hrend der inkrementelle Ansatz h√§ufig zu isolierten Einzell√∂sungen f√ºhrt, erm√∂glicht die strukturierte Gap-Analyse eine ganzheitliche Transformation, die regulatorische Anforderungen mit betrieblicher Effizienz und strategischen Zielen in Einklang bringt.\n\nüîç Systematische Identifikation von Synergien und Interdependenzen:\n‚Ä¢ Aufdeckung prozess- und system√ºbergreifender Abh√§ngigkeiten, die bei isolierten Betrachtungen √ºbersehen werden, was bis zu 30% Effizienzgewinne bei der Implementierung erm√∂glicht.\n‚Ä¢ Identifikation von Datenfl√ºssen und Schnittstellen zwischen verschiedenen regulatorischen Anforderungen (z.B. Beziehungen zwischen Kapitalplanung, Risikomanagement und Offenlegungspflichten).\n‚Ä¢ Erkennung von Redundanzen in bestehenden Prozessen und Kontrollen, wodurch Doppelarbeiten eliminiert und Ressourcen effizienter eingesetzt werden k√∂nnen.\n‚Ä¢ Aufdeckung verdeckter Risiken in Prozess√ºberg√§ngen, die bei fragmentierten Analysen oft unentdeckt bleiben und sp√§tere Compliance-Probleme verursachen k√∂nnen.\n\nüèóÔ∏è Fundament f√ºr nachhaltige Transformation statt punktueller Korrektur:\n‚Ä¢ Schaffung einer konsistenten Basis f√ºr k√ºnftige regulatorische Anpassungen anstelle von kurzfristigen Flickl√∂sungen, die bei jeder Regulierungs√§nderung neu implementiert werden m√ºssen.\n‚Ä¢ Etablierung einer zukunftssicheren Prozess- und Systemarchitektur, die flexibel auf neue Anforderungen reagieren kann und Implementierungskosten f√ºr zuk√ºnftige Anpassungen um 40-60% reduziert.\n‚Ä¢ Integration von CRR/CRD-Anforderungen in die strategische Unternehmensplanung statt isolierter Compliance-Projekte, was zu einer verbesserten Nutzung regulatorischer Investitionen f√ºhrt.\n‚Ä¢ Entwicklung einer koh√§renten Governance-Struktur f√ºr regulatorische √Ñnderungen, die eine konsistente Steuerung √ºber alle betroffenen Bereiche hinweg gew√§hrleistet.\n\nüí∞ Kosteneffizienz und Ressourcenoptimierung:\n‚Ä¢ Vermeidung kostspieliger Nachbesserungen und Notfall-Implementierungen, die bei reaktiven Ans√§tzen durchschnittlich 2,5-mal h√∂here Kosten verursachen als proaktive, strukturierte Vorgehensweisen.\n‚Ä¢ Priorisierung von Ma√ünahmen nach regulatorischer Relevanz, Implementierungsaufwand und betrieblichem Nutzen, was eine optimale Ressourcenallokation erm√∂glicht.\n‚Ä¢ Identifikation von Automatisierungspotenzialen durch die ganzheitliche Prozessbetrachtung, wodurch manuelle T√§tigkeiten reduziert und Betriebskosten nachhaltig gesenkt werden k√∂nnen.\n‚Ä¢ Vermeidung von Parallelstrukturen und -systemen, die bei inkrementellen Anpassungen oft entstehen und zu erh√∂hten Wartungs- und Integrationskosten f√ºhren.\n\nüöÄ Strategischer Mehrwert √ºber die reine Compliance hinaus:\n‚Ä¢ Nutzung regulatorischer Anforderungen als Katalysator f√ºr betriebliche Verbesserungen und Prozessoptimierungen, die auch abseits der Compliance-Funktion Mehrwert schaffen.\n‚Ä¢ Verbesserung der Datenqualit√§t und Informationsverf√ºgbarkeit √ºber Abteilungsgrenzen hinweg, was bessere Gesch√§ftsentscheidungen erm√∂glicht.\n‚Ä¢ St√§rkung des Risikomanagements durch eine integrierte Betrachtung von Risiken √ºber Silos hinweg, was die Stabilit√§t und Resilienz des Instituts erh√∂ht.\n‚Ä¢ Entwicklung eines Kompetenzzentrums f√ºr regulatorische Themen, das proaktiv auf √Ñnderungen reagieren und Wettbewerbsvorteile sichern kann."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Wie sollte eine effektive Ist-Analyse der Prozesslandschaft im Kontext der CRR/CRD-Anforderungen strukturiert sein und welche Methoden empfiehlt ADVISORI?",
        answer: "Eine effektive Ist-Analyse der Prozesslandschaft im CRR/CRD-Kontext erfordert einen systematischen, mehrschichtigen Ansatz, der regulatorische Expertise mit fundiertem Prozessverst√§ndnis verbindet. Im Gegensatz zu generischen Prozessanalysen muss der Fokus gezielt auf den regulatorisch relevanten Aspekten liegen, ohne dabei die operativen Realit√§ten und strategischen Ziele aus dem Blick zu verlieren. ADVISORI setzt auf einen bew√§hrten methodischen Ansatz, der Tiefe, Breite und Pr√§zision vereint.\n\nüîÑ Mehrdimensionaler Analyserahmen:\n‚Ä¢ Regulatorische Dimension: Systematische Zuordnung der Prozesse zu spezifischen CRR/CRD-Anforderungen mit detaillierter Bewertung der Compliance-Relevanz und -Kritikalit√§t jedes Prozessschritts.\n‚Ä¢ Organisatorische Dimension: Analyse der Aufbauorganisation mit Fokus auf Verantwortlichkeiten, Kompetenzen und Kontrollfunktionen entlang der Three Lines of Defense, inklusive Identifikation von Governance-L√ºcken und √úberschneidungen.\n‚Ä¢ Technische Dimension: Bewertung der systemischen Unterst√ºtzung von Prozessen mit Analyse der Datenfl√ºsse, Schnittstellenqualit√§t und Automatisierungsgrad im Kontext regulatorischer Anforderungen.\n‚Ä¢ Kulturelle Dimension: Evaluation des Compliance-Bewusstseins, der Risikokultur und des Verst√§ndnisses f√ºr regulatorische Anforderungen in den betroffenen Fachbereichen als Grundlage f√ºr Ver√§nderungsmanagement.\n\nüìä Datenerhebungsmethoden und Analysewerkzeuge:\n‚Ä¢ Strukturierte Prozessdokumentation: Nutzung standardisierter Notationen wie BPMN 2.0 f√ºr eine einheitliche, detaillierte Darstellung von Prozessen mit regulatorischen Kontrollpunkten, Datenelementen und Systemverwendung.\n‚Ä¢ Tiefeninterviews mit Schl√ºsselpersonen: Durchf√ºhrung zielgerichteter Interviews mit Prozesseignern, Fachexperten und Kontrollfunktionen zur Erfassung impliziten Wissens und informeller Praktiken, die in formalen Dokumentationen oft fehlen.\n‚Ä¢ Systemgest√ºtzte Prozessanalyse: Einsatz von Process Mining und Workflow-Analysetools zur datenbasierten Identifikation von tats√§chlichen Prozessabl√§ufen, Engp√§ssen und Abweichungen vom Soll-Prozess.\n‚Ä¢ Regulatorischer Prozess-Scan: Abgleich der Prozesse mit einer umfassenden Bibliothek an CRR/CRD-Anforderungen und Best Practices zur systematischen Identifikation von Compliance-L√ºcken und -Risiken.\n\nüß© ADVISORI-Methodik f√ºr eine strukturierte Ist-Analyse:\n‚Ä¢ Top-Down und Bottom-Up Integration: Kombination einer anforderungsgetriebenen Analyse (ausgehend von regulatorischen Vorgaben) mit einer prozessgetriebenen Perspektive (ausgehend von bestehenden Abl√§ufen) f√ºr eine l√ºckenlose 360¬∞-Betrachtung.\n‚Ä¢ Prozesspriorisierungsmatrix: Bewertung aller Prozesse nach ihrer regulatorischen Kritikalit√§t, operativen Bedeutung und Ver√§nderungsnotwendigkeit zur fokussierten Ressourcenallokation in der Analysephase.\n‚Ä¢ Regulatory Process Heat Map: Visuelle Darstellung der Prozesslandschaft mit farblicher Kennzeichnung der Compliance-Reife und -L√ºcken zur transparenten Kommunikation mit Management und Stakeholdern.\n‚Ä¢ Cross-Functional Assessment Workshops: Durchf√ºhrung moderierter Workshops mit Vertretern aus verschiedenen Fachbereichen zur kollaborativen Bewertung von Schnittstellen und √ºbergreifenden Prozessen.\n\nüìù Dokumentationsstandards und Deliverables:\n‚Ä¢ Integriertes Prozessrepository: Aufbau einer zentralen, strukturierten Dokumentation aller analysierten Prozesse mit klarer Verlinkung zu regulatorischen Anforderungen und Systemlandschaft.\n‚Ä¢ Prozess-RACIs: Detaillierte Verantwortlichkeitsmatrizen f√ºr alle regulatorisch relevanten Prozesse mit klarer Zuordnung von Rollen und Verantwortlichkeiten gem√§√ü des RACI-Modells (Responsible, Accountable, Consulted, Informed).\n‚Ä¢ End-to-End Prozessmodelle: Erstellung √ºbergreifender Prozessmodelle, die die komplette Wertsch√∂pfungskette vom Ursprung bis zum finalen regulatorischen Output (z.B. Meldewesen) abbilden, √ºber Abteilungs- und Systemgrenzen hinweg.\n‚Ä¢ Regulatorische Prozesslandkarte: Entwicklung einer hierarchischen Visualisierung der Prozesslandschaft mit direkter Zuordnung zu CRR/CRD-Anforderungen als Navigationsinstrument f√ºr die Gap-Analyse und sp√§tere Implementierung."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Welche typischen L√ºcken und Herausforderungen werden bei der System- und Datenarchitekturanalyse f√ºr CRR/CRD-Compliance identifiziert und wie k√∂nnen diese behoben werden?",
        answer: "Bei der System- und Datenarchitekturanalyse im CRR/CRD-Kontext treten regelm√§√üig fundamentale Herausforderungen auf, die weit √ºber einfache technische Probleme hinausgehen. Diese strukturellen L√ºcken reflektieren die Diskrepanz zwischen historisch gewachsenen IT-Landschaften und den zunehmend granularen, flexiblen und zeitkritischen Anforderungen moderner Bankenregulierung. Eine systematische Analyse dieser L√ºcken bildet den Grundstein f√ºr eine nachhaltige Transformation der regulatorischen IT-Architektur.\n\nüß© Typische systemische Fragmentierung und Integrationsdefizite:\n‚Ä¢ Silobasierte Systemlandschaften: Historisch gewachsene, nach Gesch√§ftsbereichen oder Produkten segmentierte Systeme ohne hinreichende Integration, wodurch konsistente Gesamtsichten auf Risikopositionen und Kapitalanforderungen erschwert werden.\n‚Ä¢ Diskrepanz zwischen Risiko- und Finanzsystemen: Unterschiedliche Datenmodelle, Aggregationslogiken und Bewertungsans√§tze in Risiko- und Finanzarchitekturen, die zu inkonsistenten Ergebnissen und Reconciliation-Aufw√§nden f√ºhren.\n‚Ä¢ Unzureichende Schnittstellen-Governance: Fehlende Standards und Kontrollen f√ºr Datenaustausch zwischen Systemen, was manuelle Eingriffe erfordert und die Datenintegrit√§t gef√§hrdet.\n‚Ä¢ Legacy-System-Komplexit√§t: Veraltete Kernsysteme mit eingeschr√§nkter Flexibilit√§t, die nur mit hohem Aufwand an neue regulatorische Anforderungen angepasst werden k√∂nnen.\n\nüîç L√∂sungsans√§tze f√ºr Systemintegration und Architekturoptimierung:\n‚Ä¢ Einf√ºhrung einer Regulatorischen Integration Layer: Implementierung einer spezialisierten Middleware-Ebene, die heterogene Systeme verbindet und standardisierte Schnittstellen f√ºr regulatorische Prozesse bietet.\n‚Ä¢ Microservices-Architektur f√ºr regulatorische Funktionen: Entwicklung flexibler, modularer Services f√ºr spezifische regulatorische Berechnungen und Validierungen, die leichter an √Ñnderungen angepasst werden k√∂nnen als monolithische Anwendungen.\n‚Ä¢ API-Strategie f√ºr Regulatorik: Etablierung eines umfassenden API-Frameworks, das standardisierte Zugriffe auf regulatorisch relevante Daten erm√∂glicht und die Entkopplung von Frontend- und Backend-Systemen unterst√ºtzt.\n‚Ä¢ Regulatory System Roadmap: Entwicklung einer langfristigen Systemstrategie, die schrittweise Legacy-Abl√∂sungen mit kurzfristigen Integrationsl√∂sungen kombiniert und klare Migrationspfade definiert.\n\nüìä Datenarchitekturdefizite und deren Behebung:\n‚Ä¢ Mangelnde Datengranularit√§t: Unzureichend detaillierte Daten f√ºr fortgeschrittene Risikomodelle und granulare regulatorische Anforderungen, was durch Einf√ºhrung eines Regulatory Data Warehouse mit transaktionsbasierter Granularit√§t adressiert werden kann.\n‚Ä¢ Inkonsistente Stammdaten und Taxonomien: Unterschiedliche Definitionen und Klassifikationen f√ºr gleiche Gesch√§ftsobjekte in verschiedenen Systemen, was durch ein zentrales Regulatory Master Data Management mit verbindlichen Taxonomien gel√∂st werden sollte.\n‚Ä¢ Unzureichende Datenhistorisierung: Fehlende oder inkonsistente Historisierungskonzepte, die eine Nachvollziehbarkeit regulatorischer Berechnungen im Zeitverlauf erschweren und durch ein regelbasiertes Datenarchivierungskonzept behoben werden k√∂nnen.\n‚Ä¢ Data Lineage-Defizite: Mangelnde Transparenz √ºber Datenherkunft, -transformationen und -verwendung, was durch implementierung einer end-to-end Data Lineage-L√∂sung mit speziellen Governance-Werkzeugen adressiert werden sollte.\n\n‚öôÔ∏è Prozess-System-Alignment Herausforderungen:\n‚Ä¢ Manuelle Prozessbr√ºche: Technologische L√ºcken zwischen Systemen, die durch manuelle Eingriffe, Excel-L√∂sungen und Workarounds √ºberbr√ºckt werden und durch gezielte Prozessautomatisierung und Workflow-Management geschlossen werden sollten.\n‚Ä¢ Unzureichende Kontrollfunktionen: Fehlende systemische Unterst√ºtzung f√ºr Vier-Augen-Prinzipien, Validierungen und Audit Trails, was durch Implementierung eines durchg√§ngigen Control Management Frameworks behoben werden kann.\n‚Ä¢ Verz√∂gerte Verf√ºgbarkeit regulatorischer Daten: Time-to-Report-Problematik durch ineffiziente Batch-Verarbeitung und sequenzielle Prozesse, die durch Einf√ºhrung von Near-Real-Time-Verarbeitungskonzepten und paralleler Datenverarbeitung optimiert werden kann.\n‚Ä¢ Limitierte Flexibilit√§t bei √Ñnderungen: Hoher Anpassungsaufwand bei regulatorischen √Ñnderungen durch hardcodierte Logik und fehlende Parametrisierbarkeit, was durch Etablierung konfigurierbarer Regelengines adressiert werden sollte."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie kann eine CRR/CRD Gap-Analyse optimal mit bestehenden Compliance- und Risikomanagement-Frameworks verkn√ºpft werden, um Synergien zu nutzen?",
        answer: "Die Verkn√ºpfung einer CRR/CRD Gap-Analyse mit bestehenden Compliance- und Risikomanagement-Frameworks schafft erhebliche Synergien, die weit √ºber isolierte Compliance-Ma√ünahmen hinausgehen. Durch eine intelligente Integration werden nicht nur Redundanzen vermieden, sondern es entsteht ein ganzheitlicher Governance-Ansatz, der regulatorische Anforderungen in den breiteren Kontext des organisatorischen Risikomanagements einbettet und nachhaltige Wertsch√∂pfung erm√∂glicht.\n\nüîÑ Integration in das Three Lines of Defense-Modell:\n‚Ä¢ First Line Alignment: Einbettung der CRR/CRD-Anforderungen in operative Prozesse und Kontrollen der Fachbereiche durch klare Verantwortlichkeitszuordnung und Performance-Metriken, die regulatorische Aspekte mit Gesch√§ftszielen verkn√ºpfen.\n‚Ä¢ Second Line Spezialisierung: Gezielte Erweiterung der Compliance- und Risikofunktionen um CRR/CRD-spezifische Expertise und √úberwachungsmechanismen, die in bestehende Kontrollsysteme integriert werden und diese komplement√§r erg√§nzen.\n‚Ä¢ Third Line Assurance: Entwicklung eines spezifischen Pr√ºfungsansatzes f√ºr die Interne Revision, der CRR/CRD-Compliance in regul√§re Audits einbezieht und systematisch die Effektivit√§t der implementierten Ma√ünahmen evaluiert.\n‚Ä¢ Line-√ºbergreifende Governance: Etablierung eines koordinierten Steuerungsansatzes durch spezialisierte Komitees oder Arbeitsgruppen, die Vertreter aller drei Verteidigungslinien umfassen und koh√§rente Entscheidungen sicherstellen.\n\nüß© Synergetische Verkn√ºpfung mit dem Internen Kontrollsystem (IKS):\n‚Ä¢ Integrierte Kontrolllandkarte: Mapping regulatorischer Kontrollanforderungen aus der CRR/CRD auf die bestehende Kontrolllandschaft, um Redundanzen zu eliminieren und Kontrolll√ºcken gezielt zu schlie√üen.\n‚Ä¢ Harmonisierte Kontrolldokumentation: Entwicklung eines einheitlichen Dokumentationsstandards, der sowohl allgemeine IKS-Anforderungen als auch spezifische CRR/CRD-Kontrollen umfasst und eine konsistente Qualit√§tssicherung erm√∂glicht.\n‚Ä¢ Risikoorientierte Kontrollpriorisierung: Nutzung der aus der Gap-Analyse gewonnenen Risikobewertungen zur Fokussierung von Kontrollressourcen auf die kritischsten regulatorischen Bereiche, in Abstimmung mit dem allgemeinen operationellen Risikomanagement.\n‚Ä¢ Automatisierte Kontrollintegration: Implementierung technologiegest√ºtzter Kontrollmechanismen, die sowohl regulatorische als auch allgemeine Kontrollziele abdecken und durch zentrale Monitoring-Systeme √ºberwacht werden k√∂nnen.\n\nüìà Verkn√ºpfung mit dem Risikomanagement-Framework:\n‚Ä¢ Integrierte Risikoidentifikation: Erweiterung bestehender Risikoinventare und -taxonomien um spezifische CRR/CRD-Compliance-Risiken, so dass diese in regul√§ren Risk Assessment-Prozessen miterfasst und bewertet werden.\n‚Ä¢ Harmonisierte Risikobewertungsmethodik: Angleichung der in der Gap-Analyse verwendeten Bewertungskriterien an die allgemeine Risikobewertungsmethodik des Instituts f√ºr eine konsistente Priorisierung und Aggregation.\n‚Ä¢ Verzahnung mit ICAAP/ILAAP: Nutzung der in der Gap-Analyse identifizierten Prozess- und Systeml√ºcken zur Verbesserung der internen Kapital- und Liquidit√§tsad√§quanzprozesse, mit besonderem Fokus auf Datenqualit√§t und Methodenrobustheit.\n‚Ä¢ Erweitertes Limit-Management: Integration regulatorischer Kennzahlen und Schwellenwerte in das allgemeine Limit-System des Instituts, mit entsprechenden Eskalations- und Governance-Prozessen bei Ann√§herung an kritische Grenzwerte.\n\nüîê Synergien im Daten-Governance-Bereich:\n‚Ä¢ Integriertes Data Quality Management: Verkn√ºpfung regulatorischer Datenanforderungen mit dem allgemeinen Datenqualit√§tsrahmenwerk, inklusive harmonisierter Metriken, Kontrollen und Verbesserungsprozesse.\n‚Ä¢ Gemeinsame Data Lineage: Entwicklung einer umfassenden Datenherkunfts- und Verwendungsdokumentation, die sowohl regulatorische als auch gesch√§ftliche Verwendungszwecke abdeckt und Mehrfacherhebungen vermeidet.\n‚Ä¢ Koordiniertes Data Ownership: Etablierung eines abgestimmten Data-Stewardship-Modells, das klare Verantwortlichkeiten f√ºr regulatorisch relevante Daten im Rahmen des allgemeinen Datengovernance-Modells definiert.\n‚Ä¢ Zentralisiertes Metadaten-Management: Aufbau eines unternehmensweiten Metadaten-Repositories, das regulatorische Definitionen und Taxonomien mit gesch√§ftlichen Begriffsdefinitionen harmonisiert und konsistente Datentransformationen erm√∂glicht."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
