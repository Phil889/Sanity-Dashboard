import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISMS ISO 27001 page with FAQ batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'isms-iso-27001' })
    
    if (!existingDoc) {
      throw new Error('Document "isms-iso-27001" not found')
    }
    
    // Create new FAQs for ISMS certification and compliance
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 13),
        question: 'Wie bereitet man sich auf die ISO 27001 Zertifizierung vor und was sind die kritischen Erfolgsfaktoren?',
        answer: "Die Vorbereitung auf die ISO 27001 Zertifizierung erfordert eine systematische Herangehensweise, die weit √ºber die reine Dokumentenerstellung hinausgeht. Erfolgreiche Zertifizierungen basieren auf einer gr√ºndlichen ISMS-Implementierung, effektiver Vorbereitung und strategischer Planung des Zertifizierungsprozesses.\n\nüéØ Strategische Zertifizierungsplanung:\n‚Ä¢ Fr√ºhzeitige Definition der Zertifizierungsziele und des gew√ºnschten Anwendungsbereichs\n‚Ä¢ Auswahl einer akkreditierten Zertifizierungsstelle mit entsprechender Branchenexpertise\n‚Ä¢ Entwicklung eines realistischen Zeitplans mit ausreichenden Puffern f√ºr Nachbesserungen\n‚Ä¢ Budgetplanung f√ºr alle Zertifizierungskosten einschlie√ülich m√∂glicher Folgeaudits\n‚Ä¢ Integration der Zertifizierungsvorbereitung in die Gesamtprojektplanung\n\nüìã Systematische ISMS-Readiness-Bewertung:\n‚Ä¢ Durchf√ºhrung umfassender Gap-Analysen gegen alle ISO 27001 Anforderungen\n‚Ä¢ Bewertung der Implementierungsqualit√§t und Wirksamkeit aller Sicherheitskontrollen\n‚Ä¢ √úberpr√ºfung der Vollst√§ndigkeit und Qualit√§t der ISMS-Dokumentation\n‚Ä¢ Test der operativen ISMS-Prozesse unter realistischen Bedingungen\n‚Ä¢ Validierung der Kompetenz und des Bewusstseins aller beteiligten Mitarbeiter\n\nüîç Interne Audit-Vorbereitung:\n‚Ä¢ Durchf√ºhrung mehrerer interner Audits mit externen oder unabh√§ngigen Auditoren\n‚Ä¢ Simulation des Zertifizierungsaudits mit realistischen Audit-Szenarien\n‚Ä¢ Identifikation und Behebung aller Nichtkonformit√§ten vor dem externen Audit\n‚Ä¢ Training der Mitarbeiter f√ºr Audit-Interviews und Dokumentenpr√ºfungen\n‚Ä¢ Aufbau von Routine und Sicherheit im Umgang mit Audit-Situationen\n\nüìä Dokumentations-Exzellenz:\n‚Ä¢ Sicherstellung der Vollst√§ndigkeit aller obligatorischen Dokumente\n‚Ä¢ Qualit√§tspr√ºfung der Dokumenteninhalte auf Konsistenz und Verst√§ndlichkeit\n‚Ä¢ Nachweis der praktischen Anwendung und Wirksamkeit dokumentierter Verfahren\n‚Ä¢ Aufbau einer logischen und nachvollziehbaren Dokumentenstruktur\n‚Ä¢ Vorbereitung von Evidenzen f√ºr die Umsetzung aller ISMS-Aktivit√§ten\n\nüë• Mitarbeiter-Readiness und Change Management:\n‚Ä¢ Umfassende Schulung aller Mitarbeiter zu ihren ISMS-Rollen und Verantwortlichkeiten\n‚Ä¢ Aufbau von Sicherheitsbewusstsein und Verst√§ndnis f√ºr ISO 27001 Anforderungen\n‚Ä¢ Training von Schl√ºsselpersonen f√ºr Audit-Interviews und Pr√§sentationen\n‚Ä¢ Entwicklung einer positiven Einstellung zur Zertifizierung als Qualit√§tsmerkmal\n‚Ä¢ Sicherstellung der Verf√ºgbarkeit kompetenter Ansprechpartner w√§hrend des Audits\n\nüîÑ Kontinuierliche Verbesserung vor Zertifizierung:\n‚Ä¢ Nachweis funktionierender PDCA-Zyklen und kontinuierlicher Verbesserung\n‚Ä¢ Dokumentation von Lessons Learned und implementierten Verbesserungsma√ünahmen\n‚Ä¢ Demonstration der ISMS-Reife durch mehrere Management Review Zyklen\n‚Ä¢ Aufbau einer Kultur der kontinuierlichen Verbesserung und Selbstreflexion\n‚Ä¢ Vorbereitung auf Fragen zur ISMS-Entwicklung und zuk√ºnftigen Pl√§nen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 14),
        question: 'Welche Rolle spielt die Kompetenz und das Bewusstsein der Mitarbeiter im ISMS?',
        answer: "Kompetenz und Bewusstsein der Mitarbeiter bilden das Fundament eines erfolgreichen ISMS nach ISO 27001. Menschen sind sowohl die gr√∂√üte Schwachstelle als auch der wichtigste Erfolgsfaktor f√ºr Informationssicherheit. Ein systematischer Ansatz zur Kompetenzentwicklung und Bewusstseinsbildung ist daher essentiell f√ºr die ISMS-Wirksamkeit.\n\nüéØ Strategische Bedeutung von Human Factors:\n‚Ä¢ Mitarbeiter sind die erste und letzte Verteidigungslinie gegen Informationssicherheitsbedrohungen\n‚Ä¢ Menschliche Fehler verursachen einen Gro√üteil aller Sicherheitsvorf√§lle in Organisationen\n‚Ä¢ Kompetente und bewusste Mitarbeiter k√∂nnen Bedrohungen fr√ºhzeitig erkennen und melden\n‚Ä¢ Sicherheitskultur entsteht durch das Verhalten und die Einstellung aller Organisationsmitglieder\n‚Ä¢ Compliance mit Sicherheitsrichtlinien h√§ngt ma√ügeblich vom Verst√§ndnis und der Akzeptanz ab\n\nüìö Systematische Kompetenzentwicklung:\n‚Ä¢ Identifikation spezifischer Kompetenzanforderungen f√ºr verschiedene Rollen und Verantwortlichkeiten\n‚Ä¢ Entwicklung rollenspezifischer Schulungsprogramme f√ºr unterschiedliche Zielgruppen\n‚Ä¢ Aufbau von Grundlagenwissen zu Informationssicherheit f√ºr alle Mitarbeiter\n‚Ä¢ Spezialisierte Schulungen f√ºr Mitarbeiter in sicherheitskritischen Positionen\n‚Ä¢ Kontinuierliche Weiterbildung zu neuen Bedrohungen und Sicherheitstechnologien\n\nüß† Bewusstseinsbildung und Sensibilisierung:\n‚Ä¢ Regelm√§√üige Awareness-Kampagnen zu aktuellen Sicherheitsthemen und Bedrohungen\n‚Ä¢ Praktische √úbungen und Simulationen f√ºr realistische Sicherheitsszenarien\n‚Ä¢ Kommunikation von Sicherheitsvorf√§llen und Lessons Learned ohne Schuldzuweisungen\n‚Ä¢ Integration von Sicherheitsbotschaften in allt√§gliche Kommunikationskan√§le\n‚Ä¢ Aufbau einer positiven Sicherheitskultur durch Anerkennung und Belohnung\n\nüìä Messung und Bewertung der Kompetenz:\n‚Ä¢ Entwicklung von Kompetenzprofilen und Bewertungskriterien f√ºr sicherheitsrelevante Rollen\n‚Ä¢ Regelm√§√üige Kompetenzbewertungen durch Tests, Interviews oder praktische √úbungen\n‚Ä¢ Tracking der Schulungsteilnahme und Bewertung der Lerneffektivit√§t\n‚Ä¢ Messung des Sicherheitsbewusstseins durch Umfragen und Verhaltensbeobachtungen\n‚Ä¢ Analyse von Sicherheitsvorf√§llen im Hinblick auf Kompetenz- und Bewusstseinsl√ºcken\n\nüé™ Innovative Lernans√§tze und Methoden:\n‚Ä¢ Einsatz von E-Learning-Plattformen f√ºr flexible und skalierbare Schulungen\n‚Ä¢ Gamification-Elemente zur Steigerung der Motivation und des Engagements\n‚Ä¢ Microlearning-Ans√§tze f√ºr kontinuierliche und verdauliche Wissensvermittlung\n‚Ä¢ Peer-to-Peer-Learning und Erfahrungsaustausch zwischen Mitarbeitern\n‚Ä¢ Simulation von Phishing-Angriffen und anderen realistischen Bedrohungsszenarien\n\nüîÑ Kontinuierliche Verbesserung der Human Factors:\n‚Ä¢ Regelm√§√üige √úberpr√ºfung und Aktualisierung der Schulungsinhalte und Methoden\n‚Ä¢ Integration von Feedback und Verbesserungsvorschl√§gen der Mitarbeiter\n‚Ä¢ Anpassung der Programme an ver√§nderte Bedrohungslandschaften und Technologien\n‚Ä¢ Benchmarking mit Best Practices anderer Organisationen\n‚Ä¢ Aufbau einer lernenden Organisation mit kontinuierlicher Kompetenzentwicklung\n\nüåü Aufbau einer nachhaltigen Sicherheitskultur:\n‚Ä¢ Vorbildfunktion der F√ºhrungskr√§fte und sichtbares Commitment zur Informationssicherheit\n‚Ä¢ Integration von Sicherheitszielen in Mitarbeiterbeurteilungen und Anreizsysteme\n‚Ä¢ Schaffung offener Kommunikationskan√§le f√ºr Sicherheitsbedenken und Verbesserungsvorschl√§ge\n‚Ä¢ Aufbau von Vertrauen durch transparente und faire Behandlung von Sicherheitsvorf√§llen\n‚Ä¢ Kontinuierliche Verst√§rkung positiver Sicherheitsverhaltensweisen durch Anerkennung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 15),
        question: 'Wie wird das ISMS an ver√§nderte Gesch√§ftsanforderungen und neue Bedrohungen angepasst?',
        answer: "Die Anpassungsf√§higkeit des ISMS an ver√§nderte Gesch√§ftsanforderungen und neue Bedrohungen ist ein kritischer Erfolgsfaktor f√ºr nachhaltige Informationssicherheit. Ein agiles und responsives ISMS erm√∂glicht es Organisationen, proaktiv auf Ver√§nderungen zu reagieren und ihre Sicherheitsposture kontinuierlich zu optimieren.\n\nüîÑ Agile ISMS-Architektur f√ºr Ver√§nderungen:\n‚Ä¢ Design des ISMS mit inh√§renter Flexibilit√§t und Anpassungsf√§higkeit\n‚Ä¢ Modularer Aufbau von Sicherheitskontrollen f√ºr einfache Erweiterung und Modifikation\n‚Ä¢ Etablierung von Change Management Prozessen f√ºr systematische ISMS-Anpassungen\n‚Ä¢ Integration von Feedback-Schleifen f√ºr kontinuierliche Verbesserung und Anpassung\n‚Ä¢ Aufbau von Resilienz durch redundante und adaptive Sicherheitsmechanismen\n\nüìä Kontinuierliches Monitoring der Ver√§nderungstreiber:\n‚Ä¢ Systematische √úberwachung der Gesch√§ftsentwicklung und strategischen Ver√§nderungen\n‚Ä¢ Monitoring der Bedrohungslandschaft durch Threat Intelligence und Security Research\n‚Ä¢ Verfolgung regulatorischer Entwicklungen und neuer Compliance-Anforderungen\n‚Ä¢ Beobachtung technologischer Trends und deren Auswirkungen auf die Informationssicherheit\n‚Ä¢ Analyse von Branchenentwicklungen und Best Practices anderer Organisationen\n\nüéØ Proaktive Risikoantizipation und Szenarioplanung:\n‚Ä¢ Entwicklung von Zukunftsszenarien f√ºr verschiedene Gesch√§fts- und Bedrohungsentwicklungen\n‚Ä¢ Durchf√ºhrung regelm√§√üiger Risikobewertungen unter Ber√ºcksichtigung neuer Faktoren\n‚Ä¢ Aufbau von Fr√ºhwarnsystemen f√ºr kritische Ver√§nderungen in der Risikolandschaft\n‚Ä¢ Szenario-basierte Planung von Anpassungsma√ünahmen und Kontingenzpl√§nen\n‚Ä¢ Integration von Trend-Analysen in die strategische ISMS-Planung\n\nüîß Systematische ISMS-Anpassungsprozesse:\n‚Ä¢ Etablierung strukturierter Prozesse f√ºr die Bewertung und Implementierung von √Ñnderungen\n‚Ä¢ Entwicklung von Kriterien f√ºr die Priorisierung verschiedener Anpassungsma√ünahmen\n‚Ä¢ Aufbau von Cross-funktionalen Teams f√ºr die Bewertung komplexer Ver√§nderungen\n‚Ä¢ Implementation von Pilot-Programmen f√ºr die Erprobung neuer Sicherheitsans√§tze\n‚Ä¢ Dokumentation und Kommunikation aller ISMS-√Ñnderungen an relevante Stakeholder\n\nüöÄ Innovation und Technologie-Integration:\n‚Ä¢ Systematische Evaluierung neuer Sicherheitstechnologien und deren Integrationspotential\n‚Ä¢ Aufbau von Innovationspartnerschaften mit Technologieanbietern und Forschungseinrichtungen\n‚Ä¢ Pilotierung emerging Technologies in kontrollierten Umgebungen\n‚Ä¢ Integration von Artificial Intelligence und Machine Learning in Sicherheitsprozesse\n‚Ä¢ Entwicklung von Cloud-first und Mobile-first Sicherheitsstrategien\n\nüìà Performance-basierte Anpassungssteuerung:\n‚Ä¢ Nutzung von KPIs und Metriken zur Identifikation von Anpassungsbedarfen\n‚Ä¢ Implementierung von Dashboards f√ºr Real-time Monitoring der ISMS-Performance\n‚Ä¢ Aufbau von Analytics-F√§higkeiten f√ºr datengetriebene Entscheidungsfindung\n‚Ä¢ Benchmarking der ISMS-Performance gegen Branchenstandards und Best Practices\n‚Ä¢ Kontinuierliche Optimierung basierend auf Performance-Daten und Feedback\n\nüåê Stakeholder-Integration und Kommunikation:\n‚Ä¢ Aufbau von Kommunikationskan√§len mit allen relevanten internen und externen Stakeholdern\n‚Ä¢ Regelm√§√üige Abstimmung mit Gesch√§ftsbereichen √ºber ver√§nderte Anforderungen\n‚Ä¢ Integration von Kunden- und Partnerfeedback in die ISMS-Entwicklung\n‚Ä¢ Zusammenarbeit mit Regulatoren und Branchenverb√§nden bei neuen Anforderungen\n‚Ä¢ Transparente Kommunikation √ºber ISMS-√Ñnderungen und deren Auswirkungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 16),
        question: 'Welche Vorteile bietet ein zertifiziertes ISMS f√ºr die Organisation und ihre Stakeholder?',
        answer: "Ein zertifiziertes ISMS nach ISO 27001 bietet umfassende Vorteile, die weit √ºber die reine Compliance hinausgehen und strategischen Mehrwert f√ºr die gesamte Organisation und ihre Stakeholder schaffen. Diese Vorteile manifestieren sich in verschiedenen Dimensionen von operativer Effizienz bis hin zu strategischen Wettbewerbsvorteilen.\n\nüèÜ Strategische Gesch√§ftsvorteile:\n‚Ä¢ Aufbau von Vertrauen und Glaubw√ºrdigkeit bei Kunden, Partnern und Investoren\n‚Ä¢ Differenzierung im Wettbewerb durch nachgewiesene Informationssicherheitskompetenz\n‚Ä¢ Erschlie√üung neuer Gesch√§ftsm√∂glichkeiten in sicherheitssensitiven M√§rkten\n‚Ä¢ St√§rkung der Marktposition durch Demonstration von Professionalit√§t und Zuverl√§ssigkeit\n‚Ä¢ Erh√∂hung des Unternehmenswerts durch reduzierte Risiken und verbesserte Governance\n\nüõ°Ô∏è Operative Sicherheitsverbesserungen:\n‚Ä¢ Systematische Reduzierung von Informationssicherheitsrisiken durch strukturierte Herangehensweise\n‚Ä¢ Verbesserte Incident Response F√§higkeiten durch etablierte Prozesse und Verfahren\n‚Ä¢ Erh√∂hte Resilienz gegen Cyber-Angriffe und andere Sicherheitsbedrohungen\n‚Ä¢ Optimierte Business Continuity durch integrierte Notfall- und Wiederherstellungsplanung\n‚Ä¢ Proaktive Sicherheitskultur statt reaktiver Schadensbegrenzung\n\nüí∞ Finanzielle und wirtschaftliche Vorteile:\n‚Ä¢ Reduzierung von Kosten durch Vermeidung von Sicherheitsvorf√§llen und Datenschutzverletzungen\n‚Ä¢ Optimierung von Versicherungspr√§mien durch nachgewiesene Risikominimierung\n‚Ä¢ Effizienzsteigerungen durch standardisierte und optimierte Sicherheitsprozesse\n‚Ä¢ Vermeidung von Compliance-Strafen und regulatorischen Sanktionen\n‚Ä¢ Positive Auswirkungen auf Kreditw√ºrdigkeit und Finanzierungskonditionen\n\nüìã Compliance und regulatorische Vorteile:\n‚Ä¢ Erf√ºllung vielf√§ltiger regulatorischer Anforderungen durch umfassenden Sicherheitsrahmen\n‚Ä¢ Vereinfachung von Compliance-Nachweisen gegen√ºber Aufsichtsbeh√∂rden\n‚Ä¢ Vorbereitung auf zuk√ºnftige regulatorische Entwicklungen durch robuste Grundlage\n‚Ä¢ Reduzierung des Aufwands f√ºr multiple Compliance-Audits durch integrierte Herangehensweise\n‚Ä¢ Aufbau von Expertise f√ºr die Navigation komplexer regulatorischer Landschaften\n\nüë• Stakeholder-Vertrauen und Beziehungsvorteile:\n‚Ä¢ Erh√∂htes Vertrauen von Kunden durch transparente und nachpr√ºfbare Sicherheitsma√ünahmen\n‚Ä¢ Verbesserte Partnerbeziehungen durch gemeinsame Sicherheitsstandards und Verst√§ndnis\n‚Ä¢ St√§rkung der Mitarbeiterzufriedenheit durch professionelle Arbeitsumgebung\n‚Ä¢ Positive Wahrnehmung bei Investoren und Finanzpartnern\n‚Ä¢ Aufbau langfristiger Gesch√§ftsbeziehungen basierend auf Vertrauen und Zuverl√§ssigkeit\n\nüîÑ Organisatorische Entwicklungsvorteile:\n‚Ä¢ Aufbau einer Kultur der kontinuierlichen Verbesserung und Qualit√§tsorientierung\n‚Ä¢ Entwicklung interner Kompetenzen in Risikomanagement und Sicherheitstechnologien\n‚Ä¢ Verbesserung der organisatorischen Reife und Managementsystem-F√§higkeiten\n‚Ä¢ St√§rkung der Change Management Kompetenz durch systematische Herangehensweise\n‚Ä¢ Aufbau von Innovationsf√§higkeit durch strukturierte Prozesse und klare Verantwortlichkeiten\n\nüåê Markt- und Wettbewerbsvorteile:\n‚Ä¢ Zugang zu neuen M√§rkten und Kunden mit hohen Sicherheitsanforderungen\n‚Ä¢ Teilnahme an √∂ffentlichen Ausschreibungen mit Sicherheitszertifizierungsanforderungen\n‚Ä¢ Aufbau von Alleinstellungsmerkmalen in commoditisierten M√§rkten\n‚Ä¢ St√§rkung der Verhandlungsposition bei Gesch√§ftsabschl√ºssen\n‚Ä¢ Entwicklung von Sicherheit als Verkaufsargument und Differenzierungsmerkmal"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
