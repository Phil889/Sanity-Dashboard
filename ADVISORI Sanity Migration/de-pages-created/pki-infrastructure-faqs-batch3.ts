import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating PKI Infrastructure page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'pki-infrastructure' })
    
    if (!existingDoc) {
      throw new Error('Document "pki-infrastructure" not found')
    }
    
    // Create new FAQs for implementation and integration
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'Welche Herausforderungen gibt es bei der PKI-Migration und wie werden sie bew√§ltigt?',
        answer: "PKI-Migration ist ein komplexer Prozess, der sorgf√§ltige Planung, schrittweise Implementierung und umfassende Risikominimierung erfordert. Erfolgreiche PKI-Migrationen balancieren Sicherheitsanforderungen mit operativer Kontinuit√§t und minimieren Ausfallzeiten.\n\nüîÑ Migrationsstrategie und Planung:\n‚Ä¢ Legacy PKI Assessment analysiert bestehende Zertifikatslandschaft und identifiziert Abh√§ngigkeiten\n‚Ä¢ Migration Roadmap definiert Phasen, Meilensteine und Rollback-Strategien\n‚Ä¢ Risk Assessment identifiziert kritische Pfade und potenzielle St√∂rungen\n‚Ä¢ Stakeholder Alignment gew√§hrleistet organisationsweite Unterst√ºtzung\n‚Ä¢ Resource Planning allokiert notwendige technische und personelle Ressourcen\n\nüèóÔ∏è Technische Migrationsmuster:\n‚Ä¢ Parallel Migration betreibt alte und neue PKI-Systeme gleichzeitig\n‚Ä¢ Phased Rollout migriert schrittweise verschiedene Anwendungsbereiche\n‚Ä¢ Big Bang Migration ersetzt gesamte PKI-Infrastruktur in einem Schritt\n‚Ä¢ Hybrid Approach kombiniert verschiedene Migrationsmuster je nach Anforderung\n‚Ä¢ Blue-Green Deployment erm√∂glicht schnelle Rollback-M√∂glichkeiten\n\nüìú Certificate Transition Management:\n‚Ä¢ Cross-Signing etabliert Vertrauen zwischen alter und neuer PKI\n‚Ä¢ Certificate Mapping √ºbersetzt Zertifikatsattribute zwischen Systemen\n‚Ä¢ Dual Certificate Support erm√∂glicht parallele Nutzung alter und neuer Zertifikate\n‚Ä¢ Automated Renewal Transition automatisiert √úbergang zu neuen Zertifikaten\n‚Ä¢ Legacy Certificate Revocation widerruft alte Zertifikate kontrolliert\n\nüîß Application Integration Challenges:\n‚Ä¢ Dependency Mapping identifiziert alle PKI-abh√§ngigen Anwendungen\n‚Ä¢ API Compatibility gew√§hrleistet nahtlose Integration neuer PKI-Services\n‚Ä¢ Certificate Store Migration √ºbertr√§gt Zertifikate zwischen verschiedenen Speichersystemen\n‚Ä¢ Protocol Upgrade aktualisiert kryptographische Protokolle und Algorithmen\n‚Ä¢ Performance Impact Assessment bewertet Auswirkungen auf Anwendungsperformance\n\nüõ°Ô∏è Security und Compliance w√§hrend Migration:\n‚Ä¢ Security Gap Analysis identifiziert tempor√§re Sicherheitsl√ºcken\n‚Ä¢ Compliance Continuity gew√§hrleistet durchg√§ngige Einhaltung regulatorischer Anforderungen\n‚Ä¢ Audit Trail Maintenance dokumentiert alle Migrationsaktivit√§ten\n‚Ä¢ Incident Response Planning definiert Verfahren f√ºr Migrationsprobleme\n‚Ä¢ Vulnerability Management √ºberwacht neue Sicherheitsrisiken\n\nüìä Testing und Validation:\n‚Ä¢ Comprehensive Testing validiert alle PKI-Funktionen in neuer Umgebung\n‚Ä¢ Load Testing √ºberpr√ºft Performance unter realistischen Bedingungen\n‚Ä¢ Interoperability Testing gew√§hrleistet Kompatibilit√§t mit bestehenden Systemen\n‚Ä¢ Security Testing validiert Sicherheitseigenschaften der neuen PKI\n‚Ä¢ User Acceptance Testing best√§tigt Funktionalit√§t aus Anwendersicht\n\nüîÑ Rollback und Recovery Planning:\n‚Ä¢ Rollback Procedures definieren schnelle R√ºckkehr zur alten PKI\n‚Ä¢ Data Backup Strategy sichert alle kritischen PKI-Daten\n‚Ä¢ Recovery Time Objectives definieren akzeptable Ausfallzeiten\n‚Ä¢ Emergency Procedures erm√∂glichen schnelle Reaktion auf kritische Probleme\n‚Ä¢ Communication Plans informieren Stakeholder √ºber Migrationsstatus\n\n‚ö° Performance und Optimization:\n‚Ä¢ Capacity Planning dimensioniert neue PKI-Infrastruktur angemessen\n‚Ä¢ Performance Monitoring √ºberwacht Systemleistung w√§hrend Migration\n‚Ä¢ Bottleneck Identification lokalisiert und behebt Performance-Engp√§sse\n‚Ä¢ Scalability Testing validiert Skalierbarkeit der neuen PKI\n‚Ä¢ Optimization Strategies verbessern Effizienz nach Migration"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'Wie wird PKI-Monitoring und -Alerting implementiert und welche Metriken sind wichtig?',
        answer: "Effektives PKI-Monitoring ist essentiell f√ºr die Aufrechterhaltung der Sicherheit, Verf√ºgbarkeit und Performance von PKI-Systemen. Umfassendes Monitoring kombiniert technische Metriken mit Sicherheitsindikatoren und Business-relevanten KPIs.\n\nüìä Core PKI Metrics und KPIs:\n‚Ä¢ Certificate Issuance Rate √ºberwacht Anzahl ausgestellter Zertifikate pro Zeitraum\n‚Ä¢ Certificate Expiration Tracking verfolgt ablaufende Zertifikate proaktiv\n‚Ä¢ Revocation Rate analysiert H√§ufigkeit und Gr√ºnde f√ºr Zertifikatswiderrufe\n‚Ä¢ Validation Success Rate misst erfolgreiche Zertifikatsvalidierungen\n‚Ä¢ Mean Time to Certificate Issuance bewertet Effizienz der Zertifikatsausstellung\n\nüîê Security Monitoring Indicators:\n‚Ä¢ Failed Authentication Attempts identifizieren potenzielle Angriffe\n‚Ä¢ Unusual Certificate Requests erkennen anomale Zertifikatsanforderungen\n‚Ä¢ Cryptographic Algorithm Usage √ºberwacht Verwendung veralteter Algorithmen\n‚Ä¢ Key Compromise Indicators detektieren m√∂gliche Schl√ºsselkompromittierungen\n‚Ä¢ Certificate Chain Validation Failures identifizieren Vertrauensprobleme\n\n‚ö° Performance und Availability Metrics:\n‚Ä¢ Response Time Monitoring misst Latenz von PKI-Services\n‚Ä¢ Throughput Metrics √ºberwachen Transaktionsvolumen\n‚Ä¢ System Uptime und Availability Tracking gew√§hrleisten Service-Level-Agreements\n‚Ä¢ Resource Utilization √ºberwacht CPU, Memory und Storage-Verbrauch\n‚Ä¢ Network Latency Impact bewertet Netzwerk-Performance-Einfl√ºsse\n\nüèóÔ∏è Infrastructure Health Monitoring:\n‚Ä¢ HSM Status Monitoring √ºberwacht Hardware Security Module-Gesundheit\n‚Ä¢ Database Performance Metrics verfolgen PKI-Datenbank-Performance\n‚Ä¢ Certificate Store Health √ºberpr√ºft Integrit√§t von Zertifikatsspeichern\n‚Ä¢ Backup System Status gew√§hrleistet Funktionalit√§t von Backup-Systemen\n‚Ä¢ Load Balancer Health √ºberwacht Verteilung von PKI-Anfragen\n\nüìà Business Impact Metrics:\n‚Ä¢ Service Availability Impact bewertet Auswirkungen auf Gesch√§ftsprozesse\n‚Ä¢ User Experience Metrics messen Zufriedenheit mit PKI-Services\n‚Ä¢ Compliance Status Tracking √ºberwacht Einhaltung regulatorischer Anforderungen\n‚Ä¢ Cost per Certificate analysiert operative Effizienz\n‚Ä¢ Time to Resolution misst Geschwindigkeit der Probleml√∂sung\n\nüö® Alerting und Notification Systems:\n‚Ä¢ Threshold-based Alerts benachrichtigen bei √úberschreitung kritischer Werte\n‚Ä¢ Anomaly Detection identifiziert ungew√∂hnliche Muster automatisch\n‚Ä¢ Escalation Procedures definieren Eskalationspfade f√ºr verschiedene Alert-Typen\n‚Ä¢ Multi-channel Notifications nutzen verschiedene Kommunikationskan√§le\n‚Ä¢ Alert Correlation reduziert Noise durch intelligente Alert-Gruppierung\n\nüîç Advanced Analytics und Intelligence:\n‚Ä¢ Predictive Analytics prognostizieren zuk√ºnftige PKI-Anforderungen\n‚Ä¢ Trend Analysis identifiziert langfristige Entwicklungen\n‚Ä¢ Capacity Forecasting plant zuk√ºnftige Infrastruktur-Anforderungen\n‚Ä¢ Security Intelligence korreliert PKI-Events mit Bedrohungsinformationen\n‚Ä¢ Performance Optimization Analytics identifizieren Verbesserungspotenziale\n\nüõ†Ô∏è Monitoring Tools und Platforms:\n‚Ä¢ SIEM Integration korreliert PKI-Events mit anderen Sicherheitsereignissen\n‚Ä¢ Network Monitoring Tools √ºberwachen PKI-Netzwerkverkehr\n‚Ä¢ Application Performance Monitoring verfolgt PKI-abh√§ngige Anwendungen\n‚Ä¢ Custom Dashboard Development visualisiert PKI-spezifische Metriken\n‚Ä¢ API Monitoring √ºberwacht PKI-Service-Schnittstellen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'Welche Disaster Recovery und Business Continuity Strategien gibt es f√ºr PKI-Systeme?',
        answer: "PKI Disaster Recovery und Business Continuity erfordern spezialisierte Strategien, die die kritische Rolle von PKI-Systemen f√ºr organisationsweite Sicherheit ber√ºcksichtigen. Effektive DR/BC-Pl√§ne gew√§hrleisten kontinuierliche Verf√ºgbarkeit kryptographischer Services auch bei schwerwiegenden St√∂rungen.\n\nüèóÔ∏è PKI-spezifische DR/BC Architektur:\n‚Ä¢ Geographically Distributed CAs verteilen Certificate Authorities √ºber mehrere Standorte\n‚Ä¢ Hot Standby Systems erm√∂glichen sofortige √úbernahme bei Prim√§rsystem-Ausfall\n‚Ä¢ Cold Standby Solutions bieten kosteng√ºnstige Backup-Optionen mit l√§ngeren Recovery-Zeiten\n‚Ä¢ Hybrid DR Models kombinieren verschiedene Ans√§tze je nach Kritikalit√§t\n‚Ä¢ Cloud-based DR Services nutzen Cloud-Infrastruktur f√ºr skalierbare Disaster Recovery\n\nüîê Root CA Protection und Recovery:\n‚Ä¢ Offline Root CA Storage sch√ºtzt kritischste PKI-Komponenten durch Air-Gap-Isolation\n‚Ä¢ Secure Root CA Backup erstellt verschl√ºsselte Backups von Root CA-Schl√ºsseln\n‚Ä¢ Multi-Person Recovery Procedures implementieren Vier-Augen-Prinzip f√ºr Root CA-Wiederherstellung\n‚Ä¢ Hardware Security Module Clustering verteilt Root CA-Funktionalit√§t √ºber mehrere HSMs\n‚Ä¢ Emergency Root CA Procedures definieren Notfallverfahren bei Root CA-Kompromittierung\n\nüìä Recovery Time und Point Objectives:\n‚Ä¢ RTO Definition spezifiziert maximale akzeptable Ausfallzeiten f√ºr verschiedene PKI-Services\n‚Ä¢ RPO Requirements definieren maximalen akzeptablen Datenverlust\n‚Ä¢ Service Priority Matrix priorisiert kritische PKI-Funktionen f√ºr Recovery-Reihenfolge\n‚Ä¢ Graduated Recovery Levels erm√∂glichen stufenweise Wiederherstellung der Funktionalit√§t\n‚Ä¢ Business Impact Analysis bewertet Auswirkungen von PKI-Ausf√§llen auf Gesch√§ftsprozesse\n\nüîÑ Data Backup und Replication:\n‚Ä¢ Certificate Database Replication synchronisiert PKI-Datenbanken zwischen Standorten\n‚Ä¢ Incremental Backup Strategies minimieren Backup-Zeiten und Storage-Anforderungen\n‚Ä¢ Cross-Site Backup Verification gew√§hrleistet Integrit√§t von Backup-Daten\n‚Ä¢ Automated Backup Testing validiert Wiederherstellbarkeit regelm√§√üig\n‚Ä¢ Secure Backup Transport sch√ºtzt Backup-Daten w√§hrend √úbertragung und Speicherung\n\nüö® Incident Response Integration:\n‚Ä¢ PKI Incident Classification kategorisiert verschiedene Arten von PKI-St√∂rungen\n‚Ä¢ Emergency Response Teams definieren spezialisierte PKI-Recovery-Teams\n‚Ä¢ Communication Protocols informieren Stakeholder √ºber PKI-Ausf√§lle und Recovery-Status\n‚Ä¢ Escalation Procedures definieren Eskalationspfade f√ºr verschiedene Incident-Typen\n‚Ä¢ Post-Incident Analysis verbessert DR/BC-Pl√§ne basierend auf Lessons Learned\n\nüß™ Testing und Validation:\n‚Ä¢ Regular DR Drills testen Disaster Recovery-Verfahren unter realistischen Bedingungen\n‚Ä¢ Tabletop Exercises simulieren verschiedene Disaster-Szenarien\n‚Ä¢ Technical Recovery Testing validiert technische Wiederherstellungsverfahren\n‚Ä¢ End-to-End Testing √ºberpr√ºft vollst√§ndige PKI-Funktionalit√§t nach Recovery\n‚Ä¢ Performance Impact Assessment bewertet Performance-Auswirkungen von DR-Systemen\n\nüåê Multi-Site und Cloud Strategies:\n‚Ä¢ Active-Active Configuration erm√∂glicht gleichzeitige Nutzung mehrerer PKI-Standorte\n‚Ä¢ Active-Passive Setup h√§lt Backup-Systeme in Bereitschaft\n‚Ä¢ Cloud Hybrid Models kombinieren On-Premises und Cloud-basierte DR-Ressourcen\n‚Ä¢ Cross-Cloud Redundancy verteilt DR-Ressourcen √ºber mehrere Cloud-Provider\n‚Ä¢ Edge Computing Integration erweitert DR-Strategien auf Edge-Standorte\n\nüìã Compliance und Regulatory Considerations:\n‚Ä¢ Regulatory DR Requirements erf√ºllen branchenspezifische Disaster Recovery-Anforderungen\n‚Ä¢ Audit Trail Continuity gew√§hrleistet l√ºckenlose Dokumentation auch w√§hrend DR-Ereignissen\n‚Ä¢ Compliance Reporting w√§hrend DR-Situationen\n‚Ä¢ Data Sovereignty Compliance ber√ºcksichtigt Datenschutz-Anforderungen bei Cross-Border DR\n‚Ä¢ Recovery Documentation erstellt umfassende Dokumentation aller DR-Aktivit√§ten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'Wie werden PKI-Systeme f√ºr Post-Quantum Cryptography vorbereitet und migriert?',
        answer: "Die Vorbereitung auf Post-Quantum Cryptography (PQC) ist eine der kritischsten langfristigen Herausforderungen f√ºr PKI-Systeme. Quantencomputer bedrohen die Sicherheit aktueller kryptographischer Algorithmen, weshalb eine proaktive Migration zu quantenresistenten Verfahren essentiell ist.\n\nüî¨ Quantum Threat Assessment:\n‚Ä¢ Cryptographic Inventory analysiert alle verwendeten kryptographischen Algorithmen\n‚Ä¢ Quantum Risk Timeline bewertet Zeitrahmen f√ºr praktische Quantencomputer-Bedrohungen\n‚Ä¢ Algorithm Vulnerability Assessment identifiziert besonders gef√§hrdete kryptographische Verfahren\n‚Ä¢ Business Impact Analysis bewertet Auswirkungen von Quantum-Angriffen\n‚Ä¢ Compliance Requirements ber√ºcksichtigen regulatorische Anforderungen f√ºr PQC-Migration\n\nüõ°Ô∏è Post-Quantum Algorithm Selection:\n‚Ä¢ NIST PQC Standards implementieren standardisierte quantenresistente Algorithmen\n‚Ä¢ Algorithm Agility Design erm√∂glicht flexible Anpassung an neue kryptographische Verfahren\n‚Ä¢ Hybrid Cryptography kombiniert klassische und quantenresistente Algorithmen\n‚Ä¢ Performance Impact Assessment bewertet Auswirkungen von PQC-Algorithmen auf System-Performance\n‚Ä¢ Interoperability Testing gew√§hrleistet Kompatibilit√§t zwischen verschiedenen PQC-Implementierungen\n\nüîÑ Migration Strategy Development:\n‚Ä¢ Phased Migration Approach implementiert schrittweise √úbergang zu PQC\n‚Ä¢ Critical Path Analysis identifiziert priorit√§re Systeme f√ºr PQC-Migration\n‚Ä¢ Backward Compatibility Planning gew√§hrleistet Interoperabilit√§t w√§hrend √úbergangsphase\n‚Ä¢ Risk-based Prioritization priorisiert Migration basierend auf Bedrohungsrisiko\n‚Ä¢ Timeline Development erstellt realistische Migrationszeitpl√§ne\n\nüèóÔ∏è Infrastructure Modernization:\n‚Ä¢ Hardware Upgrade Requirements identifizieren notwendige Hardware-Anpassungen\n‚Ä¢ Software Stack Updates aktualisieren kryptographische Bibliotheken und Frameworks\n‚Ä¢ HSM PQC Support implementiert quantenresistente Algorithmen in Hardware Security Modules\n‚Ä¢ Network Protocol Updates passen Kommunikationsprotokolle an PQC-Anforderungen an\n‚Ä¢ Storage Requirements ber√ºcksichtigen gr√∂√üere Schl√ºssel- und Signaturgr√∂√üen\n\nüìú Certificate Lifecycle Adaptation:\n‚Ä¢ PQC Certificate Formats definieren neue Zertifikatsstrukturen f√ºr quantenresistente Algorithmen\n‚Ä¢ Extended Validity Periods ber√ºcksichtigen l√§ngere Migrationszeitr√§ume\n‚Ä¢ Dual Algorithm Certificates unterst√ºtzen parallele Nutzung klassischer und quantenresistenter Verfahren\n‚Ä¢ Certificate Chain Migration plant √úbergang von CA-Hierarchien zu PQC\n‚Ä¢ Revocation Mechanism Updates passen CRL und OCSP an PQC-Anforderungen an\n\nüîß Implementation Challenges:\n‚Ä¢ Performance Optimization minimiert Auswirkungen gr√∂√üerer PQC-Schl√ºssel und -Signaturen\n‚Ä¢ Memory and Storage Scaling ber√ºcksichtigt erh√∂hte Ressourcenanforderungen\n‚Ä¢ Network Bandwidth Impact bewertet Auswirkungen gr√∂√üerer kryptographischer Daten\n‚Ä¢ Battery Life Considerations f√ºr mobile und IoT-Ger√§te\n‚Ä¢ Legacy System Integration verbindet alte Systeme mit PQC-f√§higen Komponenten\n\nüß™ Testing und Validation:\n‚Ä¢ Cryptographic Agility Testing validiert F√§higkeit zum Algorithmus-Wechsel\n‚Ä¢ Performance Benchmarking vergleicht PQC-Performance mit klassischen Verfahren\n‚Ä¢ Security Analysis √ºberpr√ºft Sicherheitseigenschaften von PQC-Implementierungen\n‚Ä¢ Interoperability Testing gew√§hrleistet Kompatibilit√§t zwischen verschiedenen PQC-Systemen\n‚Ä¢ Stress Testing validiert System-Stabilit√§t unter PQC-Last\n\nüìä Monitoring und Maintenance:\n‚Ä¢ Algorithm Lifecycle Management √ºberwacht Entwicklung neuer quantenresistenter Verfahren\n‚Ä¢ Threat Intelligence Integration verfolgt Fortschritte in Quantencomputing-Technologie\n‚Ä¢ Performance Monitoring √ºberwacht Auswirkungen von PQC auf System-Performance\n‚Ä¢ Compliance Tracking gew√§hrleistet Einhaltung sich entwickelnder PQC-Standards\n‚Ä¢ Continuous Improvement adaptiert PQC-Strategien an neue Erkenntnisse und Technologien"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
