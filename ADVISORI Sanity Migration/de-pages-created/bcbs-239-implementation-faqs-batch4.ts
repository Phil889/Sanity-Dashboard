import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating BCBS-239 Implementation page with FAQs batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'bcbs-239-implementation' })
    
    if (!existingDoc) {
      throw new Error('Document "bcbs-239-implementation" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Welche Data Lineage Anforderungen stellt BCBS-239 und wie unterst√ºtzt ADVISORI bei deren Umsetzung?",
        answer: "Die umfassende Dokumentation und Nachvollziehbarkeit von Datenfl√ºssen (Data Lineage) ist eine der zentralen Anforderungen von BCBS-239. Finanzinstitute m√ºssen in der Lage sein, die vollst√§ndige Historie ihrer Risikodaten transparent nachzuweisen ‚Äì von der Quelle √ºber Transformationen bis zur Nutzung in Berichten. ADVISORI hat einen spezialisierten Ansatz entwickelt, der sowohl regulatorische Anforderungen erf√ºllt als auch praktischen Mehrwert schafft.\n\nüîÑ Data Lineage im BCBS-239 Kontext:\n‚Ä¢ End-to-End Nachvollziehbarkeit: Dokumentation des vollst√§ndigen Lebenszyklus von Risikodaten von der Erfassung in Quellsystemen √ºber alle Transformationen, Aggregationen und Berechnungen bis zur finalen Berichterstellung.\n‚Ä¢ Granularit√§t auf verschiedenen Ebenen: Erfassung von Datenfl√ºssen auf unterschiedlichen Detaillierungsebenen ‚Äì von der Business-Ebene f√ºr Prozess√ºbersichten bis zur technischen Ebene mit konkreten Systemen, Tabellen und Feldern.\n‚Ä¢ Qualit√§tskontrollen und Validierungspunkte: Integration von Informationen √ºber Kontrollen, Validierungen und Qualit√§tspr√ºfungen entlang des Datenwegs zur Sicherstellung der Datenintegrit√§t.\n‚Ä¢ Impact-Analyse-F√§higkeit: Erm√∂glichung von vorw√§rts- und r√ºckw√§rtsgerichteten Analysen, um Auswirkungen von √Ñnderungen oder die Ursache von Datenproblemen schnell identifizieren zu k√∂nnen.\n\nüõ†Ô∏è ADVISORI's Implementierungsansatz f√ºr robuste Data Lineage:\n‚Ä¢ Mehrdimensionales Lineage-Framework: Entwicklung eines ganzheitlichen Frameworks, das technische, gesch√§ftliche und regulatorische Aspekte der Datenherkunft integriert und verschiedene Betrachtungsebenen erm√∂glicht.\n‚Ä¢ Automatisierte Lineage-Erfassung: Implementierung von Tools zur automatisierten Erfassung von Metadaten und Datenfl√ºssen, die manuelle Dokumentation minimieren und Aktualit√§t sicherstellen.\n‚Ä¢ Visualisierungsl√∂sungen: Bereitstellung intuitiver, interaktiver Visualisierungen der Datenfl√ºsse, die komplexe Zusammenh√§nge verst√§ndlich darstellen und gezielte Analysen erm√∂glichen.\n‚Ä¢ Governance-Integration: Einbettung von Data Lineage in das √ºbergreifende Datengovernance-Framework mit klaren Verantwortlichkeiten f√ºr die Pflege und Aktualisierung der Lineage-Informationen.\n\nüíº Konkrete Implementierungsschritte mit ADVISORI:\n‚Ä¢ Assessment und Scoping: Detaillierte Analyse der bestehenden Datenlandschaft und Definition des optimalen Detaillierungsgrads f√ºr die Lineage-Dokumentation basierend auf regulatorischen Anforderungen und praktischer Nutzbarkeit.\n‚Ä¢ Technologieauswahl: Evaluierung und Selektion geeigneter Lineage-Tools unter Ber√ºcksichtigung der spezifischen IT-Landschaft und Anforderungen des Finanzinstituts.\n‚Ä¢ Pilotimplementierung: Schrittweise Einf√ºhrung beginnend mit kritischen Risikodatenprozessen und systematische Ausweitung auf weitere Bereiche.\n‚Ä¢ Integration mit bestehenden Metadaten-Repositories: Verkn√ºpfung der Lineage-L√∂sung mit anderen Metadaten-Quellen wie Data Dictionaries, Gesch√§ftsglossar und Systemdokumentation.\n\nDurch diesen umfassenden Ansatz unterst√ºtzt ADVISORI Finanzinstitute nicht nur bei der Erf√ºllung regulatorischer Anforderungen, sondern schafft einen echten Mehrwert f√ºr das Datenmanagement. Eine gut implementierte Data Lineage erm√∂glicht schnellere und pr√§zisere Root-Cause-Analysen bei Datenproblemen, reduziert den Aufwand f√ºr regulatorische Nachweise und erleichtert die Bewertung von √Ñnderungsauswirkungen signifikant."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Wie hilft ADVISORI bei der Implementierung von BCBS-239-konformen Test- und Validierungsverfahren f√ºr Risikodaten und -berichte?",
        answer: "Robuste Test- und Validierungsverfahren sind entscheidend f√ºr die Sicherstellung der Qualit√§t und Zuverl√§ssigkeit von Risikodaten und -berichten im Rahmen der BCBS-239 Compliance. ADVISORI hat einen mehrstufigen Ansatz entwickelt, der systematische, risikoorientierte Testverfahren in den gesamten Datenlebenszyklus integriert.\n\nüîç Comprehensive Testing Framework:\n‚Ä¢ Mehrstufiges Validierungsmodell: Implementierung eines geschichteten Testansatzes mit verschiedenen Validierungsebenen ‚Äì von automatisierten Basis-Datenqualit√§tskontrollen √ºber fachliche Plausibilit√§tspr√ºfungen bis zu End-to-End Prozessvalidierungen.\n‚Ä¢ Risikobasierte Testpriorisierung: Fokussierung der Testressourcen auf kritische Datenbereiche und Prozesse basierend auf regulatorischer Relevanz, Gesch√§ftskritikalit√§t und Fehleranf√§lligkeit.\n‚Ä¢ Integrierter Testansatz: Verzahnung von Datenqualit√§tstests mit funktionalen und nicht-funktionalen Tests der IT-Systeme, um ganzheitliche Qualit√§tssicherung zu gew√§hrleisten.\n‚Ä¢ Automatisierte vs. manuelle Tests: Ausgewogene Kombination automatisierter Routinetests f√ºr Effizienz und gezielter manueller Expertentests f√ºr komplexe Validierungen.\n\n‚öôÔ∏è Methodische Komponenten des Validierungsansatzes:\n‚Ä¢ Data Quality Rules Engine: Implementierung einer regelbasierten Validierungsengine, die Datenqualit√§tskontrollen automatisiert auf verschiedenen Stufen des Datenflusses durchf√ºhrt.\n‚Ä¢ Reconciliation Framework: Entwicklung eines systematischen Abstimmungsrahmens, der die Konsistenz und Vollst√§ndigkeit der Daten √ºber System- und Prozessgrenzen hinweg sicherstellt.\n‚Ä¢ Trend- und Anomalieanalysen: Einsatz statistischer Verfahren zur Erkennung ungew√∂hnlicher Muster oder Ausrei√üer in Risikodaten, die auf potenzielle Qualit√§tsprobleme hindeuten k√∂nnen.\n‚Ä¢ Regulatory Validation Suite: Spezifische Testsuiten f√ºr regulatorische Anforderungen, die sowohl formale Kriterien als auch inhaltliche Aspekte der Berichterstellung abdecken.\n\nüöÄ ADVISORI's praktischer Implementierungsansatz:\n‚Ä¢ Testing Strategy & Governance: Entwicklung einer umfassenden Teststrategie mit klaren Verantwortlichkeiten, Prozessen und Eskalationswegen f√ºr identifizierte Probleme.\n‚Ä¢ Test Case Repository: Aufbau einer strukturierten Bibliothek von Testf√§llen und -szenarien, die kontinuierlich erweitert und an neue Anforderungen angepasst wird.\n‚Ä¢ Test Automation Framework: Implementierung eines skalierbaren Frameworks zur Automatisierung wiederkehrender Tests, das die Effizienz erh√∂ht und personelle Ressourcen f√ºr komplexe Analysen freisetzt.\n‚Ä¢ Continuous Integration Testing: Integration von Datenqualit√§tstests in die regul√§ren Entwicklungs- und Betriebsprozesse, um fr√ºhzeitige Fehlererkennung zu gew√§hrleisten.\n\nüîÑ Testkreislauf f√ºr kontinuierliche Verbesserung:\n‚Ä¢ Baseline Testing: Initiale umfassende Tests zur Ermittlung des Status quo und Identifikation von Schwachstellen als Ausgangsbasis f√ºr Verbesserungen.\n‚Ä¢ Regression Testing: Systematische Wiederholungstests nach √Ñnderungen, um unbeabsichtigte Nebenwirkungen zu erkennen und Stabilit√§t sicherzustellen.\n‚Ä¢ Performance & Stress Testing: Spezifische Tests zur Bewertung der Leistungsf√§higkeit von Risikodatensystemen unter erh√∂hter Last und in Stresssituationen.\n‚Ä¢ Continuous Improvement: Regelm√§√üige √úberpr√ºfung und Optimierung der Testverfahren selbst auf Basis gesammelter Erfahrungen und neuer Anforderungen.\n\nDurch diesen umfassenden Testansatz unterst√ºtzt ADVISORI Finanzinstitute nicht nur bei der Erf√ºllung der BCBS-239 Anforderungen, sondern etabliert eine nachhaltige Qualit√§tskultur f√ºr Risikodaten, die sowohl regulatorische Sicherheit als auch gesch√§ftlichen Mehrwert schafft."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Wie integriert ADVISORI die BCBS-239 Implementierung in bestehende Projektportfolios und Change-Management-Prozesse?",
        answer: "Die Integration einer BCBS-239 Implementierung in die bestehende Projektlandschaft und Change-Management-Prozesse ist entscheidend f√ºr den Erfolg und die Nachhaltigkeit der Initiative. ADVISORI verfolgt einen strategischen Integrationsansatz, der Synergien maximiert, Konflikte minimiert und eine effiziente Ressourcennutzung sicherstellt.\n\nüîÑ Strategische Integration in die Projektlandschaft:\n‚Ä¢ Portfolio-Alignment: Systematische Analyse des bestehenden Projektportfolios zur Identifikation von √úberschneidungen, Abh√§ngigkeiten und Synergiepotenzialen mit der BCBS-239 Implementierung.\n‚Ä¢ Integrierte Roadmap: Entwicklung einer konsolidierten Umsetzungsroadmap, die BCBS-239 Ma√ünahmen mit anderen relevanten Initiativen synchronisiert und Ressourcenkonflikte proaktiv adressiert.\n‚Ä¢ Governance-Harmonisierung: Abstimmung der BCBS-239 Governance-Strukturen mit bestehenden Projektsteuerungsgremien, um Konsistenz zu gew√§hrleisten und Mehrfachberichterstattung zu vermeiden.\n‚Ä¢ Delivery-Koordination: Etablierung von Koordinationsmechanismen zwischen BCBS-239 und anderen Projekten, insbesondere bei gemeinsam genutzten Ressourcen oder √ºberlappenden Arbeitspaketen.\n\n‚öôÔ∏è Integration in Change-Management-Prozesse:\n‚Ä¢ Change-Impact-Analyse: Systematische Bewertung der Auswirkungen der BCBS-239 Implementierung auf bestehende Prozesse, Systeme und Organisationsstrukturen als Basis f√ºr gezieltes Change Management.\n‚Ä¢ Change Readiness Assessment: Evaluation der Ver√§nderungsbereitschaft und -f√§higkeit der Organisation als Grundlage f√ºr die Entwicklung ma√ügeschneiderter Change-Strategien.\n‚Ä¢ Stakeholder-zentrierter Ansatz: Identifikation und gezielte Einbindung aller relevanten Stakeholder mit spezifisch auf ihre Bed√ºrfnisse und Rolle ausgerichteten Kommunikations- und Beteiligungsformaten.\n‚Ä¢ Cultural Change Management: F√∂rderung der notwendigen kulturellen Ver√§nderung hin zu einer datenorientierten Risikomanagement-Kultur als langfristiger Erfolgsfaktor.\n\nüõ†Ô∏è ADVISORI's praktischer Integrationsansatz:\n‚Ä¢ Program Integration Office: Einrichtung einer zentralen Koordinationsinstanz, die als Br√ºcke zwischen der BCBS-239 Implementierung und anderen Projekten sowie den bestehenden Change-Prozessen fungiert.\n‚Ä¢ Synergie-Workshops: Durchf√ºhrung strukturierter Workshops mit Vertretern verschiedener Initiativen zur Identifikation und Aussch√∂pfung von Synergiepotenzialen.\n‚Ä¢ Integrated Planning Cycles: Harmonisierung der Planungszyklen von BCBS-239 mit dem allgemeinen Projektportfolio-Management f√ºr konsistente Ressourcenplanung und Priorisierung.\n‚Ä¢ Cross-Project Risk Management: Etablierung eines √ºbergreifenden Risikomanagements, das potenzielle Konflikte und Abh√§ngigkeiten zwischen BCBS-239 und anderen Initiativen fr√ºhzeitig erkennt und adressiert.\n\nüìà Erfolgsfaktoren f√ºr eine nachhaltige Integration:\n‚Ä¢ Executive Sponsorship: Gewinnung und kontinuierliche Einbindung hochrangiger Sponsoren, die die Integration der BCBS-239 in die Gesamtstrategie unterst√ºtzen und Priorit√§tenkonflikte aufl√∂sen k√∂nnen.\n‚Ä¢ Balanced Scorecard Approach: Entwicklung eines ausgewogenen Kennzahlensystems, das sowohl BCBS-239-spezifische als auch √ºbergreifende organisatorische Ziele ber√ºcksichtigt.\n‚Ä¢ Change Network: Aufbau eines Netzwerks von Change Agents aus verschiedenen Bereichen, die als Multiplikatoren und Br√ºckenbauer zwischen der BCBS-239 Implementation und ihren jeweiligen Organisationseinheiten fungieren.\n‚Ä¢ Kommunikationsstrategie: Implementierung einer transparenten, konsistenten Kommunikationsstrategie, die den Kontext, die Bedeutung und den Fortschritt der BCBS-239 Implementierung im Gesamtkontext der Organisationsstrategie vermittelt.\n\nDurch diesen integrierten Ansatz wird die BCBS-239 Implementierung nicht als isolierte Compliance-Initiative, sondern als integraler Bestandteil der organisatorischen Transformation positioniert, was Akzeptanz erh√∂ht, Ressourcen optimiert und nachhaltige Ver√§nderung f√∂rdert."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie unterst√ºtzt ADVISORI Banken bei der Entwicklung einer nachhaltigen Betriebsstrategie f√ºr ihre BCBS-239 Systeme und Prozesse?",
        answer: "Die Entwicklung einer robusten Betriebsstrategie f√ºr BCBS-239-konforme Systeme und Prozesse ist entscheidend f√ºr die langfristige Wirksamkeit und Wirtschaftlichkeit der Implementation. ADVISORI hat einen umfassenden Ansatz entwickelt, der die √úberf√ºhrung von Projektresultaten in nachhaltige Betriebsstrukturen systematisch unterst√ºtzt.\n\n‚öôÔ∏è Kernelemente einer nachhaltigen BCBS-239 Betriebsstrategie:\n‚Ä¢ Operatives Governance-Modell: Entwicklung eines differenzierten Governance-Rahmens mit klar definierten Rollen, Verantwortlichkeiten und Entscheidungswegen f√ºr den Regelbetrieb der BCBS-239-L√∂sung.\n‚Ä¢ Kontinuierliches Datenqualit√§tsmanagement: Etablierung systematischer Prozesse und Kontrollen zur fortlaufenden √úberwachung, Bewertung und Verbesserung der Risikodatenqualit√§t im Tagesgesch√§ft.\n‚Ä¢ Incident und Problem Management: Implementation spezialisierter Prozesse f√ºr die effiziente Erkennung, Analyse und Behebung von St√∂rungen und Problemen in Risikodatenprozessen unter Ber√ºcksichtigung regulatorischer Anforderungen.\n‚Ä¢ Release und Change Management: Entwicklung angepasster Verfahren f√ºr die kontrollierte Einf√ºhrung von √Ñnderungen an BCBS-239-relevanten Systemen und Prozessen mit besonderem Fokus auf regulatorische Implikationen.\n\nüîÑ √úbergang vom Projekt zum Regelbetrieb:\n‚Ä¢ Transition Planning: Detaillierte Planung der √úbergangsphase mit klaren Meilensteinen, Verantwortlichkeiten und Akzeptanzkriterien f√ºr die √úbergabe vom Projekt- ins Linienmanagement.\n‚Ä¢ Knowledge Transfer: Strukturierter Wissenstransfer von Projektteams zu operativen Teams mit umfassender Dokumentation, Schulungen und Mentoring-Phasen.\n‚Ä¢ Parallel Run: Durchf√ºhrung von Parallel-Betriebs-Phasen, in denen neue und alte Prozesse gleichzeitig laufen, um Stabilit√§t zu gew√§hrleisten und Vertrauen aufzubauen.\n‚Ä¢ Stufenweise Verantwortungs√ºbergabe: Schrittweise √úbertragung von Verantwortlichkeiten auf operative Teams mit zunehmendem Reifegrad und Selbstst√§ndigkeit.\n\nüõ†Ô∏è Operationalisierung regulatorischer Anforderungen:\n‚Ä¢ Regulatory Change Management: Etablierung eines systematischen Prozesses zur √úberwachung, Bewertung und Umsetzung neuer oder ge√§nderter regulatorischer Anforderungen im laufenden Betrieb.\n‚Ä¢ Compliance Monitoring: Implementation eines kontinuierlichen √úberwachungssystems f√ºr die fortlaufende Einhaltung der BCBS-239 Anforderungen mit klar definierten Kennzahlen und Schwellenwerten.\n‚Ä¢ Audit-readiness: Entwicklung von Strukturen und Prozessen, die eine kontinuierliche Pr√ºfungsbereitschaft sicherstellen und regulatorische Anfragen effizient beantworten k√∂nnen.\n‚Ä¢ Continuous Improvement: Etablierung eines systematischen Verbesserungsprozesses, der Feedback aus dem operativen Betrieb, Audits und regulatorischen Pr√ºfungen f√ºr kontinuierliche Optimierungen nutzt.\n\nüíº ADVISORI's Implementierungsansatz f√ºr den nachhaltigen Betrieb:\n‚Ä¢ Operational Readiness Assessment: Durchf√ºhrung einer detaillierten Bewertung der operativen Bereitschaft von Prozessen, Systemen, Tools und Teams f√ºr den √úbergang in den Regelbetrieb.\n‚Ä¢ Betriebshandbuch-Entwicklung: Erstellung umfassender Betriebsdokumentationen mit klaren Anweisungen, Prozessbeschreibungen und Eskalationswegen f√ºr alle relevanten Szenarien.\n‚Ä¢ Operatives Kennzahlensystem: Entwicklung eines ausgewogenen KPI-Sets zur kontinuierlichen √úberwachung der operativen Performance und Compliance im Regelbetrieb.\n‚Ä¢ Support-Modell-Design: Konzeption eines passenden Support-Modells mit definierten Service Levels, Support-Tiers und Eskalationswegen f√ºr BCBS-239-relevante Systeme und Prozesse.\n\nDurch diesen ganzheitlichen Ansatz unterst√ºtzt ADVISORI Finanzinstitute dabei, ihre BCBS-239-L√∂sungen nicht nur erfolgreich zu implementieren, sondern sie auch langfristig effizient und compliant zu betreiben. Die nachhaltige Betriebsstrategie sichert die Investition in die BCBS-239 Implementation und gew√§hrleistet kontinuierliche Compliance bei gleichzeitiger Optimierung der Betriebskosten."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
