import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating IAM Security page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iam-security' })
    
    if (!existingDoc) {
      throw new Error('Document "iam-security" not found')
    }
    
    // Create new FAQs for threat detection and incident response
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie entwickelt man eine effektive IAM Threat Detection Strategie und welche Technologien sind f√ºr die fr√ºhzeitige Erkennung von Identit√§tsbedrohungen entscheidend?',
        answer: "Eine effektive IAM Threat Detection Strategie erfordert einen mehrschichtigen Ansatz, der traditionelle signaturbasierte Erkennung mit modernen verhaltensbasierten Analytics kombiniert. Die Herausforderung liegt darin, legitime Benutzeraktivit√§ten von potenziell b√∂sartigen Verhaltensweisen zu unterscheiden, ohne die Produktivit√§t zu beeintr√§chtigen.\n\nüîç Behavioral Analytics und Baseline-Erstellung:\n‚Ä¢ User Behavior Profiling f√ºr Erstellung individueller Aktivit√§tsmuster und Normalverhalten\n‚Ä¢ Entity Relationship Mapping f√ºr Verst√§ndnis typischer Zugriffsmuster und Ressourcennutzung\n‚Ä¢ Temporal Analysis f√ºr Identifikation ungew√∂hnlicher Aktivit√§tszeiten und Frequenzen\n‚Ä¢ Geolocation Intelligence f√ºr Erkennung anomaler Standorte und unm√∂glicher Reisen\n‚Ä¢ Device Fingerprinting f√ºr Identifikation unbekannter oder kompromittierter Ger√§te\n\nüö® Advanced Threat Detection Capabilities:\n‚Ä¢ Credential Stuffing Detection durch Analyse von Login-Versuchen und Erfolgsmustern\n‚Ä¢ Brute Force Attack Recognition mit adaptiven Schwellenwerten und Rate Limiting\n‚Ä¢ Lateral Movement Detection f√ºr Verfolgung verd√§chtiger Netzwerkbewegungen\n‚Ä¢ Privilege Escalation Monitoring f√ºr Erkennung unautorisierten Rechtezuwachses\n‚Ä¢ Data Exfiltration Patterns f√ºr Identifikation ungew√∂hnlicher Daten√ºbertragungen\n\nüß† Machine Learning und KI-Integration:\n‚Ä¢ Unsupervised Learning f√ºr Erkennung unbekannter Angriffsmuster ohne vorherige Signaturen\n‚Ä¢ Supervised Learning f√ºr Klassifikation bekannter Bedrohungstypen und Angriffsvektoren\n‚Ä¢ Deep Learning f√ºr komplexe Musteranalyse in gro√üen Datenmengen\n‚Ä¢ Ensemble Methods f√ºr Kombination verschiedener Erkennungsalgorithmen\n‚Ä¢ Continuous Learning f√ºr Anpassung an neue Bedrohungen und Umgebungsver√§nderungen\n\nüìä Data Sources und Integration:\n‚Ä¢ Authentication Logs f√ºr Analyse von Login-Ereignissen und Authentifizierungsmustern\n‚Ä¢ Authorization Events f√ºr √úberwachung von Zugriffsentscheidungen und Rechtenutzung\n‚Ä¢ Network Traffic Analysis f√ºr Korrelation mit Identit√§tsereignissen\n‚Ä¢ Application Logs f√ºr Verst√§ndnis von Anwendungsnutzung und Anomalien\n‚Ä¢ Threat Intelligence Feeds f√ºr Anreicherung mit aktuellen Bedrohungsinformationen\n\n‚ö° Real-time Processing und Response:\n‚Ä¢ Stream Processing f√ºr Echtzeit-Analyse von Sicherheitsereignissen\n‚Ä¢ Complex Event Processing f√ºr Korrelation mehrerer Ereignisse zu Bedrohungsszenarien\n‚Ä¢ Automated Alerting mit intelligenter Priorisierung und Kontextualisierung\n‚Ä¢ Dynamic Risk Scoring f√ºr kontinuierliche Bewertung von Benutzer- und Session-Risiken\n‚Ä¢ Adaptive Thresholds f√ºr Reduzierung von False Positives und Alert Fatigue\n\nüîß Implementation und Operational Excellence:\n‚Ä¢ SIEM Integration f√ºr zentrale √úberwachung und Korrelation mit anderen Sicherheitsereignissen\n‚Ä¢ API-driven Architecture f√ºr flexible Integration verschiedener Datenquellen\n‚Ä¢ Scalable Infrastructure f√ºr Verarbeitung gro√üer Datenmengen in Echtzeit\n‚Ä¢ Privacy-preserving Analytics f√ºr Schutz sensibler Benutzerdaten\n‚Ä¢ Continuous Tuning f√ºr Optimierung der Erkennungsgenauigkeit und Performance"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Best Practices gelten f√ºr IAM Incident Response und wie kann man sich optimal auf identit√§tsbezogene Sicherheitsvorf√§lle vorbereiten?',
        answer: "IAM Incident Response erfordert spezialisierte Verfahren und Werkzeuge, da identit√§tsbezogene Sicherheitsvorf√§lle oft komplexe Auswirkungen auf die gesamte IT-Infrastruktur haben k√∂nnen. Eine effektive Vorbereitung und strukturierte Response-Prozesse sind entscheidend f√ºr die Minimierung von Sch√§den und die schnelle Wiederherstellung der Sicherheit.\n\nüìã Incident Response Planning und Vorbereitung:\n‚Ä¢ Identity-specific Playbooks f√ºr verschiedene Arten von IAM-Sicherheitsvorf√§llen\n‚Ä¢ Escalation Procedures mit klaren Rollen und Verantwortlichkeiten\n‚Ä¢ Communication Plans f√ºr interne und externe Stakeholder\n‚Ä¢ Legal und Compliance Considerations f√ºr regulatorische Meldepflichten\n‚Ä¢ Recovery Procedures f√ºr schnelle Wiederherstellung kompromittierter Identit√§ten\n\nüö® Incident Classification und Prioritization:\n‚Ä¢ Severity Levels basierend auf Auswirkungen und betroffenen Systemen\n‚Ä¢ Impact Assessment f√ºr Bewertung potenzieller Gesch√§ftsauswirkungen\n‚Ä¢ Threat Actor Profiling f√ºr Verst√§ndnis der Angriffsmotivation und -methoden\n‚Ä¢ Asset Criticality Mapping f√ºr Priorisierung der Response-Aktivit√§ten\n‚Ä¢ Timeline Analysis f√ºr Rekonstruktion der Angriffskette und Schadensbewertung\n\nüîç Investigation und Forensic Analysis:\n‚Ä¢ Digital Forensics f√ºr detaillierte Analyse kompromittierter Systeme und Accounts\n‚Ä¢ Log Analysis und Timeline Reconstruction f√ºr Verst√§ndnis der Angriffsmethoden\n‚Ä¢ Artifact Collection f√ºr Beweissicherung und sp√§tere Analyse\n‚Ä¢ Memory Analysis f√ºr Erkennung von Advanced Persistent Threats\n‚Ä¢ Network Forensics f√ºr Verfolgung lateraler Bewegungen und Datenexfiltration\n\n‚ö° Containment und Eradication Strategies:\n‚Ä¢ Account Isolation f√ºr sofortige Eind√§mmung kompromittierter Identit√§ten\n‚Ä¢ Session Termination f√ºr Beendigung aktiver b√∂sartiger Sessions\n‚Ä¢ Privilege Revocation f√ºr tempor√§re Entfernung kritischer Berechtigungen\n‚Ä¢ System Quarantine f√ºr Isolation betroffener Systeme und Anwendungen\n‚Ä¢ Credential Reset f√ºr umfassende Erneuerung potenziell kompromittierter Credentials\n\nüîÑ Recovery und Restoration Procedures:\n‚Ä¢ Identity Restoration f√ºr sichere Wiederherstellung legitimer Benutzerzugriffe\n‚Ä¢ System Hardening f√ºr Verbesserung der Sicherheit vor Wiederinbetriebnahme\n‚Ä¢ Monitoring Enhancement f√ºr verst√§rkte √úberwachung nach Vorf√§llen\n‚Ä¢ User Communication f√ºr Information betroffener Benutzer √ºber erforderliche Ma√ünahmen\n‚Ä¢ Business Continuity f√ºr Aufrechterhaltung kritischer Gesch√§ftsprozesse\n\nüìä Post-Incident Analysis und Lessons Learned:\n‚Ä¢ Root Cause Analysis f√ºr Identifikation der grundlegenden Ursachen\n‚Ä¢ Gap Assessment f√ºr Bewertung der Wirksamkeit bestehender Sicherheitskontrollen\n‚Ä¢ Process Improvement f√ºr Optimierung der Incident Response Verfahren\n‚Ä¢ Training Updates f√ºr Verbesserung der Team-F√§higkeiten basierend auf Erfahrungen\n‚Ä¢ Documentation Updates f√ºr Aktualisierung von Playbooks und Verfahren\n\nüõ†Ô∏è Tools und Automation f√ºr Incident Response:\n‚Ä¢ SOAR Platforms f√ºr Orchestrierung und Automatisierung von Response-Aktivit√§ten\n‚Ä¢ Threat Intelligence Integration f√ºr Anreicherung von Incident-Daten\n‚Ä¢ Communication Tools f√ºr koordinierte Response-Aktivit√§ten\n‚Ä¢ Forensic Toolkits f√ºr spezialisierte Analyse von IAM-Systemen\n‚Ä¢ Metrics und Reporting f√ºr Messung der Response-Effektivit√§t und Compliance"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie implementiert man adaptive Authentication Systeme und welche Faktoren sollten bei der dynamischen Risikobewertung ber√ºcksichtigt werden?',
        answer: "Adaptive Authentication Systeme revolutionieren die Benutzerauthentifizierung durch dynamische Anpassung der Sicherheitsanforderungen basierend auf Risikobewertungen in Echtzeit. Diese Systeme erm√∂glichen es, Sicherheit und Benutzerfreundlichkeit optimal zu balancieren, indem sie nur dann zus√§tzliche Authentifizierungsschritte erfordern, wenn das Risiko erh√∂ht ist.\n\nüéØ Risk Assessment Framework und Scoring:\n‚Ä¢ Multi-dimensional Risk Modeling mit gewichteten Risikofaktoren\n‚Ä¢ Real-time Risk Calculation basierend auf aktuellen Kontextinformationen\n‚Ä¢ Historical Risk Patterns f√ºr Ber√ºcksichtigung vergangener Benutzeraktivit√§ten\n‚Ä¢ Peer Group Comparison f√ºr Bewertung im Kontext √§hnlicher Benutzerprofile\n‚Ä¢ Dynamic Threshold Adjustment f√ºr adaptive Anpassung an ver√§nderte Bedrohungslagen\n\nüåç Contextual Factors und Environmental Intelligence:\n‚Ä¢ Geolocation Analysis f√ºr Bewertung von Standortanomalien und unm√∂glichen Reisen\n‚Ä¢ Device Intelligence f√ºr Erkennung bekannter versus unbekannter Ger√§te\n‚Ä¢ Network Analysis f√ºr Bewertung der Netzwerkumgebung und Vertrauensw√ºrdigkeit\n‚Ä¢ Time-based Patterns f√ºr Identifikation ungew√∂hnlicher Aktivit√§tszeiten\n‚Ä¢ Application Context f√ºr Ber√ºcksichtigung der angeforderten Ressourcen und deren Sensitivit√§t\n\nüîê Authentication Factor Selection und Orchestration:\n‚Ä¢ Risk-appropriate Factor Selection basierend auf aktueller Risikobewertung\n‚Ä¢ Progressive Authentication f√ºr schrittweise Erh√∂hung der Sicherheitsanforderungen\n‚Ä¢ Biometric Integration f√ºr nahtlose und sichere Authentifizierung\n‚Ä¢ Behavioral Biometrics f√ºr kontinuierliche Verifikation w√§hrend der Session\n‚Ä¢ Fallback Mechanisms f√ºr Situationen, in denen prim√§re Faktoren nicht verf√ºgbar sind\n\nüì± User Experience Optimization:\n‚Ä¢ Seamless Authentication f√ºr minimale Unterbrechung bei niedrigem Risiko\n‚Ä¢ Transparent Security f√ºr unsichtbare Sicherheitsma√ünahmen im Hintergrund\n‚Ä¢ User Education f√ºr Verst√§ndnis und Akzeptanz adaptiver Sicherheitsma√ünahmen\n‚Ä¢ Accessibility Considerations f√ºr Unterst√ºtzung verschiedener Benutzerbed√ºrfnisse\n‚Ä¢ Performance Optimization f√ºr schnelle Risikobewertung ohne Latenz\n\nüß† Machine Learning und Predictive Analytics:\n‚Ä¢ Behavioral Modeling f√ºr Erstellung individueller Benutzerprofile\n‚Ä¢ Anomaly Detection f√ºr Identifikation abweichender Verhaltensmuster\n‚Ä¢ Predictive Risk Assessment f√ºr Vorhersage potenzieller Sicherheitsrisiken\n‚Ä¢ Continuous Learning f√ºr Verbesserung der Risikobewertung √ºber Zeit\n‚Ä¢ Model Validation f√ºr Sicherstellung der Genauigkeit und Fairness der Algorithmen\n\n‚öôÔ∏è Technical Implementation und Integration:\n‚Ä¢ API-driven Architecture f√ºr flexible Integration verschiedener Authentifizierungsmethoden\n‚Ä¢ Real-time Decision Engines f√ºr schnelle Risikobewertung und Faktor-Auswahl\n‚Ä¢ Policy Management f√ºr konfigurierbare Risikoschwellen und Authentifizierungsrichtlinien\n‚Ä¢ Audit und Compliance f√ºr vollst√§ndige Protokollierung aller Authentifizierungsentscheidungen\n‚Ä¢ Scalability Design f√ºr Unterst√ºtzung gro√üer Benutzerzahlen und hoher Transaktionsvolumen\n\nüìä Monitoring und Continuous Improvement:\n‚Ä¢ Authentication Analytics f√ºr Analyse von Authentifizierungsmustern und Erfolgsraten\n‚Ä¢ User Feedback Integration f√ºr Verbesserung der User Experience\n‚Ä¢ False Positive Reduction f√ºr Minimierung unn√∂tiger Sicherheitsherausforderungen\n‚Ä¢ Security Effectiveness Measurement f√ºr Bewertung der Sicherheitsverbesserungen\n‚Ä¢ Regulatory Compliance f√ºr Erf√ºllung von Authentifizierungsanforderungen verschiedener Standards"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Strategien gibt es f√ºr die sichere Integration von IAM Security in DevOps und CI/CD Pipelines und wie kann man Security-by-Design implementieren?',
        answer: "Die Integration von IAM Security in DevOps und CI/CD Pipelines erfordert einen fundamentalen Wandel von traditionellen Security-Ans√§tzen hin zu Security-by-Design Prinzipien. Diese Integration erm√∂glicht es, Sicherheit als integralen Bestandteil des Entwicklungsprozesses zu etablieren, anstatt sie als nachgelagerte Aktivit√§t zu behandeln.\n\nüîß DevSecOps Integration und Pipeline Security:\n‚Ä¢ Security Gates in CI/CD Pipelines f√ºr automatisierte Sicherheitspr√ºfungen\n‚Ä¢ Infrastructure as Code (IaC) f√ºr konsistente und sichere IAM-Konfigurationen\n‚Ä¢ Automated Security Testing f√ºr kontinuierliche Validierung von IAM-Implementierungen\n‚Ä¢ Policy as Code f√ºr versionierte und nachvollziehbare Sicherheitsrichtlinien\n‚Ä¢ Shift-Left Security f√ºr fr√ºhzeitige Integration von Sicherheitskontrollen\n\nüèóÔ∏è Security-by-Design Architecture Principles:\n‚Ä¢ Secure Defaults f√ºr sichere Grundkonfigurationen aller IAM-Komponenten\n‚Ä¢ Least Privilege Implementation f√ºr minimale erforderliche Berechtigungen\n‚Ä¢ Defense in Depth f√ºr mehrschichtige Sicherheitskontrollen\n‚Ä¢ Fail-Safe Design f√ºr sichere Behandlung von Fehlerzust√§nden\n‚Ä¢ Privacy by Design f√ºr Schutz sensibler Identit√§tsdaten von Anfang an\n\nüîê Identity-Centric Security in Development:\n‚Ä¢ Developer Identity Management f√ºr sichere Entwickleridentit√§ten und Zugriffe\n‚Ä¢ Service Identity f√ºr sichere Authentifizierung zwischen Microservices\n‚Ä¢ API Security f√ºr Schutz von IAM-APIs und Endpunkten\n‚Ä¢ Secrets Management f√ºr sichere Handhabung von Credentials in Code und Deployment\n‚Ä¢ Container Security f√ºr Identit√§tsverwaltung in containerisierten Umgebungen\n\nüöÄ Automation und Orchestration:\n‚Ä¢ Automated Provisioning f√ºr konsistente Bereitstellung von IAM-Ressourcen\n‚Ä¢ Configuration Management f√ºr automatisierte Konfiguration und Updates\n‚Ä¢ Compliance Automation f√ºr kontinuierliche √úberpr√ºfung regulatorischer Anforderungen\n‚Ä¢ Incident Response Automation f√ºr schnelle Reaktion auf Sicherheitsereignisse\n‚Ä¢ Rollback Mechanisms f√ºr sichere R√ºckg√§ngigmachung problematischer Deployments\n\nüìä Monitoring und Observability:\n‚Ä¢ Real-time Security Monitoring f√ºr kontinuierliche √úberwachung der Pipeline-Sicherheit\n‚Ä¢ Audit Logging f√ºr vollst√§ndige Nachverfolgung aller Sicherheitsereignisse\n‚Ä¢ Metrics und Alerting f√ºr proaktive Erkennung von Sicherheitsproblemen\n‚Ä¢ Distributed Tracing f√ºr Verfolgung von Identit√§ten durch komplexe Systeme\n‚Ä¢ Security Dashboards f√ºr Visualisierung der Sicherheitslage in Echtzeit\n\nüõ°Ô∏è Vulnerability Management und Threat Modeling:\n‚Ä¢ Automated Vulnerability Scanning f√ºr kontinuierliche Identifikation von Sicherheitsl√ºcken\n‚Ä¢ Dependency Management f√ºr √úberwachung und Updates von Sicherheitsbibliotheken\n‚Ä¢ Threat Modeling Integration f√ºr systematische Bewertung von Sicherheitsrisiken\n‚Ä¢ Penetration Testing Automation f√ºr regelm√§√üige Sicherheitstests\n‚Ä¢ Security Code Review f√ºr manuelle und automatisierte Code-Analyse\n\nüîÑ Continuous Compliance und Governance:\n‚Ä¢ Regulatory Mapping f√ºr Zuordnung von Compliance-Anforderungen zu technischen Kontrollen\n‚Ä¢ Automated Reporting f√ºr regelm√§√üige Compliance-Berichte\n‚Ä¢ Change Management f√ºr kontrollierte √Ñnderungen an Sicherheitskonfigurationen\n‚Ä¢ Risk Assessment Integration f√ºr kontinuierliche Risikobewertung\n‚Ä¢ Documentation Automation f√ºr automatische Generierung von Sicherheitsdokumentation\n\nüéì Training und Culture Transformation:\n‚Ä¢ Security Training f√ºr Entwickler und Operations-Teams\n‚Ä¢ Security Champions Programme f√ºr F√∂rderung von Sicherheitsbewusstsein\n‚Ä¢ Collaborative Security f√ºr gemeinsame Verantwortung zwischen Teams\n‚Ä¢ Feedback Loops f√ºr kontinuierliche Verbesserung der Sicherheitsprozesse\n‚Ä¢ Knowledge Sharing f√ºr Verbreitung von Security Best Practices"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
