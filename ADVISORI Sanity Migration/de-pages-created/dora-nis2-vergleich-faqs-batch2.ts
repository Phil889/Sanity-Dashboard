import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA NIS2 Vergleich page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-nis2-vergleich' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-nis2-vergleich" not found')
    }
    
    // Create new FAQs for DORA NIS2 comparison implementation aspects
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Welche Unterschiede bestehen zwischen DORA und NIS2 bei den Incident-Reporting-Anforderungen und wie k√∂nnen diese harmonisiert werden?',
        answer: "Die Incident-Reporting-Anforderungen von DORA und NIS2 unterscheiden sich erheblich in Detailgrad, Zeitrahmen und Berichtsinhalten, was eine sorgf√§ltige Koordination erfordert. Eine harmonisierte Herangehensweise kann jedoch Synergien schaffen und die Compliance-Effizienz erh√∂hen.\n\n‚è∞ Zeitrahmen und Meldefristen:\n‚Ä¢ DORA fordert eine initiale Meldung schwerwiegender IKT-bezogener Incidents innerhalb von vier Stunden nach Entdeckung\n‚Ä¢ Detaillierte Zwischenberichte m√ºssen innerhalb von 72 Stunden und finale Berichte innerhalb eines Monats eingereicht werden\n‚Ä¢ NIS2 verlangt eine erste Meldung innerhalb von 24 Stunden nach Kenntnisnahme des Incidents\n‚Ä¢ Ein detaillierter Bericht muss innerhalb von 72 Stunden und ein finaler Bericht innerhalb eines Monats folgen\n‚Ä¢ Die unterschiedlichen initialen Meldefristen erfordern angepasste Incident-Response-Prozesse\n\nüìã Berichtsinhalt und Detailgrad:\n‚Ä¢ DORA definiert sehr spezifische Inhaltsanforderungen mit Fokus auf IKT-Services, betroffene Kunden und operative Auswirkungen\n‚Ä¢ Die Berichte m√ºssen detaillierte Informationen √ºber Drittanbieter-Beteiligung und Recovery-Ma√ünahmen enthalten\n‚Ä¢ NIS2 fordert Informationen √ºber die Art des Incidents, betroffene Services und ergriffene Ma√ünahmen\n‚Ä¢ Der Fokus liegt auf der Bewertung der Auswirkungen auf kritische Infrastrukturen und Services\n‚Ä¢ DORA-Berichte sind tendenziell detaillierter und finanzspezifischer als NIS2-Berichte\n\nüéØ Schwellenwerte und Klassifizierung:\n‚Ä¢ DORA definiert klare Kriterien f√ºr schwerwiegende IKT-bezogene Incidents basierend auf Auswirkungen auf Gesch√§ftst√§tigkeiten\n‚Ä¢ Die Klassifizierung ber√ºcksichtigt Faktoren wie Kundenzahl, Transaktionsvolumen und Systemverf√ºgbarkeit\n‚Ä¢ NIS2 verwendet risikobasierte Bewertungen zur Bestimmung meldepflichtiger Incidents\n‚Ä¢ Die Schwellenwerte k√∂nnen je nach Mitgliedstaat und Sektor variieren\n‚Ä¢ Eine einheitliche Klassifizierungsmatrix kann beide Anforderungen adressieren\n\nüîÑ Harmonisierungsstrategien:\n‚Ä¢ Entwicklung integrierter Incident-Classification-Frameworks, die beide Regulierungen ber√ºcksichtigen\n‚Ä¢ Implementierung von Reporting-Systemen, die automatisch beide Formate generieren k√∂nnen\n‚Ä¢ Etablierung koordinierter Incident-Response-Teams mit Expertise in beiden Frameworks\n‚Ä¢ Schaffung einheitlicher Dokumentationsstandards, die alle erforderlichen Informationen erfassen\n‚Ä¢ Entwicklung von Escalation-Prozessen, die beide Meldefristen ber√ºcksichtigen\n\nü§ù Stakeholder-Koordination:\n‚Ä¢ Aufbau von Beziehungen zu allen relevanten Aufsichtsbeh√∂rden f√ºr beide Frameworks\n‚Ä¢ Entwicklung koordinierter Kommunikationsstrategien f√ºr Incident-Situationen\n‚Ä¢ Etablierung von Feedback-Mechanismen zur kontinuierlichen Verbesserung der Reporting-Prozesse\n‚Ä¢ Teilnahme an Brancheninitiativen zur Harmonisierung von Incident-Reporting-Standards\n‚Ä¢ Regelm√§√üige Abstimmung mit Aufsichtsbeh√∂rden √ºber Best Practices und Erwartungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Wie unterscheiden sich die Drittanbieter-Management-Anforderungen zwischen DORA und NIS2, und welche integrierten Ans√§tze sind m√∂glich?',
        answer: "Die Drittanbieter-Management-Anforderungen von DORA und NIS2 zeigen sowohl √úberschneidungen als auch spezifische Unterschiede, die eine strategische Integration erfordern. Ein koordinierter Ansatz kann die Effizienz steigern und gleichzeitig beide regulatorischen Anforderungen erf√ºllen.\n\nüîç Scope und Anwendungsbereich:\n‚Ä¢ DORA fokussiert spezifisch auf IKT-Drittanbieter und deren Services f√ºr Finanzinstitute\n‚Ä¢ Die Regulierung definiert kritische IKT-Drittanbieter basierend auf Systemrelevanz und Substituierbarkeit\n‚Ä¢ NIS2 adressiert Supply-Chain-Risiken breiter und umfasst verschiedene Arten von Drittanbietern\n‚Ä¢ Der Fokus liegt auf Drittanbietern, die kritische oder wichtige Services f√ºr die Organisation erbringen\n‚Ä¢ Beide Frameworks erfordern eine systematische Identifikation und Klassifizierung von Drittanbietern\n\nüìä Risikobewertung und Due Diligence:\n‚Ä¢ DORA verlangt detaillierte IKT-Risikobewertungen mit spezifischen Kriterien f√ºr Finanzdienstleistungen\n‚Ä¢ Die Bewertung muss Faktoren wie Konzentration, Komplexit√§t und Kritikalit√§t ber√ºcksichtigen\n‚Ä¢ NIS2 fordert risikobasierte Bewertungen der Supply-Chain mit Fokus auf Cybersecurity-Risiken\n‚Ä¢ Die Bewertung sollte die gesamte Lieferkette und potenzielle Schwachstellen umfassen\n‚Ä¢ Integrierte Risikobewertungsframeworks k√∂nnen beide Anforderungen effizient adressieren\n\nüìã Vertragliche Anforderungen und Governance:\n‚Ä¢ DORA definiert spezifische vertragliche Mindestanforderungen f√ºr IKT-Drittanbieter-Vertr√§ge\n‚Ä¢ Diese umfassen Audit-Rechte, Incident-Notification und Exit-Strategien\n‚Ä¢ NIS2 fordert angemessene Cybersecurity-Klauseln in Drittanbieter-Vertr√§gen\n‚Ä¢ Der Fokus liegt auf der Sicherstellung angemessener Cybersecurity-Standards bei Drittanbietern\n‚Ä¢ Harmonisierte Vertragsstandards k√∂nnen beide regulatorischen Anforderungen erf√ºllen\n\nüîÑ Monitoring und √úberwachung:\n‚Ä¢ DORA verlangt kontinuierliche √úberwachung kritischer IKT-Drittanbieter mit regelm√§√üigen Reviews\n‚Ä¢ Die √úberwachung muss Performance, Risiken und Compliance-Status umfassen\n‚Ä¢ NIS2 fordert angemessene √úberwachung der Supply-Chain-Cybersecurity\n‚Ä¢ Der Fokus liegt auf der Identifikation und Behandlung von Cybersecurity-Risiken\n‚Ä¢ Integrierte Monitoring-Systeme k√∂nnen Effizienz und Effektivit√§t steigern\n\nüö™ Exit-Strategien und Kontinuit√§tsplanung:\n‚Ä¢ DORA fordert detaillierte Exit-Strategien f√ºr kritische IKT-Drittanbieter\n‚Ä¢ Diese m√ºssen Transition-Pl√§ne, Datenportabilit√§t und Business-Continuity umfassen\n‚Ä¢ NIS2 verlangt Kontinuit√§tspl√§ne f√ºr kritische Supply-Chain-Abh√§ngigkeiten\n‚Ä¢ Der Fokus liegt auf der Aufrechterhaltung kritischer Services bei Drittanbieter-Ausf√§llen\n‚Ä¢ Koordinierte Kontinuit√§tsplanung kann beide Anforderungen effektiv adressieren\n\nüéØ Integrierte Implementierungsstrategien:\n‚Ä¢ Entwicklung einheitlicher Drittanbieter-Governance-Frameworks f√ºr beide Regulierungen\n‚Ä¢ Implementierung integrierter Due-Diligence-Prozesse mit erweiterten Bewertungskriterien\n‚Ä¢ Schaffung harmonisierter Vertragsstandards und -Templates\n‚Ä¢ Etablierung koordinierter Monitoring- und Review-Prozesse\n‚Ä¢ Entwicklung integrierter Exit- und Kontinuit√§tsstrategien f√ºr alle kritischen Drittanbieter"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Welche Governance-Strukturen sind erforderlich, um sowohl DORA- als auch NIS2-Anforderungen effektiv zu managen?',
        answer: "Die effektive Governance beider Frameworks erfordert durchdachte organisatorische Strukturen, die sowohl die spezifischen Anforderungen jeder Regulierung als auch deren Synergien ber√ºcksichtigen. Eine integrierte Governance-Architektur kann Effizienz maximieren und Compliance-Risiken minimieren.\n\nüèóÔ∏è Organisatorische Struktur und Verantwortlichkeiten:\n‚Ä¢ Etablierung eines √ºbergeordneten Digital Resilience Committee mit Verantwortung f√ºr beide Frameworks\n‚Ä¢ Definition klarer Rollen f√ºr DORA- und NIS2-spezifische Compliance-Funktionen\n‚Ä¢ Schaffung von Cross-Functional Teams mit Expertise in beiden regulatorischen Bereichen\n‚Ä¢ Implementierung einer Matrix-Organisation mit geteilten Verantwortlichkeiten f√ºr √ºberschneidende Bereiche\n‚Ä¢ Etablierung klarer Eskalationswege und Entscheidungsstrukturen f√ºr beide Frameworks\n\nüë• F√ºhrungsebene und Board-Oversight:\n‚Ä¢ Sicherstellung angemessener Board-Level-Expertise f√ºr beide Regulierungsframeworks\n‚Ä¢ Implementierung regelm√§√üiger Board-Reporting-Mechanismen f√ºr DORA- und NIS2-Compliance\n‚Ä¢ Definition klarer Verantwortlichkeiten f√ºr Gesch√§ftsf√ºhrung und Aufsichtsrat\n‚Ä¢ Etablierung von Risk-Appetite-Statements, die beide Frameworks ber√ºcksichtigen\n‚Ä¢ Schaffung von Governance-Strukturen f√ºr strategische Entscheidungen zu beiden Regulierungen\n\nüìä Risikomanagement-Integration:\n‚Ä¢ Entwicklung integrierter Risk-Assessment-Frameworks f√ºr beide Regulierungen\n‚Ä¢ Implementierung einheitlicher Risk-Reporting-Strukturen und -Metriken\n‚Ä¢ Schaffung koordinierter Risk-Appetite- und Tolerance-Frameworks\n‚Ä¢ Etablierung integrierter Risk-Monitoring- und -Management-Prozesse\n‚Ä¢ Entwicklung harmonisierter Risk-Treatment- und Mitigation-Strategien\n\nüîÑ Operative Governance-Prozesse:\n‚Ä¢ Implementierung integrierter Policy- und Procedure-Management-Systeme\n‚Ä¢ Schaffung koordinierter Change-Management-Prozesse f√ºr beide Frameworks\n‚Ä¢ Etablierung einheitlicher Dokumentations- und Record-Keeping-Standards\n‚Ä¢ Entwicklung harmonisierter Training- und Awareness-Programme\n‚Ä¢ Implementierung integrierter Performance-Management- und KPI-Systeme\n\nüìã Compliance-Monitoring und -Reporting:\n‚Ä¢ Entwicklung integrierter Compliance-Monitoring-Dashboards f√ºr beide Frameworks\n‚Ä¢ Implementierung automatisierter Compliance-Tracking- und -Reporting-Systeme\n‚Ä¢ Schaffung koordinierter Internal-Audit-Programme f√ºr beide Regulierungen\n‚Ä¢ Etablierung einheitlicher Compliance-Testing- und -Validation-Prozesse\n‚Ä¢ Entwicklung harmonisierter Regulatory-Reporting-Mechanismen\n\nü§ù Stakeholder-Management und Kommunikation:\n‚Ä¢ Aufbau koordinierter Beziehungen zu allen relevanten Aufsichtsbeh√∂rden\n‚Ä¢ Entwicklung integrierter Stakeholder-Communication-Strategien\n‚Ä¢ Implementierung einheitlicher Incident-Communication-Prozesse\n‚Ä¢ Schaffung koordinierter Industry-Engagement- und Advocacy-Aktivit√§ten\n‚Ä¢ Etablierung harmonisierter Public-Relations- und Reputation-Management-Ans√§tze\n\nüîÆ Kontinuierliche Verbesserung und Anpassung:\n‚Ä¢ Implementierung integrierter Lessons-Learned- und Best-Practice-Sharing-Mechanismen\n‚Ä¢ Schaffung koordinierter Regulatory-Intelligence- und Horizon-Scanning-Capabilities\n‚Ä¢ Entwicklung adaptiver Governance-Strukturen f√ºr sich √§ndernde regulatorische Anforderungen\n‚Ä¢ Etablierung kontinuierlicher Governance-Effectiveness-Reviews\n‚Ä¢ Implementierung integrierter Innovation- und Technology-Adoption-Prozesse"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Wie k√∂nnen Organisationen die unterschiedlichen Penetrationstesting-Anforderungen von DORA und NIS2 koordinieren?',
        answer: "Die Penetrationstesting-Anforderungen von DORA und NIS2 unterscheiden sich in Umfang, Frequenz und Methodik, bieten jedoch M√∂glichkeiten f√ºr eine koordinierte Herangehensweise, die Effizienz steigert und umfassendere Sicherheitsbewertungen erm√∂glicht.\n\nüéØ DORA-spezifische Testing-Anforderungen:\n‚Ä¢ DORA fordert regelm√§√üige digitale operationelle Resilienz-Tests einschlie√ülich Vulnerability-Assessments und Penetrationstests\n‚Ä¢ Threat-Led Penetration Testing (TLPT) ist f√ºr kritische Finanzinstitute verpflichtend\n‚Ä¢ Die Tests m√ºssen realistische Angriffsszenarios simulieren und die gesamte IKT-Infrastruktur abdecken\n‚Ä¢ Spezifische Anforderungen f√ºr Tests kritischer IKT-Drittanbieter und deren Services\n‚Ä¢ Detaillierte Dokumentations- und Reporting-Anforderungen f√ºr alle Testergebnisse\n\nüõ°Ô∏è NIS2-Testing-Erwartungen:\n‚Ä¢ NIS2 fordert regelm√§√üige Cybersecurity-Assessments einschlie√ülich Vulnerability-Scans und Penetrationstests\n‚Ä¢ Die Tests sollten risikobasiert und proportional zur Kritikalit√§t der Services sein\n‚Ä¢ Fokus auf die Bewertung der Wirksamkeit implementierter Cybersecurity-Ma√ünahmen\n‚Ä¢ Ber√ºcksichtigung der gesamten IT-Infrastruktur und kritischen Systeme\n‚Ä¢ Flexibilit√§t bei der Wahl der Testing-Methoden und -Frequenz\n\nüîÑ Koordinierte Testing-Strategien:\n‚Ä¢ Entwicklung integrierter Testing-Frameworks, die beide regulatorischen Anforderungen erf√ºllen\n‚Ä¢ Harmonisierung von Testing-Zyklen zur Maximierung der Effizienz und Minimierung von St√∂rungen\n‚Ä¢ Implementierung umfassender Scope-Definitionen, die alle kritischen Systeme und Services abdecken\n‚Ä¢ Koordination verschiedener Testing-Methoden f√ºr optimale Coverage und Insights\n‚Ä¢ Entwicklung einheitlicher Testing-Standards und -Qualit√§tskriterien\n\nüìä Integrierte Testing-Planung:\n‚Ä¢ Erstellung koordinierter Testing-Kalender, die beide regulatorischen Zyklen ber√ºcksichtigen\n‚Ä¢ Entwicklung risikoorientierter Testing-Priorisierung f√ºr optimale Ressourcennutzung\n‚Ä¢ Implementierung von Testing-Portfolios, die verschiedene Methoden und Ans√§tze kombinieren\n‚Ä¢ Koordination interner und externer Testing-Ressourcen f√ºr maximale Effizienz\n‚Ä¢ Schaffung flexibler Testing-Frameworks, die sich an sich √§ndernde Bedrohungslandschaften anpassen\n\nüîç Erweiterte Testing-Methoden:\n‚Ä¢ Integration von Red-Team-Exercises, die sowohl DORA- als auch NIS2-Anforderungen adressieren\n‚Ä¢ Implementierung kontinuierlicher Security-Testing-Ans√§tze f√ºr laufende Bewertungen\n‚Ä¢ Entwicklung szenariobasierter Testing-Ans√§tze f√ºr realistische Bedrohungssimulationen\n‚Ä¢ Koordination von Application-, Network- und Infrastructure-Testing f√ºr umfassende Coverage\n‚Ä¢ Integration von Social-Engineering- und Physical-Security-Tests\n\nüìã Reporting und Dokumentation:\n‚Ä¢ Entwicklung integrierter Testing-Reports, die beide regulatorischen Anforderungen erf√ºllen\n‚Ä¢ Implementierung standardisierter Vulnerability-Classification- und Risk-Rating-Systeme\n‚Ä¢ Schaffung koordinierter Remediation-Tracking- und -Management-Prozesse\n‚Ä¢ Entwicklung einheitlicher Testing-Metriken und KPIs f√ºr beide Frameworks\n‚Ä¢ Etablierung harmonisierter Testing-Governance- und Oversight-Mechanismen\n\nüöÄ Kontinuierliche Verbesserung:\n‚Ä¢ Implementierung von Lessons-Learned-Prozessen aus allen Testing-Aktivit√§ten\n‚Ä¢ Entwicklung adaptiver Testing-Strategien basierend auf Threat-Intelligence\n‚Ä¢ Koordination mit Industry-Best-Practices und Threat-Sharing-Initiativen\n‚Ä¢ Etablierung kontinuierlicher Testing-Capability-Entwicklung\n‚Ä¢ Integration von Emerging-Technologies und -Methoden in Testing-Frameworks"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
