import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Anforderungen page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-anforderungen' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-anforderungen" not found')
    }
    
    // Create new FAQs for ISO 27001 requirements fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Welche grundlegenden Anforderungen definiert ISO 27001 f√ºr ein wirksames ISMS?',
        answer: "ISO 27001 definiert umfassende Anforderungen f√ºr die Etablierung, Implementierung, Aufrechterhaltung und kontinuierliche Verbesserung eines Informationssicherheits-Managementsystems. Diese Anforderungen bilden das Fundament f√ºr systematische Informationssicherheit und gehen weit √ºber technische Ma√ünahmen hinaus, indem sie einen ganzheitlichen Management-Ansatz verfolgen.\n\nüèóÔ∏è Strukturelle ISMS-Anforderungen:\n‚Ä¢ Etablierung eines systematischen Managementsystems mit klaren Verantwortlichkeiten, Prozessen und Governance-Strukturen\n‚Ä¢ Definition des Anwendungsbereichs und der Grenzen des ISMS unter Ber√ºcksichtigung aller relevanten Gesch√§ftsprozesse und Informationswerte\n‚Ä¢ Entwicklung einer Informationssicherheitspolitik, die strategische Ausrichtung und Grunds√§tze der Organisation widerspiegelt\n‚Ä¢ Aufbau einer angemessenen Organisationsstruktur mit definierten Rollen, Verantwortlichkeiten und Befugnissen f√ºr Informationssicherheit\n‚Ä¢ Implementierung eines systematischen Ansatzes zur Planung, Durchf√ºhrung, √úberwachung und Verbesserung von Sicherheitsma√ünahmen\n\nüéØ Risikomanagement-Anforderungen:\n‚Ä¢ Etablierung eines systematischen Risikomanagement-Prozesses, der alle Aspekte der Informationssicherheit abdeckt\n‚Ä¢ Durchf√ºhrung regelm√§√üiger Risikobeurteilungen zur Identifikation, Analyse und Bewertung von Informationssicherheitsrisiken\n‚Ä¢ Entwicklung und Implementierung von Risikobehandlungspl√§nen mit angemessenen Kontrollma√ünahmen\n‚Ä¢ Kontinuierliche √úberwachung und √úberpr√ºfung der Risikolandschaft und Anpassung der Behandlungsstrategien\n‚Ä¢ Integration des Risikomanagements in alle relevanten Gesch√§ftsprozesse und Entscheidungsfindungen\n\nüìã Kontrollma√ünahmen-Anforderungen:\n‚Ä¢ Auswahl und Implementierung angemessener Kontrollma√ünahmen basierend auf Risikobeurteilung und Gesch√§ftsanforderungen\n‚Ä¢ Systematische Umsetzung der relevanten Kontrollziele aus Anhang A der ISO 27001 mit insgesamt 114 Kontrollma√ünahmen\n‚Ä¢ Entwicklung detaillierter Implementierungspl√§ne f√ºr jede ausgew√§hlte Kontrollma√ünahme\n‚Ä¢ Regelm√§√üige √úberpr√ºfung der Wirksamkeit implementierter Kontrollma√ünahmen\n‚Ä¢ Kontinuierliche Anpassung und Verbesserung der Kontrollma√ünahmen basierend auf ver√§nderten Risiken und Gesch√§ftsanforderungen\n\nüîÑ Betriebsanforderungen:\n‚Ä¢ Etablierung systematischer Prozesse f√ºr die t√§gliche Verwaltung und den Betrieb des ISMS\n‚Ä¢ Implementierung von Verfahren zur √úberwachung, Messung und Bewertung der ISMS-Performance\n‚Ä¢ Durchf√ºhrung regelm√§√üiger interner Audits zur √úberpr√ºfung der Konformit√§t und Wirksamkeit\n‚Ä¢ Etablierung von Management-Reviews zur strategischen Bewertung und Steuerung des ISMS\n‚Ä¢ Implementierung systematischer Verbesserungsprozesse basierend auf Audit-Ergebnissen, Vorf√§llen und ver√§nderten Anforderungen\n\nüìö Dokumentations- und Nachweisanforderungen:\n‚Ä¢ Entwicklung und Aufrechterhaltung einer umfassenden ISMS-Dokumentation einschlie√ülich Richtlinien, Verfahren und Arbeitsanweisungen\n‚Ä¢ Systematische Dokumentation aller ISMS-Aktivit√§ten, Entscheidungen und Ergebnisse f√ºr Nachweiszwecke\n‚Ä¢ Implementierung eines effektiven Dokumentenmanagement-Systems mit Versionskontrolle und Zugriffsbeschr√§nkungen\n‚Ä¢ Aufbewahrung relevanter Aufzeichnungen als Nachweis f√ºr die ordnungsgem√§√üe Funktion des ISMS\n‚Ä¢ Sicherstellung der Verf√ºgbarkeit und Integrit√§t aller ISMS-Dokumentation f√ºr interne und externe Audits"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie werden die 114 Kontrollma√ünahmen aus Anhang A systematisch bewertet und implementiert?',
        answer: "Die systematische Bewertung und Implementierung der 114 Kontrollma√ünahmen aus Anhang A der ISO 27001 erfordert einen strukturierten, risikorientierten Ansatz, der sowohl die spezifischen Gesch√§ftsanforderungen als auch die individuelle Risikolandschaft der Organisation ber√ºcksichtigt. Dieser Prozess geht weit √ºber eine einfache Checklisten-Abarbeitung hinaus und erfordert tiefgreifende Analyse und strategische Planung.\n\nüîç Systematische Kontrollbewertung:\n‚Ä¢ Durchf√ºhrung einer umfassenden Anwendbarkeitsanalyse f√ºr jede der 114 Kontrollma√ünahmen unter Ber√ºcksichtigung der spezifischen Gesch√§ftst√§tigkeit, IT-Landschaft und regulatorischen Anforderungen\n‚Ä¢ Bewertung der aktuellen Implementierung bestehender Kontrollma√ünahmen durch detaillierte Gap-Analyse und Reifegradbewertung\n‚Ä¢ Risikoorientierte Priorisierung der Kontrollma√ünahmen basierend auf ihrer Bedeutung f√ºr die Behandlung identifizierter Risiken\n‚Ä¢ Ber√ºcksichtigung von Abh√§ngigkeiten zwischen verschiedenen Kontrollma√ünahmen und deren synergetischen Effekten\n‚Ä¢ Bewertung der Kosten-Nutzen-Relation jeder Kontrollma√ünahme im Kontext der Gesamtstrategie\n\nüìä Risikoorientierte Auswahl:\n‚Ä¢ Verkn√ºpfung jeder Kontrollma√ünahme mit spezifischen Risiken aus der Risikobeurteilung zur Sicherstellung zielgerichteter Implementierung\n‚Ä¢ Bewertung der Wirksamkeit verschiedener Kontrollma√ünahmen bei der Behandlung identifizierter Risiken\n‚Ä¢ Ber√ºcksichtigung regulatorischer und vertraglicher Anforderungen bei der Kontrollauswahl\n‚Ä¢ Analyse von Branchenstandards und Best Practices zur Validierung der Kontrollauswahl\n‚Ä¢ Entwicklung einer ausgewogenen Mischung aus pr√§ventiven, detektiven und korrektiven Kontrollma√ünahmen\n\nüéØ Phasenweise Implementierungsstrategie:\n‚Ä¢ Entwicklung einer strukturierten Implementierungsroadmap mit klaren Phasen, Meilensteinen und Abh√§ngigkeiten\n‚Ä¢ Priorisierung kritischer Kontrollma√ünahmen f√ºr die erste Implementierungsphase basierend auf Risikobewertung und Business Impact\n‚Ä¢ Ber√ºcksichtigung verf√ºgbarer Ressourcen, Budgets und organisatorischer Kapazit√§ten bei der Phasenplanung\n‚Ä¢ Integration der Kontrollimplementierung in bestehende Projekte und Gesch√§ftsprozesse zur Maximierung der Effizienz\n‚Ä¢ Etablierung von Quick Wins durch Implementierung einfach umsetzbarer Kontrollma√ünahmen f√ºr sofortige Sicherheitsverbesserungen\n\nüîß Ma√ügeschneiderte Implementierung:\n‚Ä¢ Anpassung jeder Kontrollma√ünahme an die spezifischen Gegebenheiten, Prozesse und Technologien der Organisation\n‚Ä¢ Entwicklung detaillierter Implementierungspl√§ne mit konkreten Aktivit√§ten, Verantwortlichkeiten und Zeitpl√§nen\n‚Ä¢ Integration der Kontrollma√ünahmen in bestehende Gesch√§ftsprozesse zur Minimierung operativer St√∂rungen\n‚Ä¢ Ber√ºcksichtigung kultureller und organisatorischer Faktoren bei der Gestaltung der Implementierung\n‚Ä¢ Aufbau interner Kompetenzen und Verantwortlichkeiten f√ºr die nachhaltige Aufrechterhaltung der Kontrollma√ünahmen\n\nüìà Kontinuierliche √úberwachung und Optimierung:\n‚Ä¢ Etablierung systematischer √úberwachungsmechanismen zur kontinuierlichen Bewertung der Kontrollwirksamkeit\n‚Ä¢ Implementierung von KPIs und Metriken f√ºr jede Kontrollma√ünahme zur objektiven Leistungsmessung\n‚Ä¢ Regelm√§√üige √úberpr√ºfung und Anpassung der Kontrollma√ünahmen basierend auf ver√§nderten Risiken, Technologien und Gesch√§ftsanforderungen\n‚Ä¢ Durchf√ºhrung periodischer Wirksamkeitsbewertungen und Verbesserungsma√ünahmen\n‚Ä¢ Integration der Kontrollergebnisse in das kontinuierliche Verbesserungsprogramm des ISMS"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Dokumentationsanforderungen m√ºssen f√ºr eine erfolgreiche ISO 27001 Zertifizierung erf√ºllt werden?',
        answer: "Die Dokumentationsanforderungen der ISO 27001 sind umfassend und bilden das R√ºckgrat eines wirksamen ISMS. Sie dienen nicht nur der Compliance, sondern auch der operativen Steuerung, Wissensbewahrung und kontinuierlichen Verbesserung. Eine systematische Herangehensweise an die Dokumentation ist entscheidend f√ºr den Zertifizierungserfolg und die nachhaltige ISMS-Wirksamkeit.\n\nüìã Pflichtdokumente nach ISO 27001:\n‚Ä¢ Informationssicherheitspolitik als strategisches Grundlagendokument mit klarer Ausrichtung und Verpflichtung des Top-Managements\n‚Ä¢ Anwendungsbereich und Grenzen des ISMS mit pr√§ziser Definition der abgedeckten Bereiche, Prozesse und Standorte\n‚Ä¢ Risikobeurteilungs- und Risikobehandlungsmethodik mit detaillierter Beschreibung der angewandten Verfahren und Kriterien\n‚Ä¢ Anwendbarkeitserkl√§rung f√ºr alle 114 Kontrollma√ünahmen mit Begr√ºndung f√ºr Auswahl oder Ausschluss\n‚Ä¢ Risikobeurteilungsbericht mit systematischer Dokumentation aller identifizierten Risiken und deren Bewertung\n‚Ä¢ Risikobehandlungsplan mit konkreten Ma√ünahmen, Verantwortlichkeiten und Zeitpl√§nen\n\nüîÑ Prozessdokumentation:\n‚Ä¢ Detaillierte Verfahrensbeschreibungen f√ºr alle kritischen ISMS-Prozesse einschlie√ülich Risikomanagement, Incident Management und Change Management\n‚Ä¢ Arbeitsanweisungen f√ºr die operative Umsetzung der Kontrollma√ünahmen mit klaren Schritt-f√ºr-Schritt-Anleitungen\n‚Ä¢ Prozesslandkarte mit Darstellung aller ISMS-relevanten Prozesse und deren Wechselwirkungen\n‚Ä¢ Rollen- und Verantwortlichkeitsmatrix mit eindeutiger Zuordnung von Aufgaben und Befugnissen\n‚Ä¢ Eskalations- und Kommunikationswege f√ºr verschiedene Szenarien und Situationen\n\nüìä Aufzeichnungen und Nachweise:\n‚Ä¢ Systematische Dokumentation aller ISMS-Aktivit√§ten, Entscheidungen und Ergebnisse als Nachweis f√ºr die ordnungsgem√§√üe Funktion\n‚Ä¢ Audit-Berichte von internen und externen Audits mit detaillierter Dokumentation von Feststellungen und Korrekturma√ünahmen\n‚Ä¢ Management-Review-Protokolle mit Dokumentation strategischer Entscheidungen und Verbesserungsma√ünahmen\n‚Ä¢ Incident-Reports und deren Behandlung als Nachweis f√ºr die Wirksamkeit der Reaktionsprozesse\n‚Ä¢ Schulungs- und Sensibilisierungsnachweise f√ºr alle relevanten Mitarbeiter\n‚Ä¢ √úberwachungs- und Messergebnisse zur Demonstration der kontinuierlichen ISMS-Performance\n\nüéØ Kontrollspezifische Dokumentation:\n‚Ä¢ Detaillierte Beschreibung der Implementierung jeder ausgew√§hlten Kontrollma√ünahme mit konkreten Umsetzungsdetails\n‚Ä¢ Wirksamkeitsnachweise f√ºr implementierte Kontrollma√ünahmen durch Tests, Messungen oder Bewertungen\n‚Ä¢ Konfigurationsdokumentation f√ºr technische Sicherheitsma√ünahmen und deren Einstellungen\n‚Ä¢ Betriebshandb√ºcher f√ºr sicherheitskritische Systeme und Prozesse\n‚Ä¢ Notfall- und Business Continuity-Pl√§ne mit detaillierten Verfahren f√ºr verschiedene St√∂rungsszenarien\n\nüìö Dokumentenmanagement-Anforderungen:\n‚Ä¢ Implementierung eines systematischen Dokumentenmanagement-Systems mit Versionskontrolle, Freigabeprozessen und Zugriffsbeschr√§nkungen\n‚Ä¢ Eindeutige Kennzeichnung und Klassifizierung aller ISMS-Dokumente nach Vertraulichkeit und Wichtigkeit\n‚Ä¢ Regelm√§√üige √úberpr√ºfung und Aktualisierung der Dokumentation zur Sicherstellung der Aktualit√§t und Relevanz\n‚Ä¢ Sichere Aufbewahrung und Backup-Strategien f√ºr alle kritischen ISMS-Dokumente\n‚Ä¢ Schulung der Mitarbeiter im Umgang mit der ISMS-Dokumentation und deren ordnungsgem√§√üer Verwendung\n\nüîç Audit-Vorbereitung durch Dokumentation:\n‚Ä¢ Strukturierte Aufbereitung aller Dokumente und Nachweise f√ºr effiziente Audit-Durchf√ºhrung\n‚Ä¢ Entwicklung einer Evidenz-Matrix, die alle Anforderungen mit entsprechenden Nachweisen verkn√ºpft\n‚Ä¢ Vorbereitung von Dokumenten-Roadmaps f√ºr Auditoren zur Navigation durch die ISMS-Dokumentation\n‚Ä¢ Sicherstellung der Verf√ºgbarkeit und Zug√§nglichkeit aller relevanten Dokumente w√§hrend des Audits\n‚Ä¢ Training der Mitarbeiter in der Pr√§sentation und Erl√§uterung der ISMS-Dokumentation gegen√ºber Auditoren"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie wird die Angemessenheit und Wirksamkeit der implementierten ISO 27001 Anforderungen kontinuierlich √ºberwacht?',
        answer: "Die kontinuierliche √úberwachung der Angemessenheit und Wirksamkeit implementierter ISO 27001 Anforderungen ist ein kritischer Erfolgsfaktor f√ºr ein lebendiges und effektives ISMS. Dieser Prozess geht weit √ºber sporadische Kontrollen hinaus und erfordert systematische, datengetriebene Ans√§tze zur kontinuierlichen Bewertung und Verbesserung der Informationssicherheit.\n\nüìä Systematische Performance-Messung:\n‚Ä¢ Entwicklung und Implementierung umfassender KPIs und Metriken f√ºr alle kritischen ISMS-Bereiche einschlie√ülich Risikomanagement, Kontrollwirksamkeit und Incident-Response\n‚Ä¢ Etablierung von Baseline-Messungen und Zielwerten f√ºr objektive Leistungsbewertung und Trendanalyse\n‚Ä¢ Implementierung automatisierter Monitoring-Systeme f√ºr kontinuierliche Datenerfassung und Echtzeit√ºberwachung kritischer Sicherheitsparameter\n‚Ä¢ Regelm√§√üige Bewertung der Relevanz und Aussagekraft der verwendeten Metriken und deren Anpassung an ver√§nderte Anforderungen\n‚Ä¢ Integration von qualitativen und quantitativen Bewertungsmethoden f√ºr eine ganzheitliche Performance-Sicht\n\nüîç Kontinuierliche Kontrollbewertung:\n‚Ä¢ Systematische und regelm√§√üige √úberpr√ºfung der Wirksamkeit aller implementierten Kontrollma√ünahmen durch Tests, Assessments und Bewertungen\n‚Ä¢ Durchf√ºhrung von Penetrationstests, Vulnerability Assessments und anderen technischen Pr√ºfungen zur Validierung der Kontrollwirksamkeit\n‚Ä¢ Implementierung von Kontroll-Self-Assessments durch die verantwortlichen Prozesseigner zur kontinuierlichen Selbstbewertung\n‚Ä¢ Regelm√§√üige √úberpr√ºfung der Angemessenheit der Kontrollma√ünahmen im Kontext sich ver√§ndernder Bedrohungen und Gesch√§ftsanforderungen\n‚Ä¢ Dokumentation und Analyse von Kontrollausf√§llen oder -schw√§chen zur Identifikation von Verbesserungspotenzialen\n\nüéØ Risikoorientierte √úberwachung:\n‚Ä¢ Kontinuierliche √úberwachung der Risikolandschaft und Bewertung der Wirksamkeit der Risikobehandlungsma√ünahmen\n‚Ä¢ Implementierung von Fr√ºhwarnsystemen zur proaktiven Identifikation neuer oder sich ver√§ndernder Risiken\n‚Ä¢ Regelm√§√üige Aktualisierung der Risikobeurteilung basierend auf ver√§nderten Gesch√§ftsprozessen, Technologien oder Bedrohungen\n‚Ä¢ √úberwachung von Risikoindikatoren und Schwellenwerten zur rechtzeitigen Erkennung kritischer Entwicklungen\n‚Ä¢ Integration von Threat Intelligence und externen Risikoinformationen in die kontinuierliche Risikobewertung\n\nüîÑ Systematische Audit-Programme:\n‚Ä¢ Entwicklung und Durchf√ºhrung umfassender interner Audit-Programme mit risikoorientierter Priorisierung und Abdeckung aller ISMS-Bereiche\n‚Ä¢ Implementierung kontinuierlicher Audit-Ans√§tze anstelle punktueller Jahresaudits f√ºr bessere Abdeckung und rechtzeitige Problemerkennung\n‚Ä¢ Einsatz qualifizierter und unabh√§ngiger Auditoren zur objektiven Bewertung der ISMS-Wirksamkeit\n‚Ä¢ Systematische Verfolgung und √úberwachung der Umsetzung von Audit-Feststellungen und Korrekturma√ünahmen\n‚Ä¢ Integration externer Audit-Ergebnisse und Zertifizierungsaudits in das kontinuierliche Verbesserungsprogramm\n\nüìà Management-Review und strategische Steuerung:\n‚Ä¢ Regelm√§√üige Management-Reviews zur strategischen Bewertung der ISMS-Performance und Angemessenheit\n‚Ä¢ Systematische Analyse von Trends, Mustern und Entwicklungen in der ISMS-Performance zur Identifikation strategischer Handlungsfelder\n‚Ä¢ Bewertung der Ressourcenausstattung und organisatorischen Unterst√ºtzung f√ºr das ISMS\n‚Ä¢ √úberpr√ºfung der Alignment zwischen ISMS-Zielen und Gesch√§ftszielen zur Sicherstellung strategischer Relevanz\n‚Ä¢ Entscheidungsfindung √ºber notwendige Anpassungen, Verbesserungen oder strategische Neuausrichtungen des ISMS\n\nüöÄ Kontinuierliche Verbesserung:\n‚Ä¢ Implementierung systematischer Verbesserungsprozesse basierend auf Monitoring-Ergebnissen, Audit-Feststellungen und Stakeholder-Feedback\n‚Ä¢ Etablierung einer Kultur der kontinuierlichen Verbesserung mit Anreizen f√ºr proaktive Verbesserungsvorschl√§ge\n‚Ä¢ Regelm√§√üige Bewertung und Aktualisierung der ISMS-Prozesse, Verfahren und Kontrollma√ünahmen\n‚Ä¢ Integration von Lessons Learned aus Sicherheitsvorf√§llen und externen Entwicklungen in die ISMS-Verbesserung\n‚Ä¢ Benchmarking mit Branchenstandards und Best Practices zur Identifikation von Verbesserungspotenzialen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
