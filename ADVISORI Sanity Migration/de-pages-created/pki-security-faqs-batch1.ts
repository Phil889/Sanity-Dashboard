import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating PKI Security page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'pki-security' })
    
    if (!existingDoc) {
      throw new Error('Document "pki-security" not found')
    }
    
    // Create new FAQs for PKI Security fundamentals and threat protection
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Warum ist PKI Security mehr als traditionelle Certificate-Verwaltung und wie transformiert es moderne Vertrauensarchitekturen?',
        answer: "PKI Security repr√§sentiert einen paradigmatischen Wandel von reaktiver Certificate-Administration zu proaktiver Sicherheitsarchitektur-Orchestrierung. Es etabliert PKI als strategisches Sicherheits-Asset, das nicht nur Zertifikate sch√ºtzt, sondern auch als fundamentale Vertrauensgrundlage f√ºr AI-gest√ºtzte Gesch√§ftsmodelle, kritische Infrastrukturen und Zero Trust-Implementierungen fungiert.\n\nüõ°Ô∏è Advanced Threat Protection und Security Intelligence:\n‚Ä¢ PKI Security etabliert intelligente Bedrohungsabwehr-Systeme, die PKI-spezifische Angriffsvektoren wie Certificate Spoofing, CA Compromise und Man-in-the-Middle-Attacken proaktiv erkennen und neutralisieren\n‚Ä¢ Machine Learning-gest√ºtzte Anomaly Detection analysiert Certificate-Nutzungsmuster kontinuierlich und identifiziert verd√§chtige Aktivit√§ten, die auf Kompromittierungen oder Missbrauch hindeuten k√∂nnten\n‚Ä¢ Threat Intelligence-Integration korreliert PKI-Events mit globalen Bedrohungsdatenbanken und erm√∂glicht pr√§ventive Schutzma√ünahmen gegen emerging threats\n‚Ä¢ Behavioral Analytics √ºberwachen Certificate-Lifecycle-Aktivit√§ten und erkennen Abweichungen von normalen Nutzungsmustern automatisch\n‚Ä¢ Advanced Persistent Threat-Erkennung identifiziert langfristige, koordinierte Angriffe gegen PKI-Infrastrukturen durch Korrelation verschiedener Security Events\n\nüîç Real-time Security Monitoring und Incident Response:\n‚Ä¢ Kontinuierliche √úberwachung aller Certificate-Aktivit√§ten mit intelligenter Event-Korrelation und automatischer Priorit√§tsbewertung von Sicherheitsereignissen\n‚Ä¢ Certificate Transparency Log-Monitoring √ºberwacht √∂ffentliche CT-Logs proaktiv auf unerwartete oder nicht autorisierte Zertifikatsausstellungen f√ºr Organisationsdom√§nen\n‚Ä¢ Automated Security Alerting und Escalation-Management gew√§hrleisten schnelle Reaktionen auf kritische PKI-Sicherheitsereignisse ohne manuelle Intervention\n‚Ä¢ Real-time Dashboard und Executive Reporting bieten umfassende Einblicke in PKI-Sicherheitsstatus und erm√∂glichen datengest√ºtzte Entscheidungen\n‚Ä¢ Emergency Response-Automation koordiniert sofortige Ma√ünahmen bei Certificate-Kompromittierungen oder Sicherheitsvorf√§llen\n\nüåê Zero Trust PKI Integration und moderne Sicherheitsarchitekturen:\n‚Ä¢ Zero Trust PKI Architecture-Design implementiert kontinuierliche Certificate-Verifikation und eliminiert implizites Vertrauen in PKI-Komponenten\n‚Ä¢ Adaptive Certificate Policies passen Sicherheitsrichtlinien dynamisch basierend auf Risk Context, Threat Intelligence und aktuellen Bedrohungslagen an\n‚Ä¢ Micro-segmentation mit Certificate-basierter Network Access Control erm√∂glicht granulare Zugriffskontrolle und minimiert Attack Surface\n‚Ä¢ Identity-centric PKI Security verbindet Certificate-Management nahtlos mit modernen Identity-Management-Systemen und erm√∂glicht holistische Sicherheitsstrategien\n‚Ä¢ Dynamic Trust Evaluation bewertet Vertrauensw√ºrdigkeit von Certificates kontinuierlich basierend auf aktuellen Sicherheitskontexten\n\n‚ö° Automated Incident Response und Recovery-Orchestrierung:\n‚Ä¢ Vollautomatisierte Incident Detection und Response-Systeme reagieren sofort auf PKI-Sicherheitsereignisse ohne menschliche Intervention\n‚Ä¢ Emergency Certificate Revocation und Replacement-Automation minimieren Ausfallzeiten und gew√§hrleisten Business Continuity bei Sicherheitsvorf√§llen\n‚Ä¢ Forensic Data Collection sammelt relevante Sicherheitsdaten automatisch f√ºr nachgelagerte Untersuchungen und Compliance-Dokumentation\n‚Ä¢ Business Continuity-Integration stellt sicher, dass PKI-Sicherheitsma√ünahmen Gesch√§ftsprozesse nicht beeintr√§chtigen\n‚Ä¢ Recovery-Orchestrierung koordiniert systematische Wiederherstellung nach Sicherheitsvorf√§llen mit minimalen Business Impact"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie funktioniert Real-time Certificate Security Monitoring und warum ist es gesch√§ftskritisch f√ºr moderne Organisationen?',
        answer: "Real-time Certificate Security Monitoring transformiert passive PKI-√úberwachung in proaktive Sicherheitsintelligenz. Es etabliert kontinuierliche Visibility √ºber alle Certificate-Aktivit√§ten und erm√∂glicht sofortige Reaktionen auf Sicherheitsbedrohungen, bevor sie kritische Gesch√§ftsprozesse beeintr√§chtigen k√∂nnen.\n\nüìä Comprehensive Certificate Activity Monitoring:\n‚Ä¢ Real-time Certificate Activity Monitoring √ºberwacht alle Certificate-Lifecycle-Events kontinuierlich, einschlie√ülich Ausstellung, Erneuerung, Widerruf und Nutzung √ºber alle PKI-Systeme hinweg\n‚Ä¢ Security Event-Korrelation analysiert Certificate-Events im Kontext anderer Sicherheitsereignisse und identifiziert komplexe Angriffsmuster, die isoliert betrachtet unerkannt bleiben w√ºrden\n‚Ä¢ Multi-dimensional Analytics bewerten Certificate-Aktivit√§ten basierend auf Zeit, Ort, Nutzer, Anwendung und Sicherheitskontext f√ºr umfassende Threat Detection\n‚Ä¢ Cross-system Visibility integriert Monitoring √ºber verschiedene Certificate Authorities, PKI-Plattformen und Anwendungen f√ºr einheitliche Sicherheits√ºbersicht\n‚Ä¢ Historical Trend Analysis identifiziert langfristige Muster und Anomalien in Certificate-Nutzung, die auf systematische Sicherheitsrisiken hindeuten k√∂nnten\n\nüîç Advanced Anomaly Detection und Threat Intelligence:\n‚Ä¢ Machine Learning-Algorithmen lernen normale Certificate-Verhaltensmuster und erkennen Abweichungen automatisch, die auf Sicherheitsbedrohungen oder Missbrauch hindeuten\n‚Ä¢ Behavioral Profiling erstellt individuelle Nutzungsprofile f√ºr Certificate-Inhaber und identifiziert ungew√∂hnliche Aktivit√§ten proaktiv\n‚Ä¢ Geolocation-basierte Anomaly Detection erkennt Certificate-Nutzung von unerwarteten Standorten oder verd√§chtigen geografischen Mustern\n‚Ä¢ Time-based Pattern Analysis identifiziert Certificate-Aktivit√§ten au√üerhalb normaler Gesch√§ftszeiten oder in ungew√∂hnlichen Zeitmustern\n‚Ä¢ Threat Intelligence-Integration korreliert Certificate-Events mit aktuellen Bedrohungsinformationen und Indicators of Compromise\n\nüö® Certificate Transparency und Rogue Certificate Detection:\n‚Ä¢ Certificate Transparency Log-√úberwachung monitort √∂ffentliche CT-Logs kontinuierlich auf unerwartete Zertifikatsausstellungen f√ºr Organisationsdom√§nen\n‚Ä¢ Rogue Certificate Detection identifiziert nicht autorisierte oder verd√§chtige Zertifikate proaktiv, bevor sie f√ºr Angriffe verwendet werden k√∂nnen\n‚Ä¢ Brand Protection-Services √ºberwachen Certificate-Ausstellungen f√ºr √§hnliche oder verwechselbare Domainnamen, die f√ºr Phishing oder Brand Impersonation verwendet werden k√∂nnten\n‚Ä¢ Typosquatting Detection erkennt Certificate-Requests f√ºr Domain-Variationen automatisch und warnt vor potenziellen Betrugsm√∂glichkeiten\n‚Ä¢ Certificate Pinning-Violations werden sofort erkannt und eskaliert, um Man-in-the-Middle-Angriffe zu verhindern\n\n‚ö° Automated Security Alerting und Response-Integration:\n‚Ä¢ Intelligent Alerting-Systeme priorisieren Sicherheitsereignisse automatisch basierend auf Schweregrad, Business Impact und aktueller Bedrohungslage\n‚Ä¢ Escalation-Management gew√§hrleistet, dass kritische PKI-Sicherheitsereignisse an entsprechende Teams und Stakeholder weitergeleitet werden\n‚Ä¢ SIEM-Integration korreliert PKI-Security-Events mit anderen Sicherheitsereignissen f√ºr umfassende Threat Detection und Response\n‚Ä¢ Automated Response-Workflows initiieren sofortige Schutzma√ünahmen bei kritischen Sicherheitsereignissen ohne manuelle Intervention\n‚Ä¢ Mobile Alerting und Push-Notifications erm√∂glichen sofortige Benachrichtigung von Security-Teams auch au√üerhalb regul√§rer Arbeitszeiten\n\nüìà Executive Reporting und Security Intelligence:\n‚Ä¢ Real-time Security Dashboard bietet umfassende Einblicke in PKI-Sicherheitsstatus mit interaktiven Visualisierungen und Drill-down-Funktionalit√§ten\n‚Ä¢ Executive Reporting liefert strategische Sicherheitsmetriken und KPIs f√ºr Management-Entscheidungen und Board-Reporting\n‚Ä¢ Compliance Reporting automatisiert Dokumentation f√ºr regulatorische Anforderungen und Audit-Unterst√ºtzung\n‚Ä¢ Trend Analysis und Predictive Analytics identifizieren emerging threats und erm√∂glichen proaktive Sicherheitsma√ünahmen\n‚Ä¢ Risk Scoring quantifiziert PKI-Sicherheitsrisiken und erm√∂glicht datengest√ºtzte Priorisierung von Sicherheitsinvestitionen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Rolle spielt Zero Trust PKI Integration in modernen Sicherheitsarchitekturen und wie gew√§hrleistet es adaptive Sicherheit?',
        answer: "Zero Trust PKI Integration bildet das strategische Fundament f√ºr moderne Sicherheitsarchitekturen, die auf dem Prinzip \"Never Trust, Always Verify\" basieren. Es transformiert traditionelle perimeter-basierte Sicherheitsmodelle in adaptive, context-aware Vertrauensarchitekturen, die kontinuierliche Verifikation und dynamische Sicherheitsentscheidungen erm√∂glichen.\n\nüîê Zero Trust Architecture-Design und kontinuierliche Verifikation:\n‚Ä¢ Zero Trust PKI Architecture eliminiert implizites Vertrauen in Certificate-basierte Authentifizierung und implementiert kontinuierliche Verifikation aller PKI-Komponenten und -Transaktionen\n‚Ä¢ Continuous Certificate Validation √ºberpr√ºft Zertifikatsstatus, Trust Chain-Integrit√§t und Revocation-Status in Echtzeit f√ºr jede Authentifizierungsanfrage\n‚Ä¢ Multi-factor Certificate Authentication kombiniert Certificate-basierte Authentifizierung mit zus√§tzlichen Verifikationsfaktoren f√ºr erh√∂hte Sicherheit\n‚Ä¢ Context-aware Trust Decisions ber√ºcksichtigen Device Health, Location, Time, User Behavior und Threat Intelligence bei Vertrauensentscheidungen\n‚Ä¢ Dynamic Trust Scoring bewertet Vertrauensw√ºrdigkeit von Certificate-Inhabern kontinuierlich basierend auf aktuellen Sicherheitskontexten und Verhaltensmustern\n\nüéØ Adaptive Certificate Policies und Risk-based Security:\n‚Ä¢ Risk-based Certificate Policies passen Sicherheitsanforderungen dynamisch basierend auf aktueller Bedrohungslage, User Context und Resource Sensitivity an\n‚Ä¢ Adaptive Authentication-Flows erh√∂hen Sicherheitsanforderungen automatisch bei erh√∂hten Risikoindikatoren oder verd√§chtigen Aktivit√§ten\n‚Ä¢ Conditional Access-Integration verbindet PKI-basierte Authentifizierung mit modernen Conditional Access-Systemen f√ºr granulare Zugriffskontrolle\n‚Ä¢ Threat Intelligence-driven Policies aktualisieren Certificate-Sicherheitsrichtlinien automatisch basierend auf aktuellen Bedrohungsinformationen\n‚Ä¢ Machine Learning-gest√ºtzte Policy Optimization lernt aus Sicherheitsereignissen und optimiert Policies kontinuierlich f√ºr bessere Security-Performance Balance\n\nüåê Micro-segmentation und Certificate-basierte Network Access Control:\n‚Ä¢ Certificate-basierte Network Segmentation implementiert granulare Netzwerk-Zugriffskontrolle basierend auf Certificate-Attributen und Trust Levels\n‚Ä¢ Software-Defined Perimeter-Integration nutzt Certificates f√ºr dynamische, encrypted Network Tunnels zwischen verifizierten Endpoints\n‚Ä¢ Application-level Micro-segmentation gew√§hrleistet, dass nur authentifizierte und autorisierte Certificate-Inhaber auf spezifische Anwendungen zugreifen k√∂nnen\n‚Ä¢ Device Certificate-basierte IoT Security implementiert Zero Trust-Prinzipien f√ºr Internet of Things-Umgebungen mit automatischer Device Authentication\n‚Ä¢ Service Mesh-Integration nutzt Certificates f√ºr sichere Service-to-Service-Kommunikation in containerisierten und Cloud-native Umgebungen\n\nüîÑ Identity-centric PKI Security und holistische Integration:\n‚Ä¢ Identity-centric Certificate Management verbindet PKI nahtlos mit modernen Identity-Management-Systemen und erm√∂glicht einheitliche Identity Governance\n‚Ä¢ Attribute-based Certificate Policies nutzen Identity-Attribute f√ºr dynamische Certificate-Ausstellung und -Verwaltung basierend auf Rollen und Berechtigungen\n‚Ä¢ Lifecycle-Integration synchronisiert Certificate-Lifecycle mit Identity-Lifecycle f√ºr automatische Certificate-Verwaltung bei Personalwechseln\n‚Ä¢ Single Sign-On-Integration erm√∂glicht nahtlose User Experience bei gleichzeitiger Aufrechterhaltung starker Certificate-basierter Sicherheit\n‚Ä¢ Privileged Access Management-Integration nutzt Certificates f√ºr sichere Verwaltung privilegierter Zugriffe mit erh√∂hten Sicherheitsanforderungen\n\n‚ö° Dynamic Trust Evaluation und Adaptive Response:\n‚Ä¢ Real-time Trust Assessment bewertet Vertrauensw√ºrdigkeit von Certificate-Transaktionen kontinuierlich basierend auf multiplen Sicherheitsfaktoren\n‚Ä¢ Behavioral Trust Scoring analysiert User- und Device-Verhalten kontinuierlich und passt Trust Levels dynamisch an\n‚Ä¢ Threat Context Integration ber√ºcksichtigt aktuelle Bedrohungsinformationen bei Trust-Entscheidungen und erm√∂glicht proaktive Sicherheitsma√ünahmen\n‚Ä¢ Automated Trust Remediation initiiert automatische Schutzma√ünahmen bei reduzierten Trust Levels, wie zus√§tzliche Authentifizierung oder Zugriffsbeschr√§nkungen\n‚Ä¢ Continuous Trust Monitoring √ºberwacht Trust-Status kontinuierlich und erm√∂glicht sofortige Reaktionen auf Vertrauensver√§nderungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie gew√§hrleistet Automated PKI Incident Response schnelle Recovery und minimiert Business Impact bei Sicherheitsvorf√§llen?',
        answer: "Automated PKI Incident Response transformiert reaktive Sicherheitsma√ünahmen in proaktive, intelligente Response-Systeme. Es etabliert vollautomatisierte Workflows, die Sicherheitsvorf√§lle in Sekunden erkennen, bewerten und neutralisieren, w√§hrend gleichzeitig Business Continuity gew√§hrleistet und Recovery-Zeiten minimiert werden.\n\nüö® Intelligent Incident Detection und Classification:\n‚Ä¢ Automated Incident Detection nutzt Machine Learning und Behavioral Analytics zur sofortigen Erkennung von PKI-Sicherheitsvorf√§llen, einschlie√ülich Certificate Compromise, CA Breach und Unauthorized Certificate Usage\n‚Ä¢ Multi-source Event Correlation analysiert Events aus verschiedenen PKI-Systemen, SIEM-Plattformen und Threat Intelligence-Feeds f√ºr umfassende Incident Detection\n‚Ä¢ Severity Classification bewertet Sicherheitsvorf√§lle automatisch basierend auf Business Impact, Threat Level und Affected Systems f√ºr priorisierte Response\n‚Ä¢ False Positive Reduction nutzt Advanced Analytics zur Minimierung von Fehlalarmen und gew√§hrleistet, dass Response-Teams sich auf echte Bedrohungen konzentrieren k√∂nnen\n‚Ä¢ Threat Attribution versucht automatisch, Angreifer und Attack Vectors zu identifizieren f√ºr gezielte Response-Strategien\n\n‚ö° Automated Response-Orchestrierung und Containment:\n‚Ä¢ Immediate Threat Containment isoliert kompromittierte PKI-Komponenten automatisch, um Lateral Movement und weitere Sch√§den zu verhindern\n‚Ä¢ Emergency Certificate Revocation widerruft kompromittierte Zertifikate sofort √ºber alle relevanten Certificate Authorities und Distribution Points\n‚Ä¢ Automated Certificate Replacement generiert und deployed Replacement-Certificates automatisch f√ºr kritische Services ohne manuelle Intervention\n‚Ä¢ Network Isolation implementiert automatische Netzwerk-Segmentierung um betroffene Systeme, w√§hrend gleichzeitig kritische Business Functions aufrechterhalten werden\n‚Ä¢ Service Continuity-Ma√ünahmen aktivieren Backup-Systeme und Failover-Mechanismen automatisch zur Minimierung von Service-Unterbrechungen\n\nüîß Intelligent Recovery-Orchestrierung und System Restoration:\n‚Ä¢ Automated Recovery Workflows orchestrieren systematische Wiederherstellung von PKI-Services basierend auf vordefinierte Recovery-Priorit√§ten und Dependencies\n‚Ä¢ Configuration Restoration stellt PKI-System-Konfigurationen aus sicheren Backups wieder her und gew√§hrleistet Konsistenz √ºber alle Komponenten\n‚Ä¢ Certificate Redeployment automatisiert die Verteilung neuer Zertifikate an alle betroffenen Systeme und Anwendungen\n‚Ä¢ Trust Chain Reconstruction rebuildet kompromittierte Trust Chains und gew√§hrleistet Integrit√§t der gesamten PKI-Hierarchie\n‚Ä¢ Service Validation f√ºhrt automatische Tests durch, um sicherzustellen, dass alle PKI-Services nach Recovery ordnungsgem√§√ü funktionieren\n\nüìä Forensic Data Collection und Evidence Preservation:\n‚Ä¢ Automated Evidence Collection sammelt relevante Forensic Data automatisch w√§hrend Incident Response ohne Beeintr√§chtigung der Recovery-Aktivit√§ten\n‚Ä¢ Chain of Custody-Management gew√§hrleistet rechtlich verwertbare Dokumentation aller gesammelten Beweise f√ºr potenzielle rechtliche Verfahren\n‚Ä¢ Timeline Reconstruction erstellt detaillierte Incident Timelines automatisch basierend auf Log-Daten und System-Events\n‚Ä¢ Impact Assessment quantifiziert Business Impact und Sch√§den automatisch f√ºr Insurance Claims und Management Reporting\n‚Ä¢ Lessons Learned-Dokumentation erfasst Incident Details automatisch f√ºr kontinuierliche Verbesserung von Response-Prozessen\n\nüîÑ Business Continuity Integration und Stakeholder Communication:\n‚Ä¢ Business Impact Minimization priorisiert Recovery-Aktivit√§ten basierend auf Business Criticality und minimiert Auswirkungen auf kritische Gesch√§ftsprozesse\n‚Ä¢ Stakeholder Notification informiert relevante Teams, Management und externe Partner automatisch √ºber Incident Status und Recovery Progress\n‚Ä¢ Compliance Reporting generiert automatische Berichte f√ºr regulatorische Anforderungen und Audit-Dokumentation\n‚Ä¢ Customer Communication-Templates erm√∂glichen schnelle, konsistente Kommunikation mit Kunden √ºber Service-Auswirkungen\n‚Ä¢ Post-Incident Analysis f√ºhrt automatische Analysen durch zur Identifizierung von Verbesserungsm√∂glichkeiten und Prevention-Strategien"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
