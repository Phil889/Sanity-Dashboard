import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA Dokumentationsanforderungen page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-dokumentationsanforderungen' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-dokumentationsanforderungen" not found')
    }
    
    // Create new FAQs for DORA documentation fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Welche spezifischen Dokumentationsanforderungen stellt DORA an Finanzunternehmen?',
        answer: "DORA etabliert umfassende und detaillierte Dokumentationsanforderungen, die weit √ºber traditionelle IT-Dokumentation hinausgehen und eine vollst√§ndige Nachverfolgbarkeit aller Aspekte der digitalen operationellen Resilienz gew√§hrleisten. Diese Anforderungen sind darauf ausgelegt, Aufsichtsbeh√∂rden eine transparente Bewertung der IKT-Risikomanagement-Praktiken zu erm√∂glichen und gleichzeitig Unternehmen bei der kontinuierlichen Verbesserung ihrer Resilienz zu unterst√ºtzen.\n\nüìã IKT-Risikomanagement-Dokumentation:\n‚Ä¢ Vollst√§ndige Dokumentation der IKT-Risikomanagement-Strategie, einschlie√ülich Zielsetzungen, Scope, Governance-Strukturen und Verantwortlichkeiten\n‚Ä¢ Detaillierte Risiko-Register mit Identifikation, Bewertung und Kategorisierung aller IKT-Risiken sowie deren potenzielle Auswirkungen auf Gesch√§ftst√§tigkeiten\n‚Ä¢ Umfassende Dokumentation von Risikobewertungsmethodiken, Bewertungskriterien und Risikotoleranz-Definitionen\n‚Ä¢ Nachweis regelm√§√üiger Risikobewertungen und deren Ergebnisse, einschlie√ülich Trend-Analysen und Vergleichsstudien\n‚Ä¢ Dokumentation aller Risikominderungsma√ünahmen, deren Implementierungsstatus und Effektivit√§tsbewertungen\n\nüîß IKT-Systeme und Infrastruktur-Dokumentation:\n‚Ä¢ Vollst√§ndige Inventarisierung aller IKT-Systeme, einschlie√ülich Hardware, Software, Netzwerkkomponenten und Cloud-Services\n‚Ä¢ Detaillierte Systemarchitektur-Diagramme und Datenfluss-Dokumentation f√ºr kritische Gesch√§ftsprozesse\n‚Ä¢ Dokumentation von System-Interdependenzen, kritischen Pfaden und Single Points of Failure\n‚Ä¢ Umfassende Konfigurationsdokumentation und Change-Management-Protokolle\n‚Ä¢ Sicherheitskonfigurationen, Zugriffskontrollen und Berechtigungsmatrizen f√ºr alle kritischen Systeme\n\nüìä Incident-Management und Response-Dokumentation:\n‚Ä¢ Standardisierte Incident-Klassifikation und Eskalationsprozeduren mit klaren Verantwortlichkeiten und Zeitvorgaben\n‚Ä¢ Vollst√§ndige Dokumentation aller IKT-Incidents, einschlie√ülich Ursachenanalyse, Auswirkungsbewertung und Lessons Learned\n‚Ä¢ Business Continuity und Disaster Recovery Pl√§ne mit regelm√§√üigen Test-Protokollen und Verbesserungsma√ünahmen\n‚Ä¢ Kommunikationspl√§ne f√ºr verschiedene Incident-Szenarien, einschlie√ülich interner und externer Stakeholder-Kommunikation\n‚Ä¢ Dokumentation von Recovery-Zeiten, Service-Level-Agreements und Performance-Metriken w√§hrend St√∂rungen\n\nü§ù Drittanbieter-Management-Dokumentation:\n‚Ä¢ Vollst√§ndige Register aller IKT-Drittanbieter mit Kritikalit√§tsbewertung und Risikokategorisierung\n‚Ä¢ Due-Diligence-Dokumentation f√ºr alle kritischen IKT-Drittanbieter, einschlie√ülich Sicherheitsbewertungen und Compliance-Nachweise\n‚Ä¢ Vertragsdokumentation mit spezifischen SLAs, Sicherheitsanforderungen und Ausstiegsklauseln\n‚Ä¢ Kontinuierliche Monitoring-Berichte und Performance-Bewertungen f√ºr kritische Drittanbieter-Beziehungen\n‚Ä¢ Dokumentation von Konzentrationsrisiken und Diversifikationsstrategien im Drittanbieter-Portfolio"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie strukturiere ich ein DORA-konformes Dokumentationsmanagementsystem?',
        answer: "Ein DORA-konformes Dokumentationsmanagementsystem erfordert eine systematische und strukturierte Herangehensweise, die sowohl regulatorische Anforderungen erf√ºllt als auch operative Effizienz gew√§hrleistet. Das System muss skalierbar, benutzerfreundlich und auditierbar sein, w√§hrend es gleichzeitig die kontinuierliche Pflege und Aktualisierung der Dokumentation unterst√ºtzt.\n\nüèóÔ∏è Dokumentationsarchitektur und Strukturierung:\n‚Ä¢ Entwicklung einer hierarchischen Dokumentationsstruktur mit klaren Kategorien f√ºr verschiedene DORA-Anforderungsbereiche\n‚Ä¢ Implementierung einheitlicher Namenskonventionen und Versionskontrollsysteme f√ºr alle Dokumente\n‚Ä¢ Etablierung von Dokumententyp-spezifischen Templates und Standardformaten zur Gew√§hrleistung von Konsistenz\n‚Ä¢ Aufbau einer logischen Ordnerstruktur mit klaren Zugriffsberechtigungen basierend auf Rollen und Verantwortlichkeiten\n‚Ä¢ Integration von Metadaten-Management f√ºr erweiterte Suchfunktionen und automatisierte Kategorisierung\n\nüìö Dokumentenklassifikation und Taxonomie:\n‚Ä¢ Entwicklung einer umfassenden Dokumententaxonomie, die alle DORA-relevanten Bereiche abdeckt\n‚Ä¢ Implementierung von Klassifikationssystemen f√ºr Vertraulichkeit, Kritikalit√§t und regulatorische Relevanz\n‚Ä¢ Etablierung klarer Dokumentenlebenszyklus-Definitionen mit Erstellungs-, Review-, Genehmigungs- und Archivierungsphasen\n‚Ä¢ Aufbau von Verkn√ºpfungssystemen zwischen verwandten Dokumenten und Referenzmaterialien\n‚Ä¢ Integration von Compliance-Mapping zur direkten Verkn√ºpfung von Dokumenten mit spezifischen DORA-Anforderungen\n\nüîÑ Workflow-Management und Automatisierung:\n‚Ä¢ Implementierung automatisierter Workflows f√ºr Dokumentenerstellung, Review und Genehmigungsprozesse\n‚Ä¢ Etablierung von Benachrichtigungssystemen f√ºr anstehende Reviews, Aktualisierungen und Compliance-Deadlines\n‚Ä¢ Aufbau von Eskalationsmechanismen f√ºr √ºberf√§llige Dokumentenaktualisierungen oder fehlende Genehmigungen\n‚Ä¢ Integration von elektronischen Signaturen und Genehmigungsverfahren f√ºr kritische Dokumente\n‚Ä¢ Entwicklung von Dashboard-Systemen f√ºr Echtzeit-√úbersicht √ºber Dokumentenstatus und Compliance-Metriken\n\nüîç Qualit√§tssicherung und Compliance-Monitoring:\n‚Ä¢ Implementierung regelm√§√üiger Dokumentenaudits und Qualit√§tspr√ºfungen durch spezialisierte Teams\n‚Ä¢ Etablierung von Peer-Review-Prozessen f√ºr kritische Dokumente und regulatorische Berichte\n‚Ä¢ Aufbau von Compliance-Checklisten und Validierungsverfahren f√ºr verschiedene Dokumententypen\n‚Ä¢ Integration von automatisierten Compliance-Checks und Vollst√§ndigkeitspr√ºfungen\n‚Ä¢ Entwicklung von Metriken und KPIs zur kontinuierlichen √úberwachung der Dokumentationsqualit√§t\n\nüõ°Ô∏è Sicherheit und Zugriffskontrolle:\n‚Ä¢ Implementierung robuster Zugriffskontrollen basierend auf dem Prinzip der minimalen Berechtigung\n‚Ä¢ Etablierung von Audit-Trails f√ºr alle Dokumentenzugriffe, √Ñnderungen und Downloads\n‚Ä¢ Aufbau von Backup- und Recovery-Systemen f√ºr kritische Dokumentation\n‚Ä¢ Integration von Verschl√ºsselungstechnologien f√ºr sensible Dokumente und Daten√ºbertragung\n‚Ä¢ Entwicklung von Incident-Response-Verfahren f√ºr Dokumentensicherheitsverletzungen oder Datenverluste"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Audit-Trails und Nachweise ben√∂tige ich f√ºr DORA-Compliance?',
        answer: "DORA-konforme Audit-Trails und Nachweise sind essentiell f√ºr die Demonstration kontinuierlicher Compliance und erm√∂glichen Aufsichtsbeh√∂rden eine umfassende Bewertung der digitalen operationellen Resilienz. Diese Nachweise m√ºssen l√ºckenlos, nachvollziehbar und zeitnah verf√ºgbar sein, um sowohl regulatorische Anforderungen als auch interne Governance-Bed√ºrfnisse zu erf√ºllen.\n\nüìù Governance und Entscheidungsdokumentation:\n‚Ä¢ Vollst√§ndige Protokolle aller Board- und Committee-Entscheidungen bez√ºglich IKT-Risikomanagement und digitaler Resilienz\n‚Ä¢ Dokumentation von Strategieentwicklungsprozessen, einschlie√ülich Stakeholder-Konsultationen und Entscheidungsbegr√ºndungen\n‚Ä¢ Nachweis regelm√§√üiger Management-Reviews und deren Ergebnisse, einschlie√ülich Handlungsempfehlungen und Follow-up-Ma√ünahmen\n‚Ä¢ Audit-Trails f√ºr Policy-Entwicklung und -Aktualisierung, einschlie√ülich Genehmigungsverfahren und Kommunikationsprozesse\n‚Ä¢ Dokumentation von Ressourcenallokations-Entscheidungen und deren Begr√ºndung f√ºr IKT-Risikomanagement-Initiativen\n\nüîç Risikomanagement-Aktivit√§ten und -Bewertungen:\n‚Ä¢ Zeitgestempelte Dokumentation aller Risikoidentifikations- und -bewertungsaktivit√§ten mit verwendeten Methodiken\n‚Ä¢ Nachweis regelm√§√üiger Risikobewertungs-Updates und deren Ausl√∂ser, einschlie√ülich Umweltver√§nderungen oder Incident-Learnings\n‚Ä¢ Vollst√§ndige Audit-Trails f√ºr Risikominderungsma√ünahmen, von der Planung √ºber die Implementierung bis zur Effektivit√§tsbewertung\n‚Ä¢ Dokumentation von Risikotoleranz-Entscheidungen und deren regelm√§√üige √úberpr√ºfung durch das Management\n‚Ä¢ Nachweis der Integration von Risikomanagement-Erkenntnissen in Gesch√§ftsentscheidungen und strategische Planung\n\nüö® Incident-Management und Response-Nachweise:\n‚Ä¢ Chronologische Dokumentation aller IKT-Incidents mit pr√§zisen Zeitstempeln und Verantwortlichkeitszuweisungen\n‚Ä¢ Vollst√§ndige Audit-Trails f√ºr Incident-Response-Aktivit√§ten, einschlie√ülich Eskalationsentscheidungen und Kommunikationsma√ünahmen\n‚Ä¢ Nachweis der Effektivit√§t von Business Continuity Ma√ünahmen w√§hrend tats√§chlicher St√∂rungen\n‚Ä¢ Dokumentation von Post-Incident-Reviews und deren Umsetzung in Verbesserungsma√ünahmen\n‚Ä¢ Audit-Trails f√ºr regulatorische Meldungen und Kommunikation mit Aufsichtsbeh√∂rden w√§hrend kritischer Incidents\n\nü§ù Drittanbieter-Management und Oversight-Nachweise:\n‚Ä¢ Vollst√§ndige Dokumentation aller Due-Diligence-Aktivit√§ten f√ºr kritische IKT-Drittanbieter\n‚Ä¢ Audit-Trails f√ºr Vertragsverhandlungen, SLA-Definitionen und Sicherheitsanforderungen\n‚Ä¢ Nachweis kontinuierlicher Monitoring-Aktivit√§ten und Performance-Bewertungen f√ºr kritische Drittanbieter\n‚Ä¢ Dokumentation von Drittanbieter-Incident-Management und deren Auswirkungen auf eigene Gesch√§ftst√§tigkeiten\n‚Ä¢ Audit-Trails f√ºr Ausstiegsplanungen und deren regelm√§√üige Tests und Aktualisierungen\n\nüîß System- und Technologie-Management-Nachweise:\n‚Ä¢ Vollst√§ndige Change-Management-Protokolle f√ºr alle kritischen IKT-Systeme und -Infrastrukturen\n‚Ä¢ Audit-Trails f√ºr Sicherheitskonfigurationen, Patch-Management und Vulnerability-Management-Aktivit√§ten\n‚Ä¢ Nachweis regelm√§√üiger System-Assessments, Penetrationstests und Sicherheits√ºberpr√ºfungen\n‚Ä¢ Dokumentation von Backup- und Recovery-Tests mit Ergebnissen und Verbesserungsma√ünahmen\n‚Ä¢ Audit-Trails f√ºr Zugriffsverwaltung, einschlie√ülich Benutzerberechtigungen und regelm√§√üige Access-Reviews"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie gew√§hrleiste ich die kontinuierliche Aktualit√§t und Qualit√§t meiner DORA-Dokumentation?',
        answer: "Die kontinuierliche Aktualit√§t und Qualit√§t der DORA-Dokumentation ist entscheidend f√ºr nachhaltige Compliance und erfordert systematische Prozesse, die sowohl proaktive Pflege als auch reaktive Anpassungen an sich √§ndernde Umst√§nde erm√∂glichen. Effektive Dokumentationspflege geht √ºber reine Aktualisierung hinaus und umfasst kontinuierliche Verbesserung, Qualit√§tssicherung und Stakeholder-Engagement.\n\nüìÖ Systematische Review- und Update-Zyklen:\n‚Ä¢ Etablierung regelm√§√üiger, risikobasierter Review-Zyklen f√ºr verschiedene Dokumentenkategorien basierend auf deren Kritikalit√§t und √Ñnderungsfrequenz\n‚Ä¢ Implementierung von Event-getriggerten Update-Prozessen f√ºr Dokumente, die von spezifischen Gesch√§fts- oder Technologie√§nderungen betroffen sind\n‚Ä¢ Aufbau von Kalendersystemen mit automatisierten Erinnerungen f√ºr anstehende Reviews und Aktualisierungsdeadlines\n‚Ä¢ Entwicklung von Eskalationsmechanismen f√ºr √ºberf√§llige Dokumentenaktualisierungen mit klaren Verantwortlichkeiten\n‚Ä¢ Integration von Review-Ergebnissen in kontinuierliche Verbesserungsprozesse und Lessons-Learned-Systeme\n\nüéØ Qualit√§tssicherung und Validierung:\n‚Ä¢ Implementierung mehrstufiger Qualit√§tspr√ºfungen mit fachlichen, sprachlichen und Compliance-spezifischen Validierungen\n‚Ä¢ Etablierung von Peer-Review-Prozessen mit rotierenden Reviewer-Teams zur Gew√§hrleistung objektiver Bewertungen\n‚Ä¢ Aufbau von Checklisten und Qualit√§tskriterien f√ºr verschiedene Dokumententypen und deren konsistente Anwendung\n‚Ä¢ Integration von automatisierten Qualit√§tspr√ºfungen f√ºr Formatierung, Vollst√§ndigkeit und Konsistenz\n‚Ä¢ Entwicklung von Feedback-Mechanismen f√ºr Dokumentennutzer zur kontinuierlichen Verbesserung der Benutzerfreundlichkeit\n\nüîÑ Change-Management und Versionskontrolle:\n‚Ä¢ Implementierung robuster Versionskontrollsysteme mit klarer Nachverfolgung aller √Ñnderungen und deren Begr√ºndungen\n‚Ä¢ Etablierung von Change-Advisory-Boards f√ºr kritische Dokumenten√§nderungen mit Impact-Assessment und Genehmigungsverfahren\n‚Ä¢ Aufbau von Rollback-Mechanismen f√ºr den Fall problematischer Dokumenten√§nderungen\n‚Ä¢ Integration von Change-Kommunikationsprozessen zur zeitnahen Information aller betroffenen Stakeholder\n‚Ä¢ Entwicklung von Change-Impact-Analysen zur Identifikation von Auswirkungen auf verwandte Dokumente und Prozesse\n\nüìä Performance-Monitoring und Metriken:\n‚Ä¢ Entwicklung von KPIs f√ºr Dokumentationsqualit√§t, einschlie√ülich Aktualit√§t, Vollst√§ndigkeit und Benutzerfreundlichkeit\n‚Ä¢ Implementierung von Dashboard-Systemen f√ºr Echtzeit-√úbersicht √ºber Dokumentationsstatus und Compliance-Metriken\n‚Ä¢ Etablierung regelm√§√üiger Dokumentations-Audits mit externen oder internen Audit-Teams\n‚Ä¢ Aufbau von Benchmarking-Prozessen zur Bewertung der Dokumentationsqualit√§t im Vergleich zu Best Practices\n‚Ä¢ Integration von Stakeholder-Feedback und Nutzungsstatistiken in kontinuierliche Verbesserungsprozesse\n\nü§ù Stakeholder-Engagement und Training:\n‚Ä¢ Entwicklung umfassender Schulungsprogramme f√ºr alle Dokumentenverantwortlichen und -nutzer\n‚Ä¢ Etablierung von Communities of Practice f√ºr Erfahrungsaustausch und Best-Practice-Sharing\n‚Ä¢ Implementierung von Feedback-Kan√§len f√ºr kontinuierliche Verbesserungsvorschl√§ge von Dokumentennutzern\n‚Ä¢ Aufbau von Mentoring-Programmen f√ºr neue Dokumentenverantwortliche\n‚Ä¢ Integration von Dokumentationsqualit√§t in Performance-Management und Incentive-Systeme"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
