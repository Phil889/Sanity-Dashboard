import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Training page with FAQ batch 5...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-training' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-training" not found')
    }
    
    // Create new FAQs for ROI and business value
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 17),
        question: 'How does ADVISORI help organizations calculate and demonstrate the return on investment for ISO 27001 training programs?',
        answer: "ADVISORI provides comprehensive ROI analysis frameworks that enable organizations to quantify both the direct and indirect benefits of ISO 27001 training investments. Our systematic approach helps organizations build compelling business cases and demonstrate measurable value to stakeholders and decision-makers.\n\nüí∞ Comprehensive Cost-Benefit Analysis Framework:\n‚Ä¢ Detailed methodology for calculating total training investment including direct costs, opportunity costs, and resource allocation\n‚Ä¢ Quantification of tangible benefits such as reduced security incidents, faster certification processes, and improved audit outcomes\n‚Ä¢ Assessment of intangible benefits including enhanced organizational reputation, improved employee confidence, and competitive advantages\n‚Ä¢ Risk reduction valuation that translates improved security posture into financial terms and potential cost avoidance\n‚Ä¢ Benchmarking against industry standards and peer organizations to validate ROI calculations and assumptions\n\nüìä Measurable Performance Indicators:\n‚Ä¢ Development of key performance indicators that directly link training outcomes to business objectives and organizational performance\n‚Ä¢ Tracking of certification success rates and time-to-certification improvements following training implementation\n‚Ä¢ Measurement of security incident reduction rates and associated cost savings from improved security awareness and competency\n‚Ä¢ Assessment of employee retention and career advancement rates for trained personnel\n‚Ä¢ Evaluation of customer satisfaction and business development opportunities resulting from enhanced security credentials\n\nüéØ Strategic Business Value Assessment:\n‚Ä¢ Analysis of competitive advantages gained through enhanced information security capabilities and market positioning\n‚Ä¢ Evaluation of new business opportunities and market access enabled by ISO 27001 certification and demonstrated competency\n‚Ä¢ Assessment of regulatory compliance cost reductions and efficiency improvements in audit and assessment processes\n‚Ä¢ Quantification of supply chain and partnership benefits resulting from enhanced security credibility\n‚Ä¢ Measurement of operational efficiency improvements and process optimization achieved through training implementation\n\nüìà Long-Term Value Tracking:\n‚Ä¢ Longitudinal studies that track ROI development over multiple years to demonstrate sustained value creation\n‚Ä¢ Career progression tracking for trained employees and associated value to organizational capability development\n‚Ä¢ Customer retention and acquisition metrics related to enhanced security positioning and credibility\n‚Ä¢ Innovation and improvement initiatives driven by enhanced security knowledge and competency\n‚Ä¢ Organizational resilience improvements and associated business continuity value\n\nüîç Risk Mitigation Valuation:\n‚Ä¢ Quantitative risk assessment methodologies that translate security improvements into financial risk reduction\n‚Ä¢ Calculation of potential cost avoidance from prevented security incidents and data breaches\n‚Ä¢ Assessment of regulatory compliance risk reduction and associated cost savings\n‚Ä¢ Evaluation of reputation protection value and brand risk mitigation\n‚Ä¢ Analysis of business continuity improvements and associated operational risk reduction\n\nüìã Executive Reporting and Communication:\n‚Ä¢ Development of executive dashboards and reporting frameworks that communicate ROI in business terms\n‚Ä¢ Creation of compelling business case presentations that align training benefits with organizational strategic objectives\n‚Ä¢ Regular ROI updates and progress reports that demonstrate ongoing value creation and justify continued investment\n‚Ä¢ Benchmarking reports that position organizational training investment against industry best practices\n‚Ä¢ Success story development and case study creation that highlight specific ROI achievements and lessons learned"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 18),
        question: 'What role does ADVISORI play in helping organizations develop internal training capabilities and knowledge transfer programs?',
        answer: "ADVISORI is committed to building sustainable internal training capabilities that enable organizations to maintain and expand their ISO 27001 competencies independently. Our knowledge transfer approach ensures that organizations develop the expertise and resources needed for long-term success and continuous improvement.\n\nüéì Train-the-Trainer Program Development:\n‚Ä¢ Comprehensive instructor development programs that prepare internal staff to deliver high-quality ISO 27001 training\n‚Ä¢ Curriculum design and content development support that enables organizations to create customized training materials\n‚Ä¢ Teaching methodology training that equips internal trainers with adult learning principles and effective delivery techniques\n‚Ä¢ Assessment and evaluation training that ensures internal trainers can effectively measure learning outcomes and competency development\n‚Ä¢ Ongoing coaching and mentoring support for internal trainers as they develop their skills and confidence\n\nüìö Knowledge Management System Implementation:\n‚Ä¢ Development of comprehensive knowledge repositories that capture and organize ISO 27001 expertise and best practices\n‚Ä¢ Creation of training libraries including presentations, exercises, case studies, and assessment materials\n‚Ä¢ Implementation of knowledge sharing platforms that facilitate collaboration and continuous learning among internal staff\n‚Ä¢ Documentation of organizational lessons learned and implementation experiences for future reference\n‚Ä¢ Integration with existing learning management systems and corporate training infrastructure\n\nüîÑ Continuous Improvement Framework:\n‚Ä¢ Establishment of feedback mechanisms and quality assurance processes for internal training programs\n‚Ä¢ Regular review and update procedures that ensure training content remains current and relevant\n‚Ä¢ Performance measurement systems that track the effectiveness of internal training delivery\n‚Ä¢ Benchmarking processes that compare internal training outcomes with external standards and best practices\n‚Ä¢ Innovation and development programs that encourage continuous enhancement of training capabilities\n\nü§ù Mentoring and Coaching Support:\n‚Ä¢ Pairing of internal staff with experienced ADVISORI consultants for ongoing guidance and support\n‚Ä¢ Regular consultation sessions that address specific challenges and implementation questions\n‚Ä¢ Expert review and feedback on internal training materials and delivery approaches\n‚Ä¢ Access to ADVISORI expertise for complex technical questions and emerging industry developments\n‚Ä¢ Professional development planning that supports career growth for internal training staff\n\nüåê Community of Practice Development:\n‚Ä¢ Creation of internal communities of practice that foster knowledge sharing and collaborative learning\n‚Ä¢ Facilitation of regular meetings and workshops that bring together internal experts and practitioners\n‚Ä¢ Development of peer learning networks that enable cross-functional knowledge transfer\n‚Ä¢ Integration with external professional communities and industry networks for broader perspective\n‚Ä¢ Recognition and reward programs that encourage participation in knowledge sharing activities\n\nüìä Capability Maturity Assessment:\n‚Ä¢ Regular assessment of internal training capabilities and identification of development opportunities\n‚Ä¢ Gap analysis that compares current capabilities with organizational needs and industry standards\n‚Ä¢ Development roadmaps that outline steps for enhancing internal training competencies\n‚Ä¢ Resource planning and investment guidance for building sustainable training capabilities\n‚Ä¢ Success metrics and milestones that track progress toward training independence and excellence"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 19),
        question: 'How does ADVISORI address emerging trends and future developments in information security training and ISO 27001 evolution?',
        answer: "ADVISORI maintains a forward-looking perspective that anticipates and prepares for emerging trends in information security and evolving ISO 27001 requirements. Our proactive approach ensures that training programs remain relevant and valuable as the cybersecurity landscape continues to evolve rapidly.\n\nüîÆ Future-Focused Curriculum Development:\n‚Ä¢ Continuous monitoring of emerging cybersecurity threats, technologies, and regulatory developments that impact ISO 27001 implementation\n‚Ä¢ Integration of artificial intelligence, machine learning, and automation considerations into information security management training\n‚Ä¢ Preparation for quantum computing implications and post-quantum cryptography requirements in security frameworks\n‚Ä¢ Incorporation of Internet of Things, edge computing, and distributed system security challenges into training content\n‚Ä¢ Development of training modules addressing emerging regulatory frameworks and international standards evolution\n\nüåê Digital Transformation Integration:\n‚Ä¢ Training programs that address the intersection of digital transformation initiatives with information security management\n‚Ä¢ Cloud-first and cloud-native security approaches within ISO 27001 frameworks\n‚Ä¢ DevSecOps and continuous security integration methodologies for modern development environments\n‚Ä¢ Zero-trust architecture principles and implementation within traditional ISMS frameworks\n‚Ä¢ Remote work and distributed workforce security considerations in post-pandemic organizational models\n\nü§ñ Technology-Enhanced Learning Innovation:\n‚Ä¢ Virtual and augmented reality training experiences that provide immersive learning environments for complex security scenarios\n‚Ä¢ Artificial intelligence-powered personalized learning systems that adapt to individual learning styles and progress\n‚Ä¢ Gamification and simulation technologies that enhance engagement and practical skill development\n‚Ä¢ Blockchain-based credentialing and verification systems for training completion and competency validation\n‚Ä¢ Advanced analytics and machine learning for training effectiveness optimization and predictive learning outcomes\n\nüìä Industry Evolution Anticipation:\n‚Ä¢ Research and development partnerships with academic institutions and technology companies to stay ahead of industry trends\n‚Ä¢ Participation in standards development organizations and regulatory working groups to influence and anticipate changes\n‚Ä¢ Collaboration with cybersecurity vendors and technology providers to understand emerging solution capabilities\n‚Ä¢ Regular horizon scanning and trend analysis to identify potential disruptions and opportunities\n‚Ä¢ Pilot programs and experimental training approaches that test new methodologies and technologies\n\nüîÑ Adaptive Training Methodologies:\n‚Ä¢ Flexible training frameworks that can quickly incorporate new requirements and emerging best practices\n‚Ä¢ Modular content design that enables rapid updates and customization for specific industry developments\n‚Ä¢ Continuous feedback loops that capture learner needs and market demands for training evolution\n‚Ä¢ Agile development processes that enable rapid response to changing training requirements\n‚Ä¢ Cross-industry learning and knowledge transfer that brings insights from other sectors and disciplines\n\nüéØ Strategic Partnership Development:\n‚Ä¢ Collaboration with leading cybersecurity research institutions and think tanks for cutting-edge insights\n‚Ä¢ Partnerships with technology vendors and solution providers for hands-on experience with emerging tools\n‚Ä¢ Engagement with regulatory bodies and standards organizations to understand future compliance requirements\n‚Ä¢ International cooperation with global training providers and certification bodies for knowledge sharing\n‚Ä¢ Industry consortium participation that enables collective learning and best practice development"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 20),
        question: 'What comprehensive support ecosystem does ADVISORI provide to ensure long-term training success and organizational capability development?',
        answer: "ADVISORI has developed a comprehensive support ecosystem that extends far beyond traditional training delivery to provide ongoing guidance, resources, and community engagement that ensures sustainable success and continuous capability development for our clients and their personnel.\n\nüåü Holistic Success Partnership:\n‚Ä¢ Dedicated client success managers who provide personalized guidance and support throughout the entire training journey and beyond\n‚Ä¢ Comprehensive onboarding processes that ensure optimal training program setup and participant preparation\n‚Ä¢ Regular check-ins and progress reviews that identify opportunities for optimization and additional support\n‚Ä¢ Customized success metrics and milestone tracking that align with organizational objectives and individual career goals\n‚Ä¢ Proactive identification and resolution of potential challenges before they impact training outcomes\n\nüìö Extensive Resource Library and Knowledge Base:\n‚Ä¢ Comprehensive digital library containing implementation guides, templates, checklists, and best practice documentation\n‚Ä¢ Regular updates and additions to resource collections based on emerging trends and client feedback\n‚Ä¢ Searchable knowledge base with answers to frequently asked questions and common implementation challenges\n‚Ä¢ Video tutorials and recorded sessions that provide on-demand access to expert guidance and instruction\n‚Ä¢ Mobile-accessible resources that enable learning and reference access from any location at any time\n\nü§ù Vibrant Professional Community:\n‚Ä¢ Active alumni network that connects current and former participants for ongoing knowledge sharing and networking\n‚Ä¢ Regular virtual and in-person events including webinars, workshops, and professional development sessions\n‚Ä¢ Online discussion forums and collaboration platforms that facilitate peer-to-peer learning and problem-solving\n‚Ä¢ Mentorship programs that pair experienced professionals with those developing their careers in information security\n‚Ä¢ Industry-specific user groups that address unique challenges and opportunities in different sectors\n\nüîÑ Continuous Learning and Development:\n‚Ä¢ Ongoing professional development opportunities including advanced workshops, masterclasses, and specialized training\n‚Ä¢ Regular updates and refresher sessions that address changes in standards, regulations, and best practices\n‚Ä¢ Access to emerging technology training and hands-on experience with new tools and methodologies\n‚Ä¢ Career development guidance and planning support for professionals seeking advancement in information security\n‚Ä¢ Continuing education credits and certification maintenance support for professional credentials\n\nüí° Innovation and Thought Leadership:\n‚Ä¢ Research and development initiatives that explore new approaches to information security management and training\n‚Ä¢ Thought leadership content including whitepapers, case studies, and industry analysis\n‚Ä¢ Speaking opportunities and conference participation for participants who demonstrate exceptional expertise\n‚Ä¢ Contribution opportunities to industry publications and professional development content\n‚Ä¢ Innovation labs and pilot programs that test new training methodologies and technologies\n\nüåç Global Reach and Local Support:\n‚Ä¢ International network of trainers and consultants who provide local expertise and cultural understanding\n‚Ä¢ Multi-language support and localized content that addresses regional requirements and preferences\n‚Ä¢ Time zone-appropriate support and consultation availability for global organizations\n‚Ä¢ Local partnership networks that extend support capabilities and provide regional expertise\n‚Ä¢ Cultural adaptation services that ensure training effectiveness across diverse organizational contexts"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 5 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
