import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating BCBS-239 Data Governance Rollen page with FAQs batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'bcbs-239-data-governance-rollen' })
    
    if (!existingDoc) {
      throw new Error('Document "bcbs-239-data-governance-rollen" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: "Welche Schnittstellen m√ºssen zwischen den Data Governance Rollen und anderen Compliance-Funktionen im BCBS-239 Kontext gestaltet werden?",
        answer: "Eine erfolgreiche BCBS-239 Implementierung erfordert effektive Schnittstellen zwischen Data Governance Rollen und anderen Compliance- und Kontrollfunktionen im Finanzinstitut. Die Harmonisierung dieser Schnittstellen ist entscheidend, um Doppelarbeiten zu vermeiden, Synergien zu nutzen und konsistente Standards zu gew√§hrleisten.\n\nüîÑ Kritische Schnittstellen f√ºr effektive BCBS-239 Governance:\n‚Ä¢ Schnittstelle zum Risikomanagement: Data Governance Rollen m√ºssen eng mit dem Risikomanagement zusammenarbeiten, um sicherzustellen, dass Risikodaten den Qualit√§tsanforderungen f√ºr fundierte Risikoentscheidungen entsprechen und Risikometriken korrekt aggregiert werden.\n‚Ä¢ Schnittstelle zur Compliance-Funktion: Koordination mit der allgemeinen Compliance-Funktion zur Integration der BCBS-239 Anforderungen in das √ºbergreifende Compliance-Management-System und zur Abstimmung von Kontrollen und Monitoring-Prozessen.\n‚Ä¢ Schnittstelle zur Internen Revision: Klare Zusammenarbeit bei der Pr√ºfung der BCBS-239 Compliance, wobei Data Governance Rollen die notwendigen Informationen und Dokumentation bereitstellen und Audit-Findings systematisch nachverfolgen.\n‚Ä¢ Schnittstelle zum Regulatory Reporting: Enge Koordination mit den Verantwortlichen f√ºr die regulatorische Berichterstattung, um die Konsistenz und Qualit√§t der an Aufsichtsbeh√∂rden √ºbermittelten Risikodaten sicherzustellen.\n\nüìã Gestaltungsprinzipien f√ºr optimale Schnittstellen:\n‚Ä¢ Formale Abstimmungsprozesse: Etablierung regelm√§√üiger Abstimmungsrunden zwischen Data Governance Funktionen und anderen Compliance-Bereichen zur Koordination von Aktivit√§ten und Priorisierung von Ma√ünahmen.\n‚Ä¢ Integrierte Kontrollen: Harmonisierung von Kontrollen und Testverfahren zwischen verschiedenen Compliance-Bereichen, um √úberlappungen zu reduzieren und Effizienz zu steigern.\n‚Ä¢ Gemeinsame Metriken: Entwicklung bereichs√ºbergreifend konsistenter KPIs und Reifegradmodelle f√ºr die BCBS-239 Compliance, die von allen relevanten Funktionen genutzt werden.\n‚Ä¢ Einheitliche Dokumentation: Konsistente und zentral zug√§ngliche Dokumentation aller Compliance-relevanten Aspekte der Risikodatenaggregation und -berichterstattung.\n\nüîó Praktische Integrationsans√§tze mit anderen Governance-Frameworks:\n‚Ä¢ BCBS-239 und GDPR/DSGVO: Abstimmung der Datengovernance-Anforderungen f√ºr Risikodaten mit allgemeinen Datenschutzanforderungen, insbesondere bei Kundendaten.\n‚Ä¢ BCBS-239 und IT-Governance (COBIT, ITIL): Integration der Risikodatenanforderungen in bestehende IT-Governance-Frameworks zur Sicherstellung einer konsistenten technischen Steuerung.\n‚Ä¢ BCBS-239 und Operational Risk Management: Koordination mit dem operationellen Risikomanagement, insbesondere bei der Bewertung und Steuerung von Risiken in Datenprozessen.\n‚Ä¢ BCBS-239 und Model Risk Management: Abstimmung mit dem Model Risk Management zur Sicherstellung konsistenter Datenqualit√§tsstandards f√ºr Risikomodelle.\n\nüöÄ ADVISORIs Best Practices f√ºr effektive Governance-Integration:\n‚Ä¢ Integrated Governance Committee: Einrichtung eines √ºbergreifenden Governance-Gremiums, das alle relevanten Compliance- und Kontrollfunktionen umfasst und die Konsistenz der verschiedenen Governance-Frameworks sicherstellt.\n‚Ä¢ Gemeinsame Tooling-Strategie: Nutzung integrierter Tools f√ºr Governance, Risk und Compliance (GRC), die eine einheitliche Sicht auf alle Compliance-Anforderungen und -Ma√ünahmen erm√∂glichen.\n‚Ä¢ Cross-funktionale Teams: Bildung von bereichs√ºbergreifenden Teams f√ºr BCBS-239 Implementierungsprojekte, die Expertise aus verschiedenen Compliance- und Kontrollfunktionen vereinen.\n‚Ä¢ √úbergreifendes Schulungsprogramm: Entwicklung eines ganzheitlichen Schulungsansatzes, der Mitarbeitern ein Verst√§ndnis f√ºr die Zusammenh√§nge zwischen verschiedenen regulatorischen Anforderungen vermittelt."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: "Welche spezifischen Herausforderungen bei der Implementierung von Data Governance Rollen bestehen in mittelgro√üen Finanzinstituten und wie k√∂nnen diese adressiert werden?",
        answer: "Mittelgro√üe Finanzinstitute stehen bei der Implementierung von BCBS-239-konformen Data Governance Rollen vor besonderen Herausforderungen. Sie m√ºssen die regulatorischen Anforderungen mit begrenzteren Ressourcen als Gro√übanken erf√ºllen, verf√ºgen aber gleichzeitig √ºber komplexere Strukturen als kleine Institute. Die Entwicklung eines angemessenen und wirksamen Governance-Modells erfordert daher einen spezifisch angepassten Ansatz.\n\n‚öñÔ∏è Spezifische Herausforderungen mittelgro√üer Institute:\n‚Ä¢ Ressourcenbeschr√§nkungen: Im Vergleich zu Gro√übanken verf√ºgen mittelgro√üe Institute √ºber begrenztere personelle und finanzielle Ressourcen f√ºr spezialisierte Governance-Rollen, was eine effiziente Ressourcenallokation erfordert.\n‚Ä¢ Doppelfunktionen: H√§ufig m√ºssen Mitarbeiter mehrere Rollen gleichzeitig √ºbernehmen, was zu Interessenkonflikten und Kapazit√§tsengp√§ssen f√ºhren kann, insbesondere wenn Data Owner und Data Steward-Rollen nicht klar getrennt sind.\n‚Ä¢ Eingeschr√§nkte Spezialisierung: Geringere M√∂glichkeiten zur Etablierung hochspezialisierter Funktionen wie dedizierte Metadaten-Manager oder Data Quality Analysts, die in Gro√übanken Standard sind.\n‚Ä¢ Heterogene IT-Landschaft: Trotz geringerer Gr√∂√üe oft historisch gewachsene, komplexe IT-Strukturen mit zahlreichen Legacy-Systemen, die die Risikodatenaggregation erschweren.\n\nüí° Ma√ügeschneiderte L√∂sungsans√§tze f√ºr mittelgro√üe Institute:\n‚Ä¢ Priorisierter Rollenansatz: Fokussierung auf die kritischsten Governance-Rollen mit h√∂chstem regulatorischem Impact und schrittweise Erweiterung des Rollenmodells.\n‚Ä¢ Hybride Rollengestaltung: Kombination verwandter Governance-Funktionen in integrierten Rollen, z.B. durch Zusammenf√ºhrung von Data Stewardship mit Data Quality Management f√ºr bestimmte Dom√§nen.\n‚Ä¢ Flexible Organisationsmodelle: Statt dedizierter Vollzeitrollen Etablierung von Teil-Zust√§ndigkeiten mit klar definierten Kapazit√§tsanteilen f√ºr bestehende Mitarbeiter.\n‚Ä¢ Zentralisierte Governance-Unterst√ºtzung: Aufbau eines kleinen, aber schlagkr√§ftigen zentralen Governance-Teams, das dezentrale Rollentr√§ger mit Tools, Templates und Expertise unterst√ºtzt.\n\nüõ†Ô∏è Pragmatische Implementierungsstrategien:\n‚Ä¢ Phasenweiser Rollout: Schrittweise Einf√ºhrung des Governance-Modells, beginnend mit den kritischsten Risikodatendom√§nen und gradueller Ausweitung auf weitere Bereiche.\n‚Ä¢ Schlanke Gremienstrukturen: Vermeidung √ºberkomplexer Governance-Strukturen durch Fokussierung auf wenige, effektive Entscheidungsgremien mit klaren Mandaten.\n‚Ä¢ Toolgest√ºtzte Effizienz: Investition in geeignete Tools zur Automatisierung von Governance-Prozessen, Datenqualit√§tskontrollen und Dokumentation, um den manuellen Aufwand zu reduzieren.\n‚Ä¢ Externe Unterst√ºtzung: Strategischer Einsatz externer Expertise f√ºr spezifische Implementierungsphasen oder zur √úberbr√ºckung von Kapazit√§ts- und Wissensengp√§ssen.\n\nüåü ADVISORIs Best Practices aus erfolgreichen Implementierungen:\n‚Ä¢ Governance Maturity Assessment: Detaillierte Bewertung des Governance-Reifegrads als Basis f√ºr eine realistische Zieldefinition und Roadmap, die die spezifischen Kapazit√§ten des Instituts ber√ºcksichtigt.\n‚Ä¢ Bench Strength Analysis: Systematische Bewertung vorhandener Kompetenzen im Institut zur optimalen Allokation von Governance-Verantwortlichkeiten auf bestehende Mitarbeiter.\n‚Ä¢ Simplified Governance Operating Model: Entwicklung eines verschlankten, aber vollst√§ndigen Governance-Betriebsmodells, das alle regulatorischen Anforderungen abdeckt, ohne unn√∂tige Komplexit√§t zu schaffen.\n‚Ä¢ Value-driven Prioritization: Fokussierung der begrenzten Ressourcen auf Governance-Ma√ünahmen mit dem h√∂chsten Mehrwert f√ºr die Risikodatenqualit√§t und regulatorische Compliance."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: "Wie lassen sich Data Stewards optimal in das BCBS-239 Governance-Modell integrieren und welche Kompetenzen ben√∂tigen sie f√ºr ihre Rolle?",
        answer: "Data Stewards nehmen eine zentrale Br√ºckenfunktion in der BCBS-239 Governance ein, indem sie zwischen strategischen Data Owners und operativen Datenprozessen vermitteln. Ihre erfolgreiche Integration ins Governance-Modell und die Entwicklung der richtigen Kompetenzen sind entscheidend f√ºr die effektive Umsetzung der BCBS-239 Anforderungen im t√§glichen Betrieb.\n\nüîë Strategische Positionierung von Data Stewards im Governance-Modell:\n‚Ä¢ Organisatorische Verankerung: Data Stewards sollten idealerweise fachseitig in den Gesch√§ftsbereichen verankert sein, die die Risikodaten inhaltlich verantworten, mit einer fachlichen Berichtslinie zum Data Owner und einer methodischen Anbindung an die zentrale Datengovernance-Funktion.\n‚Ä¢ Vertikale Integration: Klare Einbindung in die Governance-Hierarchie mit definierten Eskalationswegen zum Data Owner und strukturierter Zusammenarbeit mit der CDO-Funktion.\n‚Ä¢ Horizontale Vernetzung: Etablierung eines instituts-weiten Data Steward Networks zum Wissensaustausch, zur Koordination bereichs√ºbergreifender Datenfl√ºsse und zur Harmonisierung von Standards und Prozessen.\n‚Ä¢ Prozessintegration: Formale Verankerung der Data Stewards in kritischen Datenprozessen wie Datenqualit√§tsmanagement, Metadatenpflege und Issue-Resolution mit klar definierten Aufgaben und Entscheidungsbefugnissen.\n\nüìã Kernaufgaben effektiver Data Stewards im BCBS-239 Kontext:\n‚Ä¢ Operative Datenqualit√§tssicherung: Durchf√ºhrung regelm√§√üiger Qualit√§tskontrollen, Analyse von Datenqualit√§tsproblemen und Koordination von Korrekturma√ünahmen\n‚Ä¢ Metadatenmanagement: Pflege der Datendokumentation und Sicherstellung der Nachvollziehbarkeit von Datenfl√ºssen und Datentransformationen\n‚Ä¢ Issue Management: Tracking und Priorisierung von Datenqualit√§tsproblemen, Koordination von L√∂sungsma√ünahmen und Eskalation bei kritischen Issues\n‚Ä¢ Schulung und Unterst√ºtzung: F√∂rderung des Datenqualit√§tsbewusstseins bei Datenerzeugern und -nutzern und Unterst√ºtzung bei Datenqualit√§tsfragen\n‚Ä¢ Berichterstattung: Erstellung regelm√§√üiger Berichte √ºber Datenqualit√§tsmetriken und -trends f√ºr Data Owners und Governance-Gremien\n\nüéì Erforderliche Kompetenzen f√ºr erfolgreiche Data Stewards:\n‚Ä¢ Fachliche Expertise: Tiefes Verst√§ndnis der Bedeutung, Verwendung und Zusammenh√§nge der Risikodaten in ihrem Verantwortungsbereich\n‚Ä¢ Methodisches Wissen: Kenntnisse in Datenqualit√§tsmanagement, Metadatenstandards und Datenanalysetechniken\n‚Ä¢ Regulatorisches Verst√§ndnis: Grundlegendes Wissen √ºber BCBS-239 Anforderungen und deren Implikationen f√ºr Risikodatenprozesse\n‚Ä¢ Technische Affinit√§t: Verst√§ndnis von Datenarchitekturen, Datentransformationsprozessen und Datenqualit√§tstools\n‚Ä¢ Soft Skills: Ausgepr√§gte Kommunikations- und √úberzeugungsf√§higkeiten, Probleml√∂sungskompetenz und Durchsetzungsverm√∂gen\n\nüöÄ ADVISORIs Best Practices f√ºr die Etablierung wirksamer Data Stewardship:\n‚Ä¢ Formale Rollendefinition: Entwicklung detaillierter Rollenprofile mit klaren Aufgaben, Verantwortlichkeiten und Kompetenzen, die in offiziellen Stellenbeschreibungen verankert werden\n‚Ä¢ Dedizierte Kapazit√§ten: Allokation ausreichender Zeitanteile f√ºr Data Stewardship-Aufgaben, idealerweise mindestens 50% einer Vollzeitstelle f√ºr kritische Datendom√§nen\n‚Ä¢ Strukturiertes Onboarding: Umfassendes Einarbeitungsprogramm f√ºr neue Data Stewards mit Schulungen zu methodischen Grundlagen, Tools und regulatorischen Anforderungen\n‚Ä¢ Kontinuierliche Entwicklung: Regelm√§√üige Weiterbildung und Zertifizierungsprogramme zur St√§rkung der fachlichen und methodischen Kompetenzen\n‚Ä¢ Community of Practice: Etablierung eines strukturierten Austauschs zwischen Data Stewards √ºber Abteilungsgrenzen hinweg zur F√∂rderung des Wissenstransfers und der Best-Practice-Verbreitung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: "Wie k√∂nnen Data Governance Rollen die Einhaltung der spezifischen BCBS-239 Prinzipien 1 und 2 sicherstellen und welche konkreten Verantwortlichkeiten ergeben sich daraus?",
        answer: "Die Prinzipien 1 und 2 der BCBS-239 Richtlinie bilden das Fundament f√ºr eine effektive Governance von Risikodaten. Sie fordern explizit die Etablierung eines robusten Governance-Frameworks und klarer Verantwortlichkeiten. Die richtige Ausgestaltung der Data Governance Rollen ist daher der Schl√ºssel zur Erf√ºllung dieser grundlegenden Prinzipien.\n\nüìú Kernforderungen der BCBS-239 Prinzipien 1 und 2:\n‚Ä¢ Prinzip 1: Governance ‚Äì Die Bank sollte eine starke Governance der Risikodatenaggregation und Berichterstattung etablieren, inklusive angemessener Qualit√§tssicherungsprozesse, Rollen und Verantwortlichkeiten.\n‚Ä¢ Prinzip 2: Datenarchitektur und IT-Infrastruktur ‚Äì Die Bank sollte eine Datenarchitektur und IT-Infrastruktur entwerfen, implementieren und pflegen, die die Risikodatenaggregation und Berichterstattung unter normalen Bedingungen und in Stresssituationen unterst√ºtzt.\n\nüéØ Konkrete Verantwortlichkeiten der Governance-Rollen f√ºr Prinzip 1:\n‚Ä¢ Vorstand und Gesch√§ftsleitung: Verabschiedung einer umfassenden Datengovernance-Strategie, Bereitstellung ausreichender Ressourcen und regelm√§√üige √úberwachung der BCBS-239 Compliance.\n‚Ä¢ Chief Data Officer: Entwicklung und Implementierung des Governance-Frameworks, Definition von Datenqualit√§tsstandards und √úberwachung der Einhaltung auf Institutsebene.\n‚Ä¢ Data Owner: √úbernahme der Verantwortung f√ºr die Qualit√§t spezifischer Risikodatendom√§nen, Definition dom√§nenspezifischer Standards und Genehmigung wesentlicher Daten√§nderungen.\n‚Ä¢ Data Steward: Operative Umsetzung der Datenqualit√§tsstandards, Durchf√ºhrung von Kontrollen und Koordination von Qualit√§tsverbesserungsma√ünahmen.\n‚Ä¢ Data Quality Manager: Entwicklung und √úberwachung der Datenqualit√§tsmetriken, Analyse von Qualit√§tsproblemen und Koordination bereichs√ºbergreifender Verbesserungsinitiativen.\n\nüíª Spezifische Verantwortlichkeiten f√ºr Prinzip 2:\n‚Ä¢ Vorstand/CIO: Sicherstellung ausreichender Investitionen in eine robuste IT-Infrastruktur f√ºr Risikodaten und Unterst√ºtzung strategischer Datenmanagementinitiativen.\n‚Ä¢ Chief Data Architect: Entwicklung einer BCBS-239-konformen Datenarchitektur mit klaren Datenfl√ºssen und minimalen manuellen Interventionen.\n‚Ä¢ IT Data Custodian: Technische Implementierung und Wartung der Systeme zur Risikodatenaggregation gem√§√ü den definierten Architekturprinzipien.\n‚Ä¢ Data Lineage Manager: Dokumentation und Pflege der End-to-End-Datenfl√ºsse von der Quelle bis zum Reporting, um vollst√§ndige Transparenz und Nachvollziehbarkeit zu gew√§hrleisten.\n‚Ä¢ Data Governance Council: Abstimmung zwischen Business- und IT-Anforderungen und Priorisierung von Architektur- und Infrastrukturma√ünahmen.\n\nüìä Praktische Governance-Mechanismen zur Umsetzung der Prinzipien:\n‚Ä¢ Datenqualit√§ts-Framework: Etablierung eines umfassenden Frameworks mit Standards, Metriken und Kontrollprozessen zur systematischen Steuerung der Risikodatenqualit√§t.\n‚Ä¢ RACI-Matrizen: Detaillierte Definition der Verantwortlichkeiten f√ºr alle Aspekte der Risikodatenaggregation und -berichterstattung √ºber den gesamten Datenlebenszyklus.\n‚Ä¢ Data Governance Policies: Formalisierung der Governance-Anforderungen in verbindlichen Richtlinien und Prozessdokumentationen.\n‚Ä¢ Issue Management: Strukturierter Prozess zur Identifikation, Eskalation und Behebung von Datenqualit√§tsproblemen mit klaren Verantwortlichkeiten.\n‚Ä¢ Datenqualit√§ts-Reporting: Regelm√§√üige Berichterstattung an Management und Vorstand √ºber den Status der Datenqualit√§t und der BCBS-239 Compliance.\n\nüöÄ ADVISORIs bew√§hrte Implementierungsans√§tze:\n‚Ä¢ Integriertes Governance-Modell: Entwicklung eines ganzheitlichen Modells, das sowohl die datenbezogenen (Prinzip 1) als auch die technischen Aspekte (Prinzip 2) der Governance abdeckt.\n‚Ä¢ Compliance-Mapping: Detaillierte Zuordnung aller regulatorischen Anforderungen zu spezifischen Rollen und Verantwortlichkeiten, um eine vollst√§ndige Abdeckung zu gew√§hrleisten.\n‚Ä¢ Reifegradmodell: Entwicklung eines Reifegradmodells f√ºr die BCBS-239 Governance, das eine strukturierte Evolution der Governance-F√§higkeiten erm√∂glicht.\n‚Ä¢ Integrit√§ts-Checks: Regelm√§√üige √úberpr√ºfung der Konsistenz und Wirksamkeit des Governance-Modells durch unabh√§ngige Kontrollinstanzen."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
