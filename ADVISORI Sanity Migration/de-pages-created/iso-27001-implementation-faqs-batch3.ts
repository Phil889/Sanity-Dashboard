import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Implementation page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-implementation' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-implementation" not found')
    }
    
    // Create new FAQs for change management and organizational aspects
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'Wie gestaltet man effektives Change Management bei der ISO 27001 Implementierung?',
        answer: "Effektives Change Management ist entscheidend f√ºr den Erfolg einer ISO 27001 Implementierung, da es die organisatorische Transformation begleitet und Widerst√§nde √ºberwindet. Ein strukturierter Change Management-Ansatz gew√§hrleistet nachhaltige Verankerung der Informationssicherheit in der Organisationskultur.\n\nüéØ Strategische Change-Planung:\n‚Ä¢ Entwicklung einer umfassenden Change-Strategie mit klaren Zielen und Erfolgskriterien\n‚Ä¢ Stakeholder-Analyse zur Identifikation von Bef√ºrwortern, Skeptikern und Widerst√§nden\n‚Ä¢ Kommunikationsstrategie mit zielgruppenspezifischen Botschaften und Kan√§len\n‚Ä¢ Aufbau einer Change-Coalition aus einflussreichen F√ºhrungskr√§ften und Meinungsbildnern\n‚Ä¢ Definition von Change-Meilensteinen und Messgr√∂√üen f√ºr Fortschrittskontrolle\n\nüë• Mitarbeiterengagement und Partizipation:\n‚Ä¢ Fr√ºhzeitige Einbindung von Mitarbeitern in Planungs- und Entscheidungsprozesse\n‚Ä¢ Aufbau von Change Champions und Multiplikatoren in verschiedenen Organisationsbereichen\n‚Ä¢ Regelm√§√üige Feedback-Runden und offene Kommunikationsformate\n‚Ä¢ Ber√ºcksichtigung von Mitarbeiterbedenken und konstruktive L√∂sungsfindung\n‚Ä¢ Schaffung von Erfolgsgeschichten und positiven Erfahrungen zur Motivation\n\nüì¢ Kommunikation und Transparenz:\n‚Ä¢ Entwicklung einer konsistenten Kommunikationsstrategie mit regelm√§√üigen Updates\n‚Ä¢ Verwendung verschiedener Kommunikationskan√§le f√ºr maximale Reichweite\n‚Ä¢ Transparente Darstellung von Zielen, Fortschritten und Herausforderungen\n‚Ä¢ Aufbau von Verst√§ndnis f√ºr die Notwendigkeit und Vorteile der ISMS-Implementierung\n‚Ä¢ Kontinuierliche Anpassung der Kommunikation basierend auf Feedback\n\nüéì Kompetenzentwicklung und Schulungen:\n‚Ä¢ Systematische Identifikation von Qualifikationsl√ºcken und Schulungsbedarfen\n‚Ä¢ Entwicklung zielgruppenspezifischer Schulungsprogramme f√ºr verschiedene Rollen\n‚Ä¢ Kombination verschiedener Lernformate wie Pr√§senzschulungen, E-Learning und Workshops\n‚Ä¢ Aufbau interner Trainer und Wissensmultiplikatoren\n‚Ä¢ Kontinuierliche Weiterbildung und Kompetenzaktualisierung\n\nüîÑ Widerstandsmanagement:\n‚Ä¢ Proaktive Identifikation und Analyse von Widerstandsquellen\n‚Ä¢ Entwicklung spezifischer Strategien f√ºr verschiedene Arten von Widerst√§nden\n‚Ä¢ Aufbau von Vertrauen durch transparente Kommunikation und Partizipation\n‚Ä¢ Adressierung von √Ñngsten und Bedenken durch gezielte Unterst√ºtzung\n‚Ä¢ Transformation von Skeptikern zu Unterst√ºtzern durch positive Erfahrungen\n\nüìä Kulturwandel und Verhaltens√§nderung:\n‚Ä¢ Entwicklung einer Sicherheitskultur durch Vorbildfunktion der F√ºhrung\n‚Ä¢ Integration von Sicherheitsbewusstsein in t√§gliche Arbeitsabl√§ufe\n‚Ä¢ Aufbau von Belohnungs- und Anerkennungssystemen f√ºr sicherheitsbewusstes Verhalten\n‚Ä¢ Schaffung von Lernm√∂glichkeiten aus Fehlern ohne Schuldzuweisungen\n‚Ä¢ Kontinuierliche Verst√§rkung gew√ºnschter Verhaltensweisen\n\nüéØ Nachhaltigkeit und Verankerung:\n‚Ä¢ Entwicklung von Mechanismen zur dauerhaften Verankerung der Ver√§nderungen\n‚Ä¢ Integration von ISMS-Prozessen in bestehende Managementsysteme\n‚Ä¢ Aufbau von Feedback-Schleifen f√ºr kontinuierliche Verbesserung\n‚Ä¢ Etablierung von Governance-Strukturen f√ºr nachhaltige Change-Begleitung\n‚Ä¢ Regelm√§√üige Bewertung und Anpassung der Change-Strategie"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'Welche Herausforderungen entstehen bei der ISO 27001 Implementierung in multinationalen Organisationen?',
        answer: "Die ISO 27001 Implementierung in multinationalen Organisationen bringt komplexe Herausforderungen mit sich, die eine durchdachte Strategie und flexible Herangehensweise erfordern. Kulturelle, rechtliche und operative Unterschiede m√ºssen systematisch ber√ºcksichtigt und harmonisiert werden.\n\nüåç Rechtliche und regulatorische Komplexit√§t:\n‚Ä¢ Navigation durch verschiedene nationale Datenschutz- und Sicherheitsgesetze\n‚Ä¢ Harmonisierung unterschiedlicher Compliance-Anforderungen und Standards\n‚Ä¢ Ber√ºcksichtigung lokaler Meldepflichten und Aufsichtsbeh√∂rden\n‚Ä¢ Anpassung an verschiedene Rechtssysteme und Durchsetzungsmechanismen\n‚Ä¢ Aufbau von Legal-Expertise f√ºr alle relevanten Jurisdiktionen\n\nüè¢ Organisatorische und strukturelle Herausforderungen:\n‚Ä¢ Koordination zwischen verschiedenen Gesch√§ftseinheiten und Standorten\n‚Ä¢ Harmonisierung unterschiedlicher IT-Landschaften und Systemarchitekturen\n‚Ä¢ Integration verschiedener Managementsysteme und Governance-Strukturen\n‚Ä¢ Aufbau einheitlicher Reporting-Linien und Eskalationswege\n‚Ä¢ Ber√ºcksichtigung verschiedener Organisationskulturen und Arbeitsweisen\n\nüåê Kulturelle und sprachliche Aspekte:\n‚Ä¢ Anpassung von Sicherheitsrichtlinien an lokale Kulturen und Werte\n‚Ä¢ √úbersetzung und Lokalisierung von Dokumentation und Schulungsmaterialien\n‚Ä¢ Ber√ºcksichtigung unterschiedlicher Kommunikationsstile und Hierarchien\n‚Ä¢ Aufbau kultureller Sensibilit√§t bei globalen ISMS-Teams\n‚Ä¢ Integration verschiedener Arbeits- und Entscheidungskulturen\n\nüîß Technische Integration und Standardisierung:\n‚Ä¢ Harmonisierung verschiedener IT-Infrastrukturen und Sicherheitstools\n‚Ä¢ Aufbau einheitlicher Monitoring- und Reporting-Systeme\n‚Ä¢ Integration verschiedener Cloud-Umgebungen und Service-Provider\n‚Ä¢ Standardisierung von Sicherheitskonfigurationen √ºber alle Standorte\n‚Ä¢ Ber√ºcksichtigung unterschiedlicher technischer Reifegrade\n\n‚è∞ Zeitzonenmanagement und Koordination:\n‚Ä¢ Koordination von Projekten √ºber verschiedene Zeitzonen hinweg\n‚Ä¢ Aufbau von Follow-the-Sun-Modellen f√ºr kontinuierliche Betreuung\n‚Ä¢ Planung von globalen Meetings und Abstimmungsrunden\n‚Ä¢ Ber√ºcksichtigung lokaler Feiertage und Arbeitszeiten\n‚Ä¢ Etablierung asynchroner Kommunikations- und Entscheidungsprozesse\n\nüí∞ Ressourcenallokation und Budgetierung:\n‚Ä¢ Verteilung von Implementierungskosten auf verschiedene Einheiten\n‚Ä¢ Ber√ºcksichtigung unterschiedlicher Lohnniveaus und Kostenstrukturen\n‚Ä¢ Aufbau lokaler Expertise versus zentrale Ressourcennutzung\n‚Ä¢ Koordination von Investitionen in verschiedene W√§hrungen\n‚Ä¢ Optimierung von Ressourcennutzung durch Skaleneffekte\n\nüéØ Governance und Steuerung:\n‚Ä¢ Aufbau einer globalen ISMS-Governance mit lokaler Flexibilit√§t\n‚Ä¢ Definition einheitlicher Standards bei Ber√ºcksichtigung lokaler Anforderungen\n‚Ä¢ Etablierung globaler Policies mit lokalen Implementierungsrichtlinien\n‚Ä¢ Aufbau von Matrix-Organisationen f√ºr effektive Koordination\n‚Ä¢ Balance zwischen zentraler Kontrolle und lokaler Autonomie\n\nüìä Erfolgsmessung und Reporting:\n‚Ä¢ Entwicklung einheitlicher KPIs und Metriken f√ºr alle Standorte\n‚Ä¢ Aufbau konsolidierter Reporting-Systeme mit lokalen Detailansichten\n‚Ä¢ Ber√ºcksichtigung verschiedener Gesch√§ftsmodelle und Reifegrade\n‚Ä¢ Etablierung globaler Benchmarks und Best-Practice-Sharing\n‚Ä¢ Kontinuierliche Anpassung an sich √§ndernde globale Anforderungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'Wie bereitet man sich optimal auf die ISO 27001 Zertifizierungsaudits vor?',
        answer: "Eine optimale Vorbereitung auf ISO 27001 Zertifizierungsaudits erfordert systematische Planung, umfassende Dokumentation und praktische Validierung aller ISMS-Komponenten. Eine strukturierte Audit-Vorbereitung minimiert Risiken und maximiert die Erfolgswahrscheinlichkeiten.\n\nüìã Systematische Audit-Vorbereitung:\n‚Ä¢ Entwicklung einer detaillierten Audit-Roadmap mit Zeitpl√§nen und Verantwortlichkeiten\n‚Ä¢ Durchf√ºhrung umfassender Gap-Analysen gegen alle ISO 27001 Anforderungen\n‚Ä¢ Aufbau vollst√§ndiger Evidenz-Sammlungen f√ºr alle implementierten Kontrollen\n‚Ä¢ Vorbereitung aller erforderlichen Dokumente und Nachweise\n‚Ä¢ Koordination mit der Zertifizierungsstelle f√ºr Terminplanung und Logistik\n\nüîç Interne Audit-Programme:\n‚Ä¢ Etablierung regelm√§√üiger interner Audits zur kontinuierlichen Readiness-√úberpr√ºfung\n‚Ä¢ Aufbau qualifizierter interner Audit-Teams mit entsprechender Zertifizierung\n‚Ä¢ Durchf√ºhrung von Mock-Audits zur Simulation der Zertifizierungssituation\n‚Ä¢ Systematische Dokumentation und Nachverfolgung aller Audit-Findings\n‚Ä¢ Kontinuierliche Verbesserung der Audit-Prozesse basierend auf Erfahrungen\n\nüìä Dokumentations-Readiness:\n‚Ä¢ Vollst√§ndige √úberpr√ºfung aller ISMS-Dokumente auf Aktualit√§t und Vollst√§ndigkeit\n‚Ä¢ Sicherstellung konsistenter Dokumentationsstrukturen und Versionskontrolle\n‚Ä¢ Vorbereitung von Evidenz-Portfolios f√ºr alle Sicherheitskontrollen\n‚Ä¢ Aufbau von Audit-Trails f√ºr alle kritischen ISMS-Prozesse\n‚Ä¢ Bereitstellung elektronischer Dokumentenzugriffe f√ºr Auditoren\n\nüë• Team-Vorbereitung und Schulungen:\n‚Ä¢ Intensive Schulung aller Audit-Teilnehmer zu ISO 27001 Anforderungen\n‚Ä¢ Vorbereitung auf typische Auditor-Fragen und Interviewsituationen\n‚Ä¢ Aufbau von Kommunikationskompetenzen f√ºr professionelle Audit-Gespr√§che\n‚Ä¢ Definition klarer Rollen und Verantwortlichkeiten w√§hrend des Audits\n‚Ä¢ Durchf√ºhrung von Rollenspielen und Simulation kritischer Audit-Szenarien\n\nüîß Technische System-Validierung:\n‚Ä¢ Umfassende Tests aller implementierten Sicherheitskontrollen\n‚Ä¢ Validierung der Wirksamkeit durch Penetration Tests und Vulnerability Assessments\n‚Ä¢ √úberpr√ºfung aller Monitoring- und Logging-Systeme auf Funktionsf√§higkeit\n‚Ä¢ Demonstration der Incident Response-F√§higkeiten durch Tabletop-√úbungen\n‚Ä¢ Sicherstellung der Verf√ºgbarkeit aller technischen Systeme w√§hrend des Audits\n\nüìà Management Review und Governance:\n‚Ä¢ Durchf√ºhrung umfassender Management Reviews vor dem Audit\n‚Ä¢ Validierung der ISMS-Performance durch aktuelle KPIs und Metriken\n‚Ä¢ √úberpr√ºfung aller Risikobewertungen und Behandlungsma√ünahmen\n‚Ä¢ Demonstration kontinuierlicher Verbesserungsaktivit√§ten\n‚Ä¢ Sicherstellung des Management-Commitments und der Ressourcenverf√ºgbarkeit\n\nüéØ Audit-Logistik und Koordination:\n‚Ä¢ Detaillierte Planung der Audit-Agenda mit allen Beteiligten\n‚Ä¢ Bereitstellung geeigneter R√§umlichkeiten und technischer Ausstattung\n‚Ä¢ Koordination von Terminen mit allen relevanten Stakeholdern\n‚Ä¢ Vorbereitung von Backup-Pl√§nen f√ºr kritische Situationen\n‚Ä¢ Etablierung klarer Kommunikationswege w√§hrend des Audits\n\n‚úÖ Post-Audit-Aktivit√§ten:\n‚Ä¢ Systematische Nachbereitung aller Audit-Findings und Empfehlungen\n‚Ä¢ Entwicklung von Korrekturma√ünahmen-Pl√§nen f√ºr identifizierte Schwachstellen\n‚Ä¢ Dokumentation von Lessons Learned f√ºr zuk√ºnftige Audits\n‚Ä¢ Kontinuierliche √úberwachung der Umsetzung von Verbesserungsma√ünahmen\n‚Ä¢ Vorbereitung auf Surveillance-Audits und Rezertifizierungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'Welche Rolle spielen externe Berater bei der ISO 27001 Implementierung?',
        answer: "Externe Berater k√∂nnen eine entscheidende Rolle bei der ISO 27001 Implementierung spielen, indem sie Expertise, Objektivit√§t und bew√§hrte Praktiken einbringen. Die richtige Auswahl und Einbindung externer Unterst√ºtzung kann den Implementierungserfolg erheblich beschleunigen und verbessern.\n\nüéØ Strategische Beratungsleistungen:\n‚Ä¢ Entwicklung ma√ügeschneiderter ISMS-Strategien basierend auf Organisationszielen\n‚Ä¢ Gap-Analysen und Readiness-Assessments f√ºr realistische Implementierungsplanung\n‚Ä¢ Aufbau von Business Cases und ROI-Kalkulationen f√ºr Management-Entscheidungen\n‚Ä¢ Benchmarking gegen Branchenstandards und Best Practices\n‚Ä¢ Strategische Roadmap-Entwicklung mit Priorisierung und Ressourcenplanung\n\nüîß Technische Implementierungsunterst√ºtzung:\n‚Ä¢ Design und Architektur von ISMS-Komponenten und Sicherheitskontrollen\n‚Ä¢ Auswahl und Implementierung geeigneter Sicherheitstechnologien\n‚Ä¢ Integration bestehender Systeme in die ISMS-Architektur\n‚Ä¢ Entwicklung von Monitoring- und Reporting-L√∂sungen\n‚Ä¢ Technische Validierung und Testing implementierter Kontrollen\n\nüìö Wissenstransfer und Kompetenzaufbau:\n‚Ä¢ Schulung interner Teams zu ISO 27001 Anforderungen und Best Practices\n‚Ä¢ Aufbau interner ISMS-Kompetenzen f√ºr nachhaltige Eigenst√§ndigkeit\n‚Ä¢ Mentoring von Schl√ºsselpersonal w√§hrend der Implementierung\n‚Ä¢ Entwicklung organisationsspezifischer Schulungsmaterialien\n‚Ä¢ Etablierung von Communities of Practice f√ºr kontinuierlichen Wissensaustausch\n\n‚ö° Beschleunigung und Effizienzsteigerung:\n‚Ä¢ Nutzung bew√§hrter Implementierungsmethoden und Templates\n‚Ä¢ Vermeidung typischer Fallstricke durch Erfahrungswissen\n‚Ä¢ Parallele Bearbeitung komplexer Workstreams durch zus√§tzliche Ressourcen\n‚Ä¢ Fokussierung interner Teams auf kritische Gesch√§ftsaktivit√§ten\n‚Ä¢ Reduzierung der Time-to-Market f√ºr ISMS-Implementierung\n\nüîç Objektivit√§t und externe Perspektive:\n‚Ä¢ Unabh√§ngige Bewertung bestehender Sicherheitsma√ünahmen\n‚Ä¢ Objektive Identifikation von Verbesserungspotenzialen\n‚Ä¢ Externe Validierung von Implementierungsans√§tzen\n‚Ä¢ Neutrale Moderation bei internen Konflikten oder Widerst√§nden\n‚Ä¢ Benchmarking gegen externe Standards und Vergleichsorganisationen\n\nüìä Audit-Vorbereitung und Compliance-Unterst√ºtzung:\n‚Ä¢ Vorbereitung auf Zertifizierungsaudits durch erfahrene Auditoren\n‚Ä¢ Mock-Audits und Readiness-Assessments\n‚Ä¢ Unterst√ºtzung bei der Behebung von Audit-Findings\n‚Ä¢ Begleitung w√§hrend der Zertifizierungsaudits\n‚Ä¢ Kontinuierliche Compliance-√úberwachung und -optimierung\n\nü§ù Auswahlkriterien f√ºr externe Berater:\n‚Ä¢ Nachgewiesene Expertise in ISO 27001 und Informationssicherheit\n‚Ä¢ Branchenspezifische Erfahrung und Referenzen\n‚Ä¢ Zertifizierungen und Qualifikationen der Beraterteams\n‚Ä¢ Methodische Ans√§tze und bew√§hrte Implementierungsframeworks\n‚Ä¢ Kulturelle Passung und Kommunikationsf√§higkeiten\n\n‚öñÔ∏è Balance zwischen externer Unterst√ºtzung und interner Eigenst√§ndigkeit:\n‚Ä¢ Klare Definition von Beratungsumfang und Eigenverantwortlichkeiten\n‚Ä¢ Strukturierter Wissenstransfer f√ºr nachhaltige interne Kompetenzen\n‚Ä¢ Schrittweise Reduzierung der externen Abh√§ngigkeit\n‚Ä¢ Aufbau interner Change Agents und ISMS-Champions\n‚Ä¢ Langfristige Partnerschaft f√ºr kontinuierliche Unterst√ºtzung bei Bedarf"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
