import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Windows PKI page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'windows-pki' })
    
    if (!existingDoc) {
      throw new Error('Document "windows-pki" not found')
    }
    
    // Create new FAQs for Windows Server Certificate Services fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Warum ist Windows Server Certificate Services mehr als traditionelle PKI und wie transformiert es Windows Enterprise-Vertrauen?',
        answer: "Windows Server Certificate Services repr√§sentiert einen paradigmatischen Wandel von isolierten PKI-Systemen zu strategisch integrierten Windows-nativen Vertrauensarchitekturen. Es etabliert PKI als nativen Bestandteil der Windows-Infrastruktur, der nicht nur Certificate-Management erm√∂glicht, sondern auch als strategischer Enabler f√ºr Windows Server-Modernisierung, Active Directory-Integration und moderne Windows-Enterprise-Transformation fungiert.\n\nüèõÔ∏è Windows-native PKI-Integration und Domain-Architektur:\n‚Ä¢ Windows Server Certificate Services etabliert PKI als nativen Bestandteil der Windows-Domain-Infrastruktur mit nahtloser Integration in bestehende Active Directory-Strukturen und Windows-Authentifizierungssysteme\n‚Ä¢ Domain-integrierte Certificate Authority-Hierarchien erm√∂glichen automatisierte Certificate-Ausstellung basierend auf Active Directory-Gruppenmitgliedschaften und Computer-Accounts\n‚Ä¢ Windows-native Auto-Enrollment-Funktionalit√§t gew√§hrleistet transparente Certificate-Bereitstellung ohne Benutzerinteraktion f√ºr Workstations, Server und Domain-Services\n‚Ä¢ Group Policy-Integration erm√∂glicht zentrale Verwaltung von Certificate-Richtlinien und automatische Verteilung von Trusted Root Certification Authorities\n‚Ä¢ Multi-Domain-Unterst√ºtzung erweitert PKI-Vertrauen √ºber komplexe Windows-Enterprise-Topologien hinweg\n\nüîê Enterprise Root CA und Windows-Hierarchie-Design:\n‚Ä¢ Enterprise Root CA-Implementierung schafft vertrauensvolle Grundlage f√ºr alle Windows-Services mit optimaler Integration in Windows Certificate Stores\n‚Ä¢ Subordinate CA-Hierarchien erm√∂glichen granulare Kontrolle und Delegation von Certificate-Ausstellungsrechten an verschiedene Windows-Organizational Units\n‚Ä¢ Certificate Revocation List-Optimierung und Online Certificate Status Protocol-Implementation gew√§hrleisten Echtzeit-Validierung von Certificate-Status in Windows-Umgebungen\n‚Ä¢ Cross-Domain-Certification-F√§higkeiten erm√∂glichen Vertrauen zwischen verschiedenen Windows-Domains und Forest-Strukturen\n‚Ä¢ Hardware Security Module-Integration sch√ºtzt kritische CA-Schl√ºssel mit Windows-nativen HSM-Providern und CryptoAPI-Integration\n\nüåê Windows-Ecosystem-Harmonisierung und Service-Integration:\n‚Ä¢ Nahtlose Integration mit Internet Information Services erm√∂glicht SSL/TLS-Certificate-Management f√ºr Windows-Web-Services\n‚Ä¢ Exchange Server-Integration unterst√ºtzt S/MIME-Verschl√ºsselung, digitale Signaturen und sichere E-Mail-Kommunikation in Windows-Umgebungen\n‚Ä¢ SharePoint-Integration erm√∂glicht Certificate-based Authentication, Document Protection und sichere Collaboration-Szenarien\n‚Ä¢ Windows-native Application-Integration schafft sichere Kommunikationskan√§le mit Certificate-basierter Identit√§tsvalidierung f√ºr Windows-Services\n‚Ä¢ System Center-Integration erm√∂glicht umfassendes Monitoring und Management von Certificate-Lifecycles in Windows-Infrastrukturen\n\nüíº Business Value und strategische Windows-Vorteile:\n‚Ä¢ Signifikante Kosteneinsparungen durch Eliminierung externer Certificate Authority-Abh√§ngigkeiten f√ºr interne Windows-Anwendungen\n‚Ä¢ Beschleunigte Deployment-Zyklen durch automatisierte Certificate-Bereitstellung in Windows-DevOps-Pipelines\n‚Ä¢ Verbesserte Compliance-Posture durch integrierte Windows Event Log-Trails und automatisierte Reporting-Funktionen\n‚Ä¢ Erh√∂hte Sicherheit durch Certificate-basierte Authentifizierung f√ºr kritische Windows-Anwendungen und Services\n‚Ä¢ Strategische Flexibilit√§t f√ºr Hybrid Cloud-Szenarien mit einheitlicher Windows PKI-Governance\n\nüöÄ Innovation und Windows Future-Readiness:\n‚Ä¢ PowerShell-Integration erm√∂glicht Infrastructure as Code-Ans√§tze f√ºr Windows PKI-Management\n‚Ä¢ Windows Management Instrumentation-Integration unterst√ºtzt moderne Windows-Anwendungsintegration und DevOps-Workflows\n‚Ä¢ Container-Unterst√ºtzung f√ºr moderne Windows-Anwendungsarchitekturen mit dynamischer Certificate-Bereitstellung\n‚Ä¢ Windows Server Core-Deployment f√ºr minimale Attack Surface und optimierte Performance\n‚Ä¢ Azure-Integration f√ºr Hybrid Cloud-Szenarien mit einheitlicher Windows PKI-Governance"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie funktioniert Windows Certificate Template-Management und warum ist es gesch√§ftskritisch f√ºr Windows Enterprise-Skalierung?',
        answer: "Windows Certificate Template-Management transformiert statische Certificate-Konfigurationen in dynamische, policy-gesteuerte Windows-native Systeme, die automatisch auf Gesch√§ftsanforderungen reagieren. Es eliminiert nicht nur manuelle Certificate-Verwaltung, sondern schafft auch strategische Vorteile durch konsistente Windows-Sicherheitsrichtlinien, automatisierte Compliance und nahtlose Skalierung f√ºr wachsende Windows-Infrastrukturen.\n\nüìã Windows-native Template-basierte Certificate-Governance:\n‚Ä¢ Certificate Templates definieren einheitliche Windows-Sicherheitsrichtlinien und Verwendungszwecke f√ºr verschiedene Certificate-Typen mit granularer Kontrolle √ºber Schl√ºssell√§ngen, G√ºltigkeitsdauern und Windows-spezifische Verwendungseinschr√§nkungen\n‚Ä¢ Version-Management erm√∂glicht kontrollierte Evolution von Certificate-Richtlinien ohne Unterbrechung bestehender Windows-Services\n‚Ä¢ Permission-basierte Template-Zugriffe gew√§hrleisten, dass nur autorisierte Windows-Benutzer und Computer-Accounts spezifische Certificate-Typen anfordern k√∂nnen\n‚Ä¢ Custom Object Identifier-Unterst√ºtzung erm√∂glicht organisationsspezifische Certificate-Extensions und Windows-Compliance-Anforderungen\n‚Ä¢ Template-Inheritance-Mechanismen vereinfachen Management komplexer Windows Certificate-Hierarchien\n\nü§ñ Windows Auto-Enrollment und Group Policy-Automation:\n‚Ä¢ Group Policy-gesteuerte Auto-Enrollment-Konfiguration erm√∂glicht transparente Certificate-Bereitstellung basierend auf Windows-Benutzer- und Computer-Gruppenmitgliedschaften\n‚Ä¢ Conditional Access-Integration gew√§hrleistet, dass Certificate-Ausstellung nur unter definierten Windows-Sicherheitsbedingungen erfolgt\n‚Ä¢ Automatic Certificate Request-Processing eliminiert manuelle Genehmigungsworkflows f√ºr Routine-Certificate-Anfragen in Windows-Umgebungen\n‚Ä¢ Certificate Renewal-Automation verhindert Service-Unterbrechungen durch abgelaufene Certificates in Windows-Infrastrukturen\n‚Ä¢ Intelligent Certificate Distribution stellt sicher, dass Certificates automatisch in relevante Windows Certificate Stores installiert werden\n\nüîÑ Windows-native Lifecycle-Management und Renewal-Strategien:\n‚Ä¢ Proactive Certificate Renewal-Benachrichtigungen informieren Windows-Administratoren und Anwendungsbesitzer rechtzeitig √ºber anstehende Certificate-Abl√§ufe\n‚Ä¢ Automated Renewal-Workflows koordinieren Certificate-Updates mit Windows-Anwendungs-Deployments und Service-Restarts\n‚Ä¢ Certificate Archival-Policies gew√§hrleisten langfristige Verf√ºgbarkeit historischer Certificates f√ºr Windows-Compliance und Forensik\n‚Ä¢ Emergency Certificate Replacement-Prozesse erm√∂glichen schnelle Reaktion auf Sicherheitsvorf√§lle oder Kompromittierungen in Windows-Umgebungen\n‚Ä¢ Certificate Usage Analytics identifizieren ungenutzte oder redundante Certificates f√ºr Windows-Optimierung\n\nüõ°Ô∏è Windows Security und Compliance-Integration:\n‚Ä¢ Template-basierte Security Policies gew√§hrleisten konsistente Anwendung von Windows-Sicherheitsstandards √ºber alle Certificate-Typen hinweg\n‚Ä¢ Windows Event Log-Integration dokumentiert alle Certificate-Template-√Ñnderungen und -Verwendungen f√ºr Compliance-Nachweise\n‚Ä¢ Role-based Access Control f√ºr Template-Management gew√§hrleistet, dass nur autorisierte Windows-Administratoren Certificate-Richtlinien √§ndern k√∂nnen\n‚Ä¢ Certificate Transparency-Integration erm√∂glicht Monitoring und Validierung ausgestellter Certificates in Windows-Umgebungen\n‚Ä¢ Compliance Reporting-Automation generiert regelm√§√üige Berichte √ºber Certificate-Template-Verwendung und Windows-Sicherheitsstatus\n\nüìä Windows Enterprise-Skalierung und Performance-Optimierung:\n‚Ä¢ Template-Caching-Mechanismen optimieren Certificate-Ausstellungsperformance in gro√üen Windows-Enterprise-Umgebungen\n‚Ä¢ Load Balancing zwischen mehreren Windows Certificate Authorities gew√§hrleistet hohe Verf√ºgbarkeit und Skalierbarkeit\n‚Ä¢ Geographic Distribution von Certificate Templates erm√∂glicht lokale Certificate-Ausstellung in globalen Windows-Organisationen\n‚Ä¢ Capacity Planning-Tools prognostizieren Certificate-Anforderungen basierend auf Windows-Template-Verwendungsmustern\n‚Ä¢ Performance Monitoring identifiziert Engp√§sse und Optimierungspotenziale in Windows-Template-Processing-Workflows"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Rolle spielt Windows Certificate Store-Management in modernen Windows PKI-Architekturen und wie gew√§hrleistet es Enterprise-Sicherheit?',
        answer: "Windows Certificate Store-Management bildet das kritische Sicherheitsfundament f√ºr Windows PKI-Architekturen, das nicht nur Certificate-Speicherung und -Zugriff verwaltet, sondern auch als strategisches Sicherheitsinstrument f√ºr Windows-native Authentifizierung, Compliance-Enforcement und Trust-Management fungiert. Es transformiert statische Certificate-Verwaltung in dynamische, Windows-integrierte Sicherheitssysteme, die proaktiv auf Bedrohungen reagieren.\n\nüîç Windows Certificate Store-Architektur und Hierarchie-Management:\n‚Ä¢ Windows Certificate Store-Hierarchie gew√§hrleistet strukturierte und sichere Certificate-Speicherung mit Personal Store, Computer Store, Service Store und Enterprise Store-Kategorien\n‚Ä¢ Trusted Root Certification Authorities Store-Management erm√∂glicht zentrale Kontrolle √ºber vertrauensw√ºrdige Certificate Authorities in Windows-Umgebungen\n‚Ä¢ Intermediate Certification Authorities Store-Optimierung gew√§hrleistet effiziente Certificate Chain-Validierung und Trust Path-Discovery\n‚Ä¢ Untrusted Certificates Store-Management sch√ºtzt vor kompromittierten oder widerrufenen Certificates in Windows-Infrastrukturen\n‚Ä¢ Personal Certificate Store-Isolation gew√§hrleistet sichere Trennung von Benutzer- und Computer-Certificates\n\n‚ö° Group Policy-gesteuerte Certificate Store-Verwaltung:\n‚Ä¢ Group Policy Certificate Deployment erm√∂glicht zentrale Verteilung von Trusted Root Certificates und Intermediate Certificates √ºber Windows-Dom√§nen\n‚Ä¢ Automatic Certificate Store Updates gew√§hrleisten konsistente Certificate-Verf√ºgbarkeit √ºber alle Windows-Systeme hinweg\n‚Ä¢ Certificate Store Access Control Lists definieren granulare Berechtigungen f√ºr Certificate-Zugriff und -Verwaltung\n‚Ä¢ Certificate Store Backup und Recovery-Strategien gew√§hrleisten Kontinuit√§t bei System-Ausf√§llen oder Disaster-Szenarien\n‚Ä¢ Certificate Store Monitoring √ºberwacht Certificate-√Ñnderungen und identifiziert potenzielle Sicherheitsvorf√§lle\n\nüö® Windows-native Security und Access Control:\n‚Ä¢ CryptoAPI-Integration gew√§hrleistet sichere Certificate-Zugriffe durch Windows-Anwendungen mit standardisierten Schnittstellen\n‚Ä¢ Certificate Store Permissions-Management definiert granulare Zugriffskontrolle f√ºr verschiedene Windows-Benutzer und Service-Accounts\n‚Ä¢ Hardware Security Module-Integration sch√ºtzt kritische Private Keys mit Windows-nativen CSP-Providern\n‚Ä¢ Certificate Store Encryption gew√§hrleistet Schutz gespeicherter Certificates vor unbefugtem Zugriff\n‚Ä¢ Windows Event Log-Integration dokumentiert alle Certificate Store-Aktivit√§ten f√ºr Audit und Compliance-Zwecke\n\nüìä PowerShell-basierte Certificate Store-Automation:\n‚Ä¢ PowerShell Certificate Store-Cmdlets erm√∂glichen automatisierte Certificate-Verwaltung und Deployment-Workflows\n‚Ä¢ Certificate Store Inventory-Scripts identifizieren und katalogisieren alle Certificates in Windows-Infrastrukturen\n‚Ä¢ Automated Certificate Validation-Scripts √ºberpr√ºfen Certificate-G√ºltigkeit und Compliance-Status\n‚Ä¢ Certificate Store Cleanup-Automation entfernt abgelaufene oder nicht mehr ben√∂tigte Certificates\n‚Ä¢ Certificate Store Reporting-Scripts generieren detaillierte Berichte √ºber Certificate-Verwendung und -Status\n\nüîó Windows-Integration und Application Support:\n‚Ä¢ Internet Information Services-Integration erm√∂glicht nahtlose SSL/TLS-Certificate-Verwaltung f√ºr Windows-Web-Services\n‚Ä¢ Exchange Server Certificate Store-Integration unterst√ºtzt S/MIME und Transport Layer Security f√ºr sichere E-Mail-Kommunikation\n‚Ä¢ SharePoint Certificate Store-Integration erm√∂glicht Certificate-based Authentication und Document Signing\n‚Ä¢ Windows Service Certificate Store-Integration gew√§hrleistet sichere Service-to-Service-Kommunikation\n‚Ä¢ Third-Party Application Certificate Store-Integration √ºber standardisierte Windows CryptoAPI-Schnittstellen\n\n‚öôÔ∏è Enterprise-Management und Operational Excellence:\n‚Ä¢ Centralized Certificate Store-Management-Konsolen erm√∂glichen einheitliche Verwaltung von Certificate Stores √ºber Windows-Infrastrukturen hinweg\n‚Ä¢ Certificate Store Health Monitoring √ºberwacht Certificate Store-Performance und identifiziert potenzielle Probleme\n‚Ä¢ Certificate Store Compliance Reporting gew√§hrleistet Einhaltung regulatorischer Anforderungen und interner Richtlinien\n‚Ä¢ Certificate Store Disaster Recovery-Strategien gew√§hrleisten schnelle Wiederherstellung bei System-Ausf√§llen\n‚Ä¢ Certificate Store Performance Optimization-Tools identifizieren und beheben Engp√§sse in Certificate-Zugriffs-Workflows"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie gew√§hrleistet Windows Server Failover Clustering nahtlose PKI-Hochverf√ºgbarkeit in kritischen Enterprise-Umgebungen?',
        answer: "Windows Server Failover Clustering transformiert traditionelle Single-Point-of-Failure PKI-Architekturen in hochverf√ºgbare, resiliente Certificate Authority-Systeme, die kontinuierliche PKI-Services auch bei Hardware-Ausf√§llen oder Wartungsarbeiten gew√§hrleisten. Es etabliert PKI als gesch√§ftskritische Infrastruktur-Komponente, die nicht nur operative Kontinuit√§t sicherstellt, sondern auch als strategisches Fundament f√ºr unternehmensweite Digitalisierung und Sicherheitstransformation fungiert.\n\nüå≥ Windows Failover Cluster-Architektur f√ºr Certificate Authorities:\n‚Ä¢ Windows Server Failover Clustering etabliert Active-Passive Certificate Authority-Konfigurationen mit automatischem Failover bei Node-Ausf√§llen\n‚Ä¢ Shared Storage-Integration gew√§hrleistet konsistente Certificate Authority-Datenbank-Verf√ºgbarkeit √ºber alle Cluster-Nodes hinweg\n‚Ä¢ Cluster-aware Certificate Authority-Services erm√∂glichen nahtlose Failover-Operationen ohne Service-Unterbrechung\n‚Ä¢ Virtual Network Name-Management gew√§hrleistet konsistente Certificate Authority-Erreichbarkeit unabh√§ngig vom aktiven Cluster-Node\n‚Ä¢ Cluster Resource Dependencies definieren optimale Startup-Sequenzen und Abh√§ngigkeiten zwischen PKI-Komponenten\n\nüîó High Availability Certificate Authority-Database-Management:\n‚Ä¢ SQL Server Always On Availability Groups gew√§hrleisten hochverf√ºgbare Certificate Authority-Datenbank-Replikation\n‚Ä¢ Certificate Authority-Database Backup und Recovery-Strategien minimieren Recovery Time Objectives bei Disaster-Szenarien\n‚Ä¢ Database Transaction Log-Management gew√§hrleistet Konsistenz und Integrit√§t von Certificate-Ausstellungs-Transaktionen\n‚Ä¢ Database Performance Monitoring identifiziert Engp√§sse und optimiert Certificate-Ausstellungs-Performance\n‚Ä¢ Database Security Hardening sch√ºtzt kritische Certificate Authority-Daten vor unbefugtem Zugriff\n\nüö® Automated Failover und Recovery-Mechanismen:\n‚Ä¢ Cluster Health Monitoring √ºberwacht Certificate Authority-Service-Status und initiiert automatische Failover-Operationen\n‚Ä¢ Certificate Authority-Service Dependencies gew√§hrleisten koordinierte Failover-Sequenzen f√ºr abh√§ngige PKI-Komponenten\n‚Ä¢ Failover Validation-Scripts √ºberpr√ºfen Certificate Authority-Funktionalit√§t nach Failover-Operationen\n‚Ä¢ Automated Recovery-Procedures minimieren Mean Time To Recovery bei Certificate Authority-Ausf√§llen\n‚Ä¢ Failover Notification-Systems informieren Administratoren √ºber Cluster-Status-√Ñnderungen und erforderliche Ma√ünahmen\n\nüìä Load Balancing und Performance-Optimierung:\n‚Ä¢ Network Load Balancing f√ºr Certificate Authority-Web-Services gew√§hrleistet optimale Verteilung von Certificate-Requests\n‚Ä¢ Certificate Authority-Performance Counters erm√∂glichen kontinuierliches Monitoring von PKI-Service-Performance\n‚Ä¢ Capacity Planning-Tools prognostizieren Certificate Authority-Ressourcenbedarf basierend auf historischen Verwendungsmustern\n‚Ä¢ Certificate Authority-Scaling-Strategien erm√∂glichen horizontale Erweiterung bei steigenden PKI-Anforderungen\n‚Ä¢ Performance Tuning-Guidelines optimieren Certificate Authority-Konfiguration f√ºr maximale Durchsatzraten\n\nüõ°Ô∏è Security und Compliance in Cluster-Umgebungen:\n‚Ä¢ Cluster Security Hardening gew√§hrleist Schutz kritischer Certificate Authority-Infrastrukturen vor Sicherheitsbedrohungen\n‚Ä¢ Certificate Authority-Cluster Audit Logging dokumentiert alle PKI-Operationen f√ºr Compliance und Forensik-Zwecke\n‚Ä¢ Role-based Access Control f√ºr Cluster-Management gew√§hrleistet, dass nur autorisierte Administratoren Certificate Authority-Cluster verwalten k√∂nnen\n‚Ä¢ Certificate Authority-Cluster Backup-Strategien gew√§hrleisten langfristige Verf√ºgbarkeit kritischer PKI-Daten\n‚Ä¢ Disaster Recovery Testing validiert Certificate Authority-Cluster Recovery-Procedures und identifiziert Verbesserungspotenziale\n\n‚öôÔ∏è Operational Excellence und Management-Integration:\n‚Ä¢ System Center Operations Manager-Integration erm√∂glicht umfassendes Monitoring von Certificate Authority-Cluster-Health\n‚Ä¢ PowerShell-basierte Cluster-Management-Scripts automatisieren Routine-Wartungsaufgaben und Failover-Tests\n‚Ä¢ Certificate Authority-Cluster Documentation gew√§hrleistet Wissenstransfer und erleichtert Troubleshooting-Prozesse\n‚Ä¢ Change Management-Procedures koordinieren Certificate Authority-Cluster-Updates mit Gesch√§ftsanforderungen\n‚Ä¢ Certificate Authority-Cluster Performance Reporting generiert regelm√§√üige Berichte √ºber Verf√ºgbarkeit und Performance-Metriken"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
