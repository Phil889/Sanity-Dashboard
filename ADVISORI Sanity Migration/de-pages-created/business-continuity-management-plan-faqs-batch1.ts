import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Business Continuity Management Plan page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'business-continuity-management-plan' })
    
    if (!existingDoc) {
      throw new Error('Document "business-continuity-management-plan" not found')
    }
    
    // Create new FAQs for BCM Plan fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was ist ein Business Continuity Management Plan und welche strukturellen Komponenten umfasst er?',
        answer: "Ein Business Continuity Management Plan ist ein strukturiertes Dokument, das alle notwendigen Ma√ünahmen, Prozesse und Ressourcen f√ºr die Aufrechterhaltung kritischer Gesch√§ftsfunktionen w√§hrend und nach St√∂rungen definiert. Er bildet die operative Grundlage f√ºr effektive Kontinuit√§tssicherung und transformiert strategische BCM-Konzepte in konkrete Handlungsanweisungen.\n\nüìã Plan-Architektur und Strukturkomponenten:\n‚Ä¢ Ein BCM-Plan folgt einer hierarchischen Struktur mit strategischen, taktischen und operativen Ebenen f√ºr klare Verantwortlichkeiten\n‚Ä¢ Modularer Aufbau erm√∂glicht flexible Anpassung an verschiedene St√∂rungsszenarien und Organisationsbereiche\n‚Ä¢ Standardisierte Dokumentationsformate gew√§hrleisten Konsistenz und erleichtern Verst√§ndnis unter Zeitdruck\n‚Ä¢ Integrierte Checklisten und Workflows f√ºhren systematisch durch kritische Entscheidungsprozesse\n‚Ä¢ Cross-referenzierte Anh√§nge und Ressourcenlisten bieten schnellen Zugriff auf ben√∂tigte Informationen\n\nüéØ Kritische Gesch√§ftsfunktionen und Priorit√§ten:\n‚Ä¢ Business Impact Analysis definiert kritische Prozesse und deren Wiederherstellungszeiten\n‚Ä¢ Priorisierungsmatrix strukturiert Ressourcenallokation basierend auf Gesch√§ftskritikalit√§t\n‚Ä¢ Abh√§ngigkeitsmapping visualisiert Interdependenzen zwischen verschiedenen Gesch√§ftsbereichen\n‚Ä¢ Service Level Agreements definieren minimale Betriebsanforderungen f√ºr kritische Funktionen\n‚Ä¢ Eskalationsmatrizen regeln Entscheidungsbefugnisse bei verschiedenen St√∂rungsgraden\n\nüîÑ Aktivierungsmechanismen und Entscheidungsstrukturen:\n‚Ä¢ Klare Aktivierungskriterien definieren wann und wie der Plan in Kraft tritt\n‚Ä¢ Entscheidungsb√§ume f√ºhren durch komplexe Situationsbewertungen und Handlungsoptionen\n‚Ä¢ Kommunikationskaskaden gew√§hrleisten zeitnahe Information aller relevanten Stakeholder\n‚Ä¢ Rollback-Mechanismen erm√∂glichen kontrollierte R√ºckkehr zum Normalbetrieb\n‚Ä¢ Dokumentationspflichten sichern Nachvollziehbarkeit aller getroffenen Ma√ünahmen\n\nüë• Rollen und Verantwortlichkeiten:\n‚Ä¢ Crisis Management Team mit definierten Rollen und Entscheidungsbefugnissen\n‚Ä¢ Fachbereichsverantwortliche f√ºr spezifische Wiederherstellungsaktivit√§ten\n‚Ä¢ Kommunikationsverantwortliche f√ºr interne und externe Stakeholder-Information\n‚Ä¢ Technische Teams f√ºr IT-Systeme und Infrastruktur-Wiederherstellung\n‚Ä¢ Externe Dienstleister und deren Integration in Wiederherstellungsprozesse\n\nüìû Kommunikations- und Koordinationsstrukturen:\n‚Ä¢ Mehrstufige Kommunikationspl√§ne f√ºr verschiedene Zielgruppen und Situationen\n‚Ä¢ Alternative Kommunikationskan√§le f√ºr den Fall von Infrastrukturausf√§llen\n‚Ä¢ Stakeholder-spezifische Messaging-Templates f√ºr konsistente Kommunikation\n‚Ä¢ Medien- und √ñffentlichkeitsarbeit-Strategien zum Schutz der Reputation\n‚Ä¢ Regelm√§√üige Status-Updates und Fortschrittsberichte w√§hrend der Krisenbew√§ltigung\n\nüõ†Ô∏è Ressourcen und Infrastruktur-Komponenten:\n‚Ä¢ Detaillierte Inventarlisten kritischer Ressourcen und deren Verf√ºgbarkeit\n‚Ä¢ Alternative Arbeitspl√§tze und Backup-Standorte mit vollst√§ndiger Ausstattung\n‚Ä¢ Technologie-Ressourcen einschlie√ülich Hardware, Software und Datenbackups\n‚Ä¢ Externe Dienstleister und Lieferanten f√ºr kritische Unterst√ºtzungsleistungen\n‚Ä¢ Finanzielle Ressourcen und Budgetfreigaben f√ºr Notfallma√ünahmen\n\nüìä Monitoring und Fortschrittsverfolgung:\n‚Ä¢ Key Performance Indicators zur Messung der Wiederherstellungseffektivit√§t\n‚Ä¢ Echtzeit-Dashboards f√ºr kontinuierliche Situations√ºberwachung\n‚Ä¢ Meilenstein-Tracking f√ºr systematische Fortschrittskontrolle\n‚Ä¢ Qualit√§tssicherungs-Mechanismen zur Validierung wiederhergestellter Funktionen\n‚Ä¢ Lessons-Learned-Dokumentation f√ºr kontinuierliche Planverbesserung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie erfolgt die systematische Entwicklung und Strukturierung eines effektiven BCM-Plans?',
        answer: "Die systematische Entwicklung eines BCM-Plans erfordert einen methodischen Ansatz, der organisationsspezifische Anforderungen mit bew√§hrten Planungsstandards verbindet. Ein strukturierter Entwicklungsprozess gew√§hrleistet Vollst√§ndigkeit, Konsistenz und operative Wirksamkeit des resultierenden Plans.\n\nüîç Anforderungsanalyse und Scope-Definition:\n‚Ä¢ Comprehensive Business Impact Analysis identifiziert kritische Gesch√§ftsprozesse und deren Abh√§ngigkeiten\n‚Ä¢ Risk Assessment bewertet potenzielle Bedrohungen und deren Auswirkungen auf verschiedene Gesch√§ftsbereiche\n‚Ä¢ Stakeholder-Mapping erfasst alle relevanten internen und externen Interessensgruppen\n‚Ä¢ Regulatory Requirements Analysis ber√ºcksichtigt branchenspezifische Compliance-Anforderungen\n‚Ä¢ Organisational Context Review analysiert Unternehmenskultur, Struktur und verf√ºgbare Ressourcen\n\nüìê Plan-Architektur und Design-Prinzipien:\n‚Ä¢ Modularer Aufbau erm√∂glicht flexible Anpassung an verschiedene St√∂rungsszenarien\n‚Ä¢ Hierarchische Struktur trennt strategische Entscheidungen von operativen Ma√ünahmen\n‚Ä¢ Standardisierte Templates gew√§hrleisten Konsistenz √ºber verschiedene Gesch√§ftsbereiche\n‚Ä¢ Cross-funktionale Integration verbindet verschiedene Organisationseinheiten\n‚Ä¢ Skalierbare Strukturen unterst√ºtzen sowohl lokale als auch unternehmensweite St√∂rungen\n\nüìù Inhaltsentwicklung und Dokumentationsstandards:\n‚Ä¢ Strukturierte Informationssammlung durch systematische Interviews und Workshops\n‚Ä¢ Collaborative Content Creation mit allen relevanten Fachbereichen und Stakeholdern\n‚Ä¢ Standardisierte Dokumentationsformate f√ºr einheitliche Darstellung und Verst√§ndlichkeit\n‚Ä¢ Version Control Mechanismen f√ºr nachvollziehbare Entwicklung und √Ñnderungsverfolgung\n‚Ä¢ Quality Assurance Prozesse zur Validierung von Vollst√§ndigkeit und Genauigkeit\n\nüéØ Szenario-basierte Planentwicklung:\n‚Ä¢ Multiple Scenario Planning f√ºr verschiedene St√∂rungstypen und Schweregrade\n‚Ä¢ Worst-Case-Analysen zur Vorbereitung auf extreme Situationen\n‚Ä¢ Cascading Failure Modeling f√ºr komplexe Interdependenz-Szenarien\n‚Ä¢ Recovery Time Objective Definition f√ºr verschiedene Kritikalit√§tsstufen\n‚Ä¢ Alternative Strategy Development f√ºr verschiedene Ressourcenverf√ºgbarkeiten\n\nüîó Integration und Koordination:\n‚Ä¢ Cross-departmental Alignment gew√§hrleistet organisationsweite Konsistenz\n‚Ä¢ External Stakeholder Integration bindet Lieferanten, Partner und Dienstleister ein\n‚Ä¢ Technology Integration verbindet BCM-Pl√§ne mit IT-Disaster-Recovery-Strategien\n‚Ä¢ Regulatory Compliance Mapping stellt Einhaltung aller relevanten Vorschriften sicher\n‚Ä¢ Corporate Strategy Alignment verbindet BCM-Planung mit Unternehmenszielen\n\n‚úÖ Validierung und Qualit√§tssicherung:\n‚Ä¢ Expert Review Prozesse durch interne und externe BCM-Spezialisten\n‚Ä¢ Stakeholder Validation durch systematische Review-Zyklen mit allen Beteiligten\n‚Ä¢ Completeness Checks anhand standardisierter Checklisten und Frameworks\n‚Ä¢ Consistency Verification √ºber verschiedene Plan-Komponenten und Gesch√§ftsbereiche\n‚Ä¢ Usability Testing zur √úberpr√ºfung der praktischen Anwendbarkeit unter Stress\n\nüîÑ Iterative Verfeinerung und Optimierung:\n‚Ä¢ Feedback Integration aus Stakeholder-Reviews und Expertenbeurteilungen\n‚Ä¢ Continuous Improvement durch systematische Identifikation von Verbesserungspotenzialen\n‚Ä¢ Benchmark Comparison mit Industry Best Practices und Standards\n‚Ä¢ Pilot Testing in kontrollierten Umgebungen vor vollst√§ndiger Implementierung\n‚Ä¢ Change Management f√ºr systematische Einf√ºhrung von Planaktualisierungen\n\nüìö Dokumentation und Wissensmanagement:\n‚Ä¢ Comprehensive Documentation aller Entwicklungsentscheidungen und Rationale\n‚Ä¢ Knowledge Transfer Mechanismen f√ºr nachhaltige Organisationskompetenz\n‚Ä¢ Training Material Development f√ºr effektive Planvermittlung\n‚Ä¢ Best Practice Capture f√ºr zuk√ºnftige Planentwicklungsprojekte\n‚Ä¢ Institutional Memory Preservation durch strukturierte Wissensdokumentation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Implementierungsstrategien und Rollout-Ans√§tze haben sich f√ºr BCM-Pl√§ne bew√§hrt?',
        answer: "Die erfolgreiche Implementierung von BCM-Pl√§nen erfordert strategische Rollout-Ans√§tze, die organisationale Ver√§nderungen systematisch managen und nachhaltige Adoption sicherstellen. Bew√§hrte Implementierungsstrategien kombinieren strukturierte Phasenplanung mit adaptivem Change Management f√ºr optimale Akzeptanz und Wirksamkeit.\n\nüéØ Phasenweise Implementierungsstrategie:\n‚Ä¢ Pilot Phase mit ausgew√§hlten Gesch√§ftsbereichen zur Validierung und Optimierung\n‚Ä¢ Schrittweise Ausweitung auf weitere Organisationseinheiten basierend auf Lessons Learned\n‚Ä¢ Parallel Implementation f√ºr kritische Bereiche mit beschleunigten Zeitpl√§nen\n‚Ä¢ Staged Rollout mit definierten Meilensteinen und Go/No-Go-Entscheidungspunkten\n‚Ä¢ Full Deployment erst nach erfolgreicher Validierung aller Komponenten\n\nüë• Stakeholder-Engagement und Change Management:\n‚Ä¢ Executive Sponsorship durch sichtbare Unterst√ºtzung der F√ºhrungsebene\n‚Ä¢ Champion Network mit BCM-Botschaftern in allen Gesch√§ftsbereichen\n‚Ä¢ Cross-functional Teams f√ºr koordinierte Implementierung √ºber Abteilungsgrenzen\n‚Ä¢ Resistance Management durch proaktive Identifikation und Adressierung von Bedenken\n‚Ä¢ Cultural Integration durch Verbindung von BCM-Werten mit Organisationskultur\n\nüìö Schulungs- und Awareness-Programme:\n‚Ä¢ Role-specific Training f√ºr verschiedene Verantwortlichkeitsebenen und Funktionen\n‚Ä¢ Hands-on Workshops mit praktischen √úbungen und Szenario-Simulationen\n‚Ä¢ E-Learning Modules f√ºr flexible und skalierbare Wissensvermittlung\n‚Ä¢ Regular Refresher Sessions zur Aufrechterhaltung von Kompetenz und Awareness\n‚Ä¢ Certification Programs f√ºr kritische Rollen und Verantwortlichkeiten\n\nüîß Technische Integration und Tool-Deployment:\n‚Ä¢ System Integration mit bestehenden IT-Infrastrukturen und Business-Anwendungen\n‚Ä¢ Automated Workflow Implementation f√ºr standardisierte Prozessabl√§ufe\n‚Ä¢ Communication Platform Setup f√ºr effektive Krisenkommunikation\n‚Ä¢ Document Management Systems f√ºr zentrale Planverwaltung und -zugriff\n‚Ä¢ Monitoring Dashboard Deployment f√ºr Echtzeit-Situations√ºberwachung\n\nüìä Performance Monitoring und Feedback-Mechanismen:\n‚Ä¢ Key Performance Indicators zur Messung der Implementierungseffektivit√§t\n‚Ä¢ Regular Pulse Surveys zur Erfassung von Stakeholder-Feedback und Zufriedenheit\n‚Ä¢ Usage Analytics f√ºr datenbasierte Optimierung von Plan-Komponenten\n‚Ä¢ Incident Tracking zur kontinuierlichen Verbesserung basierend auf realen Erfahrungen\n‚Ä¢ Success Metrics Definition f√ºr objektive Bewertung des Implementierungserfolgs\n\nüé™ √úbungs- und Testprogramme:\n‚Ä¢ Tabletop Exercises f√ºr risikoarme Validierung von Plan-Komponenten\n‚Ä¢ Functional Exercises mit spezifischen Gesch√§ftsbereichen und Prozessen\n‚Ä¢ Full-scale Simulations f√ºr comprehensive Systemtests unter realistischen Bedingungen\n‚Ä¢ Surprise Drills zur √úberpr√ºfung der tats√§chlichen Reaktionsf√§higkeit\n‚Ä¢ Cross-organizational Exercises mit externen Partnern und Dienstleistern\n\nüìû Kommunikations- und Marketing-Strategien:\n‚Ä¢ Internal Marketing Campaigns zur Steigerung von Awareness und Engagement\n‚Ä¢ Success Story Sharing zur Demonstration von Wert und Nutzen\n‚Ä¢ Regular Updates √ºber Implementierungsfortschritt und Erfolge\n‚Ä¢ Feedback Channels f√ºr kontinuierliche Verbesserungsvorschl√§ge\n‚Ä¢ Recognition Programs f√ºr herausragende Beitr√§ge zur BCM-Implementierung\n\nüîÑ Kontinuierliche Optimierung und Anpassung:\n‚Ä¢ Agile Implementation Approach mit regelm√§√üigen Sprint-Reviews und Anpassungen\n‚Ä¢ Feedback Loop Integration f√ºr systematische Einarbeitung von Verbesserungsvorschl√§gen\n‚Ä¢ Benchmark Reviews gegen Industry Best Practices und Standards\n‚Ä¢ Technology Evolution Management f√ºr Integration neuer Tools und Technologien\n‚Ä¢ Organizational Change Adaptation bei strukturellen oder strategischen Ver√§nderungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie werden BCM-Pl√§ne systematisch getestet, validiert und kontinuierlich verbessert?',
        answer: "Die systematische Testung und Validierung von BCM-Pl√§nen ist entscheidend f√ºr deren operative Wirksamkeit und kontinuierliche Verbesserung. Ein strukturiertes Test- und Validierungsframework gew√§hrleistet, dass Pl√§ne unter realen Bedingungen funktionieren und sich kontinuierlich an ver√§ndernde Anforderungen anpassen.\n\nüß™ Mehrstufiges Testframework:\n‚Ä¢ Desk-based Reviews f√ºr initiale Vollst√§ndigkeits- und Konsistenzpr√ºfungen\n‚Ä¢ Tabletop Exercises mit strukturierten Diskussionen und Szenario-Durchspielen\n‚Ä¢ Functional Tests f√ºr spezifische Plan-Komponenten und Prozessabl√§ufe\n‚Ä¢ Simulation Exercises mit realistischen St√∂rungsszenarien und Zeitdruck\n‚Ä¢ Live Exercises mit tats√§chlicher Aktivierung von Backup-Systemen und -Prozessen\n\nüìã Szenario-basierte Validierungsans√§tze:\n‚Ä¢ Multiple Threat Scenarios f√ºr verschiedene St√∂rungstypen und Schweregrade\n‚Ä¢ Cascading Failure Simulations f√ºr komplexe Interdependenz-Situationen\n‚Ä¢ Time-compressed Exercises zur √úberpr√ºfung der Reaktionsgeschwindigkeit\n‚Ä¢ Resource Constraint Scenarios mit limitierten Verf√ºgbarkeiten\n‚Ä¢ Cross-functional Coordination Tests f√ºr organisations√ºbergreifende Zusammenarbeit\n\nüéØ Performance-Messung und KPI-Tracking:\n‚Ä¢ Recovery Time Objectives Measurement f√ºr kritische Gesch√§ftsprozesse\n‚Ä¢ Communication Effectiveness Assessment durch Stakeholder-Feedback\n‚Ä¢ Decision Quality Evaluation basierend auf Entscheidungsgeschwindigkeit und -genauigkeit\n‚Ä¢ Resource Utilization Efficiency zur Optimierung von Ressourcenallokation\n‚Ä¢ Stakeholder Satisfaction Metrics f√ºr ganzheitliche Wirksamkeitsbewertung\n\nüîç Systematische Schwachstellenanalyse:\n‚Ä¢ Gap Analysis zur Identifikation von L√ºcken in Plan-Abdeckung und -Tiefe\n‚Ä¢ Failure Mode Analysis f√ºr potenzielle Versagenspunkte und deren Auswirkungen\n‚Ä¢ Dependency Vulnerability Assessment f√ºr kritische Abh√§ngigkeiten\n‚Ä¢ Communication Breakdown Analysis zur Verbesserung von Informationsfl√ºssen\n‚Ä¢ Human Factor Evaluation f√ºr verhaltensbasierte Optimierungen\n\nüìä Datensammlung und Analyse-Methoden:\n‚Ä¢ Structured Observation Protocols w√§hrend √úbungen und Tests\n‚Ä¢ Participant Feedback Surveys f√ºr qualitative Insights und Verbesserungsvorschl√§ge\n‚Ä¢ Performance Metrics Tracking durch automatisierte Monitoring-Systeme\n‚Ä¢ Video Analysis f√ºr detaillierte Verhaltens- und Prozessanalyse\n‚Ä¢ Comparative Benchmarking gegen Industry Standards und Best Practices\n\nüîÑ Kontinuierliche Verbesserungs-Zyklen:\n‚Ä¢ After Action Reviews nach jeder √úbung oder realem Ereignis\n‚Ä¢ Lessons Learned Integration in Plan-Updates und Verbesserungen\n‚Ä¢ Regular Plan Refresh Cycles basierend auf organisationalen Ver√§nderungen\n‚Ä¢ Technology Evolution Adaptation f√ºr neue Tools und Systeme\n‚Ä¢ Regulatory Update Integration bei √Ñnderungen von Compliance-Anforderungen\n\nüìà Maturity Assessment und Entwicklungspfade:\n‚Ä¢ BCM Maturity Model Application zur Bewertung des aktuellen Entwicklungsstands\n‚Ä¢ Capability Gap Analysis f√ºr systematische Kompetenzentwicklung\n‚Ä¢ Benchmark Comparison mit f√ºhrenden Organisationen und Standards\n‚Ä¢ Roadmap Development f√ºr strukturierte Weiterentwicklung\n‚Ä¢ Investment Prioritization basierend auf Kosten-Nutzen-Analysen\n\nüéì Organisationales Lernen und Wissensmanagement:\n‚Ä¢ Knowledge Capture Mechanisms f√ºr systematische Erfahrungsdokumentation\n‚Ä¢ Best Practice Sharing zwischen verschiedenen Organisationseinheiten\n‚Ä¢ External Learning Integration durch Konferenzen, Netzwerke und Partnerschaften\n‚Ä¢ Innovation Adoption f√ºr neue Methoden und Technologien\n‚Ä¢ Cultural Learning Reinforcement durch Erfolgsgeschichten und Anerkennungsprogramme"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
