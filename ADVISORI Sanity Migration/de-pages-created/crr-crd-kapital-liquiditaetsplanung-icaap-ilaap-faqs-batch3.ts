import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating CRR/CRD Kapital- und Liquidit√§tsplanung (ICAAP/ILAAP) page with FAQs batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'crr-crd-kapital-liquiditaetsplanung-icaap-ilaap' })
    
    if (!existingDoc) {
      throw new Error('Document "crr-crd-kapital-liquiditaetsplanung-icaap-ilaap" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Welche Rolle spielt die Datenaggregation und -qualit√§t im ICAAP/ILAAP und wie k√∂nnen Finanzinstitute diese systematisch verbessern?",
        answer: "Die Datenqualit√§t und -aggregation stellt das Fundament eines jeden ICAAP/ILAAP-Frameworks dar. Selbst die fortschrittlichsten Methoden und Prozesse k√∂nnen keine zuverl√§ssigen Ergebnisse liefern, wenn die zugrundeliegenden Daten l√ºckenhaft, inkonsistent oder unzureichend granular sind. Eine systematische Verbesserung der Datenbasis erfordert sowohl technologische als auch organisatorische Ma√ünahmen und schafft einen signifikanten strategischen Mehrwert √ºber die regulatorische Compliance hinaus.\n\nüîç Zentrale Datenchallenges im ICAAP/ILAAP-Kontext:\n‚Ä¢ Datenintegration und -harmonisierung: Zusammenf√ºhrung heterogener Datenquellen aus unterschiedlichen Systemen und Gesch√§ftsbereichen zu einer konsistenten, qualit√§tsgesicherten Gesamtsicht auf Risiko- und Kapitaldaten.\n‚Ä¢ Granularit√§tsanforderungen: Sicherstellung der erforderlichen Detailtiefe f√ºr verschiedene Analyse- und Reportingzwecke, von aggregierten Management-Dashboards bis hin zu granularen Stress-Szenarien auf Einzelpositionsebene.\n‚Ä¢ Zeitliche Konsistenz: Harmonisierung unterschiedlicher zeitlicher Bez√ºge (Point-in-Time vs. Through-the-Cycle Betrachtungen) und konsistente historische Zeitreihen als Basis f√ºr zukunftsgerichtete Projektionen.\n‚Ä¢ Datenlineage und Governance: Nachvollziehbare Dokumentation von Datenherkunft, -transformationen und -verantwortlichkeiten √ºber den gesamten ICAAP/ILAAP-Prozess hinweg.\n\nüõ†Ô∏è Strategische Hebel zur Datenqualit√§tsverbesserung:\n‚Ä¢ Datenqualit√§tsmanagementsystem: Implementierung eines systematischen DQMS mit klaren Metriken, Verantwortlichkeiten und Eskalationswegen speziell f√ºr ICAAP/ILAAP-relevante Daten.\n‚Ä¢ Data Ownership Matrix: Etablierung eindeutiger Verantwortlichkeiten f√ºr Datenqualit√§t mit definierten Data Owners, Data Stewards und Data Custodians entlang der gesamten Datenlieferkette.\n‚Ä¢ Automatisierte Datenqualit√§tskontrollen: Integration von Plausibilit√§tspr√ºfungen, Konsistenzkontrollen und Business Rules direkt in die Datenverarbeitungsprozesse mit automatisierten Alerting-Mechanismen.\n‚Ä¢ Data Lineage Framework: Aufbau eines umfassenden Lineage-Systems, das den vollst√§ndigen Datenlebenszyklus von der Quelle bis zum Report transparent dokumentiert und auditierbar macht.\n\nüíæ Technologische Enabler f√ºr exzellente Datenaggregation:\n‚Ä¢ Integrierte Datenplattform: Etablierung einer einheitlichen Datenplattform f√ºr alle ICAAP/ILAAP-relevanten Daten, die als Single Point of Truth f√ºr Risikomessung, Stresstesting und Reporting dient.\n‚Ä¢ Metadata Management: Implementierung eines umfassenden Metadatenmanagements, das technische und fachliche Metadaten verkn√ºpft und die Interpretierbarkeit der Daten sicherstellt.\n‚Ä¢ Self-Service Analytics f√ºr Risk & Finance: Bereitstellung flexibler Analyseumgebungen, die es Fachexperten erm√∂glichen, Daten eigenst√§ndig zu analysieren und ad-hoc Fragestellungen zu beantworten.\n‚Ä¢ Reconciliation Engine: Aufbau automatisierter Abstimmungsmechanismen zwischen unterschiedlichen Datensichten und Aggregationsebenen zur Sicherstellung konsistenter Zahlenwerke."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Wie kann die Gesch√§ftsleitung die Ergebnisse des ICAAP/ILAAP effektiv f√ºr strategische Entscheidungen nutzen und welche Governance-Strukturen sind daf√ºr erforderlich?",
        answer: "Die strategische Nutzung von ICAAP/ILAAP-Erkenntnissen durch die Gesch√§ftsleitung transformiert diese regulatorischen Prozesse von reinen Compliance-√úbungen zu wertvollen Steuerungsinstrumenten. Eine effektive Integration in die Unternehmensf√ºhrung erfordert sowohl geeignete Governance-Strukturen als auch eine zielgruppengerechte Aufbereitung der komplexen Risiko- und Kapitalinformationen, um fundierte strategische Entscheidungen zu erm√∂glichen.\n\nüß† Strategische Anwendungsbereiche f√ºr ICAAP/ILAAP-Erkenntnisse:\n‚Ä¢ Gesch√§ftsmodelloptimierung: Nutzung von Risiko-Rendite-Analysen zur Identifikation von Gesch√§ftsfeldern mit suboptimalem Kapitalertrag und Entwicklung gezielter Optimierungsma√ünahmen.\n‚Ä¢ Capital Planning & Allocation: Entwicklung einer zukunftsorientierten Kapitalplanung und risikoadjustierten Ressourcenallokation auf Basis granularer ICAAP-Ergebnisse und Szenarioanalysen.\n‚Ä¢ Produktentwicklung und Pricing: Integration von Kapital- und Liquidit√§tskosten in die Produkt- und Preisgestaltung zur Sicherstellung nachhaltiger Profitabilit√§t unter Ber√ºcksichtigung regulatorischer Anforderungen.\n‚Ä¢ M&A Due Diligence: Bewertung potenzieller Akquisitions- oder Desinvestitionsentscheidungen hinsichtlich ihrer Auswirkungen auf das Risikoprofil und die Kapital-/Liquidit√§tsposition des Gesamtinstituts.\n\nüèõÔ∏è Governance-Strukturen f√ºr effektive Entscheidungsprozesse:\n‚Ä¢ Integriertes Komitee-System: Etablierung einer abgestimmten Komitee-Struktur, die Kapital-, Liquidit√§ts- und Risikothemen in einem koh√§renten Rahmen behandelt und klare Entscheidungswege definiert.\n‚Ä¢ Risk Appetite Framework: Entwicklung eines umfassenden RAF, das strategische Ziele mit konkreten Risikolimits verkn√ºpft und als Leitplanke f√ºr Gesch√§ftsentscheidungen dient.\n‚Ä¢ Management Action Framework: Definition klar definierter Eskalations- und Handlungsstufen bei Ann√§herung an oder √úberschreitung von Risikotoleranzen, mit vordefinierten Handlungsoptionen f√ºr verschiedene Szenarien.\n‚Ä¢ Three Lines of Defense: Klare Verankerung von ICAAP/ILAAP in allen drei Verteidigungslinien mit entsprechenden Rollen und Verantwortlichkeiten von der Gesch√§ftsebene bis zur internen Revision.\n\nüìä Decision-Enabling f√ºr die Gesch√§ftsleitung:\n‚Ä¢ Executive Dashboard: Entwicklung eines pr√§gnanten Management-Cockpits, das die wichtigsten ICAAP/ILAAP-Erkenntnisse visualisiert und strategische Implikationen hervorhebt.\n‚Ä¢ Impact Analysis: Bereitstellung intuitiver What-if-Analysetools, die der Gesch√§ftsleitung erm√∂glichen, die Auswirkungen strategischer Optionen auf Kapital und Liquidit√§t eigenst√§ndig zu simulieren.\n‚Ä¢ Strategic Link-up: Explizite Verkn√ºpfung von ICAAP/ILAAP-Ergebnissen mit strategischen Initiativen und KPIs in der regul√§ren Strategieplanung und -√ºberpr√ºfung.\n‚Ä¢ Capability Building: Gezielte Schulung und Sensibilisierung der Gesch√§ftsleitung f√ºr Kapital- und Liquidit√§tsthemen, um ein tieferes Verst√§ndnis f√ºr die strategischen Implikationen zu schaffen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Welche Ans√§tze empfiehlt ADVISORI zur Integration von Recovery Planning in ICAAP/ILAAP-Frameworks und wie k√∂nnen Synergien zwischen diesen regulatorischen Anforderungen genutzt werden?",
        answer: "Die Integration von Recovery Planning und ICAAP/ILAAP repr√§sentiert eine fortschrittliche Evolutionsstufe im regulatorischen Risikomanagement. Anstatt diese Anforderungen isoliert zu betrachten, schaffen integrierte Ans√§tze signifikante Synergien, reduzieren Redundanzen und etablieren ein konsistentes Rahmenwerk vom Business-as-usual-Betrieb bis hin zum Krisenmanagement. ADVISORI empfiehlt eine systematische Verzahnung dieser komplement√§ren Prozesse, um sowohl regulatorische Effizienz als auch strategischen Mehrwert zu maximieren.\n\nüîÑ Konzeptionelle Br√ºcken zwischen Recovery Planning und ICAAP/ILAAP:\n‚Ä¢ Kontinuum der Kapital- und Liquidit√§tssteuerung: Konzeptualisierung eines nahtlosen √úbergangs von der pr√§ventiven Steuerung (ICAAP/ILAAP) zum Krisenmanagement (Recovery Plan) mit konsistenten Metriken, Schwellenwerten und Governance-Strukturen.\n‚Ä¢ Harmonisierte Stresstest-Architektur: Entwicklung eines √ºbergreifenden Stresstesting-Frameworks, das sowohl die moderaten bis schweren Stressszenarien im ICAAP/ILAAP als auch die existenzbedrohenden Szenarien im Recovery Planning abdeckt.\n‚Ä¢ Integriertes Schwellenwert- und Eskalationssystem: Etablierung eines koh√§renten Systems von Fr√ºhwarnindikatoren, Schwellenwerten und Eskalationsstufen, das von normalen Gesch√§ftslimits √ºber Vorwarnlimits bis zu Recovery-Triggern reicht.\n‚Ä¢ Konsistente Management Actions: Harmonisierung der Managementma√ünahmen in ICAAP/ILAAP und Recovery Plan, mit einem graduellen Spektrum von pr√§ventiven Ma√ünahmen bis hin zu tiefgreifenden Wiederherstellungsoptionen.\n\nüìã Praktische Implementierungsans√§tze:\n‚Ä¢ Integrierte Governance-Strukturen: Etablierung gemeinsamer oder eng verzahnter Komiteestrukturen und Verantwortlichkeiten f√ºr ICAAP/ILAAP und Recovery Planning, um Konsistenz und Effizienz zu gew√§hrleisten.\n‚Ä¢ Gemeinsame Daten- und Methodenbasis: Nutzung einheitlicher Datenquellen, Modelle und Berechnungslogiken f√ºr beide Prozesse, um methodische Konsistenz sicherzustellen und Doppelarbeiten zu vermeiden.\n‚Ä¢ Harmonisiertes Szenariodesign: Entwicklung eines konsistenten Szenario-Frameworks, das von milden ICAAP-Szenarien √ºber schwere ICAAP-Szenarien bis hin zu Recovery-Szenarien reicht und auf gemeinsamen makro√∂konomischen Parametern basiert.\n‚Ä¢ Integrierte Dokumentation und Reporting: Aufbau einer koh√§renten Dokumentations- und Berichtsstruktur, die die Verbindungen zwischen ICAAP/ILAAP und Recovery Planning transparent macht und regulatorische Anforderungen effizient erf√ºllt.\n\nüîç Spezifische Synergiefelder:\n‚Ä¢ Reverse Stress Testing als Br√ºcke: Nutzung von Reverse Stress Tests als methodisches Bindeglied zwischen ICAAP/ILAAP und Recovery Planning, um kritische Vulnerabilit√§ten zu identifizieren und die Kalibrierung von Schwellenwerten zu unterst√ºtzen.\n‚Ä¢ Erweiterte Kapital- und Liquidit√§tsprojektionen: Entwicklung integrierter Projektionsmodelle, die sowohl das normale Gesch√§ft als auch Stresssituationen und Recovery-Ma√ünahmen abbilden k√∂nnen.\n‚Ä¢ Unified Risk Appetite Framework: Erweiterung des Risk Appetite Frameworks um Recovery-Dimensionen, mit einer klaren Abgrenzung zwischen Risk Appetite, Risk Tolerance und Recovery-Schwellen.\n‚Ä¢ Gemeinsame Validierung und Backtesting: Etablierung eines √ºbergreifenden Validierungsprozesses f√ºr Modelle, Annahmen und Schwellenwerte, der sowohl ICAAP/ILAAP als auch Recovery Planning abdeckt."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie k√∂nnen mittelgro√üe Institute ihre ICAAP/ILAAP-Prozesse proportional gestalten, um regulatorische Anforderungen effizient zu erf√ºllen und gleichzeitig gesch√§ftlichen Mehrwert zu schaffen?",
        answer: "Die Herausforderung f√ºr mittelgro√üe Institute besteht darin, einen proportionalen ICAAP/ILAAP-Ansatz zu entwickeln, der die regulatorischen Anforderungen ad√§quat erf√ºllt, ohne unverh√§ltnism√§√üige Ressourcen zu binden. Ein gut konzipierter proportionaler Ansatz fokussiert auf die institutsspezifischen Risiken, nutzt schlanke Methodologien und Prozesse und schafft dennoch einen substanziellen Mehrwert f√ºr die Unternehmenssteuerung. ADVISORI unterst√ºtzt Institute bei der Entwicklung ma√ügeschneiderter L√∂sungen, die Compliance und Effizienz in Einklang bringen.\n\n‚öñÔ∏è Proportionalit√§tsprinzipien f√ºr mittelgro√üe Institute:\n‚Ä¢ Risikoorientierte Ressourcenallokation: Fokussierung der analytischen Tiefe und methodischen Komplexit√§t auf die f√ºr das Institut wesentlichen Risikoarten, basierend auf einer systematischen Materialit√§tsanalyse.\n‚Ä¢ Skalierbare Methodologie: Implementierung skalierbarer Ans√§tze, die je nach Risikomaterialit√§t und Datenverf√ºgbarkeit unterschiedliche Komplexit√§tsstufen erm√∂glichen ‚Äì von einfachen Standardans√§tzen bis hin zu selektiv eingesetzten fortgeschrittenen Methoden.\n‚Ä¢ Pragmatische Governance: Etablierung einer effizienten Governance-Struktur, die regulatorische Anforderungen erf√ºllt, aber gleichzeitig dem Gesch√§ftsmodell und der Organisationsstruktur des Instituts angemessen ist.\n‚Ä¢ Technologische Verh√§ltnism√§√üigkeit: Selektiver Einsatz technologischer L√∂sungen mit Fokus auf Bereiche mit dem h√∂chsten Automatisierungspotenzial und Return-on-Investment.\n\nüîÑ Effiziente Prozessgestaltung:\n‚Ä¢ Integrierte Planung und Limitierung: Entwicklung eines integrierten Prozesses f√ºr strategische Planung, Kapital-/Liquidit√§tsplanung und Risikolimitierung, der Redundanzen minimiert und Konsistenz maximiert.\n‚Ä¢ Gestaffelte Berichterstattung: Implementierung eines abgestuften Berichtswesens mit unterschiedlichen Detaillierungsgraden f√ºr verschiedene Adressaten ‚Äì von pr√§gnanten Management-Dashboards bis hin zu regulatorisch erforderlichen Detailberichten.\n‚Ä¢ Zyklische Prozessoptimierung: Etablierung eines kontinuierlichen Verbesserungsprozesses mit regelm√§√üiger √úberpr√ºfung der ICAAP/ILAAP-Prozesse hinsichtlich ihrer Effizienz und ihres Mehrwerts.\n‚Ä¢ Toolgest√ºtzte Workflows: Einf√ºhrung schlanker, toolgest√ºtzter Workflows f√ºr wiederkehrende ICAAP/ILAAP-Aktivit√§ten wie Datensammlung, Validierung und Dokumentation.\n\nüìä Pragmatische Methodenans√§tze mit Mehrwert:\n‚Ä¢ Vereinfachte Risikoquantifizierung: Entwicklung proportionaler Quantifizierungsans√§tze f√ºr wesentliche Risiken, die komplexe Modelle auf die erforderlichen Kernelemente reduzieren, ohne deren Aussagekraft zu kompromittieren.\n‚Ä¢ Fokussierte Stresstest-Methodik: Implementierung einer schlanken, aber aussagekr√§ftigen Stresstesting-Architektur mit selektiven Sensitivit√§tsanalysen und gezielten Szenarioanalysen f√ºr die Hauptrisikotreiber.\n‚Ä¢ Hybride Kapital- und Liquidit√§tsplanung: Kombination von Top-down- und selektiven Bottom-up-Elementen in der Planung, mit Fokus auf wesentliche Gesch√§ftsbereiche und Risikotreiber.\n‚Ä¢ Modular erweiterbares Framework: Gestaltung eines modularen ICAAP/ILAAP-Frameworks, das mit dem Institut mitwachsen kann und bei Bedarf um zus√§tzliche Komponenten erg√§nzt werden kann."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
