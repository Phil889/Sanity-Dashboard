import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA Audit & Pr√ºfung page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-audit-pruefung' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-audit-pruefung" not found')
    }
    
    // Create new FAQs for technical audit procedures and methodologies
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'Welche technischen Audit-Verfahren sind f√ºr die Bewertung der IKT-Sicherheit unter DORA erforderlich?',
        answer: "Die technische Bewertung der IKT-Sicherheit unter DORA erfordert einen umfassenden und systematischen Ansatz, der √ºber traditionelle Sicherheitsaudits hinausgeht. Die Pr√ºfungsverfahren m√ºssen sowohl die technische Robustheit als auch die operative Resilienz der IKT-Infrastruktur validieren.\n\nüîç Umfassende Infrastruktur-Assessments:\n‚Ä¢ F√ºhren Sie detaillierte Architektur-Reviews durch, die alle kritischen IKT-Komponenten und deren Interdependenzen systematisch bewerten\n‚Ä¢ Analysieren Sie Netzwerk-Topologien und Segmentierungsstrategien zur Bewertung der Eind√§mmungsf√§higkeiten bei Sicherheitsvorf√§llen\n‚Ä¢ Bewerten Sie die Wirksamkeit von Zugangskontrollen und Identity-Management-Systemen durch technische Tests und Konfigurationsanalysen\n‚Ä¢ Pr√ºfen Sie Verschl√ºsselungsimplementierungen sowohl f√ºr Daten in Ruhe als auch f√ºr Daten in Bewegung\n‚Ä¢ Analysieren Sie Backup- und Recovery-Systeme einschlie√ülich deren Sicherheit gegen moderne Bedrohungen wie Ransomware\n\nüõ°Ô∏è Erweiterte Sicherheitstests:\n‚Ä¢ Implementieren Sie kontinuierliche Vulnerability-Assessments, die √ºber punktuelle Scans hinausgehen und dynamische Bedrohungslandschaften ber√ºcksichtigen\n‚Ä¢ F√ºhren Sie umfassende Penetrationstests durch, die realistische Angriffszenarien simulieren und die gesamte Attack-Surface abdecken\n‚Ä¢ Nutzen Sie Red-Team-Exercises zur Bewertung der Detection- und Response-F√§higkeiten unter realistischen Angriffsbedingungen\n‚Ä¢ Implementieren Sie Purple-Team-Aktivit√§ten zur kontinuierlichen Verbesserung der Sicherheitsposture\n‚Ä¢ F√ºhren Sie Social-Engineering-Tests durch, um die menschlichen Faktoren der Cybersecurity zu bewerten\n\nüìä Monitoring- und Detection-Bewertung:\n‚Ä¢ Bewerten Sie die Wirksamkeit von SIEM-Systemen und deren F√§higkeit zur Erkennung komplexer und persistenter Bedrohungen\n‚Ä¢ Testen Sie Incident-Response-Prozesse durch simulierte Sicherheitsvorf√§lle verschiedener Schweregrade\n‚Ä¢ Analysieren Sie Log-Management-Systeme und deren Vollst√§ndigkeit, Integrit√§t und Verf√ºgbarkeit\n‚Ä¢ Bewerten Sie Threat-Intelligence-Integration und deren Nutzung f√ºr proaktive Sicherheitsma√ünahmen\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit von Endpoint-Detection-and-Response-Systemen\n\nüîß Konfiguration und Compliance-Validierung:\n‚Ä¢ F√ºhren Sie automatisierte Configuration-Assessments durch, die Abweichungen von Sicherheitsstandards identifizieren\n‚Ä¢ Bewerten Sie Patch-Management-Prozesse und deren Wirksamkeit bei der zeitnahen Behebung von Schwachstellen\n‚Ä¢ Pr√ºfen Sie die Implementierung von Security-Hardening-Ma√ünahmen auf allen kritischen Systemen\n‚Ä¢ Analysieren Sie Change-Management-Prozesse und deren Integration von Sicherheits√ºberlegungen\n‚Ä¢ Validieren Sie die Wirksamkeit von Data-Loss-Prevention-Systemen\n\nüåê Cloud- und Hybrid-Umgebungen:\n‚Ä¢ Bewerten Sie Cloud-Security-Konfigurationen und deren Alignment mit Best Practices und Compliance-Anforderungen\n‚Ä¢ Pr√ºfen Sie die Sicherheit von API-Schnittstellen und deren Schutz gegen moderne Angriffsvektoren\n‚Ä¢ Analysieren Sie Container- und Microservices-Sicherheit in modernen Anwendungsarchitekturen\n‚Ä¢ Bewerten Sie die Sicherheit von DevOps-Pipelines und deren Integration von Security-by-Design-Prinzipien\n‚Ä¢ Pr√ºfen Sie Multi-Cloud- und Hybrid-Cloud-Sicherheitsstrategien"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'Wie f√ºhre ich effektive Business-Continuity- und Disaster-Recovery-Audits unter DORA durch?',
        answer: "Business-Continuity- und Disaster-Recovery-Audits unter DORA erfordern eine ganzheitliche Bewertung der organisatorischen Resilienz, die weit √ºber traditionelle IT-Recovery-Tests hinausgeht. Der Fokus liegt auf der Validierung der F√§higkeit zur Aufrechterhaltung kritischer Gesch√§ftsfunktionen unter verschiedenen St√∂rungsszenarien.\n\nüéØ Umfassende Resilienz-Bewertung:\n‚Ä¢ Bewerten Sie die Vollst√§ndigkeit und Aktualit√§t von Business-Impact-Analysen und deren Integration in die Gesamtstrategie\n‚Ä¢ Pr√ºfen Sie die Angemessenheit von Recovery-Time-Objectives und Recovery-Point-Objectives f√ºr alle kritischen Gesch√§ftsprozesse\n‚Ä¢ Analysieren Sie die Interdependenzen zwischen verschiedenen Gesch√§ftsfunktionen und deren Auswirkungen auf Recovery-Strategien\n‚Ä¢ Bewerten Sie die Wirksamkeit von Kommunikationsstrategien w√§hrend St√∂rungen und Krisensituationen\n‚Ä¢ Pr√ºfen Sie die Integration von Drittanbieter-Abh√§ngigkeiten in Business-Continuity-Planungen\n\nüîÑ Praktische Recovery-Tests:\n‚Ä¢ F√ºhren Sie umfassende Disaster-Recovery-Tests durch, die realistische St√∂rungsszenarien simulieren\n‚Ä¢ Testen Sie die Wirksamkeit von Backup-Systemen durch vollst√§ndige Restore-Verfahren unter Zeitdruck\n‚Ä¢ Bewerten Sie die Funktionsf√§higkeit alternativer Arbeitspl√§tze und deren technische Ausstattung\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit von Failover-Mechanismen f√ºr kritische Systeme und Anwendungen\n‚Ä¢ Validieren Sie die Koordination zwischen verschiedenen Recovery-Teams und deren Kommunikationswege\n\nüìã Governance- und Prozess-Audits:\n‚Ä¢ Bewerten Sie die Angemessenheit von Crisis-Management-Strukturen und Entscheidungsprozessen\n‚Ä¢ Pr√ºfen Sie die Vollst√§ndigkeit und Aktualit√§t von Notfallpl√§nen und deren regelm√§√üige Aktualisierung\n‚Ä¢ Analysieren Sie die Wirksamkeit von Eskalationsprozessen und deren Integration in die Gesamtorganisation\n‚Ä¢ Bewerten Sie die Qualit√§t von Post-Incident-Reviews und deren Beitrag zur kontinuierlichen Verbesserung\n‚Ä¢ Pr√ºfen Sie die Integration von Business-Continuity-√úberlegungen in strategische Entscheidungen\n\nüåê Technologie- und Infrastruktur-Resilienz:\n‚Ä¢ Bewerten Sie die Redundanz und Verf√ºgbarkeit kritischer IT-Infrastrukturen\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit von Load-Balancing und Failover-Mechanismen\n‚Ä¢ Analysieren Sie die Sicherheit und Verf√ºgbarkeit von Backup-Rechenzentren\n‚Ä¢ Bewerten Sie die Resilienz von Netzwerkverbindungen und Kommunikationssystemen\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit von Capacity-Management unter Stressbedingungen\n\nüé™ Szenario-basierte Stresstests:\n‚Ä¢ Entwickeln Sie realistische St√∂rungsszenarien basierend auf aktuellen Bedrohungslandschaften\n‚Ä¢ F√ºhren Sie Multi-Site-Ausfallszenarien durch, die komplexe Interdependenzen testen\n‚Ä¢ Simulieren Sie Cyber-Angriffe mit gleichzeitigen physischen St√∂rungen\n‚Ä¢ Testen Sie die Resilienz gegen Pandemie-√§hnliche Situationen mit eingeschr√§nkter Personalverf√ºgbarkeit\n‚Ä¢ Bewerten Sie die Wirksamkeit unter verschiedenen Zeitpunkten und Lastbedingungen\n\nüìà Kontinuierliche Verbesserung:\n‚Ä¢ Etablieren Sie systematische Lessons-Learned-Prozesse nach jedem Test oder tats√§chlichen Vorfall\n‚Ä¢ Implementieren Sie kontinuierliche Monitoring-Mechanismen f√ºr Business-Continuity-Readiness\n‚Ä¢ Entwickeln Sie Metriken zur Bewertung der Resilienz-Maturity der Organisation\n‚Ä¢ Schaffen Sie Feedback-Schleifen zwischen verschiedenen Stakeholdern und Funktionsbereichen\n‚Ä¢ Integrieren Sie externe Benchmarks und Best Practices in die kontinuierliche Verbesserung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'Welche Rolle spielt die Bewertung von Incident-Response-F√§higkeiten in DORA-Audits?',
        answer: "Die Bewertung von Incident-Response-F√§higkeiten ist ein zentraler Bestandteil von DORA-Audits, da sie die operative Resilienz einer Organisation unter realen Stressbedingungen validiert. Eine effektive Incident-Response-Bewertung geht √ºber die Pr√ºfung von Dokumenten hinaus und testet die tats√§chliche Reaktionsf√§higkeit der Organisation.\n\nüö® Umfassende Response-Capability-Bewertung:\n‚Ä¢ Bewerten Sie die Vollst√§ndigkeit und Aktualit√§t von Incident-Response-Pl√§nen f√ºr verschiedene Arten von IKT-St√∂rungen\n‚Ä¢ Pr√ºfen Sie die Angemessenheit von Incident-Klassifizierungssystemen und deren praktische Anwendung\n‚Ä¢ Analysieren Sie die Wirksamkeit von Detection-Mechanismen und deren F√§higkeit zur fr√ºhzeitigen Identifikation von Incidents\n‚Ä¢ Bewerten Sie die Qualit√§t von Eskalationsprozessen und deren Integration in die Organisationsstruktur\n‚Ä¢ Pr√ºfen Sie die Koordination zwischen internen Teams und externen Dienstleistern w√§hrend Incidents\n\n‚ö° Praktische Response-Tests:\n‚Ä¢ F√ºhren Sie Tabletop-Exercises durch, die verschiedene Incident-Szenarien simulieren und Entscheidungsprozesse testen\n‚Ä¢ Implementieren Sie Live-Fire-Exercises, die reale Systemst√∂rungen simulieren und Response-Zeiten messen\n‚Ä¢ Testen Sie die Wirksamkeit von Kommunikationssystemen w√§hrend simulierter Notf√§lle\n‚Ä¢ Bewerten Sie die Koordination zwischen verschiedenen Response-Teams unter Zeitdruck\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit von Backup-Kommunikationswegen bei Ausfall prim√§rer Systeme\n\nüìä Forensik- und Analyse-F√§higkeiten:\n‚Ä¢ Bewerten Sie die F√§higkeiten zur forensischen Analyse von Sicherheitsvorf√§llen\n‚Ä¢ Pr√ºfen Sie die Vollst√§ndigkeit und Integrit√§t von Log-Daten f√ºr Incident-Investigations\n‚Ä¢ Analysieren Sie die Wirksamkeit von Evidence-Collection-Prozessen\n‚Ä¢ Bewerten Sie die Qualit√§t von Root-Cause-Analysen und deren Beitrag zur Verbesserung\n‚Ä¢ Pr√ºfen Sie die Integration von Threat-Intelligence in Incident-Response-Aktivit√§ten\n\nüîÑ Recovery- und Restoration-Prozesse:\n‚Ä¢ Bewerten Sie die Wirksamkeit von Containment-Strategien f√ºr verschiedene Incident-Typen\n‚Ä¢ Pr√ºfen Sie die Qualit√§t von Eradication-Prozessen und deren Vollst√§ndigkeit\n‚Ä¢ Analysieren Sie Recovery-Verfahren und deren Validierung vor Wiederaufnahme des Normalbetriebs\n‚Ä¢ Bewerten Sie die Wirksamkeit von Lessons-Learned-Prozessen nach Incidents\n‚Ä¢ Pr√ºfen Sie die Integration von Incident-Erkenntnissen in pr√§ventive Sicherheitsma√ünahmen\n\nüìã Governance- und Compliance-Integration:\n‚Ä¢ Bewerten Sie die Integration von Incident-Response in die Gesamtstrategie f√ºr operationelle Resilienz\n‚Ä¢ Pr√ºfen Sie die Angemessenheit von Reporting-Mechanismen gegen√ºber Management und Aufsichtsbeh√∂rden\n‚Ä¢ Analysieren Sie die Compliance mit regulatorischen Meldepflichten w√§hrend und nach Incidents\n‚Ä¢ Bewerten Sie die Qualit√§t von Stakeholder-Kommunikation w√§hrend Krisensituationen\n‚Ä¢ Pr√ºfen Sie die Integration von Legal- und Compliance-√úberlegungen in Response-Prozesse\n\nüéØ Kontinuierliche Verbesserung:\n‚Ä¢ Etablieren Sie systematische Post-Incident-Review-Prozesse\n‚Ä¢ Implementieren Sie Metriken zur Bewertung der Response-Effektivit√§t\n‚Ä¢ Entwickeln Sie Benchmarking-Mechanismen mit Branchenstandards\n‚Ä¢ Schaffen Sie Feedback-Schleifen zwischen verschiedenen Organisationsebenen\n‚Ä¢ Integrieren Sie externe Threat-Intelligence in die kontinuierliche Verbesserung der Response-F√§higkeiten\n\nüåê Multi-Stakeholder-Koordination:\n‚Ä¢ Bewerten Sie die Koordination mit externen Partnern und Dienstleistern\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit der Kommunikation mit Aufsichtsbeh√∂rden\n‚Ä¢ Analysieren Sie die Koordination mit Strafverfolgungsbeh√∂rden bei Cybercrime-Incidents\n‚Ä¢ Bewerten Sie die Integration von Public-Relations-√úberlegungen in Crisis-Communication\n‚Ä¢ Pr√ºfen Sie die Koordination mit Branchenpartnern bei systemischen Bedrohungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'Wie bewerte ich die Wirksamkeit von Monitoring- und Alerting-Systemen in DORA-Audits?',
        answer: "Die Bewertung von Monitoring- und Alerting-Systemen ist entscheidend f√ºr die Validierung der kontinuierlichen √úberwachungsf√§higkeiten einer Organisation. Effektive Monitoring-Systeme sind das Nervensystem der operationellen Resilienz und m√ºssen sowohl technische als auch gesch√§ftliche Perspektiven integrieren.\n\nüìä Umfassende Monitoring-Coverage-Bewertung:\n‚Ä¢ Bewerten Sie die Vollst√§ndigkeit der Monitoring-Abdeckung f√ºr alle kritischen IKT-Systeme und Gesch√§ftsprozesse\n‚Ä¢ Pr√ºfen Sie die Integration verschiedener Monitoring-Tools und deren F√§higkeit zur ganzheitlichen Sichtbarkeit\n‚Ä¢ Analysieren Sie die √úberwachung von Drittanbieter-Services und deren Integration in das Gesamtmonitoring\n‚Ä¢ Bewerten Sie die Monitoring-F√§higkeiten f√ºr Cloud- und Hybrid-Umgebungen\n‚Ä¢ Pr√ºfen Sie die √úberwachung von Netzwerk-Traffic und dessen Analyse auf Anomalien\n\n‚ö° Real-Time-Detection und Alerting:\n‚Ä¢ Bewerten Sie die Wirksamkeit von Real-Time-Alerting-Mechanismen und deren Genauigkeit\n‚Ä¢ Pr√ºfen Sie die Angemessenheit von Alert-Schwellenwerten und deren regelm√§√üige Anpassung\n‚Ä¢ Analysieren Sie die Qualit√§t von Alert-Korrelation und deren F√§higkeit zur Reduzierung von False Positives\n‚Ä¢ Bewerten Sie die Geschwindigkeit und Zuverl√§ssigkeit von Alert-Delivery-Mechanismen\n‚Ä¢ Pr√ºfen Sie die Integration von Machine Learning und AI in Anomalie-Detection\n\nüîç Datenqualit√§t und -Integrit√§t:\n‚Ä¢ Bewerten Sie die Vollst√§ndigkeit und Genauigkeit der gesammelten Monitoring-Daten\n‚Ä¢ Pr√ºfen Sie die Integrit√§t von Log-Daten und deren Schutz vor Manipulation\n‚Ä¢ Analysieren Sie die Retention-Policies f√ºr Monitoring-Daten und deren Compliance mit regulatorischen Anforderungen\n‚Ä¢ Bewerten Sie die Verf√ºgbarkeit von Monitoring-Daten w√§hrend Systemausf√§llen\n‚Ä¢ Pr√ºfen Sie die Synchronisation von Zeitstempeln zwischen verschiedenen Monitoring-Systemen\n\nüìà Performance- und Kapazit√§ts-Monitoring:\n‚Ä¢ Bewerten Sie die Wirksamkeit von Performance-Monitoring f√ºr kritische Anwendungen und Services\n‚Ä¢ Pr√ºfen Sie die Qualit√§t von Capacity-Planning basierend auf Monitoring-Daten\n‚Ä¢ Analysieren Sie die √úberwachung von Service-Level-Agreements und deren automatische Validierung\n‚Ä¢ Bewerten Sie die Monitoring-F√§higkeiten f√ºr Benutzerexperience und End-to-End-Performance\n‚Ä¢ Pr√ºfen Sie die Integration von Business-Metriken in technisches Monitoring\n\nüõ°Ô∏è Security-Monitoring und Threat-Detection:\n‚Ä¢ Bewerten Sie die Wirksamkeit von Security-Information-and-Event-Management-Systemen\n‚Ä¢ Pr√ºfen Sie die Integration von Threat-Intelligence in Monitoring- und Detection-Prozesse\n‚Ä¢ Analysieren Sie die F√§higkeiten zur Erkennung von Advanced Persistent Threats\n‚Ä¢ Bewerten Sie die Monitoring-Abdeckung f√ºr Insider-Threats und privilegierte Benutzeraktivit√§ten\n‚Ä¢ Pr√ºfen Sie die Wirksamkeit von Behavioral-Analytics f√ºr Anomalie-Detection\n\nüîÑ Automatisierung und Response-Integration:\n‚Ä¢ Bewerten Sie die Integration von Monitoring-Systemen in automatisierte Response-Mechanismen\n‚Ä¢ Pr√ºfen Sie die Qualit√§t von Runbook-Automation basierend auf Monitoring-Alerts\n‚Ä¢ Analysieren Sie die Wirksamkeit von Self-Healing-Mechanismen\n‚Ä¢ Bewerten Sie die Integration von Monitoring in Change-Management-Prozesse\n‚Ä¢ Pr√ºfen Sie die Automatisierung von Eskalationsprozessen basierend auf Alert-Severity\n\nüìã Governance und Continuous Improvement:\n‚Ä¢ Bewerten Sie die Governance-Strukturen f√ºr Monitoring-Systeme und deren strategische Ausrichtung\n‚Ä¢ Pr√ºfen Sie die regelm√§√üige Review und Optimierung von Monitoring-Konfigurationen\n‚Ä¢ Analysieren Sie die Nutzung von Monitoring-Daten f√ºr strategische Entscheidungen\n‚Ä¢ Bewerten Sie die Integration von Monitoring-Erkenntnissen in Risikomanagement-Prozesse\n‚Ä¢ Pr√ºfen Sie die kontinuierliche Verbesserung von Monitoring-F√§higkeiten basierend auf Lessons Learned"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
