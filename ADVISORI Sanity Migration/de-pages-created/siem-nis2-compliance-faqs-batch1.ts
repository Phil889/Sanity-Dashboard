import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating SIEM NIS2 Compliance page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'siem-nis2-compliance' })
    
    if (!existingDoc) {
      throw new Error('Document "siem-nis2-compliance" not found')
    }
    
    // Create new FAQs for SIEM NIS2 Compliance fundamentals and scope
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was sind die wesentlichen Unterschiede zwischen NIS und NIS2 und welche neuen Anforderungen stellt die NIS2-Richtlinie an SIEM-Systeme?',
        answer: "Die NIS2-Richtlinie stellt eine fundamentale Weiterentwicklung der urspr√ºnglichen NIS-Richtlinie dar und erweitert sowohl den Anwendungsbereich als auch die technischen und organisatorischen Anforderungen erheblich. F√ºr SIEM-Systeme bedeutet dies eine strategische Neuausrichtung auf erweiterte Monitoring-Capabilities, verbesserte Incident Response und umfassendere Compliance-Dokumentation.\n\nüèõÔ∏è Erweiterte Sektorabdeckung und Anwendungsbereich:\n‚Ä¢ Ausweitung von urspr√ºnglich sieben auf elf kritische Sektoren einschlie√ülich √∂ffentlicher Verwaltung, Weltraum und Abwasser\n‚Ä¢ Neue Kategorie der wichtigen Einrichtungen mit spezifischen SIEM-Anforderungen f√ºr digitale Infrastrukturen, Post- und Kurierdienste sowie Abfallwirtschaft\n‚Ä¢ Reduzierte Schwellenwerte f√ºr die Anwendbarkeit, wodurch deutlich mehr Organisationen unter die Richtlinie fallen\n‚Ä¢ Erweiterte Lieferketten-Verantwortung, die umfassende SIEM-√úberwachung von Drittanbietern erfordert\n‚Ä¢ Grenz√ºberschreitende Anwendung f√ºr alle EU-Mitgliedstaaten mit harmonisierten Standards\n\nüîí Versch√§rfte Cybersecurity-Anforderungen:\n‚Ä¢ Obligatorische Implementierung von Multi-Faktor-Authentifizierung mit SIEM-basierter √úberwachung aller Authentifizierungsereignisse\n‚Ä¢ Erweiterte Verschl√ºsselungsanforderungen f√ºr Daten in Ruhe und w√§hrend der √úbertragung mit kontinuierlicher SIEM-√úberwachung\n‚Ä¢ Verbesserte Backup-Strategien mit automatisierter SIEM-√úberwachung der Backup-Integrit√§t und Recovery-Prozesse\n‚Ä¢ Supply Chain Security Management mit umfassender SIEM-Integration f√ºr Drittanbieter-Monitoring\n‚Ä¢ Vulnerability Management mit automatisierter SIEM-Integration f√ºr kontinuierliche Schwachstellen-√úberwachung\n\nüìä Erweiterte SIEM-spezifische Anforderungen:\n‚Ä¢ Real-time Incident Detection mit automatisierter Klassifizierung nach NIS2-Kriterien f√ºr erhebliche und schwerwiegende Vorf√§lle\n‚Ä¢ Erweiterte Logging-Anforderungen mit mindestens 12-monatiger Aufbewahrung f√ºr forensische Analysen\n‚Ä¢ Cross-System Correlation f√ºr umfassende Bedrohungserkennung √ºber alle kritischen Systeme hinweg\n‚Ä¢ Automated Threat Intelligence Integration mit EU-weiten Threat Sharing-Plattformen\n‚Ä¢ Advanced Analytics f√ºr Anomaly Detection und Behavioral Analysis kritischer Infrastrukturen\n\n‚ö° Incident Response und Reporting:\n‚Ä¢ Versch√§rfte Meldefristen mit 24 Stunden f√ºr erste Meldung und detaillierte Follow-up-Berichte\n‚Ä¢ Erweiterte Incident-Kategorisierung mit spezifischen SIEM-Rules f√ºr verschiedene Vorfallstypen\n‚Ä¢ Cross-Border Information Sharing mit automatisierten SIEM-Schnittstellen zu nationalen CSIRTs\n‚Ä¢ Business Impact Assessment Integration in SIEM-Workflows f√ºr schnelle Schadensbewertung\n‚Ä¢ Lessons Learned Documentation mit automatisierter SIEM-Unterst√ºtzung f√ºr kontinuierliche Verbesserung\n\nüè¢ Governance und Management-Verantwortung:\n‚Ä¢ Board-Level Cybersecurity Oversight mit Executive Dashboards und Management Reporting\n‚Ä¢ Cybersecurity Training und Awareness mit SIEM-basierter √úberwachung der Trainingseffektivit√§t\n‚Ä¢ Regular Risk Assessments mit SIEM-Integration f√ºr kontinuierliche Risikobewertung\n‚Ä¢ Third-Party Risk Management mit umfassender SIEM-√úberwachung der Lieferanten-Cybersecurity\n‚Ä¢ Crisis Management Integration mit SIEM-gest√ºtzten Eskalationsprozessen und Kommunikationsworkflows"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Welche spezifischen SIEM-Konfigurationen sind erforderlich, um die NIS2-Anforderungen an Incident Detection und Classification zu erf√ºllen?',
        answer: "Die NIS2-konforme SIEM-Konfiguration erfordert eine pr√§zise Abstimmung auf die spezifischen Incident-Kategorien und Meldekriterien der Richtlinie. Dies umfasst sowohl technische Detection-Rules als auch organisatorische Workflows, die eine zeitgerechte und vollst√§ndige Compliance sicherstellen.\n\nüéØ NIS2-konforme Incident Classification Framework:\n‚Ä¢ Erhebliche Vorf√§lle mit automatisierter SIEM-Erkennung basierend auf Service-Verf√ºgbarkeit, Datenintegrit√§t und Sicherheitskontrollen\n‚Ä¢ Schwerwiegende Vorf√§lle mit erweiterten Detection-Rules f√ºr kritische Infrastruktur-Ausf√§lle und massive Datenkomprommittierung\n‚Ä¢ Cross-Sector Impact Assessment mit SIEM-Integration f√ºr Bewertung von Auswirkungen auf andere kritische Sektoren\n‚Ä¢ Business Continuity Impact Scoring mit automatisierter SIEM-Bewertung der Gesch√§ftskontinuit√§ts-Beeintr√§chtigung\n‚Ä¢ Public Safety Assessment mit SIEM-Rules f√ºr Erkennung von Vorf√§llen mit potenziellem Einfluss auf √∂ffentliche Sicherheit\n\nüîç Advanced Detection Rules und Use Cases:\n‚Ä¢ Anomaly Detection f√ºr ungew√∂hnliche Netzwerkaktivit√§ten mit Machine Learning-basierten Algorithmen f√ºr kritische Infrastrukturen\n‚Ä¢ Behavioral Analysis f√ºr privilegierte Benutzer mit speziellem Fokus auf administrative Zugriffe auf kritische Systeme\n‚Ä¢ Data Exfiltration Detection mit DLP-Integration und erweiterten Pattern-Matching f√ºr sensible Infrastrukturdaten\n‚Ä¢ Lateral Movement Detection mit Network Segmentation Monitoring f√ºr fr√ºhzeitige Erkennung von Advanced Persistent Threats\n‚Ä¢ Supply Chain Attack Detection mit spezialisierten Rules f√ºr Kompromittierung von Drittanbieter-Systemen und -Services\n\n‚è±Ô∏è Real-time Monitoring und Alerting:\n‚Ä¢ 24/7 Continuous Monitoring mit automatisierten Eskalationsprozessen f√ºr kritische Infrastruktur-Events\n‚Ä¢ Multi-Tier Alerting mit verschiedenen Schweregrad-Kategorien entsprechend NIS2-Incident-Klassifizierung\n‚Ä¢ Automated Correlation zwischen verschiedenen Datenquellen f√ºr umfassende Threat Detection\n‚Ä¢ Geolocation-based Alerting f√ºr ungew√∂hnliche Zugriffe auf kritische Systeme aus unerwarteten geografischen Regionen\n‚Ä¢ Time-based Analysis f√ºr Erkennung von Angriffen au√üerhalb normaler Gesch√§ftszeiten\n\nüìã Compliance-orientierte Logging und Documentation:\n‚Ä¢ Comprehensive Audit Trails mit tamper-proof Logging f√ºr alle sicherheitsrelevanten Ereignisse\n‚Ä¢ Automated Evidence Collection f√ºr forensische Analysen und regulatorische Untersuchungen\n‚Ä¢ Chain of Custody Documentation mit automatisierter SIEM-Unterst√ºtzung f√ºr Beweismittel-Management\n‚Ä¢ Incident Timeline Reconstruction mit detaillierter Chronologie aller relevanten Events\n‚Ä¢ Impact Assessment Documentation mit automatisierter Bewertung und Dokumentation der Vorfallsauswirkungen\n\nüîÑ Integration mit Incident Response Workflows:\n‚Ä¢ Automated Ticket Creation in ITSM-Systemen mit NIS2-konformen Incident-Kategorien\n‚Ä¢ Stakeholder Notification Workflows mit automatisierten Benachrichtigungen an relevante interne und externe Parteien\n‚Ä¢ Regulatory Reporting Integration mit automatisierter Vorbereitung von Meldungen an nationale Beh√∂rden\n‚Ä¢ Crisis Communication Support mit SIEM-gest√ºtzten Kommunikationsworkflows f√ºr Krisensituationen\n‚Ä¢ Post-Incident Analysis Automation mit systematischer Aufarbeitung und Lessons Learned Documentation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Wie implementiert man effektive Supply Chain Security Monitoring in SIEM-Systemen entsprechend den NIS2-Anforderungen?',
        answer: "Supply Chain Security ist ein zentraler Baustein der NIS2-Richtlinie und erfordert eine umfassende SIEM-Integration, die √ºber traditionelle Perimeter-Sicherheit hinausgeht. Die Implementierung muss sowohl technische √úberwachung als auch organisatorische Prozesse f√ºr das Management von Drittanbieter-Risiken umfassen.\n\nüîó Comprehensive Third-Party Risk Assessment:\n‚Ä¢ Automated Vendor Security Posture Monitoring mit kontinuierlicher SIEM-√úberwachung der Cybersecurity-Status von kritischen Lieferanten\n‚Ä¢ Digital Certificate Monitoring f√ºr alle Drittanbieter-Verbindungen mit automatisierter Erkennung von Zertifikats-Anomalien\n‚Ä¢ API Security Monitoring f√ºr alle Third-Party Integrationen mit speziellen Detection-Rules f√ºr ungew√∂hnliche API-Nutzung\n‚Ä¢ Cloud Service Provider Monitoring mit erweiterten SIEM-Capabilities f√ºr Multi-Cloud-Umgebungen\n‚Ä¢ Software Supply Chain Analysis mit automatisierter √úberwachung von Software-Updates und Patches von Drittanbietern\n\nüìä Real-time Supply Chain Visibility:\n‚Ä¢ Network Traffic Analysis f√ºr alle Drittanbieter-Verbindungen mit Deep Packet Inspection und Behavioral Analysis\n‚Ä¢ Data Flow Monitoring zwischen internen Systemen und externen Partnern mit automatisierter Klassifizierung sensibler Daten√ºbertragungen\n‚Ä¢ Access Pattern Analysis f√ºr Drittanbieter-Zugriffe mit Machine Learning-basierter Anomaly Detection\n‚Ä¢ Dependency Mapping mit dynamischer Visualisierung aller kritischen Abh√§ngigkeiten von externen Services\n‚Ä¢ Performance Impact Monitoring mit SIEM-Integration f√ºr Erkennung von Service-Degradation durch Drittanbieter\n\nüö® Advanced Threat Detection f√ºr Supply Chain:\n‚Ä¢ Compromised Vendor Detection mit spezialisierten SIEM-Rules f√ºr Erkennung kompromittierter Lieferanten-Systeme\n‚Ä¢ Malicious Software Detection in Third-Party Deliverables mit automatisierter Malware-Analyse und Sandboxing\n‚Ä¢ Data Poisoning Detection f√ºr Machine Learning-Modelle und Algorithmen von Drittanbietern\n‚Ä¢ Insider Threat Detection bei Drittanbieter-Personal mit erweiterten Behavioral Analytics\n‚Ä¢ Supply Chain Attack Pattern Recognition mit Threat Intelligence Integration f√ºr bekannte Attack Vectors\n\nüîê Security Control Validation:\n‚Ä¢ Continuous Compliance Monitoring der Drittanbieter-Sicherheitskontrollen mit automatisierten Assessment-Tools\n‚Ä¢ Penetration Testing Coordination mit SIEM-Integration f√ºr regelm√§√üige Sicherheitstests der Supply Chain\n‚Ä¢ Vulnerability Scanning der Drittanbieter-Infrastruktur mit automatisierter Risikobewertung\n‚Ä¢ Security Questionnaire Automation mit SIEM-gest√ºtzter Validierung der Anbieter-Antworten\n‚Ä¢ Audit Trail Verification f√ºr alle Drittanbieter-Aktivit√§ten mit tamper-proof Logging\n\nüìã Incident Response f√ºr Supply Chain Events:\n‚Ä¢ Automated Isolation Procedures f√ºr kompromittierte Drittanbieter-Verbindungen mit sofortiger Netzwerk-Segmentierung\n‚Ä¢ Cross-Organization Incident Coordination mit SIEM-gest√ºtzten Kommunikationsworkflows\n‚Ä¢ Evidence Preservation f√ºr Supply Chain-bezogene Incidents mit automatisierter Forensic Data Collection\n‚Ä¢ Business Impact Assessment f√ºr Drittanbieter-Ausf√§lle mit Real-time Service Dependency Analysis\n‚Ä¢ Recovery Planning Integration mit SIEM-unterst√ºtzter Koordination von Wiederherstellungsma√ünahmen\n\nüåê Regulatory Compliance und Reporting:\n‚Ä¢ NIS2-konforme Documentation aller Supply Chain-Risiken mit automatisierter Report-Generierung\n‚Ä¢ Cross-Border Information Sharing f√ºr internationale Lieferanten mit Privacy-konformen Daten√ºbertragungen\n‚Ä¢ Regulatory Notification Workflows f√ºr Supply Chain-Incidents mit automatisierten Meldungen an relevante Beh√∂rden\n‚Ä¢ Continuous Improvement Tracking mit SIEM-basierter Messung der Supply Chain Security Maturity\n‚Ä¢ Stakeholder Communication f√ºr Supply Chain-Risiken mit automatisierten Executive Dashboards und Reporting"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Welche Herausforderungen entstehen bei der Implementierung von Cross-Border Information Sharing f√ºr NIS2-Compliance und wie l√∂st man diese mit SIEM-Technologie?',
        answer: "Cross-Border Information Sharing ist ein komplexer Aspekt der NIS2-Richtlinie, der technische, rechtliche und organisatorische Herausforderungen mit sich bringt. SIEM-Systeme m√ºssen so konfiguriert werden, dass sie sowohl effektive Informationsaustausch-Mechanismen als auch strikte Datenschutz- und Souver√§nit√§tsanforderungen erf√ºllen.\n\nüåç Multi-Jurisdictional Compliance Framework:\n‚Ä¢ Privacy-Preserving Analytics mit Advanced Cryptographic Techniques f√ºr sensible Threat Intelligence ohne Preisgabe vertraulicher Details\n‚Ä¢ Data Sovereignty Compliance mit automatisierter SIEM-√úberwachung der Datenlokalisation und grenz√ºberschreitenden √úbertragungen\n‚Ä¢ GDPR-konforme Information Sharing mit automatisierter Anonymisierung und Pseudonymisierung sensibler Daten\n‚Ä¢ Legal Framework Integration mit SIEM-gest√ºtzter Dokumentation aller rechtlichen Grundlagen f√ºr Daten√ºbertragungen\n‚Ä¢ Bilateral Agreement Monitoring mit automatisierter √úberwachung der Einhaltung internationaler Kooperationsvereinbarungen\n\nüîê Secure Information Exchange Mechanisms:\n‚Ä¢ End-to-End Encryption f√ºr alle Cross-Border Communications mit Advanced Key Management und Perfect Forward Secrecy\n‚Ä¢ Zero-Trust Architecture f√ºr internationale Verbindungen mit kontinuierlicher Authentifizierung und Autorisierung\n‚Ä¢ Secure Multi-Party Computation f√ºr kollaborative Threat Analysis ohne Preisgabe individueller Daten\n‚Ä¢ Blockchain-based Trust Networks f√ºr unver√§nderliche Audit Trails bei internationalen Informationsaustausch\n‚Ä¢ Quantum-Resistant Cryptography f√ºr zukunftssichere Verschl√ºsselung kritischer Cross-Border Communications\n\nüìä Automated Threat Intelligence Sharing:\n‚Ä¢ STIX/TAXII Integration f√ºr standardisierten Austausch von Cyber Threat Intelligence mit internationalen Partnern\n‚Ä¢ Machine-Readable Indicators mit automatisierter SIEM-Integration f√ºr Real-time Threat Detection\n‚Ä¢ Contextual Information Enrichment mit automatisierter Anreicherung geteilter Indikatoren um lokale Kontext-Informationen\n‚Ä¢ False Positive Reduction durch kollaborative Machine Learning-Modelle mit internationalen Partnern\n‚Ä¢ Attribution Analysis mit Privacy-konformen Methoden f√ºr Threat Actor Identification und Tracking\n\nüö® Real-time Incident Coordination:\n‚Ä¢ Automated Incident Notification an relevante internationale CSIRTs mit standardisierten Incident-Formaten\n‚Ä¢ Cross-Border Crisis Communication mit SIEM-gest√ºtzten Multi-Language Support und kultureller Anpassung\n‚Ä¢ Joint Incident Response Coordination mit geteilten Dashboards und Real-time Collaboration Tools\n‚Ä¢ Evidence Sharing Protocols mit rechtlich abgesicherten Verfahren f√ºr forensische Daten\n‚Ä¢ Coordinated Attribution Efforts mit internationaler Zusammenarbeit bei der T√§ter-Identifikation\n\n‚öñÔ∏è Legal und Regulatory Considerations:\n‚Ä¢ Data Classification Framework mit automatisierter SIEM-Kategorisierung nach Sensitivit√§t und Sharing-Berechtigung\n‚Ä¢ Consent Management f√ºr internationale Daten√ºbertragungen mit automatisierten Approval-Workflows\n‚Ä¢ Audit Trail Documentation f√ºr alle Cross-Border Activities mit tamper-proof Logging\n‚Ä¢ Regulatory Notification Requirements mit automatisierten Meldungen an nationale Datenschutzbeh√∂rden\n‚Ä¢ International Law Compliance mit SIEM-gest√ºtzter √úberwachung sich √§ndernder rechtlicher Anforderungen\n\nüîÑ Continuous Improvement und Optimization:\n‚Ä¢ Effectiveness Measurement der internationalen Kooperationen mit KPI-basierten SIEM-Dashboards\n‚Ä¢ Cultural Adaptation f√ºr verschiedene internationale Partner mit angepassten Communication Protocols\n‚Ä¢ Language Barrier Solutions mit automatisierten √úbersetzungs- und Lokalisierungstools\n‚Ä¢ Time Zone Coordination f√ºr 24/7 internationale Zusammenarbeit mit automatisierten Handoff-Prozessen\n‚Ä¢ Trust Building Mechanisms mit gradueller Erh√∂hung der Sharing-Intensit√§t basierend auf bew√§hrter Zusammenarbeit"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
