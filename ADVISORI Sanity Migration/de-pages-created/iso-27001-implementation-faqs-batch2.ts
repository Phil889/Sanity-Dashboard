import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Implementation page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-implementation' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-implementation" not found')
    }
    
    // Create new FAQs for technical implementation and system setup
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie implementiert man technische Sicherheitskontrollen nach ISO 27001 Annex A systematisch?',
        answer: "Die systematische Implementierung technischer Sicherheitskontrollen nach ISO 27001 Annex A erfordert eine strukturierte Herangehensweise, die sowohl die normativen Anforderungen als auch die spezifischen Gesch√§ftsanforderungen ber√ºcksichtigt. Eine erfolgreiche technische Umsetzung basiert auf einer durchdachten Architektur und schrittweisen Implementierung.\n\nüîç Systematische Kontrollauswahl und -bewertung:\n‚Ä¢ Durchf√ºhrung einer umfassenden Anwendbarkeitsbewertung aller 93 Kontrollen aus Annex A\n‚Ä¢ Risikobasierte Priorisierung der Kontrollen basierend auf Bedrohungslandschaft und Gesch√§ftsanforderungen\n‚Ä¢ Bewertung bestehender Sicherheitsma√ünahmen und Identifikation von L√ºcken\n‚Ä¢ Entwicklung einer Implementierungsroadmap mit klaren Abh√§ngigkeiten und Zeitpl√§nen\n‚Ä¢ Ber√ºcksichtigung von Compliance-Anforderungen und regulatorischen Vorgaben\n\nüèóÔ∏è Architektur und Design-Prinzipien:\n‚Ä¢ Entwicklung einer koh√§renten Sicherheitsarchitektur mit Defense-in-Depth-Ansatz\n‚Ä¢ Integration von Sicherheitskontrollen in bestehende IT-Infrastruktur und Gesch√§ftsprozesse\n‚Ä¢ Ber√ºcksichtigung von Skalierbarkeit, Wartbarkeit und Performance-Anforderungen\n‚Ä¢ Implementierung von Zero-Trust-Prinzipien und Least-Privilege-Zugriffsmodellen\n‚Ä¢ Aufbau redundanter Sicherheitsebenen f√ºr kritische Assets und Prozesse\n\nüîß Technische Implementierungsdom√§nen:\n‚Ä¢ Zugangskontrollen und Identit√§tsmanagement mit Multi-Faktor-Authentifizierung\n‚Ä¢ Netzwerksicherheit mit Segmentierung, Firewalls und Intrusion Detection Systemen\n‚Ä¢ Verschl√ºsselung f√ºr Daten in Ruhe und w√§hrend der √úbertragung\n‚Ä¢ Endpoint-Sicherheit mit Anti-Malware, Device Control und Patch Management\n‚Ä¢ Sichere Systemkonfiguration und H√§rtung nach bew√§hrten Standards\n\nüìä Monitoring und √úberwachung:\n‚Ä¢ Implementierung umfassender Logging- und Monitoring-Systeme\n‚Ä¢ Aufbau von Security Information and Event Management Kapazit√§ten\n‚Ä¢ Etablierung von Incident Detection und Response-Mechanismen\n‚Ä¢ Kontinuierliche Vulnerability Assessments und Penetration Testing\n‚Ä¢ Automatisierte Compliance-√úberwachung und Reporting\n\nüîÑ Integration und Orchestrierung:\n‚Ä¢ Nahtlose Integration verschiedener Sicherheitstools und -plattformen\n‚Ä¢ Automatisierung wiederkehrender Sicherheitsaufgaben und -prozesse\n‚Ä¢ Orchestrierung von Incident Response und Remediation-Workflows\n‚Ä¢ Integration mit bestehenden IT-Service-Management-Prozessen\n‚Ä¢ Aufbau von APIs und Schnittstellen f√ºr system√ºbergreifende Kommunikation\n\n‚úÖ Validierung und Testing:\n‚Ä¢ Systematische Tests aller implementierten Sicherheitskontrollen\n‚Ä¢ Durchf√ºhrung von Penetration Tests und Vulnerability Assessments\n‚Ä¢ Validierung der Wirksamkeit durch simulierte Angriffe und Incident-Szenarien\n‚Ä¢ Regelm√§√üige √úberpr√ºfung und Anpassung der Kontrolleffektivit√§t\n‚Ä¢ Dokumentation aller Test-Ergebnisse und Verbesserungsma√ünahmen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Rolle spielt die Integration bestehender IT-Systeme bei der ISO 27001 Implementierung?',
        answer: "Die Integration bestehender IT-Systeme ist ein kritischer Erfolgsfaktor bei der ISO 27001 Implementierung, da sie die Grundlage f√ºr ein koh√§rentes und effektives ISMS bildet. Eine durchdachte Integrationsstrategie minimiert Disruption, maximiert die Nutzung vorhandener Investitionen und gew√§hrleistet nahtlose Sicherheitsprozesse.\n\nüîç Bestandsaufnahme und Systemanalyse:\n‚Ä¢ Umfassende Inventarisierung aller IT-Systeme, Anwendungen und Infrastrukturkomponenten\n‚Ä¢ Bewertung der aktuellen Sicherheitsreife und vorhandenen Schutzma√ünahmen\n‚Ä¢ Identifikation von Systemabh√§ngigkeiten, Datenfl√ºssen und Schnittstellen\n‚Ä¢ Analyse der bestehenden Governance-Strukturen und Managementprozesse\n‚Ä¢ Dokumentation von Legacy-Systemen und deren spezifischen Sicherheitsherausforderungen\n\nüèóÔ∏è Architektonische Integration:\n‚Ä¢ Entwicklung einer einheitlichen Sicherheitsarchitektur, die bestehende Systeme einbezieht\n‚Ä¢ Harmonisierung verschiedener Sicherheitsstandards und -frameworks\n‚Ä¢ Schaffung konsistenter Sicherheitsrichtlinien √ºber alle Systemgrenzen hinweg\n‚Ä¢ Integration von Cloud-, On-Premises- und Hybrid-Umgebungen\n‚Ä¢ Ber√ºcksichtigung von Microservices, Containern und modernen Anwendungsarchitekturen\n\nüîó Technische Integrationsstrategie:\n‚Ä¢ Nutzung bestehender Identity und Access Management Systeme als ISMS-Grundlage\n‚Ä¢ Integration vorhandener Monitoring- und Logging-Infrastrukturen\n‚Ä¢ Erweiterung bestehender Backup- und Disaster Recovery-L√∂sungen\n‚Ä¢ Harmonisierung von Patch Management und Vulnerability Management-Prozessen\n‚Ä¢ Konsolidierung von Security Tools und Elimination redundanter L√∂sungen\n\nüìä Datenintegration und -harmonisierung:\n‚Ä¢ Zentralisierung von Sicherheitsdaten aus verschiedenen Quellen und Systemen\n‚Ä¢ Standardisierung von Datenformaten und Reporting-Strukturen\n‚Ä¢ Aufbau einheitlicher Dashboards und Kennzahlen-Systeme\n‚Ä¢ Integration von Compliance-Daten und Audit-Trails\n‚Ä¢ Automatisierung von Datensammlung und -analyse f√ºr kontinuierliches Monitoring\n\nüîÑ Prozessintegration und Workflow-Optimierung:\n‚Ä¢ Einbindung von ISMS-Prozessen in bestehende ITIL- oder DevOps-Workflows\n‚Ä¢ Integration von Change Management und Configuration Management-Prozessen\n‚Ä¢ Harmonisierung von Incident Management und Problem Management-Verfahren\n‚Ä¢ Aufbau nahtloser Eskalations- und Kommunikationswege\n‚Ä¢ Automatisierung wiederkehrender Compliance- und Audit-Aktivit√§ten\n\n‚ö° Herausforderungen und L√∂sungsans√§tze:\n‚Ä¢ Umgang mit Legacy-Systemen durch Kompensationskontrollen und Isolation\n‚Ä¢ Minimierung von Ausfallzeiten durch phasenweise Migration und Parallel-Betrieb\n‚Ä¢ Bew√§ltigung von Kompatibilit√§tsproblemen durch Adapter und Middleware-L√∂sungen\n‚Ä¢ Management von Komplexit√§t durch modulare Implementierung und schrittweise Integration\n‚Ä¢ Sicherstellung von Performance und Verf√ºgbarkeit w√§hrend der Integrationsphasen\n\nüéØ Erfolgsmessung und Optimierung:\n‚Ä¢ Definition von KPIs f√ºr erfolgreiche Systemintegration\n‚Ä¢ Kontinuierliches Monitoring der Integrationsstabilit√§t und -performance\n‚Ä¢ Regelm√§√üige Bewertung der Integrationserfolge und Identifikation von Verbesserungspotenzialen\n‚Ä¢ Aufbau von Feedback-Mechanismen f√ºr kontinuierliche Optimierung\n‚Ä¢ Dokumentation von Lessons Learned f√ºr zuk√ºnftige Integrationsprojekte"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie entwickelt man eine effektive ISMS-Dokumentationsstruktur f√ºr komplexe Organisationen?',
        answer: "Die Entwicklung einer effektiven ISMS-Dokumentationsstruktur f√ºr komplexe Organisationen erfordert einen systematischen Ansatz, der sowohl die normativen Anforderungen der ISO 27001 als auch die spezifischen organisatorischen Gegebenheiten ber√ºcksichtigt. Eine gut strukturierte Dokumentation bildet das R√ºckgrat eines erfolgreichen ISMS.\n\nüìã Hierarchische Dokumentationsarchitektur:\n‚Ä¢ ISMS-Handbuch als √ºbergeordnetes Dokument mit strategischen Zielen und Governance-Struktur\n‚Ä¢ Richtlinien f√ºr grundlegende Sicherheitsprinzipien und organisationsweite Standards\n‚Ä¢ Verfahrensanweisungen f√ºr operative Prozesse und detaillierte Arbeitsabl√§ufe\n‚Ä¢ Arbeitsanweisungen f√ºr spezifische T√§tigkeiten und technische Implementierungen\n‚Ä¢ Formulare, Checklisten und Templates f√ºr standardisierte Dokumentation\n\nüè¢ Organisationsspezifische Anpassung:\n‚Ä¢ Ber√ºcksichtigung verschiedener Gesch√§ftsbereiche, Standorte und Tochtergesellschaften\n‚Ä¢ Anpassung an unterschiedliche Compliance-Anforderungen und regulatorische Vorgaben\n‚Ä¢ Integration verschiedener Managementsysteme und bestehender Dokumentationsstandards\n‚Ä¢ Ber√ºcksichtigung kultureller Unterschiede und lokaler Gegebenheiten\n‚Ä¢ Skalierbare Struktur f√ºr zuk√ºnftiges Wachstum und organisatorische Ver√§nderungen\n\nüîÑ Prozessorientierte Dokumentation:\n‚Ä¢ Klare Abbildung aller ISMS-Prozesse mit Inputs, Outputs und Verantwortlichkeiten\n‚Ä¢ Dokumentation von Prozessschnittstellen und Abh√§ngigkeiten\n‚Ä¢ Integration von Risikomanagement-Prozessen in die Dokumentationsstruktur\n‚Ä¢ Abbildung von Incident Management und Business Continuity-Verfahren\n‚Ä¢ Dokumentation von Audit- und Review-Prozessen mit klaren Zeitpl√§nen\n\nüìä Rollen- und verantwortungsbasierte Struktur:\n‚Ä¢ Klare Zuordnung von Dokumentationsverantwortlichkeiten zu spezifischen Rollen\n‚Ä¢ Rollenbasierte Zugriffskontrolle auf verschiedene Dokumentationsebenen\n‚Ä¢ Definition von Genehmigungsworkflows und Freigabeprozessen\n‚Ä¢ Etablierung von Document Ownership und Maintenance-Verantwortlichkeiten\n‚Ä¢ Aufbau von Eskalationswegen f√ºr Dokumentations√§nderungen\n\nüîß Technische Dokumentationsplattform:\n‚Ä¢ Auswahl geeigneter Dokumentenmanagement-Systeme mit Versionskontrolle\n‚Ä¢ Integration mit bestehenden Collaboration-Tools und Workflow-Systemen\n‚Ä¢ Implementierung automatisierter Benachrichtigungen und Review-Zyklen\n‚Ä¢ Aufbau von Suchfunktionen und Metadaten-Management\n‚Ä¢ Sicherstellung von Backup, Archivierung und Disaster Recovery f√ºr Dokumentation\n\nüìà Kontinuierliche Verbesserung und Maintenance:\n‚Ä¢ Etablierung regelm√§√üiger Dokumentationsreviews und Update-Zyklen\n‚Ä¢ Implementierung von Feedback-Mechanismen f√ºr Dokumentationsnutzer\n‚Ä¢ Aufbau von Metriken f√ºr Dokumentationsqualit√§t und -nutzung\n‚Ä¢ Kontinuierliche Anpassung an sich √§ndernde Gesch√§ftsanforderungen\n‚Ä¢ Integration von Lessons Learned aus Audits und Incidents in die Dokumentation\n\n‚úÖ Qualit√§tssicherung und Compliance:\n‚Ä¢ Sicherstellung der Vollst√§ndigkeit und Aktualit√§t aller erforderlichen Dokumente\n‚Ä¢ Regelm√§√üige √úberpr√ºfung der Dokumentation auf Konsistenz und Klarheit\n‚Ä¢ Validierung der praktischen Anwendbarkeit durch Nutzer-Feedback\n‚Ä¢ Compliance-Checks gegen ISO 27001 Anforderungen und andere Standards\n‚Ä¢ Vorbereitung der Dokumentation f√ºr interne und externe Audits"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Automatisierungsm√∂glichkeiten gibt es bei der ISO 27001 Implementierung?',
        answer: "Automatisierung spielt eine entscheidende Rolle bei der effizienten und nachhaltigen ISO 27001 Implementierung, da sie manuelle Aufw√§nde reduziert, Konsistenz gew√§hrleistet und kontinuierliche Compliance erm√∂glicht. Eine strategische Automatisierungsstrategie kann die ISMS-Effektivit√§t erheblich steigern und operative Kosten senken.\n\nü§ñ Automatisierte Compliance-√úberwachung:\n‚Ä¢ Kontinuierliches Monitoring von Sicherheitskontrollen durch automatisierte Tools\n‚Ä¢ Echtzeit-√úberwachung von Systemkonfigurationen und Abweichungen von Baseline-Standards\n‚Ä¢ Automatische Generierung von Compliance-Reports und Dashboards\n‚Ä¢ Proaktive Benachrichtigungen bei Verst√∂√üen gegen Sicherheitsrichtlinien\n‚Ä¢ Integration mit SIEM-Systemen f√ºr automatisierte Threat Detection und Response\n\nüìä Automatisierte Risikobewertung und -management:\n‚Ä¢ Kontinuierliche Vulnerability Scans und automatisierte Risikobewertung\n‚Ä¢ Dynamische Anpassung von Risiko-Scores basierend auf aktuellen Bedrohungsinformationen\n‚Ä¢ Automatisierte Korrelation von Risikodaten aus verschiedenen Quellen\n‚Ä¢ Workflow-basierte Risiko-Behandlung mit automatisierten Eskalationsprozessen\n‚Ä¢ Integration von Threat Intelligence f√ºr proaktive Risikobewertung\n\nüîß Automatisierte Kontrollimplementierung:\n‚Ä¢ Infrastructure as Code f√ºr konsistente und wiederholbare Sicherheitskonfigurationen\n‚Ä¢ Automatisierte Patch Management-Prozesse mit Testing und Rollback-Mechanismen\n‚Ä¢ Policy-basierte Zugriffskontrolle mit automatischer Rechtevergabe und -entzug\n‚Ä¢ Automatisierte Backup-Prozesse mit Integrit√§tspr√ºfung und Recovery-Testing\n‚Ä¢ DevSecOps-Integration f√ºr automatisierte Sicherheitstests in CI/CD-Pipelines\n\nüìã Automatisierte Dokumentation und Reporting:\n‚Ä¢ Automatische Generierung von ISMS-Dokumentation aus Systemkonfigurationen\n‚Ä¢ Workflow-basierte Dokumentenerstellung und -genehmigung\n‚Ä¢ Automatisierte Sammlung und Konsolidierung von Audit-Evidenzen\n‚Ä¢ Dynamische Erstellung von Management-Reports und KPI-Dashboards\n‚Ä¢ Automatisierte Benachrichtigungen f√ºr Dokumentationsreviews und Updates\n\nüîÑ Automatisierte Incident Response:\n‚Ä¢ Orchestrierte Incident Response-Workflows mit automatisierten Eskalationspfaden\n‚Ä¢ Automatische Isolierung kompromittierter Systeme und Containment-Ma√ünahmen\n‚Ä¢ Intelligente Ticket-Routing basierend auf Incident-Typ und Schweregrad\n‚Ä¢ Automatisierte Forensik-Datensammlung und -analyse\n‚Ä¢ Integration mit Communication-Tools f√ºr automatisierte Stakeholder-Benachrichtigung\n\nüéØ Automatisierte Audit-Vorbereitung:\n‚Ä¢ Kontinuierliche Sammlung und Organisation von Audit-Evidenzen\n‚Ä¢ Automatisierte √úberpr√ºfung der Vollst√§ndigkeit erforderlicher Dokumentation\n‚Ä¢ Workflow-basierte Audit-Planung und -koordination\n‚Ä¢ Automatisierte Generierung von Audit-Reports und Findings-Tracking\n‚Ä¢ Integration mit externen Audit-Tools und -plattformen\n\n‚ö° Implementierungsstrategien:\n‚Ä¢ Schrittweise Automatisierung beginnend mit repetitiven, risikoarmen Aufgaben\n‚Ä¢ Aufbau von Automatisierungs-Kompetenzen durch Schulung und Wissenstransfer\n‚Ä¢ Integration mit bestehenden IT-Operations und DevOps-Prozessen\n‚Ä¢ Verwendung von Low-Code/No-Code-Plattformen f√ºr schnelle Automatisierung\n‚Ä¢ Kontinuierliche Optimierung und Erweiterung der Automatisierungslandschaft\n\nüîç Erfolgsmessung und Optimierung:\n‚Ä¢ Definition von KPIs f√ºr Automatisierungseffektivit√§t und ROI-Messung\n‚Ä¢ Kontinuierliches Monitoring der Automatisierungsperformance\n‚Ä¢ Regelm√§√üige Bewertung und Anpassung automatisierter Prozesse\n‚Ä¢ Feedback-Integration f√ºr kontinuierliche Verbesserung\n‚Ä¢ Benchmarking gegen Branchenstandards und Best Practices"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
