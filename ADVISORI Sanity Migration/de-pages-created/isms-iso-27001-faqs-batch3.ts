import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISMS ISO 27001 page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'isms-iso-27001' })
    
    if (!existingDoc) {
      throw new Error('Document "isms-iso-27001" not found')
    }
    
    // Create new FAQs for ISMS monitoring and measurement
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'Wie wird die ISMS-Performance gemessen und welche KPIs sind dabei entscheidend?',
        answer: "Die systematische Messung der ISMS-Performance nach ISO 27001 ist essentiell fÃ¼r die Bewertung der Wirksamkeit des Informationssicherheitsmanagementsystems und die kontinuierliche Verbesserung. Ein strukturiertes Performance-Measurement-System kombiniert quantitative und qualitative Metriken zur ganzheitlichen Bewertung der ISMS-EffektivitÃ¤t.\n\nğŸ“Š Strategische Performance-Indikatoren:\nâ€¢ Grad der Zielerreichung fÃ¼r definierte Informationssicherheitsziele und deren Beitrag zu GeschÃ¤ftszielen\nâ€¢ Reifegrad des ISMS basierend auf etablierten Bewertungsmodellen und Benchmarks\nâ€¢ Stakeholder-Zufriedenheit mit der Informationssicherheit durch regelmÃ¤ÃŸige Befragungen\nâ€¢ Return on Investment fÃ¼r Informationssicherheitsinvestitionen und Kosteneinsparungen\nâ€¢ Compliance-Rate mit regulatorischen Anforderungen und internen Richtlinien\n\nğŸ›¡ï¸ Operative Sicherheits-KPIs:\nâ€¢ Anzahl und Schweregrad von SicherheitsvorfÃ¤llen sowie deren Entwicklung Ã¼ber Zeit\nâ€¢ Mean Time to Detection und Mean Time to Response fÃ¼r SicherheitsvorfÃ¤lle\nâ€¢ VerfÃ¼gbarkeit kritischer Systeme und Services gemessen an definierten SLAs\nâ€¢ Erfolgsrate von Backup- und Recovery-Prozessen sowie deren Testzyklen\nâ€¢ Patch-Management-Effizienz und Schwachstellen-Behebungszeiten\n\nğŸ”„ Prozess-Performance-Metriken:\nâ€¢ Wirksamkeit der Risikomanagement-Prozesse durch Risikoreduktion und Behandlungsfortschritt\nâ€¢ Audit-Ergebnisse und Trend der NichtkonformitÃ¤ten Ã¼ber mehrere Auditzyklen\nâ€¢ Implementierungsgrad und Wirksamkeit der ausgewÃ¤hlten Sicherheitskontrollen\nâ€¢ Effizienz von Change Management Prozessen und deren Sicherheitsbewertung\nâ€¢ Performance der Business Continuity Management Prozesse durch Ãœbungen und Tests\n\nğŸ‘¥ Human Factor und Awareness-Metriken:\nâ€¢ Teilnahmerate und Bewertungen von Sicherheitsschulungen und Awareness-Programmen\nâ€¢ Anzahl und Art von menschlichen Fehlern mit Sicherheitsauswirkungen\nâ€¢ Melderate von SicherheitsvorfÃ¤llen durch Mitarbeiter als Indikator fÃ¼r Sicherheitsbewusstsein\nâ€¢ Compliance-Rate mit Sicherheitsrichtlinien durch Monitoring und Stichproben\nâ€¢ Kompetenzentwicklung in sicherheitsrelevanten Rollen durch Bewertungen\n\nğŸ“ˆ Kontinuierliche Verbesserungs-Indikatoren:\nâ€¢ Anzahl und Umsetzungsrate von VerbesserungsmaÃŸnahmen aus Management Reviews\nâ€¢ Trend der Korrektur- und VorbeugungsmaÃŸnahmen sowie deren Wirksamkeit\nâ€¢ Innovation in Sicherheitstechnologien und Prozessoptimierungen\nâ€¢ Benchmarking-Ergebnisse im Vergleich zu Branchenstandards\nâ€¢ AnpassungsfÃ¤higkeit des ISMS an verÃ¤nderte GeschÃ¤fts- und Bedrohungslandschaften\n\nğŸ¯ Balanced Scorecard Ansatz fÃ¼r ISMS:\nâ€¢ Integration von ISMS-KPIs in eine ausgewogene Scorecard mit finanziellen, operativen, Stakeholder- und Lernperspektiven\nâ€¢ VerknÃ¼pfung von Sicherheitsmetriken mit GeschÃ¤ftsergebnissen und strategischen Zielen\nâ€¢ Aufbau von Ursache-Wirkungs-Beziehungen zwischen verschiedenen Performance-Dimensionen\nâ€¢ RegelmÃ¤ÃŸige ÃœberprÃ¼fung und Anpassung der KPIs an verÃ¤nderte PrioritÃ¤ten\nâ€¢ Kommunikation der Performance-Ergebnisse an alle relevanten Stakeholder"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'Welche Rolle spielen interne Audits im ISMS und wie werden sie effektiv durchgefÃ¼hrt?',
        answer: "Interne Audits sind ein zentrales Element des ISMS nach ISO 27001 und fungieren als systematisches Instrument zur Bewertung der ISMS-Wirksamkeit, Identifikation von VerbesserungsmÃ¶glichkeiten und Sicherstellung der kontinuierlichen Compliance. Sie bilden eine wichtige Grundlage fÃ¼r Management Reviews und die kontinuierliche Verbesserung des Systems.\n\nğŸ¯ Strategische Bedeutung interner ISMS-Audits:\nâ€¢ Systematische Bewertung der ISMS-KonformitÃ¤t mit ISO 27001 Anforderungen und internen Richtlinien\nâ€¢ Identifikation von Schwachstellen und VerbesserungsmÃ¶glichkeiten vor externen Audits\nâ€¢ ÃœberprÃ¼fung der Wirksamkeit implementierter Sicherheitskontrollen und Prozesse\nâ€¢ Bewertung der Angemessenheit des ISMS im Hinblick auf verÃ¤nderte GeschÃ¤ftsanforderungen\nâ€¢ Aufbau von internem Audit-Know-how und Sicherheitskompetenz in der Organisation\n\nğŸ“‹ Audit-Planung und Programmgestaltung:\nâ€¢ Entwicklung eines risikobasierten Audit-Programms mit angemessener Abdeckung aller ISMS-Bereiche\nâ€¢ BerÃ¼cksichtigung der KritikalitÃ¤t verschiedener Prozesse und Kontrollen bei der Audit-Frequenz\nâ€¢ Integration mit anderen Audit-AktivitÃ¤ten wie QualitÃ¤ts- oder Compliance-Audits\nâ€¢ Planung von Follow-up-Audits zur ÃœberprÃ¼fung der Wirksamkeit von KorrekturmaÃŸnahmen\nâ€¢ FlexibilitÃ¤t fÃ¼r Ad-hoc-Audits bei besonderen Ereignissen oder Risiken\n\nğŸ‘¥ Auditor-Qualifikation und UnabhÃ¤ngigkeit:\nâ€¢ Sicherstellung angemessener Qualifikation der internen Auditoren in ISO 27001 und Audit-Techniken\nâ€¢ GewÃ¤hrleistung der UnabhÃ¤ngigkeit durch Vermeidung von Interessenkonflikten\nâ€¢ Kontinuierliche Weiterbildung der Auditoren zu neuen Bedrohungen und Best Practices\nâ€¢ Aufbau eines Pools qualifizierter interner Auditoren fÃ¼r verschiedene Fachbereiche\nâ€¢ Externe UnterstÃ¼tzung bei speziellen technischen Audits oder KompetenzlÃ¼cken\n\nğŸ” Audit-DurchfÃ¼hrung und Methodik:\nâ€¢ Systematische Vorbereitung mit Analyse der zu auditierenden Bereiche und Risiken\nâ€¢ Anwendung verschiedener Audit-Techniken wie Interviews, DokumentenprÃ¼fung und Beobachtung\nâ€¢ Stichprobenbasierte ÃœberprÃ¼fung der Implementierung und Wirksamkeit von Kontrollen\nâ€¢ Fokus auf ProzesseffektivitÃ¤t und nicht nur auf DokumentenkonformitÃ¤t\nâ€¢ Konstruktive Kommunikation mit Auditees zur FÃ¶rderung einer positiven Audit-Kultur\n\nğŸ“Š Audit-Berichterstattung und Follow-up:\nâ€¢ Strukturierte Dokumentation der Audit-Ergebnisse mit klaren Feststellungen und Empfehlungen\nâ€¢ Klassifikation von NichtkonformitÃ¤ten nach Schweregrad und Risikopotential\nâ€¢ Entwicklung konkreter und umsetzbarer Korrektur- und VerbesserungsmaÃŸnahmen\nâ€¢ Verfolgung der Umsetzung von MaÃŸnahmen bis zur vollstÃ¤ndigen Behebung\nâ€¢ Trend-Analyse Ã¼ber mehrere Audit-Zyklen zur Identifikation systemischer Probleme\n\nğŸ”„ Kontinuierliche Verbesserung des Audit-Prozesses:\nâ€¢ RegelmÃ¤ÃŸige Bewertung der Audit-EffektivitÃ¤t und Anpassung der Methodik\nâ€¢ Integration von Lessons Learned und Best Practices in das Audit-Programm\nâ€¢ Nutzung von Technologie zur Effizienzsteigerung und besseren Nachverfolgung\nâ€¢ Benchmarking mit externen Audit-Standards und Branchenpraktiken\nâ€¢ Aufbau einer lernenden Audit-Organisation mit kontinuierlicher Kompetenzentwicklung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'Wie erfolgt das Management Review im ISMS und welche Entscheidungen werden dabei getroffen?',
        answer: "Das Management Review ist ein strategisches Steuerungsinstrument im ISMS nach ISO 27001, das der obersten Leitung ermÃ¶glicht, die ISMS-Performance zu bewerten, strategische Entscheidungen zu treffen und die kontinuierliche Verbesserung zu steuern. Es bildet den HÃ¶hepunkt des PDCA-Zyklus und gewÃ¤hrleistet die strategische Ausrichtung des ISMS.\n\nğŸ›ï¸ Strategische Bedeutung des Management Reviews:\nâ€¢ Bewertung der fortdauernden Eignung, Angemessenheit und Wirksamkeit des ISMS\nâ€¢ Strategische Ausrichtung der Informationssicherheit an verÃ¤nderte GeschÃ¤ftsanforderungen\nâ€¢ Entscheidung Ã¼ber Ressourcenallokation und InvestitionsprioritÃ¤ten fÃ¼r Informationssicherheit\nâ€¢ Bewertung der ISMS-Performance im Kontext der Gesamtunternehmensstrategie\nâ€¢ Demonstration des FÃ¼hrungscommitments fÃ¼r Informationssicherheit gegenÃ¼ber Stakeholdern\n\nğŸ“Š Input-Informationen fÃ¼r das Management Review:\nâ€¢ Ergebnisse interner und externer Audits sowie deren Trend-Entwicklung\nâ€¢ Performance-Daten und KPIs zur ISMS-Wirksamkeit und Zielerreichung\nâ€¢ Feedback von Stakeholdern einschlieÃŸlich Kunden, Partnern und Mitarbeitern\nâ€¢ Status von Korrektur- und VerbesserungsmaÃŸnahmen aus vorherigen Reviews\nâ€¢ VerÃ¤nderungen in der Bedrohungslandschaft und neue Sicherheitsanforderungen\n\nğŸ¯ Bewertungsdimensionen im Management Review:\nâ€¢ Angemessenheit der Informationssicherheitspolitik und strategischen Ausrichtung\nâ€¢ Wirksamkeit der Risikomanagement-Prozesse und Risikobehandlungsstrategien\nâ€¢ Performance der implementierten Sicherheitskontrollen und deren Optimierungspotential\nâ€¢ Effizienz der ISMS-Prozesse und deren Integration in GeschÃ¤ftsprozesse\nâ€¢ Kompetenz und Ressourcenausstattung fÃ¼r ISMS-AktivitÃ¤ten\n\nğŸ’¡ Strategische Entscheidungen und Outputs:\nâ€¢ Anpassung der Informationssicherheitsstrategie und Zielsetzungen\nâ€¢ Genehmigung von Investitionen in neue Sicherheitstechnologien oder Prozesse\nâ€¢ Entscheidungen Ã¼ber Ã„nderungen im ISMS-Anwendungsbereich oder der Architektur\nâ€¢ Ressourcenallokation fÃ¼r VerbesserungsmaÃŸnahmen und neue Initiativen\nâ€¢ Anpassung der Organisationsstruktur oder Verantwortlichkeiten\n\nğŸ”„ Kontinuierliche Verbesserung durch Management Review:\nâ€¢ Identifikation strategischer VerbesserungsmÃ¶glichkeiten und Innovationspotentiale\nâ€¢ Priorisierung von VerbesserungsmaÃŸnahmen basierend auf GeschÃ¤ftsauswirkungen\nâ€¢ Etablierung von Verbesserungszielen und Erfolgsmessungen\nâ€¢ Integration von Lessons Learned und Best Practices in die ISMS-Strategie\nâ€¢ FÃ¶rderung einer Kultur der kontinuierlichen Verbesserung und Innovation\n\nğŸ“ˆ Nachverfolgung und Umsetzung:\nâ€¢ Dokumentation aller Entscheidungen und deren BegrÃ¼ndung fÃ¼r Nachvollziehbarkeit\nâ€¢ Entwicklung konkreter AktionsplÃ¤ne mit Verantwortlichkeiten und ZeitplÃ¤nen\nâ€¢ RegelmÃ¤ÃŸige Ãœberwachung des Umsetzungsfortschritts zwischen den Reviews\nâ€¢ Kommunikation der Review-Ergebnisse an alle relevanten Stakeholder\nâ€¢ Integration der Review-Outputs in die strategische Planung und Budgetierung\n\nğŸª Effektive Gestaltung des Review-Prozesses:\nâ€¢ Strukturierte Vorbereitung mit qualitativ hochwertigen Informationen und Analysen\nâ€¢ Angemessene Frequenz basierend auf GeschÃ¤ftsdynamik und Risikolandschaft\nâ€¢ Einbindung aller relevanten FÃ¼hrungskrÃ¤fte und Fachexperten\nâ€¢ Fokus auf strategische Themen statt operative Details\nâ€¢ Aufbau einer konstruktiven Diskussionskultur mit Fokus auf LÃ¶sungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'Welche Dokumentationsanforderungen bestehen fÃ¼r das ISMS und wie wird eine effiziente Dokumentenstruktur aufgebaut?',
        answer: "Die Dokumentation des ISMS nach ISO 27001 bildet das Fundament fÃ¼r systematisches Informationssicherheitsmanagement und gewÃ¤hrleistet Nachvollziehbarkeit, Konsistenz und KontinuitÃ¤t. Eine durchdachte Dokumentenstruktur unterstÃ¼tzt die operative Umsetzung und erleichtert Audits sowie die kontinuierliche Verbesserung.\n\nğŸ“‹ Obligatorische ISMS-Dokumentation nach ISO 27001:\nâ€¢ Informationssicherheitspolitik als strategisches Grundlagendokument\nâ€¢ Anwendungsbereich und Grenzen des ISMS mit klarer Abgrenzung\nâ€¢ Risikomanagement-Methodik und Bewertungskriterien\nâ€¢ Statement of Applicability mit BegrÃ¼ndung fÃ¼r Kontrollauswahl\nâ€¢ Risikobewertungsberichte und RisikobehandlungsplÃ¤ne\n\nğŸ”§ Operative Dokumentationsebenen:\nâ€¢ Verfahrensanweisungen fÃ¼r alle kritischen ISMS-Prozesse\nâ€¢ Arbeitsanweisungen fÃ¼r spezifische SicherheitsaktivitÃ¤ten\nâ€¢ Formulare und Checklisten zur Standardisierung wiederkehrender Aufgaben\nâ€¢ Protokolle und Aufzeichnungen als Nachweis der ISMS-AktivitÃ¤ten\nâ€¢ NotfallplÃ¤ne und Business Continuity Dokumentation\n\nğŸ—ï¸ Strukturprinzipien fÃ¼r ISMS-Dokumentation:\nâ€¢ Hierarchische Gliederung von strategischen Richtlinien bis zu operativen Arbeitsanweisungen\nâ€¢ Klare Zuordnung von Verantwortlichkeiten fÃ¼r Erstellung, PrÃ¼fung und Genehmigung\nâ€¢ Einheitliche Dokumentenstruktur und Formatierung fÃ¼r bessere Nutzbarkeit\nâ€¢ Versionskontrolle und Ã„nderungsmanagement fÃ¼r alle Dokumente\nâ€¢ Integration mit bestehenden Managementsystem-Dokumentationen\n\nğŸ“Š Dokumentenmanagement-System:\nâ€¢ Zentrale Dokumentenablage mit kontrollierten ZugriffsmÃ¶glichkeiten\nâ€¢ Automatisierte Workflows fÃ¼r Dokumentenerstellung und Genehmigungsprozesse\nâ€¢ Benachrichtigungssysteme fÃ¼r ÃœberprÃ¼fungszyklen und Aktualisierungen\nâ€¢ Suchfunktionen und Kategorisierung fÃ¼r effiziente Dokumentenauffindung\nâ€¢ Backup und Archivierung zur Sicherstellung der DokumentenverfÃ¼gbarkeit\n\nğŸ¯ QualitÃ¤tssicherung der Dokumentation:\nâ€¢ RegelmÃ¤ÃŸige ÃœberprÃ¼fung der DokumentenaktualitÃ¤t und Relevanz\nâ€¢ KonsistenzprÃ¼fung zwischen verschiedenen Dokumentenebenen\nâ€¢ VerstÃ¤ndlichkeitsprÃ¼fung durch Zielgruppen-Feedback\nâ€¢ VollstÃ¤ndigkeitsprÃ¼fung gegen ISO 27001 Anforderungen\nâ€¢ Kontinuierliche Verbesserung basierend auf Nutzererfahrungen\n\nğŸ’¡ Effizienzsteigerung durch intelligente Dokumentation:\nâ€¢ Nutzung von Templates und Standardformaten zur Reduzierung des Erstellungsaufwands\nâ€¢ Integration von Automatisierung fÃ¼r wiederkehrende Dokumentationsprozesse\nâ€¢ Verlinkung zwischen verwandten Dokumenten fÃ¼r bessere Navigation\nâ€¢ Multimedia-Elemente wie Diagramme und Videos fÃ¼r komplexe Sachverhalte\nâ€¢ Mobile ZugÃ¤nglichkeit fÃ¼r operative Mitarbeiter im Feld\n\nğŸ”„ Lebenszyklusmanagement der Dokumentation:\nâ€¢ Systematische Planung von ÃœberprÃ¼fungs- und Aktualisierungszyklen\nâ€¢ Change Management Prozesse fÃ¼r dokumentenrelevante Ã„nderungen\nâ€¢ Archivierung veralteter Dokumentenversionen mit Aufbewahrungsfristen\nâ€¢ Schulung der Mitarbeiter im Umgang mit der ISMS-Dokumentation\nâ€¢ Kontinuierliche Optimierung der Dokumentenstruktur basierend auf Nutzungsdaten\n\nğŸŒ Integration und Harmonisierung:\nâ€¢ Abstimmung mit anderen Managementsystem-Dokumentationen\nâ€¢ BerÃ¼cksichtigung regulatorischer Dokumentationsanforderungen\nâ€¢ Harmonisierung mit Unternehmensstandards und Corporate Design\nâ€¢ Integration in bestehende Wissensmanagement-Systeme\nâ€¢ Aufbau einer einheitlichen Dokumentationskultur in der Organisation"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('âœ… FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
