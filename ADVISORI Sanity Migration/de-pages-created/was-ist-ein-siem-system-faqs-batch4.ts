import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Was ist ein SIEM-System page with FAQ batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'was-ist-ein-siem-system' })
    
    if (!existingDoc) {
      throw new Error('Document "was-ist-ein-siem-system" not found')
    }
    
    // Create new FAQs for SIEM compliance and security aspects
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 13),
        question: 'Welche Compliance-Anforderungen m√ºssen SIEM-Systeme erf√ºllen und wie unterst√ºtzen sie regulatorische Vorgaben?',
        answer: "SIEM-Systeme spielen eine zentrale Rolle bei der Erf√ºllung verschiedener Compliance-Anforderungen und regulatorischer Vorgaben. Sie fungieren als technische Enabler f√ºr die Umsetzung von Sicherheitsstandards und bieten die notwendige Dokumentation und Nachweisf√ºhrung f√ºr Audits. Die Compliance-Unterst√ºtzung durch SIEM geht weit √ºber reine Log-Sammlung hinaus und umfasst proaktive √úberwachung und automatisierte Berichterstattung.\n\nüìã Regulatorische Frameworks und Standards:\n‚Ä¢ GDPR Compliance durch umfassende √úberwachung von Datenzugriffen und automatische Erkennung von Datenschutzverletzungen\n‚Ä¢ ISO 27001 Unterst√ºtzung durch kontinuierliche √úberwachung von Sicherheitskontrollen und Incident Management\n‚Ä¢ SOX Compliance f√ºr Finanzunternehmen durch √úberwachung von IT-Kontrollen und √Ñnderungsmanagement\n‚Ä¢ HIPAA Compliance im Gesundheitswesen durch Monitoring von Patientendatenzugriffen\n‚Ä¢ PCI DSS Anforderungen f√ºr Zahlungskartenindustrie durch √úberwachung von Karteninhaberdatenumgebungen\n\nüîç Automatisierte Compliance-√úberwachung:\n‚Ä¢ Real-time Monitoring von Compliance-relevanten Aktivit√§ten und automatische Alerting bei Verst√∂√üen\n‚Ä¢ Kontinuierliche Bewertung der Einhaltung von Sicherheitsrichtlinien und -standards\n‚Ä¢ Automatische Erkennung von Konfigurationsabweichungen und Schwachstellen\n‚Ä¢ √úberwachung von Benutzerrechten und Zugriffskontrolle f√ºr Privileged Access Management\n‚Ä¢ Tracking von Datenfl√ºssen und Klassifizierung f√ºr Data Loss Prevention\n\nüìä Audit-Unterst√ºtzung und Dokumentation:\n‚Ä¢ Umfassende Audit Trails f√ºr alle sicherheitsrelevanten Aktivit√§ten mit unver√§nderlicher Protokollierung\n‚Ä¢ Automatisierte Generierung von Compliance-Reports f√ºr verschiedene Stakeholder und Aufsichtsbeh√∂rden\n‚Ä¢ Forensische Analysef√§higkeiten f√ºr detaillierte Incident Investigation und Beweissicherung\n‚Ä¢ Retention Management f√ºr langfristige Speicherung compliance-relevanter Daten\n‚Ä¢ Chain of Custody Dokumentation f√ºr rechtliche Verwertbarkeit von Beweismitteln\n\nüõ°Ô∏è Datenschutz und Privacy Compliance:\n‚Ä¢ √úberwachung von Datenzugriffen und Identifikation unautorisierten Zugriffs auf personenbezogene Daten\n‚Ä¢ Automatische Erkennung von Datenlecks und Breach Notification Workflows\n‚Ä¢ Privacy Impact Assessment Unterst√ºtzung durch Datenfluss-Monitoring\n‚Ä¢ Right to be Forgotten Compliance durch Tracking von Datenl√∂schungsaktivit√§ten\n‚Ä¢ Cross-Border Data Transfer Monitoring f√ºr internationale Datenschutzbestimmungen\n\nüèõÔ∏è Branchenspezifische Compliance:\n‚Ä¢ Finanzsektor Regulierungen wie DORA, MiFID II und Basel III durch spezialisierte Monitoring-Capabilities\n‚Ä¢ Energiesektor Compliance wie NERC CIP f√ºr kritische Infrastrukturen\n‚Ä¢ Telekommunikation Regulierungen durch √úberwachung von Kommunikationsdaten\n‚Ä¢ Pharma und Life Sciences Compliance durch GxP-konforme Dokumentation\n‚Ä¢ Government und Defense Compliance durch FISMA und andere Sicherheitsstandards\n\nüìà Kontinuierliche Compliance-Verbesserung:\n‚Ä¢ Gap Analysis und Compliance Assessment durch automatisierte Bewertung\n‚Ä¢ Trend Analysis f√ºr proaktive Identifikation von Compliance-Risiken\n‚Ä¢ Benchmarking gegen Industry Standards und Best Practices\n‚Ä¢ Integration mit GRC-Plattformen f√ºr ganzheitliches Compliance Management\n‚Ä¢ Regular Compliance Health Checks und Maturity Assessments"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 14),
        question: 'Wie gew√§hrleistet man die Sicherheit der SIEM-Infrastruktur selbst und sch√ºtzt sie vor Angriffen?',
        answer: "Die Sicherheit der SIEM-Infrastruktur ist von kritischer Bedeutung, da diese Systeme hochsensible Sicherheitsdaten verarbeiten und selbst zu attraktiven Zielen f√ºr Angreifer werden. Ein kompromittiertes SIEM-System kann nicht nur die Sicherheits√ºberwachung beeintr√§chtigen, sondern auch als Sprungbrett f√ºr weitere Angriffe dienen. Eine umfassende Sicherheitsstrategie f√ºr SIEM-Systeme erfordert mehrschichtige Schutzma√ünahmen.\n\nüè∞ Infrastruktur-H√§rtung und Segmentierung:\n‚Ä¢ Dedizierte Netzwerksegmentierung f√ºr SIEM-Komponenten mit strikter Zugriffskontrolle\n‚Ä¢ Hardening aller SIEM-Server und -Komponenten nach Security Baselines und Best Practices\n‚Ä¢ Minimierung der Angriffsfl√§che durch Deaktivierung unn√∂tiger Services und Ports\n‚Ä¢ Implementierung von Network Access Control f√ºr alle SIEM-Netzwerksegmente\n‚Ä¢ Physische Sicherheit f√ºr SIEM-Hardware in gesicherten Rechenzentren\n\nüîê Zugriffskontrolle und Authentifizierung:\n‚Ä¢ Multi-Faktor-Authentifizierung f√ºr alle SIEM-Administratoren und Benutzer\n‚Ä¢ Rollenbasierte Zugriffskontrolle mit Principle of Least Privilege\n‚Ä¢ Privileged Access Management f√ºr administrative SIEM-Zugriffe\n‚Ä¢ Regular Access Reviews und Zertifizierung von Benutzerrechten\n‚Ä¢ Session Monitoring und Recording f√ºr administrative Aktivit√§ten\n\nüõ°Ô∏è Verschl√ºsselung und Datenschutz:\n‚Ä¢ End-to-End-Verschl√ºsselung f√ºr alle Log-Daten√ºbertragungen zum SIEM\n‚Ä¢ Verschl√ºsselung gespeicherter Daten in SIEM-Datenbanken und Archiven\n‚Ä¢ Sichere Schl√ºsselverwaltung mit Hardware Security Modules\n‚Ä¢ Anonymisierung und Pseudonymisierung sensibler Daten wo m√∂glich\n‚Ä¢ Secure Communication Protocols f√ºr alle SIEM-Integrationen\n\nüîç Kontinuierliche √úberwachung der SIEM-Sicherheit:\n‚Ä¢ Monitoring der SIEM-Infrastruktur selbst durch separate √úberwachungssysteme\n‚Ä¢ Intrusion Detection f√ºr SIEM-Netzwerksegmente und -Systeme\n‚Ä¢ File Integrity Monitoring f√ºr kritische SIEM-Konfigurationsdateien\n‚Ä¢ Anomalie-Erkennung f√ºr SIEM-Administrator-Aktivit√§ten\n‚Ä¢ Regular Vulnerability Scanning und Penetration Testing der SIEM-Umgebung\n\nüîÑ Backup und Disaster Recovery:\n‚Ä¢ Regelm√§√üige Backups aller SIEM-Konfigurationen und kritischen Daten\n‚Ä¢ Geografisch verteilte Backup-Speicherung f√ºr Disaster Recovery\n‚Ä¢ Regular Backup-Verifikation und Restore-Tests\n‚Ä¢ Dokumentierte Disaster Recovery Procedures f√ºr SIEM-Systeme\n‚Ä¢ Business Continuity Planning f√ºr SIEM-Operations\n\n‚ö° Incident Response f√ºr SIEM-Kompromittierung:\n‚Ä¢ Spezielle Incident Response Playbooks f√ºr SIEM-Sicherheitsvorf√§lle\n‚Ä¢ Forensische Analysef√§higkeiten f√ºr kompromittierte SIEM-Systeme\n‚Ä¢ Isolation und Containment Procedures f√ºr betroffene SIEM-Komponenten\n‚Ä¢ Alternative Monitoring-Capabilities w√§hrend SIEM-Wiederherstellung\n‚Ä¢ Post-Incident-Analyse und Lessons Learned f√ºr SIEM-Sicherheitsverbesserungen\n\nüîß Patch Management und Wartung:\n‚Ä¢ Strukturiertes Patch Management f√ºr alle SIEM-Komponenten\n‚Ä¢ Security Update Priorisierung basierend auf Vulnerability Assessment\n‚Ä¢ Change Management Prozesse f√ºr SIEM-Konfigurations√§nderungen\n‚Ä¢ Regular Security Assessments und Compliance Audits\n‚Ä¢ Vendor Security Advisory Monitoring und Response"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 15),
        question: 'Welche Datenschutz und Privacy-Aspekte m√ºssen bei SIEM-Implementierungen ber√ºcksichtigt werden?',
        answer: "Datenschutz und Privacy-Aspekte sind bei SIEM-Implementierungen von zentraler Bedeutung, da diese Systeme gro√üe Mengen potenziell personenbezogener Daten verarbeiten. Die Herausforderung liegt darin, effektive Sicherheits√ºberwachung zu gew√§hrleisten, w√§hrend gleichzeitig Datenschutzbestimmungen eingehalten und die Privatsph√§re der Benutzer gesch√ºtzt wird. Eine durchdachte Privacy-by-Design-Strategie ist essentiell f√ºr DSGVO-konforme SIEM-Operationen.\n\nüîí Datenminimierung und Zweckbindung:\n‚Ä¢ Sammlung nur derjenigen Daten, die f√ºr legitime Sicherheitszwecke erforderlich sind\n‚Ä¢ Klare Definition und Dokumentation der Verarbeitungszwecke f√ºr alle gesammelten Daten\n‚Ä¢ Regular Data Inventory und Classification f√ºr alle SIEM-Datenquellen\n‚Ä¢ Automatische Filterung irrelevanter oder √ºberm√§√üiger personenbezogener Daten\n‚Ä¢ Zweckbindung der Datenverwendung ausschlie√ülich f√ºr Sicherheits- und Compliance-Zwecke\n\nüé≠ Anonymisierung und Pseudonymisierung:\n‚Ä¢ Implementierung von Anonymisierungstechniken f√ºr nicht-kritische Analysezwecke\n‚Ä¢ Pseudonymisierung von Benutzerdaten zur Reduzierung von Privacy-Risiken\n‚Ä¢ Tokenisierung sensibler Datenelemente wie Benutzernamen oder IP-Adressen\n‚Ä¢ Differential Privacy Techniken f√ºr statistische Analysen\n‚Ä¢ Data Masking f√ºr Test- und Entwicklungsumgebungen\n\nüìã Rechtsgrundlagen und Betroffenenrechte:\n‚Ä¢ Klare Rechtsgrundlagen f√ºr SIEM-Datenverarbeitung nach DSGVO Artikel 6 und 9\n‚Ä¢ Implementierung von Verfahren f√ºr Betroffenenrechte wie Auskunft, Berichtigung und L√∂schung\n‚Ä¢ Right to be Forgotten Compliance durch automatisierte Datenl√∂schungsverfahren\n‚Ä¢ Data Portability Unterst√ºtzung f√ºr berechtigte Anfragen\n‚Ä¢ Widerspruchsrecht-Management f√ºr Marketing- und Profiling-Aktivit√§ten\n\nüåç Internationale Datentransfers:\n‚Ä¢ Compliance mit internationalen Datentransfer-Bestimmungen wie GDPR Kapitel V\n‚Ä¢ Implementierung angemessener Schutzma√ünahmen f√ºr Drittland-Transfers\n‚Ä¢ Standard Contractual Clauses f√ºr Vendor-Beziehungen mit internationalen SIEM-Anbietern\n‚Ä¢ Data Localization Requirements f√ºr bestimmte Branchen oder Jurisdiktionen\n‚Ä¢ Cross-Border Incident Response Koordination unter Ber√ºcksichtigung lokaler Datenschutzgesetze\n\nüîç Privacy Impact Assessments:\n‚Ä¢ Durchf√ºhrung von Data Protection Impact Assessments f√ºr SIEM-Implementierungen\n‚Ä¢ Regular Privacy Risk Assessments f√ºr neue Datenquellen oder Use Cases\n‚Ä¢ Stakeholder Consultation und Betroffenen-Feedback-Integration\n‚Ä¢ Dokumentation von Privacy-Schutzma√ünahmen und deren Wirksamkeit\n‚Ä¢ Continuous Privacy Monitoring und Compliance-Bewertung\n\nüë• Mitarbeiter-Privacy und Workplace Monitoring:\n‚Ä¢ Balance zwischen Sicherheits√ºberwachung und Mitarbeiter-Privacy-Rechten\n‚Ä¢ Transparente Kommunikation √ºber SIEM-Monitoring-Aktivit√§ten\n‚Ä¢ Proportionalit√§tsprinzip bei der √úberwachung von Mitarbeiteraktivit√§ten\n‚Ä¢ Works Council und Employee Representative Consultation\n‚Ä¢ Privacy-freundliche Konfiguration von User Activity Monitoring\n\nüìä Governance und Accountability:\n‚Ä¢ Appointment von Data Protection Officers f√ºr SIEM-Operations\n‚Ä¢ Privacy-by-Design und Privacy-by-Default Implementierung\n‚Ä¢ Regular Privacy Training f√ºr SIEM-Administratoren und Analysten\n‚Ä¢ Incident Response Procedures f√ºr Privacy-Verletzungen\n‚Ä¢ Documentation und Audit Trails f√ºr alle Privacy-relevanten Aktivit√§ten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 16),
        question: 'Wie integriert man Threat Intelligence in SIEM-Systeme f√ºr verbesserte Bedrohungserkennung?',
        answer: "Die Integration von Threat Intelligence in SIEM-Systeme ist entscheidend f√ºr die Transformation von reaktiver zu proaktiver Cybersecurity. Threat Intelligence liefert den notwendigen Kontext, um aus Millionen von Events relevante Bedrohungen zu identifizieren und False Positives zu reduzieren. Eine strategische Threat Intelligence Integration erh√∂ht die Detection-Genauigkeit und erm√∂glicht pr√§zise Risikobewertungen.\n\nüåê Threat Intelligence Quellen und Feeds:\n‚Ä¢ Integration kommerzieller Threat Intelligence Feeds von spezialisierten Anbietern\n‚Ä¢ Open Source Intelligence (OSINT) Quellen f√ºr aktuelle Bedrohungsinformationen\n‚Ä¢ Government und Industry Sharing Initiatives wie CERT-Feeds\n‚Ä¢ Internal Threat Intelligence aus eigenen Incident-Analysen und Forensik\n‚Ä¢ Community-basierte Intelligence Sharing mit Branchenkollegen\n\nüîÑ Automatisierte Intelligence Integration:\n‚Ä¢ STIX/TAXII Standards f√ºr strukturierten Threat Intelligence Austausch\n‚Ä¢ Automatische IOC-Updates und Blacklist-Management\n‚Ä¢ Real-time Feed Processing und Normalisierung verschiedener Intelligence-Formate\n‚Ä¢ API-basierte Integration f√ºr kontinuierliche Intelligence-Updates\n‚Ä¢ Machine-readable Intelligence Formats f√ºr automatisierte Verarbeitung\n\nüéØ Contextual Enrichment und Attribution:\n‚Ä¢ Automatische Anreicherung von SIEM-Alerts mit relevanten Threat Intelligence Informationen\n‚Ä¢ Attribution von Angriffen zu bekannten Threat Actors und Kampagnen\n‚Ä¢ TTPs (Tactics, Techniques, Procedures) Mapping gegen MITRE ATT&CK Framework\n‚Ä¢ Geolocation und Infrastructure Analysis f√ºr verd√§chtige IP-Adressen\n‚Ä¢ Malware Family Classification und Behavior Analysis\n\nüìä Intelligence-driven Analytics:\n‚Ä¢ Threat Hunting Queries basierend auf aktuellen Intelligence-Erkenntnissen\n‚Ä¢ Predictive Analytics f√ºr emerging Threats und Attack Patterns\n‚Ä¢ Risk Scoring basierend auf Threat Intelligence Confidence und Relevance\n‚Ä¢ Campaign Tracking und Multi-Stage Attack Detection\n‚Ä¢ Threat Landscape Analysis f√ºr strategische Security Planning\n\nüîç Proaktive Threat Hunting:\n‚Ä¢ Hypothesis-driven Hunting basierend auf Intelligence-Erkenntnissen\n‚Ä¢ IOC Sweeping f√ºr historische Daten und Compromise Assessment\n‚Ä¢ Behavioral Analysis f√ºr Advanced Persistent Threats\n‚Ä¢ Infrastructure Tracking f√ºr Command and Control Servers\n‚Ä¢ Supply Chain Threat Intelligence f√ºr Third-Party Risk Assessment\n\n‚ö° Automated Response und Mitigation:\n‚Ä¢ Automatische Blocking von bekannten malicious Indicators\n‚Ä¢ Dynamic Firewall Rule Updates basierend auf Threat Intelligence\n‚Ä¢ DNS Sinkholing f√ºr Command and Control Domains\n‚Ä¢ Email Security Integration f√ºr Phishing und Malware Prevention\n‚Ä¢ Endpoint Protection Updates mit aktuellen Threat Signatures\n\nüìà Intelligence Quality und Validation:\n‚Ä¢ Source Reliability Assessment und Confidence Scoring\n‚Ä¢ False Positive Tracking und Intelligence Feedback Loops\n‚Ä¢ Timeliness und Relevance Evaluation f√ºr verschiedene Intelligence Sources\n‚Ä¢ Peer Review und Validation von Critical Intelligence\n‚Ä¢ ROI Measurement f√ºr Threat Intelligence Investments\n\nüîß Platform Integration und Orchestration:\n‚Ä¢ Threat Intelligence Platform (TIP) Integration f√ºr centralized Intelligence Management\n‚Ä¢ SOAR Platform Integration f√ºr automatisierte Intelligence-driven Workflows\n‚Ä¢ Vulnerability Management Integration f√ºr Threat-informed Patch Prioritization\n‚Ä¢ Incident Response Platform Integration f√ºr Intelligence-supported Investigations\n‚Ä¢ Business Intelligence Integration f√ºr Executive Threat Reporting"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
