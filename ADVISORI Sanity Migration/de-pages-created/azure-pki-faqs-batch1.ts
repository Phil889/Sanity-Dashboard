import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Azure PKI page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'azure-pki' })
    
    if (!existingDoc) {
      throw new Error('Document "azure-pki" not found')
    }
    
    // Create new FAQs for Azure PKI fundamentals and Key Vault integration
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Was ist Azure PKI und welche spezifischen Vorteile bietet es gegen√ºber anderen Cloud PKI-L√∂sungen?',
        answer: "Azure PKI repr√§sentiert Microsofts umfassende Antwort auf moderne Certificate Management Herausforderungen in der Cloud. Als integraler Bestandteil des Azure Ecosystems bietet es einzigartige Vorteile durch die tiefe Integration mit Microsoft Services und die Nutzung der globalen Azure-Infrastruktur.\n\nüî∑ Microsoft Ecosystem Integration:\n‚Ä¢ Nahtlose Integration mit Azure Active Directory f√ºr Identity-basierte PKI-Governance und Single Sign-On Funktionalit√§ten\n‚Ä¢ Native Unterst√ºtzung f√ºr Microsoft Office und Teams f√ºr sichere Kommunikation und Dokumentenaustausch\n‚Ä¢ Direkte Integration in Windows Server Active Directory Certificate Services f√ºr Hybrid-Szenarien\n‚Ä¢ Exchange Online und SharePoint Online Integration f√ºr sichere E-Mail und Collaboration\n‚Ä¢ Power Platform Integration f√ºr sichere Low-Code und No-Code Anwendungsentwicklung\n\n‚òÅÔ∏è Azure-native Infrastruktur und Services:\n‚Ä¢ Azure Key Vault als zentraler Service f√ºr Certificate, Key und Secret Management mit globaler Verf√ºgbarkeit\n‚Ä¢ Azure Managed HSM f√ºr FIPS-konforme Hardware Security Module Services mit dedizierter Tenant-Isolation\n‚Ä¢ Azure Monitor und Security Center Integration f√ºr umfassende √úberwachung und Threat Detection\n‚Ä¢ Azure Policy Integration f√ºr automatisierte Compliance und Governance Enforcement\n‚Ä¢ Azure Resource Manager Templates f√ºr Infrastructure as Code Deployments\n\nüõ°Ô∏è Enterprise-grade Sicherheit und Compliance:\n‚Ä¢ Multi-layered Security Approach mit Defense-in-Depth Strategien auf Infrastruktur- und Anwendungsebene\n‚Ä¢ Compliance mit internationalen Standards wie SOC, ISO, FedRAMP und branchenspezifischen Regulierungen\n‚Ä¢ Advanced Threat Protection durch Azure Sentinel Integration und Machine Learning-basierte Anomalie-Erkennung\n‚Ä¢ Zero Trust Architecture Support f√ºr moderne Sicherheitskonzepte ohne implizites Vertrauen\n‚Ä¢ Conditional Access Policies f√ºr granulare Zugriffskontrolle basierend auf Kontext und Risikobewertung\n\nüîß DevOps und Automation Excellence:\n‚Ä¢ Azure DevOps Services Integration f√ºr CI/CD Pipeline Automation und Certificate Lifecycle Management\n‚Ä¢ GitHub Actions Support f√ºr moderne DevOps Workflows und Infrastructure as Code Praktiken\n‚Ä¢ PowerShell und Azure CLI Integration f√ºr Scripting und Automation von PKI-Operationen\n‚Ä¢ REST APIs und SDKs f√ºr alle g√§ngigen Programmiersprachen und Entwicklungsumgebungen\n‚Ä¢ Logic Apps Integration f√ºr Workflow Automation und Business Process Integration\n\nüåê Globale Skalierung und Verf√ºgbarkeit:\n‚Ä¢ Weltweite Azure-Regionen f√ºr lokale Compliance-Anforderungen und optimale Performance\n‚Ä¢ Auto-scaling Capabilities f√ºr dynamische Anpassung an schwankende Certificate-Anforderungen\n‚Ä¢ Disaster Recovery und Business Continuity durch Multi-Region Deployments\n‚Ä¢ Content Delivery Network Integration f√ºr optimale Certificate Distribution und Validation\n‚Ä¢ Edge Computing Support f√ºr IoT und Mobile Device Certificate Management"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie funktioniert Azure Key Vault f√ºr PKI-Services und welche Certificate Management Funktionalit√§ten bietet es?',
        answer: "Azure Key Vault fungiert als das zentrale Nervensystem f√ºr PKI-Services in der Microsoft Cloud und bietet eine umfassende, sichere Plattform f√ºr Certificate, Key und Secret Management. Die L√∂sung kombiniert Hardware-basierte Sicherheit mit Cloud-nativer Skalierbarkeit und Enterprise-grade Funktionalit√§ten.\n\nüîê Certificate Lifecycle Management:\n‚Ä¢ Automatische Certificate Enrollment und Provisioning durch Integration mit Certificate Authorities\n‚Ä¢ Intelligent Certificate Renewal mit konfigurierbaren Vorlaufzeiten und Notification-Systemen\n‚Ä¢ Certificate Versioning und Rollback-Funktionalit√§ten f√ºr sichere Updates und Disaster Recovery\n‚Ä¢ Certificate Template Management f√ºr standardisierte Certificate-Erstellung und Policy Enforcement\n‚Ä¢ Certificate Chain Validation und Trust Path Verification f√ºr End-to-End Sicherheit\n\nüèóÔ∏è Architektur und Integration:\n‚Ä¢ Hardware Security Module Backend f√ºr FIPS-konforme Key Generation und Cryptographic Operations\n‚Ä¢ REST API Interface f√ºr programmatische Integration in Anwendungen und Automatisierungsworkflows\n‚Ä¢ Azure Resource Manager Integration f√ºr Infrastructure as Code Deployments und Template-basierte Verwaltung\n‚Ä¢ Virtual Network Service Endpoints f√ºr sichere, private Connectivity ohne Internet-Exposition\n‚Ä¢ Private Link Support f√ºr dedizierte, isolierte Netzwerkverbindungen zu Key Vault Services\n\nüîí Access Control und Security:\n‚Ä¢ Role-Based Access Control mit granularen Berechtigungen f√ºr Certificate Operations und Administrative Tasks\n‚Ä¢ Azure Active Directory Integration f√ºr Identity-basierte Authentifizierung und Authorization\n‚Ä¢ Conditional Access Policies f√ºr kontextuelle Zugriffskontrolle basierend auf Benutzer, Ger√§t und Standort\n‚Ä¢ Multi-Factor Authentication Enforcement f√ºr kritische PKI-Operationen und Administrative Zugriffe\n‚Ä¢ Just-in-Time Access f√ºr tempor√§re, zeitlich begrenzte Berechtigungen f√ºr Wartung und Troubleshooting\n\nüìä Monitoring und Compliance:\n‚Ä¢ Comprehensive Audit Logging f√ºr alle Certificate und Key Operations mit unver√§nderlichen Audit Trails\n‚Ä¢ Azure Monitor Integration f√ºr Real-time Alerting und Performance Monitoring\n‚Ä¢ Security Center Integration f√ºr Security Posture Assessment und Threat Detection\n‚Ä¢ Compliance Dashboard f√ºr kontinuierliche √úberwachung von Regulatory Requirements\n‚Ä¢ Custom Metrics und KPIs f√ºr Business-spezifische Certificate Management Anforderungen\n\nüîÑ Backup und Disaster Recovery:\n‚Ä¢ Automated Backup Strategies f√ºr Certificate und Key Material mit konfigurierbaren Retention Policies\n‚Ä¢ Cross-Region Replication f√ºr Geographic Redundancy und Disaster Recovery Capabilities\n‚Ä¢ Point-in-Time Recovery f√ºr granulare Wiederherstellung von Certificate States\n‚Ä¢ Soft Delete und Purge Protection f√ºr versehentlich gel√∂schte Certificates und Keys\n‚Ä¢ Business Continuity Planning mit RTO und RPO Optimierung f√ºr kritische PKI-Services\n\n‚ö° Performance und Skalierung:\n‚Ä¢ Global Distribution f√ºr optimale Latency und Performance in verschiedenen geografischen Regionen\n‚Ä¢ Auto-scaling f√ºr dynamische Anpassung an schwankende Certificate-Anforderungen\n‚Ä¢ Caching Strategies f√ºr h√§ufig verwendete Certificates und Keys\n‚Ä¢ Load Balancing f√ºr High Availability und Performance Optimization\n‚Ä¢ Throttling und Rate Limiting f√ºr Schutz vor Missbrauch und Denial-of-Service Attacken"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Rolle spielt Azure Managed HSM in PKI-Implementierungen und wie unterscheidet es sich von Standard Key Vault?',
        answer: "Azure Managed HSM repr√§sentiert die Premium-Tier L√∂sung f√ºr Hardware Security Module Services in Azure und bietet dedizierte, FIPS-zertifizierte Hardware f√ºr h√∂chste Sicherheitsanforderungen. Es adressiert spezifische Compliance- und Sicherheitsanforderungen, die √ºber Standard Key Vault Capabilities hinausgehen.\n\nüèõÔ∏è Hardware Security Module Architektur:\n‚Ä¢ FIPS 140-2 Level 3 zertifizierte Hardware Security Modules f√ºr h√∂chste Sicherheitsstandards\n‚Ä¢ Dedizierte Hardware-Tenants f√ºr vollst√§ndige Isolation und Kontrolle √ºber kryptographische Operationen\n‚Ä¢ Tamper-resistant und Tamper-evident Hardware f√ºr physischen Schutz gegen Manipulation\n‚Ä¢ Hardware-basierte True Random Number Generation f√ºr kryptographisch sichere Schl√ºsselerzeugung\n‚Ä¢ Secure Key Storage mit Hardware-enforced Access Controls und Encryption at Rest\n\nüîê Advanced Cryptographic Capabilities:\n‚Ä¢ Support f√ºr erweiterte Kryptographie-Algorithmen und Custom Cryptographic Functions\n‚Ä¢ Hardware-accelerated Cryptographic Operations f√ºr High-Performance Anwendungen\n‚Ä¢ Quantum-resistant Cryptography Support f√ºr zukunftssichere PKI-Implementierungen\n‚Ä¢ Custom Key Derivation Functions und Specialized Cryptographic Protocols\n‚Ä¢ Multi-party Computation Support f√ºr verteilte Kryptographie-Szenarien\n\nüè¢ Enterprise und Regulatory Compliance:\n‚Ä¢ Common Criteria EAL4+ Zertifizierung f√ºr Government und High-Security Umgebungen\n‚Ä¢ FIPS 140-2 Level 3 Compliance f√ºr Federal und Defense Contractor Requirements\n‚Ä¢ SOC 2 Type II und ISO 27001 Zertifizierungen f√ºr Enterprise Compliance Frameworks\n‚Ä¢ PCI DSS Level 1 Compliance f√ºr Payment Card Industry Anforderungen\n‚Ä¢ HIPAA und GDPR Compliance f√ºr Healthcare und Privacy Regulierungen\n\n‚öôÔ∏è Operational Excellence und Management:\n‚Ä¢ Dedicated HSM Cluster Management mit High Availability und Load Distribution\n‚Ä¢ Custom Security Domain Configuration f√ºr Multi-tenant Isolation und Governance\n‚Ä¢ Backup und Recovery Strategies mit Hardware-enforced Key Escrow Capabilities\n‚Ä¢ Role-based Administration mit Separation of Duties f√ºr kritische HSM Operations\n‚Ä¢ Comprehensive Audit Logging mit Hardware-signed Audit Trails f√ºr Forensic Analysis\n\nüîÑ Integration und Interoperability:\n‚Ä¢ PKCS#11 API Support f√ºr Legacy Application Integration und Third-party Tool Compatibility\n‚Ä¢ JCE Provider Integration f√ºr Java-basierte Enterprise Applications\n‚Ä¢ Microsoft CryptoAPI Integration f√ºr Windows-native Application Support\n‚Ä¢ OpenSSL Engine Integration f√ºr Linux und Open Source Application Compatibility\n‚Ä¢ Custom API Development f√ºr Specialized Integration Requirements\n\nüí∞ Cost und Performance Considerations:\n‚Ä¢ Dedicated Hardware Allocation f√ºr predictable Performance und Latency Characteristics\n‚Ä¢ Premium Pricing Model f√ºr Enterprise-grade Hardware Security Module Services\n‚Ä¢ Optimized f√ºr High-volume Cryptographic Operations und Certificate Management Workloads\n‚Ä¢ Scalable Architecture f√ºr Growing Certificate Management Requirements\n‚Ä¢ Total Cost of Ownership Optimization durch Managed Service Model und Operational Efficiency\n\nüåê Hybrid und Multi-Cloud Integration:\n‚Ä¢ On-premises HSM Integration f√ºr Hybrid Cloud PKI Architectures\n‚Ä¢ Cross-Cloud HSM Federation f√ºr Multi-Cloud Certificate Management Strategies\n‚Ä¢ ExpressRoute und VPN Gateway Integration f√ºr Secure Hybrid Connectivity\n‚Ä¢ Azure Stack Hub Integration f√ºr Consistent Hybrid Cloud Experiences\n‚Ä¢ Third-party HSM Interoperability f√ºr Vendor-agnostic PKI Implementations"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie erfolgt die Integration von Azure PKI mit Azure Active Directory und welche Identity-basierten PKI-Features sind verf√ºgbar?',
        answer: "Die Integration von Azure PKI mit Azure Active Directory schafft eine leistungsstarke Symbiose zwischen Identity Management und Certificate Management, die moderne Zero Trust Architekturen und Identity-basierte Sicherheitskonzepte erm√∂glicht. Diese Integration bildet das Fundament f√ºr sichere, skalierbare und benutzerfreundliche PKI-Implementierungen.\n\nüÜî Identity-basierte Certificate Management:\n‚Ä¢ User Certificate Enrollment basierend auf Azure AD Identities mit automatischer Lifecycle-Verwaltung\n‚Ä¢ Device Certificate Provisioning f√ºr Azure AD Joined und Hybrid Joined Devices\n‚Ä¢ Service Principal Certificate Management f√ºr Application-to-Application Authentication\n‚Ä¢ Managed Identity Integration f√ºr Azure Services ohne explizite Certificate Management\n‚Ä¢ Group-based Certificate Policies f√ºr rollenbasierte Certificate-Verteilung und Governance\n\nüîê Single Sign-On und Authentication Integration:\n‚Ä¢ Certificate-based Authentication f√ºr Azure AD mit Smart Card und PIV Card Support\n‚Ä¢ Seamless SSO f√ºr PKI-enabled Applications durch Azure AD Application Proxy\n‚Ä¢ Multi-Factor Authentication Integration mit Certificate-based Second Factor\n‚Ä¢ Conditional Access Policies f√ºr Certificate-basierte Zugriffskontrolle\n‚Ä¢ Passwordless Authentication Scenarios mit Certificate und Biometric Combinations\n\nüè¢ Enterprise Integration und Governance:\n‚Ä¢ Azure AD Connect Integration f√ºr Hybrid Identity und Certificate Synchronization\n‚Ä¢ Active Directory Certificate Services Integration f√ºr On-premises PKI Extension\n‚Ä¢ Group Policy Integration f√ºr Certificate Auto-enrollment und Policy Distribution\n‚Ä¢ Privileged Identity Management f√ºr Administrative Certificate Access\n‚Ä¢ Identity Governance f√ºr Certificate Lifecycle Management und Access Reviews\n\nüì± Modern Authentication und Device Management:\n‚Ä¢ Intune Integration f√ºr Mobile Device Certificate Management und Policy Enforcement\n‚Ä¢ Windows Hello for Business Integration f√ºr Biometric Authentication mit Certificate Backing\n‚Ä¢ Azure AD Application Registration f√ºr Certificate-based Service Authentication\n‚Ä¢ Microsoft Authenticator Integration f√ºr Certificate-backed Multi-Factor Authentication\n‚Ä¢ Conditional Access f√ºr Device Compliance und Certificate-based Access Control\n\nüîÑ Automated Workflows und Lifecycle Management:\n‚Ä¢ Azure Logic Apps Integration f√ºr Certificate Lifecycle Automation und Business Process Integration\n‚Ä¢ Power Automate Workflows f√ºr Certificate Request Approval und Notification Processes\n‚Ä¢ Azure Functions f√ºr Custom Certificate Processing und Integration Logic\n‚Ä¢ Event-driven Certificate Management durch Azure Event Grid Integration\n‚Ä¢ Automated Certificate Renewal basierend auf Azure AD User und Device Lifecycle Events\n\nüõ°Ô∏è Security und Compliance Integration:\n‚Ä¢ Azure AD Identity Protection f√ºr Risk-based Certificate Access Control\n‚Ä¢ Azure Sentinel Integration f√ºr Certificate-related Security Event Monitoring\n‚Ä¢ Compliance Manager Integration f√ºr Certificate Compliance Tracking und Reporting\n‚Ä¢ Azure Policy Integration f√ºr Certificate Governance und Compliance Automation\n‚Ä¢ Security Graph API Integration f√ºr Holistic Security Posture Management\n\nüåê Cross-platform und Multi-cloud Support:\n‚Ä¢ Azure AD B2B Integration f√ºr External User Certificate Management\n‚Ä¢ Azure AD B2C Integration f√ºr Customer Identity und Certificate Services\n‚Ä¢ Microsoft Graph API f√ºr Programmatic Certificate und Identity Management\n‚Ä¢ Cross-tenant Certificate Trust f√ºr Multi-organization Scenarios\n‚Ä¢ Federated Identity Support f√ºr Third-party Identity Provider Integration\n\nüìä Monitoring und Analytics:\n‚Ä¢ Azure AD Sign-in Logs Integration f√ºr Certificate Authentication Monitoring\n‚Ä¢ Usage Analytics f√ºr Certificate Utilization und Performance Optimization\n‚Ä¢ Risk Detection f√ºr Anomalous Certificate Usage Patterns\n‚Ä¢ Compliance Reporting f√ºr Certificate-based Access und Usage Patterns\n‚Ä¢ Custom Dashboards f√ºr Certificate und Identity Management KPIs"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
