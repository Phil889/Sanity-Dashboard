import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 BSI page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-bsi' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-bsi" not found')
    }
    
    // Create new FAQs for ISO 27001 BSI implementation
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Welche Schritte sind fÃ¼r eine erfolgreiche BSI-konforme ISO 27001 Zertifizierung erforderlich?',
        answer: "Eine BSI-konforme ISO 27001 Zertifizierung erfordert einen strukturierten, mehrstufigen Ansatz, der sowohl internationale ISO 27001 Standards als auch spezifische deutsche BSI-Anforderungen berÃ¼cksichtigt. Der Zertifizierungsprozess umfasst sowohl technische als auch organisatorische Aspekte und erfordert eine sorgfÃ¤ltige Vorbereitung und DurchfÃ¼hrung.\n\nğŸ“‹ Vorbereitungsphase:\nâ€¢ DurchfÃ¼hrung einer umfassenden BSI-konformen Gap-Analyse zur Identifikation von Verbesserungsbedarfen\nâ€¢ Entwicklung einer integrierten ISMS-Strategie, die ISO 27001 und BSI-Standards harmonisch verbindet\nâ€¢ Aufbau der erforderlichen organisatorischen Strukturen und Verantwortlichkeiten\nâ€¢ Schulung und Sensibilisierung aller beteiligten Mitarbeiter zu beiden Standards\nâ€¢ Erstellung eines detaillierten Implementierungs- und Zertifizierungsplans\n\nğŸ—ï¸ ISMS-Implementierung:\nâ€¢ Entwicklung BSI-konformer Informationssicherheitsrichtlinien und Verfahrensanweisungen\nâ€¢ Integration von IT-Grundschutz-Bausteinen in die ISO 27001 Kontrollstruktur\nâ€¢ DurchfÃ¼hrung einer risikobasierten Schutzbedarfsfeststellung nach BSI-Methodik\nâ€¢ Implementierung technischer und organisatorischer SicherheitsmaÃŸnahmen\nâ€¢ Aufbau von Monitoring-, Incident Response- und Business Continuity-Prozessen\n\nğŸ” Interne Vorbereitung:\nâ€¢ DurchfÃ¼hrung interner Audits zur ÃœberprÃ¼fung der ISMS-Wirksamkeit\nâ€¢ Management Review zur Bewertung der ISMS-Performance und kontinuierlichen Verbesserung\nâ€¢ Dokumentation aller Prozesse, Verfahren und Nachweise entsprechend beiden Standards\nâ€¢ Pre-Assessment durch qualifizierte interne oder externe Auditoren\nâ€¢ Behebung identifizierter Schwachstellen und Verbesserungspotentiale\n\nğŸ† Zertifizierungsaudit:\nâ€¢ Auswahl einer BSI-anerkannten Zertifizierungsstelle mit entsprechender Akkreditierung\nâ€¢ DurchfÃ¼hrung des Stage 1 Audits zur ÃœberprÃ¼fung der Dokumentation und Vorbereitung\nâ€¢ Stage 2 Audit zur detaillierten Bewertung der ISMS-Implementierung und Wirksamkeit\nâ€¢ Nachweis der ErfÃ¼llung sowohl der ISO 27001 als auch der BSI-spezifischen Anforderungen\nâ€¢ Behandlung von Audit-Findings und Implementierung erforderlicher KorrekturmaÃŸnahmen\n\nğŸ“Š Besondere BSI-Anforderungen:\nâ€¢ BerÃ¼cksichtigung deutscher Rechtslage und regulatorischer Vorgaben\nâ€¢ Integration sektorenspezifischer Standards und KRITIS-Anforderungen falls zutreffend\nâ€¢ Nachweis der Angemessenheit der SicherheitsmaÃŸnahmen entsprechend dem Stand der Technik\nâ€¢ Dokumentation der Harmonisierung von ISO 27001 Controls mit IT-Grundschutz-MaÃŸnahmen\nâ€¢ Demonstration der kontinuierlichen Anpassung an BSI-Empfehlungen und Threat Intelligence\n\nğŸ”„ Nachzertifizierung und Aufrechterhaltung:\nâ€¢ Kontinuierliche Ãœberwachung und Verbesserung des ISMS entsprechend beiden Standards\nâ€¢ JÃ¤hrliche Ãœberwachungsaudits zur BestÃ¤tigung der fortlaufenden Compliance\nâ€¢ RegelmÃ¤ÃŸige Anpassung an neue BSI-Empfehlungen und ISO 27001 Updates\nâ€¢ DreijÃ¤hrige Rezertifizierung zur Erneuerung des Zertifikats\nâ€¢ Aufbau einer nachhaltigen Compliance-Kultur fÃ¼r langfristige Zertifizierungsaufrechterhaltung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Wie unterscheidet sich die BSI-konforme Risikoanalyse von der Standard ISO 27001 Risikoanalyse?',
        answer: "Die BSI-konforme Risikoanalyse erweitert die Standard ISO 27001 Risikoanalyse um spezifische deutsche Methoden, Bedrohungsszenarien und regulatorische Anforderungen. Diese Integration schafft eine umfassendere und deutschlandspezifische Risikobewertung, die sowohl internationale Best Practices als auch nationale Sicherheitsstandards berÃ¼cksichtigt.\n\nğŸ¯ Methodische Unterschiede:\nâ€¢ Integration der BSI IT-Grundschutz-Methodik zur Schutzbedarfsfeststellung in die ISO 27001 Risikoanalyse\nâ€¢ Verwendung von IT-Grundschutz-GefÃ¤hrdungskatalogen als zusÃ¤tzliche Bedrohungsquelle\nâ€¢ BerÃ¼cksichtigung deutscher Rechtslage und spezifischer Compliance-Anforderungen\nâ€¢ Anwendung BSI-spezifischer Bewertungskriterien fÃ¼r Eintrittswahrscheinlichkeit und SchadensausmaÃŸ\nâ€¢ Integration aktueller BSI-Cyber-Sicherheitswarnungen und Threat Intelligence\n\nğŸ“Š Schutzbedarfsfeststellung nach BSI:\nâ€¢ Systematische Klassifizierung von Informationen nach Vertraulichkeit, IntegritÃ¤t und VerfÃ¼gbarkeit\nâ€¢ Verwendung der BSI-Schutzbedarfskategorien normal, hoch und sehr hoch\nâ€¢ BerÃ¼cksichtigung von AbhÃ¤ngigkeiten zwischen IT-Systemen und GeschÃ¤ftsprozessen\nâ€¢ Anwendung der Maximumsmethode zur Bestimmung des Gesamtschutzbedarfs\nâ€¢ Integration von Compliance-Anforderungen in die Schutzbedarfsbewertung\n\nğŸ›¡ï¸ Erweiterte Bedrohungsanalyse:\nâ€¢ Nutzung der BSI-GefÃ¤hrdungskataloge als umfassende Bedrohungsquelle\nâ€¢ BerÃ¼cksichtigung deutschlandspezifischer Cyber-Bedrohungen und Angriffsmuster\nâ€¢ Integration aktueller BSI-Lageberichte und Threat Intelligence\nâ€¢ Bewertung sektorenspezifischer Bedrohungen entsprechend der BranchenzugehÃ¶rigkeit\nâ€¢ BerÃ¼cksichtigung von Advanced Persistent Threats und staatlich gesteuerten Angriffen\n\nğŸ” Schwachstellenanalyse:\nâ€¢ Verwendung BSI-anerkannter Schwachstellen-Scanner und Bewertungsmethoden\nâ€¢ Integration von BSI-Sicherheitsempfehlungen und technischen Richtlinien\nâ€¢ BerÃ¼cksichtigung von Common Criteria Evaluierungen und BSI-zertifizierten Produkten\nâ€¢ Bewertung von Legacy-Systemen entsprechend BSI-Empfehlungen\nâ€¢ Analyse von Lieferanten- und Dienstleister-Risiken nach deutschen Standards\n\nğŸ“ˆ Risikobewertung und Behandlung:\nâ€¢ Anwendung BSI-konformer Risikobewertungsmatrizen und Bewertungskriterien\nâ€¢ Integration deutscher Rechtslage in die Risikotoleranz-Bestimmung\nâ€¢ BerÃ¼cksichtigung von KRITIS-Anforderungen und sektorenspezifischen Standards\nâ€¢ Verwendung von IT-Grundschutz-MaÃŸnahmenkatalogen als Behandlungsoptionen\nâ€¢ Dokumentation entsprechend deutscher Audit- und Compliance-Anforderungen\n\nğŸ”„ Kontinuierliche Ãœberwachung:\nâ€¢ RegelmÃ¤ÃŸige Aktualisierung basierend auf BSI-Cyber-Sicherheitswarnungen\nâ€¢ Integration neuer IT-Grundschutz-Bausteine und Empfehlungen\nâ€¢ Anpassung an verÃ¤nderte deutsche Rechtslage und Regulierungsanforderungen\nâ€¢ BerÃ¼cksichtigung von Lessons Learned aus deutschen SicherheitsvorfÃ¤llen\nâ€¢ Kontinuierliche Verbesserung durch BSI-Feedback und Expertenaustausch\n\nğŸ¯ Praktische Vorteile:\nâ€¢ HÃ¶here Akzeptanz bei deutschen AufsichtsbehÃ¶rden und GeschÃ¤ftspartnern\nâ€¢ Bessere Integration in deutsche Compliance-Landschaft\nâ€¢ Nutzung bewÃ¤hrter deutscher Sicherheitsmethoden und Standards\nâ€¢ Optimierte Vorbereitung auf deutsche Audit- und PrÃ¼fungsanforderungen\nâ€¢ ErhÃ¶hte Rechtssicherheit durch BerÃ¼cksichtigung nationaler Besonderheiten"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Welche Rolle spielen BSI-Zertifizierungsstellen bei der ISO 27001 Zertifizierung?',
        answer: "BSI-anerkannte Zertifizierungsstellen spielen eine zentrale Rolle bei der ISO 27001 Zertifizierung in Deutschland und gewÃ¤hrleisten die Anerkennung und GlaubwÃ¼rdigkeit der Zertifikate im deutschen Markt. Diese Stellen unterliegen besonderen QualitÃ¤tsanforderungen und Ãœberwachungsmechanismen, die eine hohe ZertifizierungsqualitÃ¤t sicherstellen.\n\nğŸ›ï¸ BSI-Anerkennung und Akkreditierung:\nâ€¢ BSI-anerkannte Zertifizierungsstellen mÃ¼ssen strenge QualitÃ¤ts- und Kompetenzkriterien erfÃ¼llen\nâ€¢ Akkreditierung durch die Deutsche Akkreditierungsstelle (DAkkS) nach ISO/IEC 17021\nâ€¢ RegelmÃ¤ÃŸige Ãœberwachung und Bewertung durch das BSI zur Aufrechterhaltung der Anerkennung\nâ€¢ Nachweis spezifischer Expertise in deutschen Sicherheitsstandards und IT-Grundschutz\nâ€¢ Kontinuierliche Weiterbildung der Auditoren zu BSI-Standards und deutschen Regulierungsanforderungen\n\nğŸ” Besondere Qualifikationen:\nâ€¢ Auditoren mit nachgewiesener Expertise in BSI IT-Grundschutz und deutschen Sicherheitsstandards\nâ€¢ Kenntnisse der deutschen Rechtslage und sektorenspezifischen Regulierungsanforderungen\nâ€¢ Erfahrung mit KRITIS-Unternehmen und kritischen Infrastrukturen\nâ€¢ VerstÃ¤ndnis fÃ¼r deutsche Compliance-Landschaft und AufsichtsbehÃ¶rden\nâ€¢ RegelmÃ¤ÃŸige Schulungen zu aktuellen BSI-Empfehlungen und Threat Intelligence\n\nğŸ“‹ Zertifizierungsprozess:\nâ€¢ DurchfÃ¼hrung BSI-konformer Audits unter BerÃ¼cksichtigung deutscher Besonderheiten\nâ€¢ Bewertung der Integration von ISO 27001 Controls mit IT-Grundschutz-MaÃŸnahmen\nâ€¢ ÃœberprÃ¼fung der Compliance mit deutschen Rechtsvorgaben und Sektorenregulierung\nâ€¢ Nachweis der Angemessenheit der SicherheitsmaÃŸnahmen entsprechend dem Stand der Technik\nâ€¢ Dokumentation und Berichterstattung entsprechend deutschen Audit-Standards\n\nğŸ† Zertifikatsanerkennung:\nâ€¢ BSI-anerkannte Zertifikate genieÃŸen hohe GlaubwÃ¼rdigkeit bei deutschen BehÃ¶rden und Unternehmen\nâ€¢ ErfÃ¼llung von Ausschreibungsanforderungen und Compliance-Vorgaben in Deutschland\nâ€¢ Anerkennung durch deutsche AufsichtsbehÃ¶rden und Regulatoren\nâ€¢ Internationale Anerkennung durch IAF-Akkreditierung und gegenseitige Anerkennungsabkommen\nâ€¢ Vertrauensbildung bei deutschen GeschÃ¤ftspartnern und Kunden\n\nğŸ”„ Ãœberwachung und Aufrechterhaltung:\nâ€¢ JÃ¤hrliche Ãœberwachungsaudits zur BestÃ¤tigung der fortlaufenden Compliance\nâ€¢ Bewertung der kontinuierlichen Anpassung an BSI-Empfehlungen und Updates\nâ€¢ ÃœberprÃ¼fung der Integration neuer deutscher Regulierungsanforderungen\nâ€¢ Monitoring der Wirksamkeit des ISMS unter BerÃ¼cksichtigung deutscher Besonderheiten\nâ€¢ DreijÃ¤hrige Rezertifizierung mit umfassender Neubewertung\n\nğŸ¯ Auswahlkriterien:\nâ€¢ Nachweis der BSI-Anerkennung und entsprechenden Akkreditierung\nâ€¢ Expertise der Auditoren in deutschen Sicherheitsstandards und Branchenspezifika\nâ€¢ Erfahrung mit Ã¤hnlichen Organisationen und Sektorenregulierung\nâ€¢ VerfÃ¼gbarkeit und FlexibilitÃ¤t fÃ¼r deutsche Marktanforderungen\nâ€¢ Reputation und Referenzen im deutschen Markt\n\nğŸ’¡ Strategische Vorteile:\nâ€¢ ErhÃ¶hte GlaubwÃ¼rdigkeit und Marktakzeptanz in Deutschland\nâ€¢ Optimale Vorbereitung auf deutsche Compliance-Anforderungen\nâ€¢ Zugang zu BSI-Netzwerken und Expertenaustausch\nâ€¢ Kontinuierliche Weiterentwicklung entsprechend deutscher Standards\nâ€¢ Langfristige Sicherstellung der Zertifikatsanerkennung im deutschen Markt"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Wie kÃ¶nnen deutsche Unternehmen von der Integration von NIS2 und ISO 27001 BSI profitieren?',
        answer: "Die Integration von NIS2-Richtlinie mit ISO 27001 BSI-Standards schafft fÃ¼r deutsche Unternehmen ein umfassendes Cyber-Sicherheitsframework, das sowohl EU-weite Compliance als auch nationale Sicherheitsanforderungen optimal erfÃ¼llt. Diese Harmonisierung ermÃ¶glicht effiziente Ressourcennutzung und maximale Compliance-Sicherheit.\n\nğŸ‡ªğŸ‡º NIS2-Richtlinie Grundlagen:\nâ€¢ Erweiterte Anwendungsbereiche auf zusÃ¤tzliche Sektoren und kleinere Unternehmen\nâ€¢ VerschÃ¤rfte Cyber-Sicherheitsanforderungen und Meldepflichten\nâ€¢ Harmonisierte EU-weite Standards fÃ¼r Cyber-Resilienz\nâ€¢ ErhÃ¶hte Sanktionen bei Nichteinhaltung der Sicherheitsanforderungen\nâ€¢ Fokus auf Supply Chain Security und Lieferantenmanagement\n\nğŸ”— Synergien zwischen NIS2 und ISO 27001 BSI:\nâ€¢ ISO 27001 ISMS bildet eine solide Grundlage fÃ¼r NIS2-Compliance\nâ€¢ BSI-Standards ergÃ¤nzen NIS2-Anforderungen um deutsche Sicherheitsspezifika\nâ€¢ IT-Grundschutz-Methodik unterstÃ¼tzt die NIS2-konforme Risikoanalyse\nâ€¢ Gemeinsame Dokumentationsstrukturen reduzieren Compliance-Aufwand\nâ€¢ Integrierte Audit-AnsÃ¤tze fÃ¼r beide Regulierungsrahmen\n\nğŸ›¡ï¸ Technische Integration:\nâ€¢ Harmonisierung von NIS2-SicherheitsmaÃŸnahmen mit ISO 27001 Controls\nâ€¢ Integration BSI-Cyber-Sicherheitsempfehlungen in NIS2-Compliance\nâ€¢ Gemeinsame Incident Response-Prozesse fÃ¼r beide Anforderungssets\nâ€¢ Koordinierte Vulnerability Management-Programme\nâ€¢ Integrierte Business Continuity und Disaster Recovery-Konzepte\n\nğŸ“Š Governance und Management:\nâ€¢ Einheitliche Cyber-Sicherheits-Governance fÃ¼r alle Regulierungsrahmen\nâ€¢ Koordinierte Risikomanagement-Prozesse entsprechend NIS2 und ISO 27001\nâ€¢ Integrierte Schulungs- und Awareness-Programme\nâ€¢ Harmonisierte Berichterstattung an verschiedene AufsichtsbehÃ¶rden\nâ€¢ Gemeinsame Management Review-Prozesse fÃ¼r kontinuierliche Verbesserung\n\nğŸš¨ Meldewesen und Incident Management:\nâ€¢ Koordinierte Meldeprozesse an BSI und zustÃ¤ndige NIS2-BehÃ¶rden\nâ€¢ Integrierte Incident Response-Teams mit Expertise in beiden Frameworks\nâ€¢ Harmonisierte Klassifizierung und Bewertung von SicherheitsvorfÃ¤llen\nâ€¢ Gemeinsame Forensik- und Analyse-Verfahren\nâ€¢ Koordinierte Kommunikation mit Stakeholdern und BehÃ¶rden\n\nğŸ¯ Operative Vorteile:\nâ€¢ Reduzierung von Doppelarbeit durch intelligente Integration beider Standards\nâ€¢ Optimierung der Compliance-Kosten durch gemeinsame Prozesse und Dokumentation\nâ€¢ ErhÃ¶hung der Cyber-Resilienz durch umfassende Sicherheitsabdeckung\nâ€¢ Verbesserung der Stakeholder-Kommunikation durch einheitliche Standards\nâ€¢ StÃ¤rkung der Wettbewerbsposition durch demonstrierte Compliance-Exzellenz\n\nğŸ”„ Implementierungsstrategie:\nâ€¢ Entwicklung einer integrierten Compliance-Roadmap fÃ¼r beide Frameworks\nâ€¢ Aufbau spezialisierter Teams mit Expertise in NIS2, ISO 27001 und BSI-Standards\nâ€¢ Implementierung gemeinsamer Tools und Plattformen fÃ¼r Compliance-Management\nâ€¢ Etablierung regelmÃ¤ÃŸiger Reviews und Updates entsprechend beiden Regulierungsrahmen\nâ€¢ Kontinuierliche Anpassung an sich entwickelnde Anforderungen und Best Practices\n\nğŸ’¡ Strategische Erfolgsfaktoren:\nâ€¢ FrÃ¼hzeitige Planung und proaktive Implementierung vor NIS2-Stichtagen\nâ€¢ Nutzung bestehender ISO 27001 BSI-Strukturen als Grundlage fÃ¼r NIS2-Compliance\nâ€¢ Aufbau von Partnerschaften mit spezialisierten Beratungsunternehmen\nâ€¢ Investition in Mitarbeiterqualifikation und kontinuierliche Weiterbildung\nâ€¢ Etablierung einer lernenden Organisation fÃ¼r adaptive Compliance-Strategien"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('âœ… FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
