import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Business Continuity Management Definition page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'business-continuity-management-definition' })
    
    if (!existingDoc) {
      throw new Error('Document "business-continuity-management-definition" not found')
    }
    
    // Create new FAQs for BCM Framework & Standards
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Welche Rolle spielt ISO 22301 in der Definition von Business Continuity Management und wie strukturiert dieser Standard das BCM-Framework?',
        answer: "ISO 22301 ist der internationale Standard f√ºr Business Continuity Management Systeme und definiert BCM als systematischen Managementansatz zur Identifikation potenzieller Bedrohungen und deren Auswirkungen auf Gesch√§ftst√§tigkeiten. Der Standard strukturiert BCM durch einen Plan-Do-Check-Act Zyklus und etabliert klare Definitionen, Anforderungen und Frameworks f√ºr die Implementierung.\n\nüìã ISO 22301 BCM-Definition:\n‚Ä¢ BCM wird als ganzheitlicher Managementprozess definiert, der Organisationen dabei unterst√ºtzt, potenzielle Bedrohungen zu identifizieren\n‚Ä¢ Der Standard betont die Entwicklung von Resilienz-Kapazit√§ten zum Schutz von Stakeholder-Interessen, Reputation und Marke\n‚Ä¢ ISO 22301 definiert BCM als kontinuierlichen Verbesserungsprozess mit systematischem Lifecycle-Management\n‚Ä¢ Die Definition umfasst sowohl pr√§ventive als auch reaktive Elemente in einem integrierten Management-System\n‚Ä¢ Der Standard etabliert BCM als strategische Managementdisziplin, nicht als operative Notfallma√ünahme\n\nüîÑ PDCA-Zyklus Framework:\n‚Ä¢ Plan Phase umfasst BCM-Policy-Entwicklung, Scope-Definition und strategische Zielsetzung\n‚Ä¢ Do Phase beinhaltet Business Impact Analysis, Risikobewertung und Implementierung von BCM-Strategien\n‚Ä¢ Check Phase fokussiert auf Monitoring, Testing, √úbungen und Performance-Bewertung\n‚Ä¢ Act Phase umfasst kontinuierliche Verbesserung, Korrekturma√ünahmen und Management Review\n‚Ä¢ Der Zyklus gew√§hrleistet systematische und kontinuierliche Entwicklung der BCM-Kapazit√§ten\n\nüéØ Strukturelle Komponenten:\n‚Ä¢ Context der Organisation umfasst interne und externe Faktoren, die BCM beeinflussen\n‚Ä¢ Leadership und Commitment definieren Verantwortlichkeiten und Governance-Strukturen\n‚Ä¢ Planung umfasst Risikobewertung, Business Impact Analysis und BCM-Strategieentwicklung\n‚Ä¢ Support umfasst Ressourcen, Kompetenzen, Awareness und Kommunikation\n‚Ä¢ Operation umfasst Implementierung von BCM-Pl√§nen und Incident Management\n\nüìä Definitorische Klarstellungen:\n‚Ä¢ Business Continuity wird als F√§higkeit definiert, Gesch√§ftst√§tigkeiten auf akzeptablem Niveau fortzusetzen\n‚Ä¢ Disruption umfasst jedes Ereignis, das Gesch√§ftst√§tigkeiten beeintr√§chtigen oder unterbrechen k√∂nnte\n‚Ä¢ Recovery Time Objective definiert die maximale akzeptable Zeit f√ºr die Wiederherstellung\n‚Ä¢ Recovery Point Objective definiert den maximalen akzeptablen Datenverlust\n‚Ä¢ Maximum Tolerable Period of Disruption definiert die Zeit, nach der Unterbrechungen untragbar werden\n\nüåê Systemischer Ansatz:\n‚Ä¢ ISO 22301 definiert BCM als Teil eines integrierten Management-System-Ansatzes\n‚Ä¢ Der Standard erm√∂glicht Integration mit anderen Management-Systemen wie ISO 9001 oder ISO 27001\n‚Ä¢ Prozessorientierter Ansatz betont Interdependenzen und systematische Beziehungen\n‚Ä¢ Risikoorientiertes Denken ist als fundamentales Prinzip in alle BCM-Aktivit√§ten integriert\n‚Ä¢ Stakeholder-Fokus gew√§hrleistet Ber√ºcksichtigung aller relevanten Interessensgruppen\n\nüîç Implementierungsrichtlinien:\n‚Ä¢ Der Standard definiert Mindestanforderungen f√ºr BCM-Systeme ohne Vorgabe spezifischer Methoden\n‚Ä¢ Flexibilit√§t erm√∂glicht Anpassung an verschiedene Organisationstypen und Branchen\n‚Ä¢ Skalierbarkeit unterst√ºtzt sowohl kleine als auch gro√üe und komplexe Organisationen\n‚Ä¢ Kontinuierliche Verbesserung ist als Kernprinzip in alle BCM-Aktivit√§ten eingebettet\n‚Ä¢ Evidenzbasierter Ansatz fordert Dokumentation und Nachweis der BCM-Wirksamkeit"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Wie definieren sich die Kernkomponenten des BCM-Lifecycle und welche methodischen Ans√§tze strukturieren diesen Prozess?',
        answer: "Der BCM-Lifecycle definiert sich als systematischer, iterativer Prozess, der alle Phasen des Business Continuity Managements von der strategischen Planung bis zur kontinuierlichen Verbesserung umfasst. Dieser Lifecycle basiert auf bew√§hrten Managementprinzipien und strukturiert BCM als kontinuierlichen Verbesserungsprozess mit definierten Phasen und √úberg√§ngen.\n\nüîÑ Lifecycle-Phasen Definition:\n‚Ä¢ Programme Management umfasst strategische BCM-Planung, Governance-Etablierung und Ressourcenallokation\n‚Ä¢ Understanding the Organization beinhaltet Kontext-Analyse, Stakeholder-Identifikation und Scope-Definition\n‚Ä¢ Business Impact Analysis systematisiert die Bewertung von Auswirkungen und Abh√§ngigkeiten\n‚Ä¢ BCM Strategy Development fokussiert auf Strategieentwicklung und Kontinuit√§tsoptionen\n‚Ä¢ BCM Response umfasst Entwicklung und Implementierung von Kontinuit√§tspl√§nen und Verfahren\n\nüìã Programme Management Framework:\n‚Ä¢ BCM-Policy definiert strategische Ausrichtung, Ziele und Governance-Prinzipien\n‚Ä¢ Organisationsstruktur etabliert Rollen, Verantwortlichkeiten und Entscheidungsprozesse\n‚Ä¢ Ressourcenplanung umfasst Budget, Personal und technische Infrastruktur\n‚Ä¢ Kommunikationsstrategie gew√§hrleistet Awareness und Engagement auf allen Organisationsebenen\n‚Ä¢ Performance Management definiert KPIs, Metriken und Erfolgsmessung\n\nüè¢ Organisationsverst√§ndnis Methodologie:\n‚Ä¢ Kontext-Analyse umfasst interne und externe Faktoren, die BCM beeinflussen\n‚Ä¢ Stakeholder-Mapping identifiziert und priorisiert relevante Interessensgruppen\n‚Ä¢ Scope-Definition etabliert Grenzen und Anwendungsbereich des BCM-Systems\n‚Ä¢ Compliance-Assessment bewertet regulatorische und vertragliche Anforderungen\n‚Ä¢ Kultur-Assessment analysiert organisationale Bereitschaft und Change-Kapazit√§ten\n\nüìä Business Impact Analysis Struktur:\n‚Ä¢ Prozess-Identifikation systematisiert alle Gesch√§ftsprozesse und deren Kritikalit√§t\n‚Ä¢ Impact-Bewertung quantifiziert finanzielle, operative und reputationsbezogene Auswirkungen\n‚Ä¢ Abh√§ngigkeits-Analyse identifiziert interne und externe Abh√§ngigkeiten\n‚Ä¢ Recovery-Ziele definieren RTO, RPO und MTPD f√ºr kritische Prozesse\n‚Ä¢ Priorisierung etabliert Hierarchien und Ressourcenallokation\n\nüéØ Strategieentwicklung Methodologie:\n‚Ä¢ Kontinuit√§tsoptionen-Analyse bewertet verschiedene Strategiealternativen\n‚Ä¢ Kosten-Nutzen-Analyse unterst√ºtzt Entscheidungsfindung und Ressourcenoptimierung\n‚Ä¢ Risiko-Akzeptanz definiert Toleranzen und Akzeptanzkriterien\n‚Ä¢ Implementierungsplanung strukturiert Umsetzung und Zeitplanung\n‚Ä¢ Integration gew√§hrleistet Kompatibilit√§t mit bestehenden Systemen und Prozessen\n\nüöÄ Response-Entwicklung Framework:\n‚Ä¢ Plan-Entwicklung strukturiert Kontinuit√§tspl√§ne und Verfahrensanweisungen\n‚Ä¢ Ressourcen-Allokation definiert erforderliche Kapazit√§ten und Infrastrukturen\n‚Ä¢ Training und Awareness gew√§hrleisten Kompetenzentwicklung und Bereitschaft\n‚Ä¢ Testing und Validation √ºberpr√ºfen Wirksamkeit und Angemessenheit\n‚Ä¢ Maintenance und Updates gew√§hrleisten Aktualit√§t und kontinuierliche Verbesserung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Welche konzeptuellen Unterschiede bestehen zwischen Business Continuity, Operational Resilience und Organizational Resilience in der BCM-Definition?',
        answer: "Die Begriffe Business Continuity, Operational Resilience und Organizational Resilience repr√§sentieren verschiedene Ebenen und Dimensionen der organisationalen Widerstandsf√§higkeit, die sich in Scope, Zeitperspektive und strategischer Ausrichtung unterscheiden. Diese konzeptuellen Unterschiede sind fundamental f√ºr das Verst√§ndnis moderner BCM-Ans√§tze und deren strategische Anwendung.\n\nüéØ Business Continuity Definition:\n‚Ä¢ Business Continuity fokussiert auf die F√§higkeit, kritische Gesch√§ftsfunktionen w√§hrend und nach St√∂rungen aufrechtzuerhalten\n‚Ä¢ Der Ansatz ist prim√§r reaktiv und konzentriert sich auf Wiederherstellung zu vordefinierten Servicelevels\n‚Ä¢ Zeitperspektive umfasst kurzfristige bis mittelfristige Kontinuit√§tssicherung\n‚Ä¢ Scope ist funktional begrenzt auf spezifische Gesch√§ftsprozesse und deren direkte Abh√§ngigkeiten\n‚Ä¢ Ziel ist die Minimierung von Gesch√§ftsunterbrechungen und deren Auswirkungen\n\nüîß Operational Resilience Konzept:\n‚Ä¢ Operational Resilience erweitert Business Continuity um proaktive Kapazit√§ten zur St√∂rungsantizipation\n‚Ä¢ Der Ansatz integriert pr√§ventive, reaktive und adaptive Strategien in einem ganzheitlichen Framework\n‚Ä¢ Zeitperspektive umfasst mittelfristige bis langfristige Resilienz-Entwicklung\n‚Ä¢ Scope umfasst operative Systeme, Prozesse und deren komplexe Interdependenzen\n‚Ä¢ Ziel ist die Entwicklung adaptiver Kapazit√§ten f√ºr verschiedene St√∂rungsszenarien\n\nüåê Organizational Resilience Framework:\n‚Ä¢ Organizational Resilience umfasst die gesamte organisationale F√§higkeit zur Adaptation und Transformation\n‚Ä¢ Der Ansatz ist strategisch und transformativ, fokussiert auf organisationales Lernen und Evolution\n‚Ä¢ Zeitperspektive ist langfristig und umfasst strategische Organisationsentwicklung\n‚Ä¢ Scope umfasst alle organisationalen Dimensionen einschlie√ülich Kultur, F√ºhrung und Innovation\n‚Ä¢ Ziel ist die Entwicklung antizipatorischer und transformativer Kapazit√§ten\n\nüìä Konzeptuelle Abgrenzungen:\n‚Ä¢ Business Continuity ist prozessorientiert, Operational Resilience systemorientiert, Organizational Resilience strategieorientiert\n‚Ä¢ Business Continuity fokussiert auf Stabilit√§t, Operational Resilience auf Adaptabilit√§t, Organizational Resilience auf Transformationsf√§higkeit\n‚Ä¢ Business Continuity ist reaktiv, Operational Resilience proaktiv, Organizational Resilience antizipatorisch\n‚Ä¢ Business Continuity ist kurzfristig, Operational Resilience mittelfristig, Organizational Resilience langfristig\n‚Ä¢ Business Continuity ist funktional, Operational Resilience operational, Organizational Resilience strategisch\n\nüîó Integrative Beziehungen:\n‚Ä¢ Business Continuity bildet die operative Grundlage f√ºr Operational Resilience\n‚Ä¢ Operational Resilience schafft die systemischen Voraussetzungen f√ºr Organizational Resilience\n‚Ä¢ Organizational Resilience definiert den strategischen Rahmen f√ºr Business Continuity und Operational Resilience\n‚Ä¢ Alle drei Konzepte sind komplement√§r und verst√§rken sich gegenseitig\n‚Ä¢ Integration erfordert systematische Koordination und strategische Ausrichtung\n\nüöÄ Evolution√§re Entwicklung:\n‚Ä¢ Moderne BCM-Ans√§tze integrieren alle drei Konzepte in ganzheitlichen Resilienz-Frameworks\n‚Ä¢ Evolution von reaktiven zu proaktiven und schlie√ülich zu antizipatorischen Ans√§tzen\n‚Ä¢ Entwicklung von isolierten zu integrierten und systemischen Resilienz-Strategien\n‚Ä¢ Zunehmende Betonung von Lernf√§higkeit, Anpassungsf√§higkeit und Transformationsf√§higkeit\n‚Ä¢ Integration von Nachhaltigkeits- und ESG-Aspekten in umfassende Resilienz-Definitionen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Wie definieren sich die methodischen Grundlagen der Business Impact Analysis und welche konzeptuellen Frameworks strukturieren diese Analyse?',
        answer: "Die Business Impact Analysis definiert sich als systematische Methodik zur Identifikation und Quantifizierung der Auswirkungen von Gesch√§ftsunterbrechungen auf kritische Organisationsfunktionen. Diese Analyse bildet das analytische Fundament f√ºr BCM-Entscheidungen und basiert auf strukturierten Frameworks, die sowohl quantitative als auch qualitative Bewertungsans√§tze integrieren.\n\nüîç Methodische Definition der BIA:\n‚Ä¢ BIA ist eine strukturierte Analysemethodik zur systematischen Bewertung von Gesch√§ftsprozess-Kritikalit√§t\n‚Ä¢ Die Methodik quantifiziert direkte und indirekte Auswirkungen von St√∂rungen √ºber verschiedene Zeitr√§ume\n‚Ä¢ BIA etabliert objektive Kriterien f√ºr Priorisierung und Ressourcenallokation in BCM-Strategien\n‚Ä¢ Die Analyse integriert finanzielle, operative, regulatorische und reputationsbezogene Impact-Dimensionen\n‚Ä¢ Methodisch basiert BIA auf systematischer Datenerhebung, Stakeholder-Interviews und quantitativer Modellierung\n\nüìä Konzeptuelle Framework-Struktur:\n‚Ä¢ Process-Mapping identifiziert und strukturiert alle Gesch√§ftsprozesse hierarchisch\n‚Ä¢ Criticality Assessment bewertet Prozesse anhand multipler Kriterien und Gewichtungen\n‚Ä¢ Impact Quantification systematisiert finanzielle und nicht-finanzielle Auswirkungen\n‚Ä¢ Dependency Analysis identifiziert interne und externe Abh√§ngigkeiten systematisch\n‚Ä¢ Recovery Objectives definieren zeitbasierte und qualit√§tsbezogene Wiederherstellungsziele\n\nüí∞ Impact-Kategorisierung Framework:\n‚Ä¢ Finanzielle Impacts umfassen direkte Umsatzverluste, zus√§tzliche Kosten und Opportunit√§tskosten\n‚Ä¢ Operative Impacts beinhalten Produktivit√§tsverluste, Qualit√§tseinbu√üen und Kapazit√§tsreduzierungen\n‚Ä¢ Regulatorische Impacts umfassen Compliance-Verletzungen, Strafen und Lizenzrisiken\n‚Ä¢ Reputationsbezogene Impacts beinhalten Kundenverluste, Marktanteilseinbu√üen und Vertrauensverluste\n‚Ä¢ Strategische Impacts umfassen langfristige Wettbewerbsnachteile und Marktpositionsverluste\n\n‚è±Ô∏è Zeitbasierte Analyse-Dimensionen:\n‚Ä¢ Immediate Impact analysiert Auswirkungen in den ersten Stunden nach St√∂rungseintritt\n‚Ä¢ Short-term Impact bewertet Auswirkungen √ºber Tage bis Wochen\n‚Ä¢ Medium-term Impact analysiert Auswirkungen √ºber Wochen bis Monate\n‚Ä¢ Long-term Impact bewertet dauerhafte oder schwer reversible Auswirkungen\n‚Ä¢ Cumulative Impact ber√ºcksichtigt Eskalations- und Verst√§rkungseffekte √ºber Zeit\n\nüîó Abh√§ngigkeits-Analyse Framework:\n‚Ä¢ Interne Abh√§ngigkeiten umfassen Personal, Technologie, Infrastruktur und Informationen\n‚Ä¢ Externe Abh√§ngigkeiten beinhalten Lieferanten, Dienstleister, Kunden und Regulatoren\n‚Ä¢ Interdependenzen analysieren wechselseitige Abh√§ngigkeiten zwischen Prozessen\n‚Ä¢ Single Points of Failure identifizieren kritische Schwachstellen und Bottlenecks\n‚Ä¢ Cascade Analysis bewertet Dominoeffekte und systemische Risiken\n\nüéØ Recovery-Ziele Definition:\n‚Ä¢ Recovery Time Objective definiert maximale akzeptable Ausfallzeit f√ºr Gesch√§ftsprozesse\n‚Ä¢ Recovery Point Objective definiert maximalen akzeptablen Datenverlust\n‚Ä¢ Maximum Tolerable Period of Disruption definiert absolute Grenzen der St√∂rungstoleranz\n‚Ä¢ Minimum Business Continuity Objective definiert minimale Servicelevel w√§hrend St√∂rungen\n‚Ä¢ Work Recovery Time definiert Zeit f√ºr vollst√§ndige Normalisierung nach St√∂rungen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
