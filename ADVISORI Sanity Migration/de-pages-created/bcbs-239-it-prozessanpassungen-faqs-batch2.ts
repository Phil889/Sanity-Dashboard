import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating BCBS-239 IT-Prozessanpassungen page with FAQs batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'bcbs-239-it-prozessanpassungen' })
    
    if (!existingDoc) {
      throw new Error('Document "bcbs-239-it-prozessanpassungen" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Welche Best Practices hat ADVISORI bei der Integration von Altsystemen in moderne BCBS-239-konforme IT-Prozesse entwickelt?",
        answer: "Die Integration von Legacy-Systemen in eine BCBS-239-konforme IT-Landschaft stellt viele Finanzinstitute vor komplexe Herausforderungen. ADVISORI hat durch zahlreiche erfolgreiche Implementierungsprojekte ein umfassendes Portfolio an Best Practices entwickelt, die eine effiziente und nachhaltige Integration erm√∂glichen, ohne gro√üangelegte System-Replacements zu erzwingen.\n\nüîÑ Strategische Integrationsans√§tze f√ºr Legacy-Systeme:\n‚Ä¢ Schichtenbasierte Entkopplung: Implementierung einer intelligenten Abstraktionsschicht zwischen Legacy-Systemen und modernen Anwendungen, die Dateninkonsistenzen harmonisiert und eine einheitliche Datensicht erm√∂glicht, ohne Kernsysteme ersetzen zu m√ºssen.\n‚Ä¢ Selektive Modernisierung: Identifikation kritischer Komponenten mit h√∂chstem Compliance-Impact und gezielte Modernisierung dieser Bereiche, w√§hrend weniger kritische Komponenten mit Middleware-L√∂sungen angebunden werden.\n‚Ä¢ Metadata-gesteuerte Integration: Einsatz zentraler Metadaten-Repositories, die systematisch Datenfelder, Berechnungslogiken und Transformationsregeln dokumentieren und eine konsistente Interpretation √ºber Systemgrenzen hinweg sicherstellen.\n‚Ä¢ Progressive Data Governance: Schrittweise Implementierung von Governance-Prozessen, beginnend mit den kritischsten Risikodaten, um schnelle Erfolge zu erzielen und gleichzeitig das Fundament f√ºr umfassendere Governance zu legen.\n\nüõ†Ô∏è Technische Best Practices f√ºr Legacy-Integration:\n‚Ä¢ API-first Strategie: Entwicklung standardisierter APIs f√ºr Legacy-Systeme, die eine einheitliche und kontrollierte Datenextraktion erm√∂glichen und gleichzeitig die Quelldatenbanken vor √ºberm√§√üiger Belastung sch√ºtzen.\n‚Ä¢ Data Virtualization Layer: Implementierung von Virtualisierungstechnologien, die Daten aus verschiedenen Quellen in Echtzeit zusammenf√ºhren, ohne physische Datenbewegungen zu erfordern.\n‚Ä¢ Automatisierte Reconciliation: Etablierung automatisierter Abgleichsprozesse zwischen Legacy-Daten und aggregierten Risikodaten, um Diskrepanzen fr√ºhzeitig zu erkennen und zu beheben.\n‚Ä¢ Staging-Areas mit Validierungslogik: Einrichtung spezieller Zwischenschichten mit implementierter Validierungslogik, die Datenqualit√§tsprobleme identifizieren und korrigieren, bevor sie in die Reporting-Kette gelangen.\n\nüí° Organisatorische Erfolgsfaktoren:\n‚Ä¢ Cross-funktionale Teams: Zusammenstellung von Teams mit kombinierter Expertise in Legacy-Technologien und modernen Architekturen, um optimale Integrationswege zu identifizieren.\n‚Ä¢ Inkrementeller Implementierungsansatz: Umsetzung in √ºberschaubaren, wertsch√∂pfenden Inkrementen mit schnellen Feedback-Zyklen statt monolithischer Gro√üprojekte.\n‚Ä¢ Detaillierte Dokumentation: Systematische Erfassung von Datenfl√ºssen, Transformationen und Abh√§ngigkeiten als Grundlage f√ºr Compliance-Nachweise und zuk√ºnftige Optimierungen.\n‚Ä¢ Knowledge Retention: Gezielte Ma√ünahmen zur Sicherung des Wissens √ºber Legacy-Systeme und deren Datenstrukturen, das oft nur bei wenigen Schl√ºsselpersonen vorhanden ist."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Welche konkreten Optimierungen bei IT-Prozessen erzeugen typischerweise den gr√∂√üten ROI in BCBS-239 Implementierungsprojekten?",
        answer: "In BCBS-239 Implementierungsprojekten gibt es bestimmte Schl√ºsselbereiche der IT-Prozessoptimierung, die erfahrungsgem√§√ü den h√∂chsten Return on Investment (ROI) generieren. ADVISORI hat durch zahlreiche erfolgreiche Projekte diese High-Impact-Optimierungsbereiche identifiziert und quantifiziert, um Implementierungsressourcen strategisch dort einzusetzen, wo sie die gr√∂√üte Wirkung entfalten.\n\nüíπ High-ROI Optimierungsbereiche in der BCBS-239 Implementierung:\n‚Ä¢ Automatisierung manueller Datenkonsolidierungsprozesse: Die Umstellung von manuellen Excel-basierten Konsolidierungsprozessen auf automatisierte Datenintegrationsl√∂sungen reduziert typischerweise den Arbeitsaufwand um 70-80% und minimiert gleichzeitig operative Risiken durch menschliche Fehler.\n‚Ä¢ Implementierung zentraler Datenqualit√§tskontrollen: Die Einf√ºhrung automatisierter, regelbasierter Datenvalidierungen an strategischen Punkten der Datenpipeline verbessert die Datenqualit√§t signifikant und reduziert nachgelagerte Korrekturaufw√§nde um durchschnittlich 60%.\n‚Ä¢ Standardisierung von Metadaten und Definitionen: Die Etablierung einheitlicher Definitionen und Berechnungsmethoden f√ºr Risikokennzahlen √ºber Abteilungen und Systeme hinweg eliminiert kostspielige Abstimmungsprozesse und erh√∂ht die Konsistenz der Risikoberichterstattung erheblich.\n‚Ä¢ Optimierung von Datentransformationsprozessen: Die Neugestaltung ineffizienter Transformationsketten mit redundanten Zwischenschritten durch streamlined Prozesse kann die Berichterstellungszeit um 40-50% verk√ºrzen.\n\nüìä Quantifizierbare Business-Case-Faktoren:\n‚Ä¢ Zeit-zu-Wert-Verh√§ltnis: Priorisierung von Optimierungen, die innerhalb von 3-6 Monaten messbare Verbesserungen liefern, wie die Automatisierung wiederkehrender manueller Prozesse oder die Implementierung von Self-Service-Reporting-Funktionen.\n‚Ä¢ Compliance-Risikominderung: Fokussierung auf Bereiche mit hohem regulatorischen Risiko, wie die Sicherstellung l√ºckenloser Datenlineage oder die Implementierung robuster Kontrollen f√ºr kritische Risikodaten, die potenzielle regulatorische Strafen vermeiden.\n‚Ä¢ Skalierbarkeitseffekte: Besonders hohen ROI bieten Prozessoptimierungen, die nicht nur f√ºr BCBS-239, sondern auch f√ºr andere regulatorische Anforderungen (wie DSGVO, DORA, Basel IV) nutzbar sind und damit Multiplikatoreffekte erzeugen.\n‚Ä¢ Kostensenkungspotenzial: Identifikation von Prozessen, deren Optimierung direkte Kosteneinsparungen generiert, etwa durch Reduktion manueller Nachbearbeitungen, Verringerung von Systemredundanzen oder Verk√ºrzung von Berichtszyklen.\n\nüîç ADVISORIs ROI-orientierter Implementierungsansatz:\n‚Ä¢ Schnelle Assessment-Methodik: Systematische Bewertung Ihrer spezifischen IT-Prozesslandschaft, um die gr√∂√üten ROI-Potenziale zu identifizieren und zu priorisieren.\n‚Ä¢ Business-Case-getriebene Roadmap: Entwicklung einer Implementierungs-Roadmap, die Value-Delivery und Investitionsrendite systematisch maximiert und fr√ºhe Erfolge sicherstellt.\n‚Ä¢ Messbares Erfolgsmonitoring: Etablierung transparenter KPIs zur kontinuierlichen Messung und Dokumentation der realisierten Verbesserungen und des gesch√§ftlichen Nutzens.\n‚Ä¢ Agiles Backlog-Management: Kontinuierliche Neubewertung und Priorisierung von Optimierungsma√ünahmen basierend auf gemessenen Ergebnissen und sich √§ndernden Gesch√§ftsbedingungen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Wie gestaltet ADVISORI die Anpassung von IT-Prozessen f√ºr BCBS-239 in dezentralen Organisationen mit internationalen Standorten?",
        answer: "Die Implementierung von BCBS-239-konformen IT-Prozessen in dezentralen, international operierenden Finanzinstituten erfordert einen spezialisierten Ansatz, der lokale Besonderheiten ber√ºcksichtigt und gleichzeitig globale Konsistenz sicherstellt. ADVISORI hat eine bew√§hrte Methodik entwickelt, die diesen Balanceakt effektiv meistert und sowohl lokale Autonomie als auch zentrale Governance erm√∂glicht.\n\nüåê Strategische Ans√§tze f√ºr internationale BCBS-239 Implementierungen:\n‚Ä¢ F√∂derierte Governance-Modelle: Etablierung einer mehrschichtigen Governance-Struktur mit zentralen Prinzipien und Standards, die jedoch lokale Anpassungen innerhalb definierter Parameter erlauben und so sowohl globale Konsistenz als auch lokale Compliance sicherstellen.\n‚Ä¢ Global-Local-Balance-Framework: Systematische Klassifizierung von Prozessen und Anforderungen in globale Standards (nicht verhandelbar), lokale Adaptionen (anpassbar) und lokale Spezifika (vollst√§ndig lokal gesteuert), um klare Entscheidungs- und Verantwortungsstrukturen zu schaffen.\n‚Ä¢ Hub-and-Spoke-Implementierungsmodell: Etablierung zentraler Kompetenz- und Koordinationszentren (Hubs), die lokale Implementierungsteams (Spokes) methodisch unterst√ºtzen und Wissenstransfer sicherstellen, ohne die lokale Verantwortung zu unterminieren.\n‚Ä¢ Harmonisierte Taxonomie und Metadaten: Entwicklung einer unternehmensweiten einheitlichen Sprache f√ºr Risikodaten mit standardisierten Definitionen, die kulturelle und sprachliche Barrieren √ºberwindet und konsistente Interpretation sicherstellt.\n\nüõ†Ô∏è Technische Implementierungsans√§tze:\n‚Ä¢ Flexible Referenzarchitekturen: Bereitstellung anpassbarer Architekturvorlagen, die zentrale Compliance-Anforderungen erf√ºllen und gleichzeitig an lokale IT-Landschaften und regulatorische Besonderheiten adaptiert werden k√∂nnen.\n‚Ä¢ Zentrale Datendienste mit lokalen Adaptoren: Implementierung zentraler Plattformen f√ºr kritische Funktionen wie Lineage, Qualit√§tsmanagement und Reporting mit flexiblen Adapter-Komponenten f√ºr verschiedene lokale Systemlandschaften.\n‚Ä¢ Standardisierte APIs und Austauschformate: Definition einheitlicher Schnittstellen und Datenstrukturen f√ºr den globalen Datenaustausch bei gleichzeitiger Unterst√ºtzung lokaler Transformationsprozesse.\n‚Ä¢ Global Monitoring mit lokaler Granularit√§t: Implementierung eines mehrstufigen √úberwachungssystems, das sowohl konsolidierte Gruppenansichten als auch detaillierte lokale Perspektiven bietet.\n\nü§ù Organisatorische Erfolgsfaktoren:\n‚Ä¢ Global-lokale Expertennetzwerke: Aufbau strukturierter Communities of Practice, die Best Practices teilen, gemeinsame Herausforderungen adressieren und kontinuierliches Lernen √ºber Standorte hinweg f√∂rdern.\n‚Ä¢ Kulturell sensibles Change Management: Ber√ºcksichtigung lokaler Unternehmenskulturen und Arbeitsweisen bei der Implementierung von Ver√§nderungen, um Akzeptanz und nachhaltige Adoption zu f√∂rdern.\n‚Ä¢ Klare Eskalationswege und Entscheidungsmechanismen: Etablierung transparenter Prozesse f√ºr die L√∂sung von Konflikten zwischen globalen und lokalen Anforderungen oder unterschiedlichen regulatorischen Vorgaben.\n‚Ä¢ Systematischer Wissenstransfer: Implementierung strukturierter Mechanismen f√ºr den Austausch von Erkenntnissen, Lessons Learned und Best Practices zwischen verschiedenen Standorten und Implementierungsphasen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Welche typischen Herausforderungen treten bei der Automatisierung von IT-Prozessen f√ºr BCBS-239 auf und wie l√∂st ADVISORI diese?",
        answer: "Die Automatisierung von IT-Prozessen ist ein zentraler Hebel zur Erf√ºllung der BCBS-239 Anforderungen, doch dieser Transformationspfad ist mit spezifischen Herausforderungen verbunden. ADVISORI hat durch umfangreiche Projekterfahrung ein tiefes Verst√§ndnis dieser H√ºrden entwickelt und bew√§hrte L√∂sungsans√§tze etabliert, die eine erfolgreiche Prozessautomatisierung erm√∂glichen.\n\nüîç Typische Herausforderungen und ADVISORIs L√∂sungsstrategien:\n‚Ä¢ Datenqualit√§tsprobleme als Automatisierungshemmnis: Bestehende Datenqualit√§tsm√§ngel blockieren h√§ufig Automatisierungsinitiativen, da manuelle Korrekturen als unverzichtbar erscheinen.\n   ‚Üí Unsere L√∂sung: Implementierung eines dualen Ansatzes mit paralleler Datenqualit√§tsverbesserung und schrittweiser Automatisierung. Etablierung intelligenter Validierungsroutinen, die Qualit√§tsprobleme systematisch identifizieren und dokumentieren, sowie Implementierung von Selbstkorrektur-Mechanismen f√ºr h√§ufige Problemf√§lle.\n\n‚Ä¢ Komplexit√§t und Intransparenz bestehender Prozesse: Oft sind manuelle Prozesse historisch gewachsen, unzureichend dokumentiert und basieren auf implizitem Expertenwissen, was ihre Automatisierung erschwert.\n   ‚Üí Unsere L√∂sung: Einsatz spezialisierter Process-Mining-Technologien zur objektiven Analyse tats√§chlicher Prozessabl√§ufe, kombiniert mit strukturierten Expertise-Extraktions-Workshops. Entwicklung transparenter Prozessmodelle mit klarer Trennung zwischen Kernlogik und Ausnahmebehandlung als Basis f√ºr die Automatisierung.\n\n‚Ä¢ Integration von Automatisierung in bestehende IT-Landschaften: Die Einbettung automatisierter Prozesse in historisch gewachsene, heterogene Systemlandschaften stellt viele Banken vor erhebliche technische Herausforderungen.\n   ‚Üí Unsere L√∂sung: Implementierung einer modularen Automatisierungsarchitektur mit klaren Schnittstellendefinitionen, die verschiedene Technologien (RPA, API-Integration, ETL-Prozesse) je nach Anwendungsfall kombiniert. Nutzung von Middleware-L√∂sungen zur √úberbr√ºckung technologischer Gr√§ben zwischen Legacy-Systemen und modernen Automatisierungsplattformen.\n\n‚Ä¢ Governance und Kontrolle automatisierter Prozesse: Mit zunehmender Automatisierung w√§chst die Herausforderung, diese Prozesse transparent zu √ºberwachen und regulatorischen Nachweis √ºber ihre korrekte Funktion zu erbringen.\n   ‚Üí Unsere L√∂sung: Entwicklung mehrstufiger Kontrollframeworks mit automatisierten Plausibilit√§tspr√ºfungen, Exception-Handling-Mechanismen und transparenten Audit-Trails. Implementation spezialisierter Monitoring-Dashboards, die Prozessausf√ºhrung, Abweichungen und Performance-Metriken in Echtzeit visualisieren.\n\nüõ†Ô∏è Methodische Erfolgsfaktoren f√ºr nachhaltige Automatisierung:\n‚Ä¢ Iterativer Proof-of-Value-Ansatz: Statt umfassender Big-Bang-L√∂sungen setzen wir auf schnelle, wertsch√∂pfende Automatisierungszyklen, die kontinuierliches Lernen erm√∂glichen und fr√ºhe Erfolge demonstrieren.\n‚Ä¢ Balanced Automation Governance: Entwicklung ausgewogener Governance-Strukturen, die notwendige Kontrolle sicherstellen, ohne Innovationsgeschwindigkeit und Flexibilit√§t zu beeintr√§chtigen.\n‚Ä¢ Mensch-Maschine-Kollaboration: Gestaltung hybrider Prozesse, die menschliche Expertise f√ºr komplexe Entscheidungen und Ausnahmebehandlungen mit maschineller Effizienz f√ºr Routineaufgaben kombinieren.\n‚Ä¢ Kontinuierliche Prozessoptimierung: Etablierung eines dauerhaften Feedback-Loops zur stetigen Verbesserung automatisierter Prozesse basierend auf neuen Erkenntnissen, Technologien und regulatorischen Entwicklungen."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
