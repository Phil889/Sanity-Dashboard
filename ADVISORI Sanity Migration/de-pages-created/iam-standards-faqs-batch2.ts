import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating IAM Standards page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iam-standards' })
    
    if (!existingDoc) {
      throw new Error('Document "iam-standards" not found')
    }
    
    // Create new FAQs for compliance and regulatory standards
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie implementiert man GDPR-konforme IAM-Systeme mit Privacy-by-Design Prinzipien und welche spezifischen Herausforderungen entstehen bei der Verarbeitung personenbezogener Daten in Identit√§tssystemen?',
        answer: "GDPR-konforme IAM-Systeme mit Privacy-by-Design Prinzipien erfordern eine fundamentale Neugestaltung traditioneller Identit√§tsverwaltung, bei der Datenschutz nicht nachtr√§glich hinzugef√ºgt, sondern von Grund auf in die Systemarchitektur integriert wird. Diese Herangehensweise transformiert Datenschutz von einer Compliance-Belastung zu einem strategischen Differentiator, der Vertrauen schafft und neue Gesch√§ftsm√∂glichkeiten erm√∂glicht.\n\nüîí Privacy-by-Design Architecture und Data Minimization:\n‚Ä¢ Data Minimization Principles mit Sammlung und Verarbeitung nur notwendiger Identit√§tsdaten\n‚Ä¢ Purpose Limitation durch klare Definition und Begrenzung der Datenverwendungszwecke\n‚Ä¢ Storage Limitation mit automatisierten L√∂schfristen und Lifecycle-Management\n‚Ä¢ Accuracy Maintenance durch kontinuierliche Datenqualit√§tskontrolle und Korrekturmechanismen\n‚Ä¢ Security Safeguards mit End-to-End-Verschl√ºsselung und Zero-Knowledge-Architekturen\n\n‚öñÔ∏è Legal Basis Management und Consent-Frameworks:\n‚Ä¢ Lawful Basis Assessment f√ºr jede Identit√§tsdatenverarbeitung mit dokumentierter Rechtfertigung\n‚Ä¢ Consent Management Platforms mit granularer Einwilligungskontrolle und Widerrufsm√∂glichkeiten\n‚Ä¢ Legitimate Interest Balancing mit systematischer Abw√§gung zwischen Gesch√§ftsinteressen und Datenschutzrechten\n‚Ä¢ Contractual Necessity Documentation f√ºr identit√§tsbezogene Vertragserf√ºllung\n‚Ä¢ Vital Interest und Public Task Evaluation f√ºr spezielle Verarbeitungssituationen\n\nüåê Cross-border Data Transfer Controls:\n‚Ä¢ Adequacy Decision Compliance f√ºr Daten√ºbertragungen in Drittl√§nder mit angemessenem Datenschutzniveau\n‚Ä¢ Standard Contractual Clauses Implementation f√ºr sichere internationale Daten√ºbertragung\n‚Ä¢ Binding Corporate Rules f√ºr multinationale Konzerne mit einheitlichen Datenschutzstandards\n‚Ä¢ Transfer Impact Assessment mit Bewertung der Datenschutzrisiken bei internationalen √úbertragungen\n‚Ä¢ Data Localization Strategies f√ºr Jurisdiktionen mit strengen Residency-Anforderungen\n\nüë§ Data Subject Rights Management:\n‚Ä¢ Right of Access Implementation mit benutzerfreundlichen Self-Service-Portalen\n‚Ä¢ Right to Rectification mit automatisierten Korrekturprozessen und Datenqualit√§tskontrolle\n‚Ä¢ Right to Erasure mit sicherer L√∂schung und Anonymisierung von Identit√§tsdaten\n‚Ä¢ Right to Data Portability mit standardisierten Exportformaten und API-Integration\n‚Ä¢ Right to Object mit granularen Opt-out-Mechanismen und Profilierungskontrollen\n\nüìä Accountability und Documentation:\n‚Ä¢ Data Protection Impact Assessment f√ºr alle IAM-Systeme mit hohem Datenschutzrisiko\n‚Ä¢ Records of Processing Activities mit vollst√§ndiger Dokumentation aller Identit√§tsdatenverarbeitungen\n‚Ä¢ Data Protection Officer Integration mit spezialisierter IAM-Datenschutzberatung\n‚Ä¢ Regular Compliance Audits mit systematischer √úberpr√ºfung der GDPR-Konformit√§t\n‚Ä¢ Breach Notification Procedures mit automatisierten Meldeprozessen und Incident-Response\n\nüöÄ Technical Implementation und Innovation:\n‚Ä¢ Pseudonymization Techniques f√ºr Identit√§tsdaten mit reversibler Anonymisierung\n‚Ä¢ Encryption at Rest und in Transit mit modernsten Verschl√ºsselungsstandards\n‚Ä¢ Access Logging und Audit Trails mit umfassender Protokollierung aller Datenzugriffe\n‚Ä¢ Automated Compliance Monitoring mit KI-gest√ºtzter Erkennung von Datenschutzverletzungen\n‚Ä¢ Privacy-preserving Analytics mit differenzieller Privatsph√§re und Federated Learning"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche spezifischen SOX-Compliance-Anforderungen gelten f√ºr IAM-Systeme in Finanzunternehmen und wie implementiert man effektive Segregation of Duties und Financial Controls?',
        answer: "SOX-Compliance f√ºr IAM-Systeme in Finanzunternehmen erfordert rigorose Financial Controls und Segregation of Duties, die √ºber traditionelle Zugriffskontrolle hinausgehen und systematische Governance-Strukturen f√ºr Finanzberichterstattung und interne Kontrollen etablieren. Diese Anforderungen transformieren IAM von einem technischen System zu einem kritischen Compliance-Instrument f√ºr Finanzintegrit√§t und Investor-Vertrauen.\n\nüìã SOX Section 404 Controls f√ºr IAM-Systeme:\n‚Ä¢ Management Assessment of Internal Controls mit systematischer Bewertung aller IAM-bezogenen Finanzkontrollen\n‚Ä¢ Auditor Attestation Requirements mit externen Pr√ºfungen der IAM-Kontrolleffektivit√§t\n‚Ä¢ Material Weakness Identification mit proaktiver Erkennung und Behebung von Kontrolldefiziten\n‚Ä¢ Significant Deficiency Management mit strukturierter Behandlung von Compliance-L√ºcken\n‚Ä¢ Quarterly Certification Processes mit regelm√§√üiger Management-Best√§tigung der Kontrollwirksamkeit\n\n‚öñÔ∏è Segregation of Duties und Conflict Prevention:\n‚Ä¢ Role-based Segregation mit systematischer Trennung unvereinbarer Funktionen\n‚Ä¢ Compensating Controls f√ºr unvermeidbare Rollenkonflikte mit zus√§tzlichen √úberwachungsma√ünahmen\n‚Ä¢ Automated Conflict Detection mit KI-gest√ºtzter Erkennung problematischer Berechtigungskombinationen\n‚Ä¢ Periodic Access Reviews mit regelm√§√üiger √úberpr√ºfung und Zertifizierung aller Finanzberechtigungen\n‚Ä¢ Exception Management mit dokumentierter Genehmigung und √úberwachung von Ausnahmen\n\nüí∞ Financial Application Controls:\n‚Ä¢ ERP System Integration mit spezialisierten Kontrollen f√ºr SAP, Oracle und andere Finanzsysteme\n‚Ä¢ General Ledger Access Controls mit granularen Berechtigungen f√ºr Buchungsoperationen\n‚Ä¢ Financial Reporting Controls mit Schutz kritischer Berichterstattungsprozesse\n‚Ä¢ Month-end Close Controls mit zeitlich begrenzten Zugriffen f√ºr Periodenabschl√ºsse\n‚Ä¢ Treasury und Cash Management Controls f√ºr hochsensible Finanzoperationen\n\nüìä Audit Trail Management und Evidence Collection:\n‚Ä¢ Comprehensive Logging mit vollst√§ndiger Protokollierung aller finanzrelevanten IAM-Aktivit√§ten\n‚Ä¢ Immutable Audit Records mit manipulationssicherer Speicherung von Compliance-Evidenz\n‚Ä¢ Real-time Monitoring mit sofortiger Erkennung verd√§chtiger Finanzaktivit√§ten\n‚Ä¢ Automated Reporting f√ºr Management und Auditoren mit standardisierten Compliance-Dashboards\n‚Ä¢ Long-term Retention mit sicherer Archivierung f√ºr regulatorische Aufbewahrungsfristen\n\nüîç Management Testing und Validation:\n‚Ä¢ Control Testing Procedures mit systematischer √úberpr√ºfung der IAM-Kontrollwirksamkeit\n‚Ä¢ Walkthrough Documentation mit detaillierter Beschreibung aller Kontrollprozesse\n‚Ä¢ Sampling Methodologies f√ºr effiziente und repr√§sentative Kontrollpr√ºfungen\n‚Ä¢ Deficiency Remediation mit strukturierter Behebung identifizierter Schw√§chen\n‚Ä¢ Continuous Monitoring mit laufender √úberwachung der Kontrollperformance\n\nüöÄ Technology Integration und Automation:\n‚Ä¢ GRC Platform Integration mit spezialisierten Governance, Risk und Compliance-Systemen\n‚Ä¢ Automated Control Testing mit KI-gest√ºtzter Validierung von Kontrollwirksamkeit\n‚Ä¢ Risk-based Access Provisioning mit automatisierten Genehmigungsworkflows\n‚Ä¢ Continuous Compliance Monitoring mit Real-time √úberwachung aller SOX-relevanten Aktivit√§ten\n‚Ä¢ Management Certification Automation mit digitalen Best√§tigungsprozessen f√ºr F√ºhrungskr√§fte"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie adressiert man branchenspezifische IAM-Standards wie HIPAA f√ºr Healthcare, PCI-DSS f√ºr Payment Processing und TISAX f√ºr Automotive Industry?',
        answer: "Branchenspezifische IAM-Standards erfordern ma√ügeschneiderte Compliance-Ans√§tze, die √ºber generische Sicherheitsframeworks hinausgehen und spezifische Branchenrisiken, regulatorische Anforderungen und Gesch√§ftsprozesse ber√ºcksichtigen. Diese sektorspezifische Spezialisierung transformiert IAM von einer standardisierten L√∂sung zu einem strategischen Differentiator, der Branchenexpertise und Compliance-Excellence demonstriert.\n\nüè• HIPAA-konforme IAM f√ºr Healthcare:\n‚Ä¢ Protected Health Information Controls mit spezialisierten Zugriffskontrollen f√ºr Patientendaten\n‚Ä¢ Minimum Necessary Standard mit granularen Berechtigungen basierend auf Behandlungsnotwendigkeit\n‚Ä¢ Business Associate Agreements mit IAM-spezifischen Vertragsklauseln f√ºr Drittanbieter\n‚Ä¢ Breach Notification Requirements mit automatisierten Meldeprozessen f√ºr PHI-Verletzungen\n‚Ä¢ Patient Rights Management mit Self-Service-Portalen f√ºr Datenzugriff und Korrektur\n\nüí≥ PCI-DSS Compliance f√ºr Payment Processing:\n‚Ä¢ Cardholder Data Environment Protection mit isolierten IAM-Systemen f√ºr Zahlungsdatenverarbeitung\n‚Ä¢ Strong Access Control Measures mit Multi-Factor-Authentication f√ºr alle privilegierten Zugriffe\n‚Ä¢ Regular Security Testing mit penetration Testing und Vulnerability Assessments\n‚Ä¢ Network Segmentation mit strikter Trennung von Zahlungs- und Gesch√§ftsnetzwerken\n‚Ä¢ Vendor Management mit spezialisierten Due-Diligence-Prozessen f√ºr Payment-Service-Provider\n\nüöó TISAX-Zertifizierung f√ºr Automotive Industry:\n‚Ä¢ Information Security Assessment mit VDA-spezifischen Bewertungskriterien\n‚Ä¢ Prototype Protection mit speziellen Kontrollen f√ºr Entwicklungsdaten und Fahrzeuginnovationen\n‚Ä¢ Data Protection Controls f√ºr Automotive-spezifische personenbezogene Daten\n‚Ä¢ Supply Chain Security mit erweiterten Vendor-Assessment-Prozessen\n‚Ä¢ Incident Response f√ºr Automotive-spezifische Sicherheitsvorf√§lle und IP-Schutz\n\nüè≠ Manufacturing und Industrial Standards:\n‚Ä¢ IEC 62443 Industrial Cybersecurity mit IAM-Integration in OT-Umgebungen\n‚Ä¢ NIST Manufacturing Profile mit spezialisierten Kontrollen f√ºr Produktionsumgebungen\n‚Ä¢ Supply Chain Risk Management mit erweiterten Vendor-Onboarding-Prozessen\n‚Ä¢ Intellectual Property Protection mit speziellen Zugriffskontrollen f√ºr Entwicklungsdaten\n‚Ä¢ Safety-critical System Controls mit funktionaler Sicherheit und Verf√ºgbarkeitsanforderungen\n\nüèõÔ∏è Government und Public Sector Standards:\n‚Ä¢ FedRAMP Authorization mit Cloud-spezifischen Sicherheitskontrollen f√ºr Regierungsdaten\n‚Ä¢ FISMA Compliance mit Risk Management Framework f√ºr Bundesbeh√∂rden\n‚Ä¢ Common Criteria Evaluation mit formaler Sicherheitszertifizierung\n‚Ä¢ Classified Information Handling mit Multi-Level-Security und Compartmentalization\n‚Ä¢ Continuous Monitoring mit Government-spezifischen √úberwachungsanforderungen\n\nüåê Cross-sector Integration und Harmonization:\n‚Ä¢ Multi-standard Compliance mit einheitlichen Kontrollen f√ºr verschiedene Branchenanforderungen\n‚Ä¢ Risk-based Approach mit sektorspezifischer Risikobewertung und Kontrollpriorisierung\n‚Ä¢ Scalable Architecture mit flexiblen IAM-Systemen f√ºr Multi-Sector-Organisationen\n‚Ä¢ Continuous Adaptation mit proaktiver Anpassung an evolvierende Branchenstandards\n‚Ä¢ Best Practice Integration mit branchen√ºbergreifendem Wissenstransfer und Innovation"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Rolle spielen internationale Standards wie Common Criteria, FIDO Alliance und OAuth/OpenID Connect bei der Entwicklung zukunftssicherer IAM-Architekturen?',
        answer: "Internationale Standards wie Common Criteria, FIDO Alliance und OAuth/OpenID Connect bilden das technologische Fundament zukunftssicherer IAM-Architekturen und erm√∂glichen Interoperabilit√§t, Sicherheit und Innovation √ºber Organisationsgrenzen hinweg. Diese Standards transformieren IAM von propriet√§ren, isolierten Systemen zu offenen, interoperablen Plattformen, die globale Zusammenarbeit und technologische Evolution unterst√ºtzen.\n\nüõ°Ô∏è Common Criteria und Formal Security Evaluation:\n‚Ä¢ Security Target Definition mit pr√§ziser Spezifikation von Sicherheitsanforderungen und Bedrohungsmodellen\n‚Ä¢ Protection Profile Compliance mit standardisierten Sicherheitsprofilen f√ºr IAM-Komponenten\n‚Ä¢ Evaluation Assurance Levels mit gradueller Vertrauensstufung von EAL1 bis EAL7\n‚Ä¢ Independent Security Testing mit formaler Validierung durch akkreditierte Pr√ºflabore\n‚Ä¢ International Recognition durch Mutual Recognition Arrangements zwischen verschiedenen L√§ndern\n\nüîê FIDO Alliance und Passwordless Authentication:\n‚Ä¢ WebAuthn Standard Implementation mit browserbasierten, kryptographischen Authentifizierungsverfahren\n‚Ä¢ CTAP Protocol Integration f√ºr externe Authenticator-Ger√§te und Hardware-Security-Keys\n‚Ä¢ Biometric Authentication mit lokaler Verarbeitung und Privacy-preserving Biometrics\n‚Ä¢ Multi-device Synchronization mit sicherer Credential-Synchronisation √ºber Ger√§tegrenzen hinweg\n‚Ä¢ Enterprise Integration mit FIDO2-konformen IAM-Systemen f√ºr skalierbare Passwordless-Deployment\n\nüåê OAuth und OpenID Connect Ecosystem:\n‚Ä¢ Authorization Framework mit standardisierten Token-basierten Autorisierungsverfahren\n‚Ä¢ Identity Layer Integration mit OpenID Connect f√ºr sichere Identit√§tsverifikation\n‚Ä¢ API Security mit OAuth-gesch√ºtzten Microservices und Resource-Server-Integration\n‚Ä¢ Federation Protocols f√ºr sichere Cross-Domain-Authentication und Single-Sign-On\n‚Ä¢ Mobile und Native App Integration mit PKCE und andere Mobile-spezifische Sicherheitserweiterungen\n\nüì° SAML und Enterprise Federation:\n‚Ä¢ Security Assertion Markup Language f√ºr XML-basierte Identity-Federation\n‚Ä¢ Cross-domain Single Sign-On mit vertrauensvollen Identity-Provider-Beziehungen\n‚Ä¢ Attribute Exchange mit standardisierten Claim-Formaten und Attribute-Mapping\n‚Ä¢ Metadata Management f√ºr automatisierte Federation-Konfiguration und Trust-Establishment\n‚Ä¢ Legacy System Integration mit SAML-Bridges f√ºr √§ltere Anwendungen\n\nüîÑ Emerging Standards und Future Technologies:\n‚Ä¢ Decentralized Identity Standards mit Self-Sovereign Identity und Verifiable Credentials\n‚Ä¢ Zero-Knowledge Proof Integration f√ºr Privacy-preserving Authentication\n‚Ä¢ Quantum-resistant Cryptography mit Post-Quantum-Algorithmen f√ºr langfristige Sicherheit\n‚Ä¢ Blockchain-based Identity mit Distributed Ledger Technology f√ºr Trust-Establishment\n‚Ä¢ AI-powered Standards mit Machine Learning f√ºr adaptive Sicherheitskontrollen\n\nüöÄ Implementation Strategy und Best Practices:\n‚Ä¢ Standards-based Architecture Design mit modularen, interoperablen Komponenten\n‚Ä¢ Vendor-neutral Implementation mit Vermeidung von Vendor-Lock-in durch Standards-Compliance\n‚Ä¢ Continuous Standards Evolution mit proaktiver Adoption neuer Standards und Protokolle\n‚Ä¢ Global Interoperability mit Cross-border-kompatiblen IAM-Systemen\n‚Ä¢ Innovation Integration mit Standards-konformer Adoption neuer Technologien und Verfahren"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
