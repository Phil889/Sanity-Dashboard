import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Training page with FAQ batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-training' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-training" not found')
    }
    
    // Create new FAQs for training delivery and methodology
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 13),
        question: 'How does ADVISORI implement blended learning approaches to maximize training effectiveness and participant engagement?',
        answer: "ADVISORI's blended learning methodology combines the best aspects of traditional classroom instruction with innovative digital learning technologies to create comprehensive, flexible, and highly effective training experiences. Our approach recognizes that different learning styles and professional constraints require diverse delivery methods to achieve optimal outcomes.\n\nüéØ Strategic Learning Design Framework:\n‚Ä¢ Systematic analysis of learning objectives to determine optimal mix of delivery methods for each training component\n‚Ä¢ Pre-training assessments that identify individual learning preferences and knowledge gaps to customize the learning journey\n‚Ä¢ Modular content design that allows participants to progress through foundational concepts at their own pace while ensuring mastery\n‚Ä¢ Integration points between online and face-to-face components that reinforce learning and provide opportunities for practical application\n‚Ä¢ Continuous feedback loops that allow real-time adjustment of learning paths based on participant progress and comprehension\n\nüíª Digital Learning Platform Integration:\n‚Ä¢ State-of-the-art learning management systems that provide seamless access to content, assessments, and collaboration tools\n‚Ä¢ Interactive multimedia content including videos, simulations, and virtual laboratories for hands-on practice\n‚Ä¢ Mobile-responsive design that enables learning access from any device at any time, accommodating busy professional schedules\n‚Ä¢ Social learning features that facilitate peer interaction, discussion forums, and collaborative problem-solving\n‚Ä¢ Adaptive learning algorithms that adjust content difficulty and pacing based on individual performance and learning patterns\n\nüè´ Enhanced Classroom Experiences:\n‚Ä¢ Flipped classroom methodology where participants complete foundational learning online and use classroom time for advanced application and discussion\n‚Ä¢ Interactive workshops that build on pre-learned concepts through case studies, role-playing, and practical exercises\n‚Ä¢ Expert-led sessions that provide deep insights, answer complex questions, and facilitate peer learning through group activities\n‚Ä¢ Hands-on laboratories and simulation exercises that allow participants to practice skills in safe, controlled environments\n‚Ä¢ Networking opportunities that connect participants with industry peers and subject matter experts for ongoing professional development\n\nüìä Continuous Assessment and Feedback:\n‚Ä¢ Formative assessments throughout the learning journey that provide immediate feedback and identify areas requiring additional attention\n‚Ä¢ Competency-based progression that ensures participants master each concept before advancing to more complex topics\n‚Ä¢ Peer assessment activities that encourage collaborative learning and provide multiple perspectives on problem-solving approaches\n‚Ä¢ Real-time analytics that track engagement, progress, and performance to optimize the learning experience\n‚Ä¢ Personalized feedback from instructors that addresses individual learning needs and career development goals\n\nüîÑ Flexible Scheduling and Accessibility:\n‚Ä¢ Self-paced online modules that accommodate varying work schedules and time zone differences for global participants\n‚Ä¢ Multiple start dates and flexible completion timelines that align with organizational training needs and individual availability\n‚Ä¢ Recorded sessions and downloadable resources that enable review and reinforcement of key concepts\n‚Ä¢ Accessibility features that ensure training is available to participants with diverse needs and technical capabilities\n‚Ä¢ Integration with corporate learning systems and professional development tracking platforms"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 14),
        question: 'What documentation and certification processes does ADVISORI provide to validate training completion and competency achievement?',
        answer: "ADVISORI maintains rigorous documentation and certification standards that provide credible evidence of training completion and competency achievement. Our comprehensive approach ensures that participants receive recognized credentials that enhance their professional standing and demonstrate their expertise to employers and clients.\n\nüìú Comprehensive Certification Portfolio:\n‚Ä¢ Detailed certificates of completion that specify training content, duration, and competency areas covered during the program\n‚Ä¢ Digital badges and micro-credentials that can be displayed on professional profiles and social media platforms\n‚Ä¢ Continuing professional education credits that support maintenance of professional certifications and career advancement\n‚Ä¢ Competency transcripts that provide detailed breakdown of skills and knowledge areas mastered during training\n‚Ä¢ Professional references and recommendations for participants who demonstrate exceptional performance and engagement\n\nüîç Rigorous Assessment and Validation:\n‚Ä¢ Multi-stage assessment process including written examinations, practical demonstrations, and portfolio submissions\n‚Ä¢ Competency-based evaluation criteria that measure both theoretical knowledge and practical application skills\n‚Ä¢ Independent verification of learning outcomes through third-party assessment and peer review processes\n‚Ä¢ Continuous assessment throughout the training program rather than relying solely on final examinations\n‚Ä¢ Remediation and re-assessment opportunities for participants who require additional support to achieve competency standards\n\nüìä Quality Assurance and Accreditation:\n‚Ä¢ Alignment with international training standards and best practices for professional development programs\n‚Ä¢ Regular external audits and reviews of training content, delivery methods, and assessment processes\n‚Ä¢ Accreditation by recognized professional bodies and certification organizations in the information security field\n‚Ä¢ Continuous improvement processes that incorporate participant feedback and industry developments\n‚Ä¢ Benchmarking against global training providers to ensure competitive quality and relevance\n\nüíº Professional Recognition and Career Support:\n‚Ä¢ Industry recognition of ADVISORI certifications by major employers, consulting firms, and certification bodies\n‚Ä¢ Career guidance and placement support for participants seeking new opportunities in information security\n‚Ä¢ Alumni network access that provides ongoing professional development and networking opportunities\n‚Ä¢ Endorsement and recommendation services for participants pursuing advanced certifications or career advancement\n‚Ä¢ Integration with professional development planning and career pathway guidance\n\nüåê Digital Credential Management:\n‚Ä¢ Secure digital credentialing platform that provides tamper-proof verification of training completion and competency achievement\n‚Ä¢ Blockchain-based credential verification that ensures authenticity and prevents fraudulent claims\n‚Ä¢ Integration with professional networking platforms and employer verification systems\n‚Ä¢ Automated renewal and maintenance tracking for credentials that require ongoing professional development\n‚Ä¢ Global accessibility and recognition of digital credentials across different markets and regulatory environments\n\nüìà Ongoing Professional Development Tracking:\n‚Ä¢ Comprehensive learning portfolio that tracks all training activities, assessments, and professional development achievements\n‚Ä¢ Integration with continuing education requirements for professional certifications and industry standards\n‚Ä¢ Personalized development planning that identifies future learning needs and career advancement opportunities\n‚Ä¢ Progress tracking and milestone recognition that celebrates achievement and encourages continued learning\n‚Ä¢ Connection to advanced training programs and specialization opportunities for continued professional growth"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 15),
        question: 'How does ADVISORI ensure quality assurance and continuous improvement in training delivery and content?',
        answer: "ADVISORI implements a comprehensive quality assurance framework that encompasses all aspects of training design, delivery, and evaluation. Our systematic approach ensures consistent high-quality experiences while continuously evolving to meet changing industry needs and participant expectations.\n\nüîç Multi-Level Quality Monitoring:\n‚Ä¢ Real-time monitoring of training delivery through participant feedback, instructor evaluation, and learning analytics\n‚Ä¢ Regular quality audits conducted by independent assessors and subject matter experts from outside the organization\n‚Ä¢ Systematic review of training materials, assessments, and delivery methods against industry best practices and standards\n‚Ä¢ Continuous tracking of participant satisfaction, learning outcomes, and post-training performance in professional environments\n‚Ä¢ Benchmarking against leading training providers and international standards for professional development programs\n\nüìä Data-Driven Improvement Processes:\n‚Ä¢ Comprehensive analytics platform that tracks participant engagement, learning progress, and competency achievement across all training programs\n‚Ä¢ Statistical analysis of training effectiveness including correlation between training methods and learning outcomes\n‚Ä¢ Longitudinal studies that track participant career progression and application of learned skills in professional settings\n‚Ä¢ Predictive modeling to identify potential learning challenges and optimize training design for different participant profiles\n‚Ä¢ Regular reporting to stakeholders on training quality metrics and improvement initiatives\n\nüë• Stakeholder Feedback Integration:\n‚Ä¢ Systematic collection of feedback from participants, employers, industry partners, and certification bodies\n‚Ä¢ Regular focus groups and advisory panels that provide strategic guidance on training content and delivery methods\n‚Ä¢ Alumni surveys that assess long-term value and application of training in professional environments\n‚Ä¢ Industry consultation processes that ensure training remains relevant to current market needs and emerging trends\n‚Ä¢ Continuous dialogue with regulatory bodies and standards organizations to maintain compliance and relevance\n\nüîÑ Continuous Content Evolution:\n‚Ä¢ Regular review and update cycles that incorporate new standards, regulations, and industry best practices\n‚Ä¢ Integration of emerging technologies and methodologies into training content and delivery approaches\n‚Ä¢ Collaboration with industry experts and thought leaders to ensure cutting-edge content and perspectives\n‚Ä¢ Pilot programs for new training approaches and technologies before full-scale implementation\n‚Ä¢ Version control and change management processes that ensure consistent quality during content updates\n\nüéì Instructor Development and Standardization:\n‚Ä¢ Comprehensive instructor training and certification programs that ensure consistent delivery quality across all trainers\n‚Ä¢ Regular calibration sessions that align instructor approaches and maintain consistent standards\n‚Ä¢ Ongoing professional development for instructors including advanced training techniques and subject matter expertise\n‚Ä¢ Peer review and mentoring programs that support instructor growth and knowledge sharing\n‚Ä¢ Performance evaluation and feedback systems that identify areas for instructor improvement and recognition\n\nüåê Global Standards and Best Practices:\n‚Ä¢ Alignment with international training standards such as ISO 29990 and other recognized frameworks for learning services\n‚Ä¢ Participation in professional training associations and standards development organizations\n‚Ä¢ Regular benchmarking against global best practices in professional development and adult learning\n‚Ä¢ Integration of research findings from educational psychology and learning science into training design\n‚Ä¢ Collaboration with academic institutions and research organizations to advance training methodologies"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 16),
        question: 'What support does ADVISORI provide for organizations implementing training programs across multiple locations and time zones?',
        answer: "ADVISORI recognizes the unique challenges faced by global organizations in delivering consistent, high-quality training across diverse geographical locations and cultural contexts. Our comprehensive support framework addresses logistical, cultural, and technological considerations to ensure successful training implementation regardless of organizational complexity.\n\nüåç Global Delivery Coordination:\n‚Ä¢ Dedicated program management team that coordinates training delivery across multiple locations and time zones\n‚Ä¢ Standardized training materials and delivery protocols that ensure consistency while allowing for local adaptation\n‚Ä¢ Multi-language support including translation of materials and availability of native-speaking instructors\n‚Ä¢ Cultural adaptation services that modify training content and delivery approaches to align with local business practices and cultural norms\n‚Ä¢ Centralized scheduling and logistics coordination that optimizes resource utilization and minimizes travel requirements\n\nüíª Technology Infrastructure Support:\n‚Ä¢ Robust virtual training platforms that support high-quality delivery across different time zones and technical environments\n‚Ä¢ Technical support services that ensure reliable connectivity and platform performance for all participants\n‚Ä¢ Hybrid delivery options that combine local in-person sessions with global virtual components\n‚Ä¢ Mobile-friendly platforms that accommodate participants using different devices and connectivity levels\n‚Ä¢ Integration with corporate learning management systems and IT infrastructure\n\nüìã Customized Implementation Planning:\n‚Ä¢ Comprehensive needs assessment that identifies specific requirements for each location and participant group\n‚Ä¢ Phased implementation approaches that allow for pilot testing and refinement before full-scale deployment\n‚Ä¢ Local coordinator training that builds internal capacity for ongoing training support and administration\n‚Ä¢ Change management support that helps organizations prepare employees for new training initiatives\n‚Ä¢ Risk assessment and contingency planning for potential implementation challenges\n\nüéØ Localized Content and Delivery:\n‚Ä¢ Regional case studies and examples that reflect local business environments and regulatory requirements\n‚Ä¢ Local instructor networks that provide cultural familiarity and language capabilities\n‚Ä¢ Adaptation of training schedules to accommodate local holidays, business practices, and work patterns\n‚Ä¢ Integration with local professional development requirements and certification pathways\n‚Ä¢ Collaboration with local partners and subject matter experts to enhance relevance and credibility\n\nüìä Centralized Monitoring and Reporting:\n‚Ä¢ Unified reporting dashboard that provides real-time visibility into training progress across all locations\n‚Ä¢ Standardized metrics and evaluation criteria that enable meaningful comparison and benchmarking\n‚Ä¢ Centralized participant tracking and certification management across the global organization\n‚Ä¢ Regular progress reviews and adjustment recommendations based on performance data and feedback\n‚Ä¢ Executive reporting that summarizes global training outcomes and return on investment\n\nü§ù Ongoing Support and Maintenance:\n‚Ä¢ Dedicated account management that provides single point of contact for global training coordination\n‚Ä¢ Regular check-ins and performance reviews to ensure continued training effectiveness and participant satisfaction\n‚Ä¢ Troubleshooting and problem resolution support for technical and logistical challenges\n‚Ä¢ Continuous improvement recommendations based on global best practices and lessons learned\n‚Ä¢ Scalability planning that supports organizational growth and changing training needs"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
