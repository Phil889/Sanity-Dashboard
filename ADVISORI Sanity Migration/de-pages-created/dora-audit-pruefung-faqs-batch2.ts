import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating DORA Audit & Pr√ºfung page with FAQ batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'dora-audit-pruefung' })
    
    if (!existingDoc) {
      throw new Error('Document "dora-audit-pruefung" not found')
    }
    
    // Create new FAQs for audit planning and scope definition
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie definiere ich den optimalen Scope f√ºr ein DORA-Audit und welche Bereiche m√ºssen priorit√§r gepr√ºft werden?',
        answer: "Die Definition des Audit-Scope ist eine strategische Entscheidung, die sowohl regulatorische Vollst√§ndigkeit als auch operative Effizienz gew√§hrleisten muss. Ein gut definierter Scope maximiert den Audit-Wert bei optimaler Ressourcennutzung und stellt sicher, dass alle kritischen Risikobereiche angemessen abgedeckt werden.\n\nüéØ Risikobasierte Scope-Definition:\n‚Ä¢ Beginnen Sie mit einer umfassenden Risikobewertung aller IKT-Systeme und -Prozesse, um die kritischsten Bereiche zu identifizieren\n‚Ä¢ Ber√ºcksichtigen Sie die Gesch√§ftskritikalit√§t verschiedener Services und deren potenzielle Auswirkungen auf die operative Kontinuit√§t\n‚Ä¢ Bewerten Sie die Komplexit√§t und Interdependenzen zwischen verschiedenen Systemen und Prozessen\n‚Ä¢ Analysieren Sie historische Incident-Daten und Schwachstellen-Assessments zur Identifikation wiederkehrender Problembereiche\n‚Ä¢ Integrieren Sie externe Threat-Intelligence und Branchentrends in die Scope-Bestimmung\n\nüìä Priorit√§re Audit-Bereiche unter DORA:\n‚Ä¢ IKT-Risikomanagement-Framework und dessen Integration in die Gesamtstrategie der Organisation\n‚Ä¢ Kritische IKT-Drittanbieter und deren Risikomanagement, einschlie√ülich Vertragsgestaltung und Monitoring\n‚Ä¢ Incident-Response und Business-Continuity-Prozesse mit Fokus auf deren Wirksamkeit unter Stressbedingungen\n‚Ä¢ Cybersecurity-Kontrollen und deren Angemessenheit f√ºr die spezifischen Bedrohungen des Instituts\n‚Ä¢ Penetrationstest-Programme und deren Integration in das kontinuierliche Risikomanagement\n\nüîç Scope-Dimensionen und Abgrenzungen:\n‚Ä¢ Definieren Sie klare zeitliche Abgrenzungen f√ºr das Audit, einschlie√ülich der zu pr√ºfenden Perioden und Stichtage\n‚Ä¢ Bestimmen Sie die organisatorischen Grenzen des Audits, einschlie√ülich Tochtergesellschaften und Outsourcing-Partner\n‚Ä¢ Legen Sie die technischen Grenzen fest, einschlie√ülich der zu pr√ºfenden Systeme, Netzwerke und Anwendungen\n‚Ä¢ Spezifizieren Sie die funktionalen Bereiche, die in das Audit einbezogen werden sollen\n‚Ä¢ Definieren Sie Ausschlusskriterien und deren Begr√ºndung f√ºr eine transparente Scope-Kommunikation\n\n‚öñÔ∏è Ausgewogenheit zwischen Tiefe und Breite:\n‚Ä¢ Entwickeln Sie einen gestuften Audit-Ansatz, der kritische Bereiche intensiv und weniger kritische Bereiche oberfl√§chlicher pr√ºft\n‚Ä¢ Planen Sie Deep-Dive-Assessments f√ºr Hochrisikobereiche und Stichprobenpr√ºfungen f√ºr Standardprozesse\n‚Ä¢ Ber√ºcksichtigen Sie die verf√ºgbaren Audit-Ressourcen und -Kompetenzen bei der Scope-Definition\n‚Ä¢ Stellen Sie sicher, dass der Scope realistisch und innerhalb der geplanten Zeitrahmen umsetzbar ist\n‚Ä¢ Entwickeln Sie Flexibilit√§t f√ºr Scope-Anpassungen basierend auf Audit-Erkenntnissen w√§hrend der Durchf√ºhrung\n\nüìà Kontinuierliche Scope-Optimierung:\n‚Ä¢ Etablieren Sie Mechanismen zur regelm√§√üigen √úberpr√ºfung und Anpassung des Audit-Scope basierend auf ver√§nderten Risikoprofilen\n‚Ä¢ Nutzen Sie Erkenntnisse aus vorherigen Audits zur Verfeinerung zuk√ºnftiger Scope-Definitionen\n‚Ä¢ Integrieren Sie Feedback von Stakeholdern und Aufsichtsbeh√∂rden in die Scope-Entwicklung\n‚Ä¢ Ber√ºcksichtigen Sie regulatorische Entwicklungen und neue DORA-Guidance bei der Scope-Anpassung\n‚Ä¢ Dokumentieren Sie Scope-Entscheidungen und deren Rationale f√ºr Transparenz und Nachvollziehbarkeit"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche Audit-Methodologien und -Tools sind f√ºr DORA-Compliance am effektivsten?',
        answer: "Die Auswahl der richtigen Audit-Methodologien und -Tools ist entscheidend f√ºr die Effektivit√§t und Effizienz von DORA-Audits. Moderne Audit-Ans√§tze kombinieren traditionelle Pr√ºfungstechniken mit innovativen Technologien und datengetriebenen Methoden zur Maximierung der Audit-Qualit√§t.\n\nüîß Moderne Audit-Methodologien:\n‚Ä¢ Risikobasierte Audit-Ans√§tze, die kontinuierliche Risikobewertungen und dynamische Audit-Planung integrieren\n‚Ä¢ Datenanalytik-gest√ºtzte Audits, die gro√üe Datenmengen systematisch analysieren und Anomalien automatisch identifizieren\n‚Ä¢ Kontinuierliche Audit-Techniken, die Real-Time-Monitoring mit periodischen Deep-Dive-Assessments kombinieren\n‚Ä¢ Szenario-basierte Audit-Methoden, die verschiedene Stress-Situationen und deren Auswirkungen simulieren\n‚Ä¢ Agile Audit-Ans√§tze, die iterative Pr√ºfungszyklen und schnelle Anpassungen an neue Erkenntnisse erm√∂glichen\n\nüõ†Ô∏è Spezialisierte DORA-Audit-Tools:\n‚Ä¢ GRC-Plattformen, die DORA-spezifische Kontrollen und Compliance-Anforderungen integrieren\n‚Ä¢ Vulnerability-Management-Systeme f√ºr kontinuierliche Sicherheitsbewertungen und Penetrationstest-Management\n‚Ä¢ Business-Continuity-Management-Tools f√ºr die Bewertung von Resilienz-Pl√§nen und Recovery-F√§higkeiten\n‚Ä¢ Drittanbieter-Risikomanagement-Plattformen f√ºr systematisches Vendor-Assessment und -Monitoring\n‚Ä¢ Incident-Management-Systeme f√ºr die Analyse von Sicherheitsvorf√§llen und Response-Effektivit√§t\n\nüìä Datengetriebene Audit-Techniken:\n‚Ä¢ Automatisierte Log-Analyse zur Identifikation von Sicherheitsanomalien und Compliance-Verst√∂√üen\n‚Ä¢ Machine-Learning-basierte Risikobewertung f√ºr pr√§diktive Audit-Planung und Fokussierung\n‚Ä¢ Network-Traffic-Analyse zur Bewertung der Wirksamkeit von Sicherheitskontrollen\n‚Ä¢ Configuration-Management-Audits durch automatisierte Compliance-Checks\n‚Ä¢ Performance-Monitoring-Integration zur Bewertung der operationellen Resilienz unter verschiedenen Lastbedingungen\n\nüéØ Integrierte Audit-Frameworks:\n‚Ä¢ COBIT-basierte Audit-Programme, die IT-Governance und DORA-Anforderungen systematisch verkn√ºpfen\n‚Ä¢ ISO-Standards-Integration f√ºr ganzheitliche Risikomanagement- und Sicherheitsbewertungen\n‚Ä¢ NIST-Framework-Alignment f√ºr strukturierte Cybersecurity-Assessments\n‚Ä¢ COSO-Integration f√ºr umfassende interne Kontrollbewertungen\n‚Ä¢ Branchenspezifische Frameworks, die Finanzdienstleistungs-spezifische Risiken und Anforderungen ber√ºcksichtigen\n\nüöÄ Innovative Audit-Technologien:\n‚Ä¢ Robotic Process Automation f√ºr standardisierte Audit-Prozesse und Dokumentenpr√ºfungen\n‚Ä¢ K√ºnstliche Intelligenz f√ºr komplexe Datenanalysen und Muster-Erkennung\n‚Ä¢ Blockchain-basierte Audit-Trails f√ºr unver√§nderliche Pr√ºfungsnachweise\n‚Ä¢ Cloud-basierte Audit-Plattformen f√ºr skalierbare und flexible Audit-Durchf√ºhrung\n‚Ä¢ Mobile Audit-L√∂sungen f√ºr effiziente Vor-Ort-Pr√ºfungen und Real-Time-Dokumentation\n\nüîÑ Kontinuierliche Methodologie-Verbesserung:\n‚Ä¢ Regelm√§√üige Bewertung der Audit-Tool-Effektivit√§t und ROI-Analyse\n‚Ä¢ Integration neuer Technologien und Methodologien basierend auf Branchenentwicklungen\n‚Ä¢ Benchmarking mit Best Practices anderer Finanzinstitute und Audit-Organisationen\n‚Ä¢ Feedback-Integration von Audit-Teams und gepr√ºften Bereichen zur kontinuierlichen Optimierung\n‚Ä¢ Anpassung an regulatorische Entwicklungen und neue DORA-Guidance"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie koordiniere ich DORA-Audits mit anderen regulatorischen Pr√ºfungen und vermeide Audit-Fatigue?',
        answer: "Die Koordination verschiedener regulatorischer Audits ist eine kritische Managementaufgabe, die strategische Planung und effiziente Ressourcennutzung erfordert. Eine durchdachte Audit-Koordination minimiert Belastungen f√ºr die Organisation und maximiert gleichzeitig den Wert aller Pr√ºfungsaktivit√§ten.\n\nüìÖ Strategische Audit-Planung und -Koordination:\n‚Ä¢ Entwickeln Sie einen integrierten Mehrjahres-Audit-Kalender, der alle regulatorischen und internen Pr√ºfungen systematisch koordiniert\n‚Ä¢ Identifizieren Sie √úberschneidungen zwischen DORA-Anforderungen und anderen Regulierungen wie NIS2, GDPR oder branchenspezifischen Standards\n‚Ä¢ Planen Sie Audit-Zyklen so, dass sich Pr√ºfungen erg√§nzen und aufeinander aufbauen, anstatt sich zu √ºberschneiden\n‚Ä¢ Koordinieren Sie mit externen Auditoren und Aufsichtsbeh√∂rden zur Optimierung von Pr√ºfungsterminen\n‚Ä¢ Entwickeln Sie Flexibilit√§t f√ºr ungeplante Audits und regulatorische Sonderpr√ºfungen\n\nüîÑ Integrierte Audit-Ans√§tze:\n‚Ä¢ Nutzen Sie gemeinsame Kontrollen und Prozesse f√ºr mehrere regulatorische Anforderungen gleichzeitig\n‚Ä¢ Entwickeln Sie √ºbergreifende Dokumentations- und Evidenz-Sammlungen, die f√ºr verschiedene Audits verwendet werden k√∂nnen\n‚Ä¢ Implementieren Sie einheitliche Risikobewertungs- und Kontroll-Frameworks, die multiple Compliance-Anforderungen abdecken\n‚Ä¢ Schaffen Sie zentrale Audit-Koordinationsstellen, die alle Pr√ºfungsaktivit√§ten √ºberwachen und steuern\n‚Ä¢ Etablieren Sie standardisierte Audit-Prozesse und -Dokumentation f√ºr Effizienzgewinne\n\nüë• Ressourcen-Management und Kapazit√§tsplanung:\n‚Ä¢ Entwickeln Sie flexible Audit-Teams mit breiten Kompetenzen, die f√ºr verschiedene Pr√ºfungsarten eingesetzt werden k√∂nnen\n‚Ä¢ Investieren Sie in Cross-Training, damit Mitarbeiter multiple Audit-Bereiche abdecken k√∂nnen\n‚Ä¢ Planen Sie Audit-Ressourcen strategisch √ºber das Jahr verteilt, um Spitzenbelastungen zu vermeiden\n‚Ä¢ Nutzen Sie externe Ressourcen gezielt f√ºr spezialisierte oder zeitlich begrenzte Audit-Anforderungen\n‚Ä¢ Implementieren Sie Workload-Management-Systeme zur optimalen Ressourcenverteilung\n\nüéØ Audit-Fatigue-Vermeidung:\n‚Ä¢ Kommunizieren Sie den Wert und Nutzen von Audits klar an alle Beteiligten\n‚Ä¢ Minimieren Sie redundante Informationsanfragen durch zentrale Datensammlung und -verwaltung\n‚Ä¢ Implementieren Sie effiziente Audit-Prozesse, die St√∂rungen des Tagesgesch√§fts minimieren\n‚Ä¢ Schaffen Sie klare Erwartungen und Zeitpl√§ne f√ºr alle Audit-Beteiligten\n‚Ä¢ Nutzen Sie Technologie zur Automatisierung routinem√§√üiger Audit-Aktivit√§ten\n\nüìä Synergien und Effizienzgewinne:\n‚Ä¢ Identifizieren Sie gemeinsame Kontrollziele zwischen verschiedenen regulatorischen Frameworks\n‚Ä¢ Nutzen Sie Audit-Erkenntnisse aus einem Bereich zur Verbesserung anderer Compliance-Bereiche\n‚Ä¢ Entwickeln Sie integrierte Reporting-Mechanismen, die multiple Stakeholder-Anforderungen erf√ºllen\n‚Ä¢ Schaffen Sie Lerneffekte zwischen verschiedenen Audit-Teams und -Bereichen\n‚Ä¢ Implementieren Sie kontinuierliche Verbesserungsprozesse basierend auf Audit-Erkenntnissen\n\nüîß Technologische Unterst√ºtzung:\n‚Ä¢ Nutzen Sie integrierte GRC-Plattformen, die multiple Compliance-Anforderungen in einer L√∂sung vereinen\n‚Ä¢ Implementieren Sie automatisierte Monitoring- und Reporting-Systeme f√ºr kontinuierliche Compliance-√úberwachung\n‚Ä¢ Entwickeln Sie Dashboards und Analytics-Tools f√ºr Real-Time-Einblicke in Compliance-Status\n‚Ä¢ Schaffen Sie zentrale Dokumenten-Repositories f√ºr effiziente Audit-Vorbereitung\n‚Ä¢ Nutzen Sie Workflow-Management-Systeme zur Koordination komplexer Audit-Prozesse"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Wie bewerte ich die Qualit√§t und Wirksamkeit meiner DORA-Audit-Prozesse?',
        answer: "Die kontinuierliche Bewertung und Verbesserung der Audit-Qualit√§t ist entscheidend f√ºr die langfristige Wirksamkeit des DORA-Compliance-Programms. Eine systematische Qualit√§tsbewertung gew√§hrleistet, dass Audits nicht nur regulatorische Anforderungen erf√ºllen, sondern auch echten Mehrwert f√ºr die Organisation schaffen.\n\nüìä Audit-Qualit√§ts-Metriken und KPIs:\n‚Ä¢ Entwickeln Sie umfassende Metriken zur Bewertung der Audit-Abdeckung, -Tiefe und -Vollst√§ndigkeit\n‚Ä¢ Messen Sie die Genauigkeit und Relevanz von Audit-Findings sowie deren Auswirkungen auf die Risikominderung\n‚Ä¢ Bewerten Sie die Effizienz von Audit-Prozessen durch Zeit- und Ressourcenverbrauch pro Audit-Bereich\n‚Ä¢ Analysieren Sie die Qualit√§t der Audit-Dokumentation und deren Nachvollziehbarkeit\n‚Ä¢ Verfolgen Sie die Implementierungsrate und -geschwindigkeit von Audit-Empfehlungen\n\nüéØ Wirksamkeits-Assessment-Methoden:\n‚Ä¢ F√ºhren Sie regelm√§√üige Post-Audit-Reviews durch, um die Genauigkeit und Relevanz der Audit-Ergebnisse zu bewerten\n‚Ä¢ Implementieren Sie Follow-up-Audits zur Validierung der Wirksamkeit implementierter Verbesserungsma√ünahmen\n‚Ä¢ Nutzen Sie Stakeholder-Feedback zur Bewertung der Audit-Qualit√§t aus verschiedenen Perspektiven\n‚Ä¢ Analysieren Sie die Korrelation zwischen Audit-Findings und tats√§chlichen Incidents oder Compliance-Verst√∂√üen\n‚Ä¢ Bewerten Sie die Vorhersagekraft Ihrer Audit-Ergebnisse f√ºr zuk√ºnftige Risiken\n\nüîç Kontinuierliche Qualit√§tsverbesserung:\n‚Ä¢ Etablieren Sie systematische Lessons-Learned-Prozesse nach jedem gr√∂√üeren Audit\n‚Ä¢ Implementieren Sie Peer-Reviews und Quality-Assurance-Checks f√ºr kritische Audit-Bereiche\n‚Ä¢ Nutzen Sie Benchmarking mit Branchenstandards und Best Practices zur Identifikation von Verbesserungspotenzialen\n‚Ä¢ Entwickeln Sie kontinuierliche Schulungs- und Entwicklungsprogramme f√ºr Audit-Teams\n‚Ä¢ Schaffen Sie Feedback-Schleifen zwischen Audit-Teams und gepr√ºften Bereichen\n\nüìà Audit-ROI und Wertsch√∂pfungs-Bewertung:\n‚Ä¢ Quantifizieren Sie den Wert von Audit-Aktivit√§ten durch Risikominderung und Compliance-Verbesserungen\n‚Ä¢ Bewerten Sie die Kosten-Nutzen-Relation verschiedener Audit-Ans√§tze und -Technologien\n‚Ä¢ Messen Sie die Auswirkungen von Audit-Empfehlungen auf operative Effizienz und Risikoprofil\n‚Ä¢ Analysieren Sie die Zeitersparnis und Effizienzgewinne durch verbesserte Audit-Prozesse\n‚Ä¢ Bewerten Sie die strategischen Beitr√§ge von Audits zur Organisationsentwicklung\n\nüîÑ Adaptive Audit-Methodologie:\n‚Ä¢ Entwickeln Sie flexible Audit-Ans√§tze, die sich an ver√§nderte Risikoprofile und regulatorische Anforderungen anpassen\n‚Ä¢ Implementieren Sie kontinuierliche Monitoring-Mechanismen zur fr√ºhzeitigen Identifikation von Qualit√§tsproblemen\n‚Ä¢ Nutzen Sie Datenanalytics zur Identifikation von Trends und Mustern in Audit-Ergebnissen\n‚Ä¢ Schaffen Sie Mechanismen zur schnellen Integration neuer Audit-Technologien und -Methoden\n‚Ä¢ Etablieren Sie regelm√§√üige Strategiereviews zur Anpassung der Audit-Philosophie und -Ziele\n\nüèÜ Best-Practice-Integration und Innovation:\n‚Ä¢ Verfolgen Sie aktiv Entwicklungen in der Audit-Profession und regulatorische Trends\n‚Ä¢ Partizipieren Sie in Branchenforen und Arbeitsgruppen zur Audit-Qualit√§t\n‚Ä¢ Experimentieren Sie mit neuen Audit-Technologien und -Ans√§tzen in kontrollierten Umgebungen\n‚Ä¢ Entwickeln Sie interne Innovation-Programme zur kontinuierlichen Audit-Verbesserung\n‚Ä¢ Schaffen Sie Partnerschaften mit Technologie-Anbietern und Beratungsunternehmen f√ºr Zugang zu neuesten Entwicklungen"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
