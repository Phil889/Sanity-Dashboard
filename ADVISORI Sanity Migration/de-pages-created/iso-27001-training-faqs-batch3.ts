import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating ISO 27001 Training page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iso-27001-training' })
    
    if (!existingDoc) {
      throw new Error('Document "iso-27001-training" not found')
    }
    
    // Create new FAQs for certification and advanced training
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'What are the pathways to ISO 27001 Lead Auditor certification and what does the certification process involve?',
        answer: "The ISO 27001 Lead Auditor certification represents the pinnacle of professional competency in information security management system auditing. ADVISORI provides comprehensive preparation and guidance through internationally recognized certification pathways that establish credibility and expertise in the global marketplace.\n\nüéì Certification Body Partnerships:\n‚Ä¢ Collaboration with internationally accredited certification bodies such as IRCA, PECB, and other recognized institutions\n‚Ä¢ Multiple certification pathway options to accommodate different professional backgrounds and career objectives\n‚Ä¢ Alignment with ISO 19011 auditing standards and best practices for management system auditing\n‚Ä¢ Recognition across global markets and acceptance by major certification and consulting organizations\n‚Ä¢ Continuing professional development requirements and recertification support\n\nüìö Comprehensive Preparation Program:\n‚Ä¢ Intensive five-day training program covering all aspects of ISO 27001 auditing principles and practices\n‚Ä¢ Detailed study of audit planning, execution, reporting, and follow-up processes\n‚Ä¢ Extensive practical exercises including mock audits, role-playing scenarios, and case study analysis\n‚Ä¢ Individual coaching and feedback sessions to address specific learning needs and competency gaps\n‚Ä¢ Pre-examination preparation including practice tests and review sessions\n\nüîç Practical Competency Development:\n‚Ä¢ Hands-on audit simulation exercises using real-world scenarios and documentation\n‚Ä¢ Development of audit programs, checklists, and sampling methodologies\n‚Ä¢ Practice in conducting opening meetings, interviews, document reviews, and closing meetings\n‚Ä¢ Training in nonconformity identification, classification, and reporting techniques\n‚Ä¢ Experience in audit team leadership, coordination, and conflict resolution\n\nüìù Examination and Assessment Process:\n‚Ä¢ Written examination covering theoretical knowledge of ISO 27001 requirements and audit principles\n‚Ä¢ Practical assessment demonstrating ability to plan, conduct, and report on audit activities\n‚Ä¢ Oral examination testing communication skills and professional judgment in audit situations\n‚Ä¢ Portfolio submission documenting relevant education, training, and professional experience\n‚Ä¢ Witness assessment during actual audit activities to validate practical competency\n\nüèÜ Professional Recognition and Career Benefits:\n‚Ä¢ International recognition enabling work as lead auditor for certification bodies worldwide\n‚Ä¢ Enhanced career opportunities in consulting, internal auditing, and compliance management\n‚Ä¢ Increased earning potential and professional credibility in information security field\n‚Ä¢ Access to exclusive professional networks and continuing education opportunities\n‚Ä¢ Foundation for advanced certifications and specializations in related areas\n\nüîÑ Ongoing Professional Development:\n‚Ä¢ Annual continuing professional development requirements to maintain certification status\n‚Ä¢ Access to advanced training programs and specialized workshops\n‚Ä¢ Participation in auditor calibration sessions and quality assurance programs\n‚Ä¢ Opportunities for mentoring new auditors and contributing to professional development\n‚Ä¢ Regular updates on standards changes and emerging audit techniques"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'How does ADVISORI prepare internal auditors to effectively evaluate and improve organizational ISMS performance?',
        answer: "ADVISORI's internal auditor development program focuses on building practical competencies that enable organizations to conduct effective self-assessments and drive continuous improvement in their information security management systems. Our approach emphasizes both technical audit skills and organizational change management capabilities.\n\nüéØ Strategic Internal Audit Approach:\n‚Ä¢ Development of risk-based audit programs that focus on areas of highest organizational impact and vulnerability\n‚Ä¢ Integration of internal audit activities with broader organizational governance and risk management processes\n‚Ä¢ Alignment of audit objectives with business goals and strategic information security objectives\n‚Ä¢ Creation of audit schedules that balance comprehensive coverage with operational efficiency\n‚Ä¢ Establishment of audit metrics and key performance indicators that demonstrate value to management\n\nüîß Practical Audit Methodology Training:\n‚Ä¢ Systematic approach to audit planning including scope definition, resource allocation, and timeline development\n‚Ä¢ Effective interviewing techniques that elicit honest feedback while maintaining positive stakeholder relationships\n‚Ä¢ Document review strategies that identify gaps between documented procedures and actual practices\n‚Ä¢ Observation techniques for assessing control effectiveness in operational environments\n‚Ä¢ Sampling methodologies that provide statistically valid conclusions while optimizing audit efficiency\n\nüìä Evidence Collection and Analysis:\n‚Ä¢ Training in various evidence types including documentary, testimonial, analytical, and physical evidence\n‚Ä¢ Techniques for corroborating findings through multiple evidence sources and validation methods\n‚Ä¢ Use of technology tools for evidence collection, analysis, and documentation\n‚Ä¢ Statistical sampling approaches for large populations and complex systems\n‚Ä¢ Root cause analysis techniques that identify underlying systemic issues rather than symptoms\n\nüí¨ Communication and Reporting Excellence:\n‚Ä¢ Development of clear, actionable audit findings that drive meaningful improvement\n‚Ä¢ Presentation skills for communicating audit results to different organizational levels and audiences\n‚Ä¢ Writing techniques for audit reports that balance technical accuracy with business relevance\n‚Ä¢ Facilitation skills for conducting effective opening and closing meetings\n‚Ä¢ Negotiation and conflict resolution techniques for addressing disagreements and resistance\n\nüîÑ Continuous Improvement Integration:\n‚Ä¢ Methods for tracking and following up on corrective action implementation\n‚Ä¢ Techniques for identifying trends and patterns across multiple audit cycles\n‚Ä¢ Integration of audit findings with organizational learning and knowledge management systems\n‚Ä¢ Development of recommendations that are practical, cost-effective, and aligned with organizational capabilities\n‚Ä¢ Collaboration with process owners to develop sustainable solutions rather than quick fixes\n\nüéì Professional Development and Recognition:\n‚Ä¢ Internal certification programs that recognize audit competency and professional growth\n‚Ä¢ Career pathway guidance for internal auditors seeking to advance their skills and responsibilities\n‚Ä¢ Cross-training opportunities in related disciplines such as risk management and business continuity\n‚Ä¢ Mentoring programs that pair experienced auditors with developing professionals\n‚Ä¢ Recognition programs that celebrate audit excellence and contribution to organizational improvement"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'What specialized training does ADVISORI offer for senior executives and board members on ISO 27001 governance responsibilities?',
        answer: "ADVISORI's executive leadership program addresses the unique responsibilities and challenges that senior leaders face in governing information security management systems. Our approach recognizes that effective ISMS governance requires both strategic vision and practical understanding of implementation realities.\n\nüèõÔ∏è Strategic Governance Framework:\n‚Ä¢ Board-level oversight responsibilities for information security risk management and compliance\n‚Ä¢ Integration of information security governance with broader enterprise risk management and corporate governance frameworks\n‚Ä¢ Establishment of appropriate governance structures including security committees and reporting relationships\n‚Ä¢ Development of information security policies and strategic direction that align with business objectives\n‚Ä¢ Oversight of information security investment decisions and resource allocation priorities\n\nüìà Business Value and Risk Management:\n‚Ä¢ Understanding the business case for ISO 27001 implementation and the return on investment calculation\n‚Ä¢ Risk appetite setting and tolerance levels for information security risks\n‚Ä¢ Integration of information security considerations into strategic business planning and decision-making\n‚Ä¢ Evaluation of information security performance metrics and key risk indicators\n‚Ä¢ Assessment of third-party risks and supply chain security considerations\n\n‚öñÔ∏è Legal and Regulatory Compliance:\n‚Ä¢ Director and officer liability considerations related to information security governance\n‚Ä¢ Regulatory compliance requirements and their impact on business operations\n‚Ä¢ Due diligence responsibilities for mergers, acquisitions, and partnership activities\n‚Ä¢ Crisis management and incident response governance during security events\n‚Ä¢ Stakeholder communication strategies during security incidents and compliance issues\n\nüéØ Leadership and Culture Development:\n‚Ä¢ Creating and sustaining a security-conscious organizational culture\n‚Ä¢ Leadership communication strategies that reinforce the importance of information security\n‚Ä¢ Change management approaches for implementing security initiatives across the organization\n‚Ä¢ Performance management and incentive alignment to support security objectives\n‚Ä¢ Building security awareness and competency throughout the organization\n\nüìä Performance Monitoring and Reporting:\n‚Ä¢ Development of executive dashboards and key performance indicators for information security\n‚Ä¢ Understanding of audit results and their implications for business operations\n‚Ä¢ Evaluation of security program effectiveness and continuous improvement opportunities\n‚Ä¢ Benchmarking against industry peers and best practices\n‚Ä¢ Integration of security metrics with broader business performance measurement systems\n\nüåê Strategic Technology and Innovation:\n‚Ä¢ Governance of emerging technologies and their security implications\n‚Ä¢ Digital transformation security considerations and risk management\n‚Ä¢ Cloud computing governance and shared responsibility models\n‚Ä¢ Artificial intelligence and machine learning security governance\n‚Ä¢ Internet of Things and operational technology security oversight\n\nüíº Practical Implementation Guidance:\n‚Ä¢ Resource planning and budgeting for information security initiatives\n‚Ä¢ Organizational structure and staffing considerations for security functions\n‚Ä¢ Vendor management and third-party security assessment processes\n‚Ä¢ Business continuity and disaster recovery planning oversight\n‚Ä¢ Insurance and risk transfer strategies for information security risks"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'How does ADVISORI address the technical training needs of IT professionals and security specialists in ISO 27001 implementation?',
        answer: "ADVISORI's technical specialist training programs are designed to bridge the gap between ISO 27001 management system requirements and practical technical implementation. Our approach ensures that IT professionals and security specialists can translate standard requirements into effective technical controls and operational procedures.\n\nüîß Technical Control Implementation:\n‚Ä¢ Detailed mapping of ISO 27001 Annex A controls to specific technical implementations and configurations\n‚Ä¢ Hands-on training in security control design, implementation, and testing methodologies\n‚Ä¢ Integration of security controls with existing IT infrastructure and operational processes\n‚Ä¢ Configuration management and change control processes for security-related systems\n‚Ä¢ Technical documentation requirements and best practices for control evidence\n\nüõ°Ô∏è Cybersecurity Framework Integration:\n‚Ä¢ Alignment of ISO 27001 requirements with cybersecurity frameworks such as NIST, CIS Controls, and MITRE ATT&CK\n‚Ä¢ Integration with existing security tools and technologies including SIEM, vulnerability management, and endpoint protection\n‚Ä¢ Threat modeling and risk assessment techniques specific to technical environments\n‚Ä¢ Security architecture design principles that support ISO 27001 compliance\n‚Ä¢ Incident response technical procedures and forensic investigation techniques\n\n‚òÅÔ∏è Cloud and Modern Technology Security:\n‚Ä¢ Cloud security implementation strategies for public, private, and hybrid cloud environments\n‚Ä¢ Container security and DevSecOps integration with ISO 27001 requirements\n‚Ä¢ API security and microservices architecture security considerations\n‚Ä¢ Identity and access management technical implementation and integration\n‚Ä¢ Data encryption and key management technical requirements and best practices\n\nüìä Monitoring and Measurement Technologies:\n‚Ä¢ Security monitoring and logging technical requirements for ISO 27001 compliance\n‚Ä¢ Implementation of security metrics collection and analysis systems\n‚Ä¢ Automated compliance monitoring and reporting tool configuration\n‚Ä¢ Security testing methodologies including penetration testing and vulnerability assessment\n‚Ä¢ Performance monitoring and capacity planning for security systems\n\nüîÑ Operational Technology and Industrial Security:\n‚Ä¢ Industrial control systems security and operational technology protection strategies\n‚Ä¢ Network segmentation and air-gapping techniques for critical systems\n‚Ä¢ Safety system integration with cybersecurity controls in industrial environments\n‚Ä¢ Remote access security for operational technology environments\n‚Ä¢ Supply chain security for industrial control system components\n\nüíª Software Development Security:\n‚Ä¢ Secure software development lifecycle integration with ISO 27001 requirements\n‚Ä¢ Code review and static analysis tool implementation and configuration\n‚Ä¢ Application security testing and dynamic analysis methodologies\n‚Ä¢ Software composition analysis and third-party component security management\n‚Ä¢ DevSecOps pipeline security and continuous integration security controls\n\nüåê Network and Infrastructure Security:\n‚Ä¢ Network architecture design principles that support information security objectives\n‚Ä¢ Firewall and intrusion prevention system configuration for ISO 27001 compliance\n‚Ä¢ Wireless network security implementation and monitoring\n‚Ä¢ Remote access and VPN security technical implementation\n‚Ä¢ Physical security integration with logical security controls and monitoring systems"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
