import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating MaRisk Dokumentationsanforderungen page with FAQs batch 5...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'marisk-dokumentationsanforderungen-prozess-kontrollbeschreibungen' })
    
    if (!existingDoc) {
      throw new Error('Document "marisk-dokumentationsanforderungen-prozess-kontrollbeschreibungen" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 17),
        question: "Wie kann die Prozess- und Kontrolldokumentation zur Verbesserung der operativen Effizienz genutzt werden und welchen Mehrwert bietet ADVISORI über die reine MaRisk-Compliance hinaus?",
        answer: "Eine hochwertige Prozess- und Kontrolldokumentation bietet weit mehr als nur regulatorische Compliance. Sie ist ein strategisches Asset, das zur Optimierung der Geschäftsprozesse, Reduktion von Ineffizienzen und kontinuierlichen Verbesserung genutzt werden kann. Ein durchdachter Dokumentationsansatz schafft erheblichen operativen Mehrwert über die reine MaRisk-Konformität hinaus.\n\n* Operative Mehrwerte einer exzellenten Prozessdokumentation:\n• Prozessoptimierung: Detaillierte Prozessdokumentation ermöglicht die systematische Identifikation von Ineffizienzen, Redundanzen und Verbesserungspotenzialen in den Geschäftsprozessen.\n• Wissensmanagement: Sicherung des organisatorischen Wissens über kritische Prozesse und deren Zusammenhänge, was besonders bei Personalwechseln oder in Vertretungssituationen wertvoll ist.\n• Organisatorische Flexibilität: Erleichterung organisatorischer Anpassungen durch klare Transparenz über Prozesszusammenhänge, Abhängigkeiten und Schnittstellen.\n• Einarbeitung und Schulung: Beschleunigung der Einarbeitung neuer Mitarbeiter und zielgerichtete Schulung durch klare und konsistente Prozessbeschreibungen.\n• Automatisierungspotenziale: Identifikation von Prozessschritten, die sich für Automatisierung oder Digitalisierung eignen, durch detaillierte Prozessanalyse.\n\n* Verknüpfung von Compliance und operativer Exzellenz:\n• Integrierte Prozesslandkarte: Entwicklung einer ganzheitlichen Prozesslandkarte, die sowohl regulatorische als auch operative Anforderungen berücksichtigt und Synergien erschließt.\n• Kontrolloptimierung: Überprüfung und Optimierung von Kontrollen nicht nur hinsichtlich ihrer regulatorischen Wirksamkeit, sondern auch ihrer operativen Effizienz und ihres Kosten-Nutzen-Verhältnisses.\n• Prozessredesign mit Doppelnutzen: Neugestaltung von Prozessen mit dem Ziel, gleichzeitig die regulatorische Konformität zu erhöhen und die operative Leistungsfähigkeit zu verbessern.\n• Lean Compliance: Anwendung von Lean-Management-Prinzipien auf Compliance-Prozesse zur Reduzierung von Komplexität und Verschwendung bei gleichzeitiger Sicherstellung der Regulierungskonformität.\n• Datengetriebene Prozesssteuerung: Nutzung der in der Dokumentation erfassten Prozessmetriken und KPIs für die kontinuierliche Überwachung und Verbesserung der Prozessleistung.\n\n* Methoden zur Erschließung operativer Potenziale aus der Dokumentation:\n• End-to-End-Prozessanalyse: Systematische Analyse der dokumentierten Prozesse von Anfang bis Ende zur Identifikation von Medienbrüchen, Engpässen und anderen Ineffizienzen.\n• Value Stream Mapping: Anwendung von Value-Stream-Mapping-Techniken auf die dokumentierten Prozesse zur Unterscheidung zwischen wertschöpfenden und nicht-wertschöpfenden Aktivitäten.\n• Schnittstellen-Optimierung: Gezieltes Redesign der Schnittstellen zwischen verschiedenen Prozessen oder Organisationseinheiten basierend auf der detaillierten Schnittstellendokumentation.\n• Root-Cause-Analyse: Nutzung der Prozessdokumentation als Grundlage für die systematische Ursachenanalyse bei wiederkehrenden Problemen oder Qualitätsmängeln.\n• Benchmarking: Vergleich dokumentierter Prozesse mit internen oder externen Best Practices zur Identifikation von Optimierungspotenzialen.\n\n* ADVISORI-Ansatz für operativen Mehrwert aus der Dokumentation:\n• Mehrwert-Assessment: Systematische Bewertung Ihrer Prozess- und Kontrolldokumentation hinsichtlich ihres operativen Mehrwerts und Identifikation konkreter Optimierungspotenziale.\n• Integrierte Prozessoptimierung: Kombination von regulatorischer Expertise und Prozessoptimierungs-Know-how für ein ganzheitliches Prozessredesign, das sowohl Compliance- als auch Effizienzanforderungen erfüllt.\n• Operative KPI-Integration: Anreicherung der Dokumentation mit operativen Leistungskennzahlen, die eine kontinuierliche Messung und Verbesserung der Prozesseffizienz ermöglichen.\n• Digitalisierungsroadmap: Ableitung konkreter Digitalisierungs- und Automatisierungspotenziale aus der detaillierten Prozessanalyse und Entwicklung einer priorisierten Umsetzungsroadmap.\n• Value-Added Compliance: Neugestaltung von Compliance-Prozessen und -Kontrollen nach dem Prinzip des 'Value-Added Compliance', bei dem regulatorische Anforderungen so erfüllt werden, dass sie gleichzeitig zum Geschäftserfolg beitragen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 18),
        question: "Wie sollten Prozess- und Kontrolldokumentationen für internationale Bankengruppen gestaltet werden, um sowohl lokale als auch gruppenweite MaRisk-Anforderungen zu erfüllen?",
        answer: "Internationale Bankengruppen stehen vor der komplexen Herausforderung, ihre Prozess- und Kontrolldokumentation so zu gestalten, dass sie sowohl den gruppenweiten Standards als auch den spezifischen regulatorischen Anforderungen in den einzelnen Ländern gerecht wird. Dies erfordert einen sorgfältig austarierten Ansatz, der Standardisierung und lokale Anpassung in ein optimales Gleichgewicht bringt.\n\n* Spezifische Herausforderungen für internationale Bankengruppen:\n• Regulatorische Diversität: Unterschiedliche und teilweise widersprüchliche regulatorische Anforderungen in verschiedenen Jurisdiktionen (MaRisk in Deutschland, CRD/CRR und nationale Umsetzungen in der EU, spezifische lokale Anforderungen).\n• Organisatorische Komplexität: Vielfältige Organisations- und Governance-Strukturen über Länder- und Rechtsgrenzen hinweg, die in der Dokumentation abgebildet werden müssen.\n• Sprachbarrieren: Notwendigkeit mehrsprachiger Dokumentationen oder Übersetzungen für lokale Aufsichtsbehörden und Mitarbeiter.\n• IT-Systemlandschaft: Heterogene IT-Landschaften mit lokalen Systemen und übergreifenden Plattformen, die in der Prozess- und Kontrolldokumentation berücksichtigt werden müssen.\n• Unterschiedliche Reifegrade: Variierende Reifegrade des Risikomanagements und der Dokumentationsqualität in verschiedenen Ländern und Geschäftseinheiten.\n\n* Strategische Ansätze für eine integrierte Gruppendokumentation:\n• Multi-Layer-Dokumentationsmodell: Entwicklung eines mehrstufigen Dokumentationsmodells mit gruppenweiten Standards als Basis und länderspezifischen Erweiterungen für lokale regulatorische Anforderungen.\n• Modularer Aufbau: Gestaltung der Dokumentation in modularer Form, sodass Teile wiederverwendet und andere länderspezifisch angepasst werden können, ohne die Gesamtstruktur zu beeinträchtigen.\n• Zentrales Governance-Framework: Etablierung eines übergreifenden Governance-Frameworks für die Dokumentation mit klaren Zuständigkeiten und Prozessen für die Abstimmung zwischen Gruppe und lokalen Einheiten.\n• Regulatorisches Mapping: Systematische Zuordnung der Dokumentationselemente zu den verschiedenen regulatorischen Anforderungen (MaRisk, CRD/CRR, lokale Vorschriften) zur Sicherstellung der Compliance in allen relevanten Jurisdiktionen.\n• Skalierbarkeit und Proportionalität: Anwendung des Proportionalitätsprinzips bei der Detailtiefe und Komplexität der Dokumentation, angepasst an die Größe und Bedeutung der lokalen Einheiten.\n\n* Operative Umsetzungsaspekte für internationale Dokumentation:\n• Dokumentationshierarchie: Klare Hierarchie von Dokumenten mit Gruppen-Policies an der Spitze, gefolgt von lokalen Policies, Prozessbeschreibungen und Arbeitsanweisungen mit definierten Abhängigkeiten und Verweisen.\n• Mehrsprachigkeit: Strategie für die Handhabung von Mehrsprachigkeit, z.B. durch zweisprachige Dokumentation, offizielle Übersetzungen oder Sprachversionen mit Versionskontrolle.\n• Zentrale Dokumentationsplattform: Implementierung einer gruppenweiten Dokumentationsplattform mit dezentralen Zugriffsrechten und Bearbeitungsmöglichkeiten für lokale Einheiten.\n• Regelmäßiger Abgleich: Etablierung eines strukturierten Prozesses für den regelmäßigen Abgleich zwischen Gruppenvorgaben und lokalen Anpassungen, insbesondere bei regulatorischen Änderungen.\n• Kulturelle Sensibilität: Berücksichtigung kultureller Unterschiede in der Dokumentationsgestaltung und -kommunikation, um die Akzeptanz und Anwendung in allen Ländern zu fördern.\n\n* ADVISORI-Ansatz für internationale Dokumentationskonzepte:\n• Global-Local Assessment: Systematische Analyse der regulatorischen Anforderungen in allen relevanten Jurisdiktionen und Identifikation von Gemeinsamkeiten und spezifischen lokalen Anforderungen.\n• Template-basierter Ansatz: Entwicklung standardisierter Dokumentationsvorlagen mit klar definierten Bereichen für gruppenweite Standards und lokale Anpassungen.\n• Regulatory Heatmap: Erstellung einer Heatmap, die aufzeigt, welche Dokumentationsbereiche besonders stark von lokalen regulatorischen Unterschieden betroffen sind und daher besondere Aufmerksamkeit erfordern.\n• Internationales Schnittstellenkonzept: Detaillierte Dokumentation der Schnittstellen zwischen Prozessen und Kontrollen über Ländergrenzen hinweg, insbesondere bei grenzüberschreitenden Dienstleistungen und Auslagerungen.\n• Global Governance Office: Unterstützung bei der Einrichtung einer zentralen Koordinationsfunktion für das internationale Dokumentationsmanagement mit klaren Prozessen für die Abstimmung zwischen Gruppe und lokalen Einheiten."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 19),
        question: "Inwiefern unterstützt ADVISORI bei der Integration von KI und fortschrittlichen Analysetechniken in die Erstellung und Nutzung von MaRisk-konformer Dokumentation?",
        answer: "Künstliche Intelligenz (KI) und fortschrittliche Analysetechniken bieten erhebliche Potenziale zur Effizienzsteigerung und Qualitätsverbesserung in der Prozess- und Kontrolldokumentation. Von der automatisierten Erstellung über intelligente Qualitätsprüfungen bis hin zur dynamischen Analyse von Kontrolleffektivität – die Anwendungsmöglichkeiten sind vielfältig, müssen jedoch im MaRisk-Kontext sorgfältig gestaltet werden.\n\n* Innovative Anwendungsfelder für KI in der Dokumentation:\n• Automatisierte Dokumentationserstellung: Einsatz von Natural Language Processing (NLP) zur Generierung von Dokumentationsentwürfen basierend auf Prozessdaten, Interviews oder bestehenden Dokumenten.\n• Intelligente Dokumentationsanalyse: Nutzung von KI zur Analyse bestehender Dokumentation hinsichtlich Qualität, Vollständigkeit, Konsistenz und Compliance mit regulatorischen Anforderungen.\n• Dynamische Risikobewertung: Einsatz von Machine Learning zur kontinuierlichen Analyse von Prozessdaten und automatischen Aktualisierung von Risikobewertungen in der Dokumentation.\n• Semantische Verknüpfungen: Anwendung von Knowledge-Graph-Technologien zur intelligenten Verknüpfung verschiedener Dokumentationselemente und Visualisierung komplexer Zusammenhänge.\n• Predictive Compliance: Vorhersage potenzieller Compliance-Risiken durch KI-basierte Analyse von Prozessmustern, Kontrollschwächen und regulatorischen Änderungen.\n\n* MaRisk-konforme Integration von KI-Technologien:\n• Governance-Framework für KI: Entwicklung eines spezifischen Governance-Rahmens für den Einsatz von KI in der Dokumentation, der die MaRisk-Anforderungen an nachvollziehbare Prozesse und Kontrollen erfüllt.\n• Mensch-im-Kreis-Prinzip: Sicherstellung, dass KI-gestützte Dokumentationsprozesse dem Mensch-im-Kreis-Prinzip folgen, bei dem die finale Verantwortung und Entscheidungskompetenz bei menschlichen Experten verbleibt.\n• Transparenz und Erklärbarkeit: Gestaltung von KI-Systemen für die Dokumentation mit Fokus auf Transparenz und Erklärbarkeit der Ergebnisse, um die aufsichtliche Akzeptanz zu gewährleisten.\n• Qualitätssicherung: Implementierung systematischer Qualitätssicherungsprozesse für KI-generierte Dokumentationselemente, einschließlich regelmäßiger Stichproben und Validierungen.\n• Auditierbarkeit: Integration von Audit-Trails in KI-Systeme, die nachvollziehbar dokumentieren, welche Dokumentationselemente durch KI erstellt oder modifiziert wurden.\n\n* Fortgeschrittene Analysetechniken für die Dokumentationsnutzung:\n• Process Mining: Anwendung von Process-Mining-Techniken zur Analyse tatsächlicher Prozessabläufe und deren Vergleich mit der dokumentierten Soll-Prozessdefinition zur Identifikation von Abweichungen.\n• Social Network Analysis: Nutzung von Netzwerkanalysen zur Identifikation kritischer Abhängigkeiten und Schlüsselpersonen in dokumentierten Prozessen und Kontrollstrukturen.\n• Natural Language Processing: Einsatz von NLP zur automatisierten Analyse und Kategorisierung umfangreicher Textdokumentation und zur Extraktion relevanter Informationen.\n• Sentiment Analysis: Anwendung von Sentiment-Analysen auf Prozessdokumentation und Feedback, um subjektive Bewertungen und potenzielle Problembereiche zu identifizieren.\n• Visual Analytics: Nutzung fortschrittlicher Visualisierungstechniken zur intuitiven Darstellung komplexer Prozess- und Kontrollzusammenhänge für verschiedene Zielgruppen.\n\n* ADVISORI-Ansatz für KI-gestützte Dokumentation:\n• KI-Readiness-Assessment: Bewertung der Bereitschaft Ihrer Organisation für den Einsatz von KI in der Dokumentation und Identifikation von Quick Wins und langfristigen Potenzialen.\n• Use-Case-Priorisierung: Systematische Identifikation und Priorisierung von KI-Anwendungsfällen für die Dokumentation basierend auf Aufwand, Nutzen und regulatorischer Akzeptanz.\n• Proof-of-Concept: Durchführung gezielter Pilotprojekte für ausgewählte KI-Anwendungsfälle in der Dokumentation, um Machbarkeit, Nutzen und Compliance-Konformität zu validieren.\n• KI-Governance-Framework: Entwicklung eines spezifischen Governance-Rahmens für den Einsatz von KI in der Dokumentation, der MaRisk-Anforderungen mit Innovationspotenzialen in Einklang bringt.\n• Change Management: Begleitung des organisatorischen Wandels bei der Einführung von KI-gestützten Dokumentationsprozessen, einschließlich Schulung, Kommunikation und Stakeholder-Management."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 20),
        question: "Wie sollte eine Prozess- und Kontrolldokumentation gestaltet sein, um für künftige regulatorische Anforderungen vorbereitet zu sein, und wie unterstützt ADVISORI bei diesem Zukunftsmanagement?",
        answer: "In einem Umfeld sich kontinuierlich weiterentwickelnder regulatorischer Anforderungen ist es entscheidend, eine zukunftsfähige Prozess- und Kontrolldokumentation zu gestalten, die nicht nur aktuelle MaRisk-Vorgaben erfüllt, sondern auch flexibel genug ist, um künftige Entwicklungen effizient zu integrieren. Eine vorausschauende Dokumentationsstrategie reduziert signifikant den Anpassungsaufwand und stärkt die langfristige Compliance-Fähigkeit des Instituts.\n\n* Erkennbare Trends in der regulatorischen Entwicklung:\n• Zunehmende Granularität: Trend zu immer detaillierteren und spezifischeren Dokumentationsanforderungen für Prozesse, Kontrollen und Risiken.\n• Stärkere Technologieorientierung: Wachsende regulatorische Fokussierung auf IT-Prozesse, automatisierte Kontrollen und digitale Risiken (z.B. in der BAIT).\n• Erhöhte Nachweisanforderungen: Verstärkte Anforderungen an die Nachweisführung für die tatsächliche Durchführung und Wirksamkeit von Kontrollen.\n• ESG-Integration: Zunehmende Bedeutung von Nachhaltigkeitsaspekten in der Prozess- und Kontrolldokumentation, insbesondere im Hinblick auf Klimarisiken.\n• Datengetriebene Aufsicht: Trend zu einer stärker datengetriebenen Aufsicht mit direkten Datenanforderungen statt traditioneller Dokumentenprüfung.\n\n* Designprinzipien für eine zukunftsfähige Dokumentation:\n• Modulare Struktur: Aufbau der Dokumentation in modularer Form, sodass einzelne Komponenten angepasst oder erweitert werden können, ohne das Gesamtsystem zu beeinträchtigen.\n• Erweiterbare Taxonomie: Entwicklung einer flexiblen Taxonomie für Prozesse, Risiken und Kontrollen, die um neue Kategorien erweitert werden kann, wenn regulatorische Anforderungen dies erfordern.\n• Metamodell-basierter Ansatz: Implementierung eines Metamodell-Ansatzes, der die Grundstruktur der Dokumentation definiert und gleichzeitig Flexibilität für künftige Anpassungen bietet.\n• Integrierte Compliance-Landkarte: Entwicklung einer Compliance-Landkarte, die die Verbindungen zwischen Prozessen, Kontrollen und verschiedenen regulatorischen Anforderungen transparent darstellt und leicht aktualisiert werden kann.\n• Versionierung und Historisierung: Etablierung eines robusten Versionierungssystems, das die Nachvollziehbarkeit von Änderungen über die Zeit sicherstellt und die Rekonstruktion früherer Zustände ermöglicht.\n\n* Technologische Enabler für zukunftssichere Dokumentation:\n• API-basierte Dokumentationsplattformen: Nutzung von Plattformen mit offenen APIs, die die Integration neuer Module, Datenquellen und Regulatorik-Updates erleichtern.\n• Metadata-Management: Implementierung eines umfassenden Metadata-Managements, das die Klassifikation, Suche und Analyse von Dokumentationselementen nach verschiedenen Dimensionen ermöglicht.\n• Regelbasierte Automatisierung: Einsatz regelbasierter Systeme, die bei regulatorischen Änderungen automatisch betroffene Dokumentationsbereiche identifizieren und Anpassungsvorschläge generieren.\n• Kollaborative Tools: Nutzung kollaborativer Plattformen, die eine effiziente Zusammenarbeit verschiedener Stakeholder bei der Anpassung der Dokumentation an neue Anforderungen ermöglichen.\n• Analytische Dashboards: Implementierung von Dashboards, die kontinuierlich den Compliance-Status der Dokumentation überwachen und frühzeitig auf Anpassungsbedarf hinweisen.\n\n* ADVISORI-Ansatz für zukunftssichere Dokumentation:\n• Regulatory Horizon Scanning: Systematische Beobachtung und Analyse regulatorischer Entwicklungen und frühzeitige Identifikation potenzieller Auswirkungen auf die Dokumentationsanforderungen.\n• Future-Proof Assessment: Bewertung Ihrer bestehenden Dokumentationslandschaft hinsichtlich ihrer Zukunftsfähigkeit und Identifikation von Bereichen mit besonderem Anpassungsbedarf.\n• Szenario-basierte Planung: Entwicklung verschiedener Szenarien für die regulatorische Entwicklung und Ableitung flexibler Dokumentationsstrategien, die auf unterschiedliche Entwicklungen vorbereitet sind.\n• Dokumentations-Roadmap: Erstellung einer mehrjährigen Roadmap für die Evolution Ihrer Dokumentationslandschaft, die sowohl geplante Optimierungen als auch Puffer für unerwartete regulatorische Änderungen berücksichtigt.\n• Regulatory Change Management: Etablierung eines strukturierten Prozesses zur kontinuierlichen Identifikation, Bewertung und Umsetzung regulatorischer Änderungen in der Dokumentationslandschaft."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('✅ FAQs batch 5 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
