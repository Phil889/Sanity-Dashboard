import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Windows PKI page with FAQ batch 4...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'windows-pki' })
    
    if (!existingDoc) {
      throw new Error('Document "windows-pki" not found')
    }
    
    // Create new FAQs for hybrid cloud integration and modern security features
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 13),
        question: 'Wie erm√∂glicht Azure Active Directory-Integration strategische Hybrid PKI-Transformation f√ºr moderne Enterprise-Architekturen?',
        answer: "Azure Active Directory-Integration f√ºr Hybrid PKI revolutioniert traditionelle On-Premises Certificate-Management durch strategisch orchestrierte Cloud-native Identit√§tssysteme, die nicht nur operative Skalierung gew√§hrleisten, sondern auch als kritisches Fundament f√ºr moderne Zero Trust-Architekturen, Hybrid Work-Szenarien und compliance-konforme Digital-Transformation fungieren.\n\nüåê Hybrid Identity und Certificate-based Authentication:\n‚Ä¢ Azure AD-Integration erm√∂glicht nahtlose Certificate-basierte Authentifizierung zwischen On-Premises Windows PKI und Cloud-Services\n‚Ä¢ Conditional Access-Policies nutzen Certificate-Attribute f√ºr granulare Zugriffskontrolle basierend auf Device Trust und User Risk\n‚Ä¢ Azure AD Certificate-based Authentication eliminiert Password-Abh√§ngigkeiten f√ºr kritische Cloud-Applications\n‚Ä¢ Multi-Factor Authentication-Integration kombiniert Certificate-Possession mit biometrischen Faktoren f√ºr Enhanced Security\n‚Ä¢ Single Sign-On-Erfahrungen erstrecken sich √ºber Hybrid Cloud-Umgebungen mit einheitlicher Certificate-Governance\n\nüîê Azure AD Connect und Certificate Synchronization:\n‚Ä¢ Azure AD Connect-Integration synchronisiert Certificate-Attribute und Trust-Relationships zwischen On-Premises und Cloud-Identit√§ten\n‚Ä¢ Certificate Template-Mapping gew√§hrleistet konsistente Certificate-Policies √ºber Hybrid Identity-Infrastrukturen\n‚Ä¢ Automated Certificate Provisioning f√ºr Azure AD-joined Devices nutzt Windows Autopilot-Integration\n‚Ä¢ Certificate Lifecycle-Synchronization koordiniert Certificate-Renewal zwischen On-Premises CA und Azure AD\n‚Ä¢ Hybrid Certificate Store-Management erm√∂glicht einheitliche Certificate-Verwaltung √ºber Cloud und On-Premises\n\n‚ö° Microsoft 365 und Office 365-Integration:\n‚Ä¢ Exchange Online-Integration erm√∂glicht S/MIME-Certificate-Management f√ºr Cloud-basierte E-Mail-Sicherheit\n‚Ä¢ SharePoint Online Certificate-based Authentication gew√§hrleistet sichere Document-Collaboration in Hybrid-Szenarien\n‚Ä¢ Teams-Integration unterst√ºtzt Certificate-basierte Meeting-Security und Compliance-Recording\n‚Ä¢ OneDrive for Business-Integration erm√∂glicht Certificate-basierte File-Encryption f√ºr Cloud-Storage\n‚Ä¢ Power Platform-Integration nutzt Certificate-based Authentication f√ºr Custom Business Applications\n\nüõ°Ô∏è Azure Information Protection und Rights Management:\n‚Ä¢ Azure Rights Management Service-Integration nutzt Windows PKI-Certificates f√ºr Document Protection\n‚Ä¢ Microsoft Purview-Integration erm√∂glicht Certificate-basierte Data Loss Prevention und Compliance-Monitoring\n‚Ä¢ Azure Information Protection-Labels nutzen Certificate-Attribute f√ºr automatische Data Classification\n‚Ä¢ Sensitivity Labels-Integration gew√§hrleistet Certificate-basierte Access Control f√ºr vertrauliche Dokumente\n‚Ä¢ Compliance Center-Integration dokumentiert Certificate-Usage f√ºr regulatorische Audit-Trails\n\nüìä Azure Security Center und Sentinel-Integration:\n‚Ä¢ Azure Security Center-Integration √ºberwacht Certificate-Health und identifiziert Sicherheitsrisiken in Hybrid-Umgebungen\n‚Ä¢ Microsoft Sentinel-Integration erm√∂glicht AI-powered Threat Detection basierend auf Certificate-Usage-Patterns\n‚Ä¢ Azure Monitor-Integration dokumentiert Certificate-Events und Performance-Metriken f√ºr Hybrid PKI-Infrastrukturen\n‚Ä¢ Log Analytics-Integration korreliert Certificate-Events mit Security-Incidents f√ºr Enhanced Threat Intelligence\n‚Ä¢ Security Score-Integration bewertet Certificate-Management-Practices und identifiziert Verbesserungspotenziale\n\nüöÄ Modern Authentication und Future-Ready Integration:\n‚Ä¢ Windows Hello for Business-Integration nutzt Azure AD-backed Certificate-Enrollment f√ºr biometrische Authentifizierung\n‚Ä¢ FIDO2-Integration erm√∂glicht passwordless Authentication mit Certificate-backed Security Keys\n‚Ä¢ Azure AD Privileged Identity Management nutzt Certificate-based Authentication f√ºr Administrative Access\n‚Ä¢ Azure AD Identity Protection-Integration nutzt Certificate-Anomalies f√ºr Risk-based Access Decisions\n‚Ä¢ Microsoft Graph API-Integration erm√∂glicht programmatische Certificate-Management f√ºr moderne Applications"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 14),
        question: 'Welche strategischen Vorteile bietet Windows Hello for Business-Integration f√ºr moderne PKI-basierte Authentifizierung?',
        answer: "Windows Hello for Business-Integration transformiert traditionelle Certificate-basierte Authentifizierung durch biometrische, hardware-backed Security-Systeme, die nicht nur User Experience revolutionieren, sondern auch als strategisches Fundament f√ºr passwordless Enterprise-Transformation, Zero Trust-Architekturen und moderne Workplace-Security fungieren.\n\nüîê Biometric Certificate-based Authentication und Hardware Security:\n‚Ä¢ Windows Hello for Business nutzt TPM-backed Certificate-Storage f√ºr biometrische Authentifizierung mit h√∂chster Sicherheitsstufe\n‚Ä¢ Hardware Security Module-Integration gew√§hrleistet, dass Private Keys niemals das sichere Hardware-Environment verlassen\n‚Ä¢ Biometric Template-Protection verhindert Fingerprint- oder Facial Recognition-Data-Extraction durch Malware\n‚Ä¢ Anti-Spoofing-Technologien sch√ºtzen vor Presentation Attacks mit Fotos oder gef√§lschten biometrischen Daten\n‚Ä¢ Secure Boot-Integration gew√§hrleistet Integrity der biometrischen Authentication-Pipeline von Hardware bis Application\n\n‚ö° PKI-Integration und Certificate Lifecycle-Management:\n‚Ä¢ Automated Certificate Enrollment nutzt Windows Hello-Gestures f√ºr User-friendly Certificate-Provisioning\n‚Ä¢ Certificate-based Single Sign-On eliminiert Password-Eingaben f√ºr alle Windows-integrated Applications\n‚Ä¢ Smart Card-Emulation erm√∂glicht Backward-Compatibility mit Legacy-Applications, die Certificate-based Authentication erwarten\n‚Ä¢ Certificate Renewal-Integration nutzt biometrische Authentifizierung f√ºr nahtlose Certificate-Updates\n‚Ä¢ Multi-Certificate-Support erm√∂glicht verschiedene Certificate-Types f√ºr unterschiedliche Security-Contexts\n\nüåê Enterprise-Integration und Hybrid Cloud-Support:\n‚Ä¢ Azure Active Directory-Integration erm√∂glicht Cloud-native Certificate-Management mit On-Premises PKI-Backing\n‚Ä¢ Group Policy-Integration automatisiert Windows Hello for Business-Deployment √ºber Enterprise-Umgebungen\n‚Ä¢ Microsoft Intune-Integration unterst√ºtzt Mobile Device Management mit Certificate-based Device Authentication\n‚Ä¢ Conditional Access-Integration nutzt biometrische Authentication-Strength f√ºr Risk-based Access Decisions\n‚Ä¢ Hybrid Certificate Authority-Support gew√§hrleistet einheitliche Certificate-Policies √ºber Cloud und On-Premises\n\nüì± Modern Device-Support und Cross-Platform-Integration:\n‚Ä¢ Windows 10/11-native Integration gew√§hrleistet optimale Performance und Security f√ºr moderne Enterprise-Devices\n‚Ä¢ Surface-Device-Optimization nutzt specialized Hardware-Features f√ºr Enhanced Biometric Authentication\n‚Ä¢ HoloLens-Integration erm√∂glicht biometrische Authentication f√ºr Mixed Reality-Enterprise-Applications\n‚Ä¢ Xbox-Integration unterst√ºtzt Consumer-to-Enterprise-Scenarios mit einheitlicher Certificate-based Authentication\n‚Ä¢ IoT Device-Integration erm√∂glicht Certificate-based Authentication f√ºr Windows IoT-Deployments\n\nüõ°Ô∏è Advanced Security Features und Threat Protection:\n‚Ä¢ Windows Defender Application Guard-Integration isoliert Certificate-Operations von potentiell kompromittierten Applications\n‚Ä¢ Windows Defender Credential Guard sch√ºtzt Certificate-derived Credentials vor Advanced Persistent Threats\n‚Ä¢ Device Guard-Integration gew√§hrleistet Code Integrity f√ºr alle Certificate-related Processes\n‚Ä¢ Microsoft Defender for Endpoint-Integration √ºberwacht Certificate-Usage f√ºr Anomaly Detection\n‚Ä¢ Azure Advanced Threat Protection nutzt Certificate-Events f√ºr Behavioral Analytics und Threat Hunting\n\nüíº Business Value und User Experience-Transformation:\n‚Ä¢ Drastische Reduktion von Password-related Help Desk-Tickets durch Elimination von Password-Dependencies\n‚Ä¢ Verbesserte User Productivity durch nahtlose, gesture-based Authentication-Erfahrungen\n‚Ä¢ Enhanced Security Posture durch Elimination von Password-based Attack Vectors\n‚Ä¢ Compliance-Vorteile durch Hardware-backed Authentication-Audit-Trails\n‚Ä¢ Future-Ready Investment in passwordless Authentication-Technologien f√ºr strategische IT-Modernisierung"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 15),
        question: 'Wie optimiert Windows Container-Integration PKI-Services f√ºr moderne Cloud-native Architekturen?',
        answer: "Windows Container-Integration f√ºr PKI-Services revolutioniert traditionelle Certificate-Management-Ans√§tze durch cloud-native, orchestrierte Systeme, die nicht nur operative Agilit√§t gew√§hrleisten, sondern auch als strategisches Fundament f√ºr Microservices-Architekturen, DevOps-Transformation und moderne Enterprise-Skalierung fungieren.\n\nüê≥ Container-native PKI-Architecture und Orchestration:\n‚Ä¢ Windows Server Container-Integration erm√∂glicht isolierte Certificate Authority-Services mit minimaler Resource-Overhead\n‚Ä¢ Docker-Integration unterst√ºtzt containerisierte PKI-Deployments mit Infrastructure as Code-Ans√§tzen\n‚Ä¢ Kubernetes-Integration erm√∂glicht orchestrierte PKI-Services mit automatischer Scaling und High Availability\n‚Ä¢ Helm Chart-Integration vereinfacht PKI-Deployment und Configuration-Management in Kubernetes-Umgebungen\n‚Ä¢ Service Mesh-Integration gew√§hrleistet Certificate-based Service-to-Service-Communication in Microservices-Architekturen\n\n‚ö° Dynamic Certificate Provisioning und Lifecycle-Management:\n‚Ä¢ Init Container-Integration erm√∂glicht automatische Certificate-Provisioning w√§hrend Container-Startup\n‚Ä¢ Sidecar Pattern-Implementation gew√§hrleistet Certificate-Management ohne Application-Code-√Ñnderungen\n‚Ä¢ Certificate Rotation-Automation koordiniert Certificate-Updates mit Container-Restart-Zyklen\n‚Ä¢ Secret Management-Integration nutzt Kubernetes Secrets f√ºr sichere Certificate-Storage und -Distribution\n‚Ä¢ ConfigMap-Integration erm√∂glicht dynamische Certificate-Configuration ohne Container-Rebuilds\n\nüîê Security und Isolation in Container-Umgebungen:\n‚Ä¢ Windows Process Isolation gew√§hrleistet sichere Trennung von PKI-Services zwischen verschiedenen Container-Workloads\n‚Ä¢ Hyper-V Container-Integration bietet Enhanced Security durch Hardware-level Isolation f√ºr kritische PKI-Operations\n‚Ä¢ Container Image Signing nutzt PKI-Certificates f√ºr Supply Chain Security und Image Integrity-Validation\n‚Ä¢ Runtime Security-Integration √ºberwacht Certificate-Usage in Container-Umgebungen f√ºr Anomaly Detection\n‚Ä¢ Network Policy-Integration gew√§hrleistet Certificate-based Network Segmentation zwischen Container-Services\n\nüìä DevOps-Integration und CI/CD-Pipeline-Support:\n‚Ä¢ Azure DevOps Pipeline-Integration automatisiert Certificate-Management in Container-Deployment-Workflows\n‚Ä¢ GitOps-Integration erm√∂glicht declarative Certificate-Configuration mit Git-based Change Management\n‚Ä¢ Continuous Security-Integration validiert Certificate-Configuration und -Compliance in CI/CD-Pipelines\n‚Ä¢ Infrastructure as Code-Integration nutzt Terraform und ARM Templates f√ºr PKI-Container-Deployment\n‚Ä¢ Monitoring und Observability-Integration dokumentiert Certificate-Lifecycle-Events in Container-Umgebungen\n\nüåê Multi-Cloud und Hybrid-Integration:\n‚Ä¢ Azure Container Instances-Integration erm√∂glicht serverless PKI-Services mit automatischer Scaling\n‚Ä¢ Azure Kubernetes Service-Integration gew√§hrleistet managed PKI-Services mit Enterprise-grade Security\n‚Ä¢ AWS EKS und Google GKE-Integration unterst√ºtzt Multi-Cloud PKI-Deployment-Strategien\n‚Ä¢ Hybrid Cloud-Integration erm√∂glicht einheitliche Certificate-Policies √ºber verschiedene Container-Plattformen\n‚Ä¢ Edge Computing-Integration unterst√ºtzt PKI-Services in IoT und Edge-Container-Deployments\n\nüöÄ Performance-Optimierung und Scalability:\n‚Ä¢ Horizontal Pod Autoscaling nutzt Certificate-Request-Metriken f√ºr dynamische PKI-Service-Skalierung\n‚Ä¢ Resource Optimization-Techniken minimieren Memory und CPU-Footprint f√ºr PKI-Container-Services\n‚Ä¢ Caching-Strategien optimieren Certificate-Retrieval-Performance in High-Throughput-Container-Umgebungen\n‚Ä¢ Load Balancing-Integration gew√§hrleistet optimale Certificate-Request-Verteilung √ºber PKI-Container-Replicas\n‚Ä¢ Performance Monitoring identifiziert Bottlenecks und Optimierungspotenziale in containerisierten PKI-Services"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 16),
        question: 'Welche Rolle spielt Windows Defender Integration in modernem PKI-Security-Management und Threat Protection?',
        answer: "Windows Defender Integration f√ºr PKI-Security-Management etabliert strategische Threat Protection-Systeme, die nicht nur Certificate-based Attacks abwehren, sondern auch als kritisches Fundament f√ºr Advanced Threat Detection, Zero Trust-Validation und moderne Enterprise-Security-Transformation fungieren.\n\nüõ°Ô∏è Advanced Threat Protection und Certificate-based Attack Prevention:\n‚Ä¢ Windows Defender Advanced Threat Protection √ºberwacht Certificate-Usage-Patterns f√ºr Anomaly Detection und Behavioral Analytics\n‚Ä¢ Certificate-based Lateral Movement Detection identifiziert Angreifer, die kompromittierte Certificates f√ºr Network-Traversal nutzen\n‚Ä¢ Machine Learning-basierte Certificate Abuse Detection erkennt ungew√∂hnliche Certificate-Request-Patterns und potenzielle Insider-Bedrohungen\n‚Ä¢ Real-time Certificate Validation-Monitoring identifiziert Man-in-the-Middle-Attacks und Certificate Spoofing-Versuche\n‚Ä¢ Automated Incident Response-Integration erm√∂glicht sofortige Certificate-Revocation bei Compromise-Detection\n\nüîç Certificate Store Protection und Integrity Monitoring:\n‚Ä¢ Windows Defender Application Guard isoliert Certificate-Operations von potentiell kompromittierten Applications\n‚Ä¢ Certificate Store Integrity-Monitoring erkennt unauthorized Certificate-Installations und Tampering-Versuche\n‚Ä¢ Credential Guard-Integration sch√ºtzt Certificate-derived Authentication-Tokens vor Memory-based Attacks\n‚Ä¢ Code Integrity-Enforcement gew√§hrleistet, dass nur signierte, vertrauensw√ºrdige Software auf Certificate Stores zugreifen kann\n‚Ä¢ Hardware Security Module-Integration nutzt TPM-backed Protection f√ºr kritische Certificate-Operations\n\n‚ö° Cloud-native Security und Microsoft 365 Defender-Integration:\n‚Ä¢ Microsoft 365 Defender-Integration korreliert Certificate-Events mit E-Mail-, Identity- und Endpoint-Security-Telemetry\n‚Ä¢ Azure Sentinel-Integration erm√∂glicht AI-powered Certificate-Security-Analytics mit Cross-Platform-Threat-Intelligence\n‚Ä¢ Microsoft Cloud App Security √ºberwacht Certificate-Usage in Cloud-Applications f√ºr Shadow IT-Detection\n‚Ä¢ Identity Protection-Integration nutzt Certificate-Anomalies f√ºr Risk-based Authentication-Decisions\n‚Ä¢ Security Score-Integration bewertet Certificate-Management-Practices und identifiziert Security-Gaps\n\nüìä Compliance und Audit-Integration:\n‚Ä¢ Compliance Manager-Integration dokumentiert Certificate-Security-Controls f√ºr regulatorische Audit-Trails\n‚Ä¢ Data Loss Prevention-Integration nutzt Certificate-Attribute f√ºr Document Classification und Access Control\n‚Ä¢ eDiscovery-Integration erm√∂glicht Certificate-based Forensic Analysis f√ºr Legal Hold-Scenarios\n‚Ä¢ Audit Log-Integration dokumentiert alle Certificate-Security-Events f√ºr Compliance-Reporting\n‚Ä¢ Risk Assessment-Integration nutzt Certificate-Security-Metriken f√ºr Enterprise Risk-Scoring\n\nüö® Incident Response und Threat Hunting:\n‚Ä¢ Security Operations Center-Integration erm√∂glicht centralized Certificate-Security-Monitoring und Response\n‚Ä¢ Threat Hunting-Queries nutzen Certificate-Telemetry f√ºr Proactive Threat Detection\n‚Ä¢ Playbook-Integration automatisiert Certificate-Security-Incident-Response-Workflows\n‚Ä¢ Threat Intelligence-Integration nutzt Certificate-IOCs f√ºr Enhanced Attack-Detection\n‚Ä¢ Forensic Analysis-Tools erm√∂glichen Deep-Dive Certificate-Security-Investigation\n\nüåê Zero Trust und Continuous Verification:\n‚Ä¢ Never Trust, Always Verify-Prinzipien nutzen Certificate-Validation f√ºr Continuous Security-Assessment\n‚Ä¢ Device Compliance-Integration nutzt Certificate-Health f√ºr Device Trust-Scoring\n‚Ä¢ Application Control-Integration gew√§hrleistet, dass nur Certificate-validierte Applications ausgef√ºhrt werden\n‚Ä¢ Network Access Control nutzt Certificate-Attribute f√ºr Dynamic Network Segmentation\n‚Ä¢ Conditional Access-Integration kombiniert Certificate-Security-Status mit Risk-based Access-Decisions"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 4 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
