import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating IAM Software page with FAQ batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'iam-software' })
    
    if (!existingDoc) {
      throw new Error('Document "iam-software" not found')
    }
    
    // Create new FAQs for IAM Software security features and compliance
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 9),
        question: 'Welche erweiterten Sicherheitsfeatures sollte eine moderne IAM Software bieten und wie bewertet man deren Wirksamkeit?',
        answer: "Moderne IAM Software muss weit √ºber grundlegende Authentifizierung hinausgehen und erweiterte Sicherheitsfeatures bieten, die den sich entwickelnden Bedrohungslandschaften und sophistizierten Angriffsvektoren gewachsen sind. Die Bewertung dieser Features erfordert eine systematische Analyse ihrer technischen Capabilities und ihrer praktischen Wirksamkeit in realen Sicherheitsszenarien.\n\nüõ°Ô∏è Adaptive Authentication und Risk-based Security:\n‚Ä¢ Behavioral Analytics zur Erkennung anomaler User-Patterns und verd√§chtiger Aktivit√§ten\n‚Ä¢ Contextual Authentication basierend auf Geolocation, Device Fingerprinting und Zeitmustern\n‚Ä¢ Machine Learning-basierte Risk Scoring f√ºr dynamische Authentication-Entscheidungen\n‚Ä¢ Real-time Threat Intelligence Integration f√ºr aktuelle Bedrohungsinformationen\n‚Ä¢ Adaptive Multi-Factor Authentication mit intelligenter Step-up Authentication\n\nüîê Zero Trust Architecture Integration:\n‚Ä¢ Continuous Verification und Never Trust, Always Verify Principles\n‚Ä¢ Micro-Segmentation und Least Privilege Access Enforcement\n‚Ä¢ Device Trust und Endpoint Security Integration\n‚Ä¢ Network-agnostic Security mit Identity-centric Access Control\n‚Ä¢ Policy-based Access Control mit granularen Berechtigungsmodellen\n\nüéØ Privileged Access Management und Administrative Security:\n‚Ä¢ Just-in-Time Access Provisioning f√ºr administrative Berechtigungen\n‚Ä¢ Session Recording und Monitoring f√ºr privilegierte Zugriffe\n‚Ä¢ Credential Vaulting und Rotation f√ºr Service Accounts und Shared Credentials\n‚Ä¢ Approval Workflows und Dual Control f√ºr kritische Operationen\n‚Ä¢ Emergency Access Procedures mit Audit Trail und Accountability\n\nüìä User and Entity Behavior Analytics:\n‚Ä¢ Baseline Establishment f√ºr normale User-Verhaltensmuster\n‚Ä¢ Anomaly Detection f√ºr ungew√∂hnliche Access-Patterns und Aktivit√§ten\n‚Ä¢ Peer Group Analysis f√ºr rollenbasierte Verhaltensvergleiche\n‚Ä¢ Threat Hunting Capabilities f√ºr proaktive Sicherheitsanalysen\n‚Ä¢ Incident Response Integration f√ºr automatisierte Threat Response\n\nüîç Advanced Audit und Forensic Capabilities:\n‚Ä¢ Comprehensive Logging aller Identity-Events mit tamper-proof Storage\n‚Ä¢ Real-time Monitoring und Alerting f√ºr sicherheitskritische Ereignisse\n‚Ä¢ Forensic Analysis Tools f√ºr detaillierte Incident Investigation\n‚Ä¢ Compliance Reporting und Automated Evidence Collection\n‚Ä¢ Chain of Custody Maintenance f√ºr rechtliche Verwertbarkeit\n\n‚ö° Threat Detection und Response Integration:\n‚Ä¢ SIEM Integration f√ºr centralized Security Event Management\n‚Ä¢ SOAR Integration f√ºr automatisierte Incident Response\n‚Ä¢ Threat Intelligence Feeds f√ºr aktuelle IOCs und Attack Patterns\n‚Ä¢ Automated Response Actions wie Account Lockout und Access Revocation\n‚Ä¢ Incident Escalation und Notification Workflows\n\nüîÑ Continuous Security Assessment:\n‚Ä¢ Regular Security Posture Assessment und Vulnerability Scanning\n‚Ä¢ Identity Hygiene Monitoring und Cleanup Recommendations\n‚Ä¢ Access Review Automation und Certification Workflows\n‚Ä¢ Risk Assessment und Mitigation Planning\n‚Ä¢ Security Metrics und KPI Tracking f√ºr kontinuierliche Verbesserung\n\nüìà Effectiveness Evaluation Criteria:\n‚Ä¢ False Positive und False Negative Rates f√ºr Detection-Algorithmen\n‚Ä¢ Mean Time to Detection und Response f√ºr Security Incidents\n‚Ä¢ User Experience Impact und Friction Measurement\n‚Ä¢ Compliance Coverage und Audit Success Rates\n‚Ä¢ ROI Measurement f√ºr Security Investment und Risk Reduction"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 10),
        question: 'Wie implementiert man Multi-Faktor-Authentifizierung in IAM Software und welche Methoden sind am sichersten?',
        answer: "Multi-Faktor-Authentifizierung ist ein kritischer Sicherheitsbaustein moderner IAM Software und erfordert eine durchdachte Implementierung, die Sicherheit, Benutzerfreundlichkeit und organisatorische Anforderungen optimal balanciert. Die Auswahl und Konfiguration der MFA-Methoden hat direkten Einfluss auf die Gesamtsicherheit und User Adoption der IAM-L√∂sung.\n\nüîê Authentication Factor Categories und Security Levels:\n‚Ä¢ Knowledge Factors wie Passw√∂rter, PINs und Security Questions als Basis-Authentifizierung\n‚Ä¢ Possession Factors wie Hardware Tokens, Smartphones und Smart Cards f√ºr physische Verifikation\n‚Ä¢ Inherence Factors wie Biometrie, Fingerabdr√ºcke und Gesichtserkennung f√ºr eindeutige Identifikation\n‚Ä¢ Location Factors wie Geolocation und Network-based Authentication f√ºr Kontext-Verifikation\n‚Ä¢ Behavioral Factors wie Typing Patterns und Mouse Movement f√ºr kontinuierliche Authentifizierung\n\nüì± Modern MFA Technologies und Implementation:\n‚Ä¢ FIDO2 und WebAuthn Standards f√ºr passwordless Authentication und Phishing-Resistenz\n‚Ä¢ Push Notifications mit cryptographic Verification f√ºr sichere Mobile Authentication\n‚Ä¢ Time-based One-Time Passwords mit standardisierten TOTP-Algorithmen\n‚Ä¢ SMS und Voice-based OTP mit Awareness f√ºr SIM-Swapping Risiken\n‚Ä¢ Hardware Security Keys f√ºr h√∂chste Sicherheitsanforderungen und Compliance\n\nüõ°Ô∏è Phishing-Resistant Authentication Methods:\n‚Ä¢ FIDO2 Security Keys als Gold Standard f√ºr Phishing-Resistenz\n‚Ä¢ Certificate-based Authentication mit PKI Integration\n‚Ä¢ Biometric Authentication mit Liveness Detection\n‚Ä¢ Device-bound Credentials mit Hardware-backed Security\n‚Ä¢ Cryptographic Challenge-Response Mechanisms\n\nüéØ Adaptive MFA und Risk-based Authentication:\n‚Ä¢ Risk Scoring basierend auf User Behavior, Location und Device Trust\n‚Ä¢ Step-up Authentication f√ºr erh√∂hte Sicherheitsanforderungen\n‚Ä¢ Contextual MFA mit intelligenter Factor-Auswahl\n‚Ä¢ Silent Authentication f√ºr vertrauensw√ºrdige Umgebungen\n‚Ä¢ Continuous Authentication f√ºr Session-basierte Sicherheit\n\nüìä Implementation Best Practices:\n‚Ä¢ Gradual Rollout mit Pilot Groups und Phased Deployment\n‚Ä¢ User Training und Change Management f√ºr erfolgreiche Adoption\n‚Ä¢ Fallback Mechanisms und Recovery Procedures f√ºr MFA-Ausf√§lle\n‚Ä¢ Device Registration und Management Workflows\n‚Ä¢ Policy Configuration f√ºr verschiedene User Groups und Applications\n\nüîÑ MFA Method Security Ranking:\n‚Ä¢ Highest Security: FIDO2 Hardware Keys und Certificate-based Authentication\n‚Ä¢ High Security: Biometric Authentication und Push Notifications mit Cryptographic Verification\n‚Ä¢ Medium Security: TOTP Apps und Hardware Tokens\n‚Ä¢ Lower Security: SMS OTP und Voice Calls aufgrund von Interception-Risiken\n‚Ä¢ Avoid: Security Questions und Email-based OTP aufgrund von Compromise-Risiken\n\n‚ö° Performance und User Experience Optimization:\n‚Ä¢ Single Sign-On Integration f√ºr reduzierte MFA-Prompts\n‚Ä¢ Remember Device Functionality f√ºr vertrauensw√ºrdige Endpoints\n‚Ä¢ Streamlined Enrollment Processes f√ºr neue MFA-Methoden\n‚Ä¢ Mobile-first Design f√ºr moderne User Expectations\n‚Ä¢ Accessibility Considerations f√ºr diverse User Needs\n\nüéØ Enterprise Deployment Considerations:\n‚Ä¢ Centralized MFA Policy Management und Configuration\n‚Ä¢ Integration mit bestehenden Identity Providers und Applications\n‚Ä¢ Compliance Requirements f√ºr verschiedene Regulatory Frameworks\n‚Ä¢ Cost-Benefit Analysis f√ºr verschiedene MFA-Technologien\n‚Ä¢ Vendor Evaluation und Long-term Support Considerations"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 11),
        question: 'Welche Compliance-Frameworks m√ºssen bei der IAM Software Auswahl ber√ºcksichtigt werden und wie stellt man Konformit√§t sicher?',
        answer: "Compliance-Frameworks bilden einen kritischen Entscheidungsfaktor bei der IAM Software Auswahl und erfordern eine systematische Analyse der regulatorischen Anforderungen sowie deren technische Umsetzung. Die Sicherstellung der Konformit√§t ist nicht nur eine rechtliche Notwendigkeit, sondern auch ein Wettbewerbsvorteil und Vertrauensfaktor f√ºr Kunden und Stakeholder.\n\nüìã Major Compliance Frameworks und IAM Requirements:\n‚Ä¢ GDPR und EU Privacy Regulations mit Fokus auf Data Protection by Design und User Rights\n‚Ä¢ SOX Compliance f√ºr Financial Controls und Access Management in b√∂rsennotierten Unternehmen\n‚Ä¢ HIPAA f√ºr Healthcare Organizations mit strengen Patient Data Protection Requirements\n‚Ä¢ PCI DSS f√ºr Payment Processing mit spezifischen Access Control und Monitoring Anforderungen\n‚Ä¢ ISO 27001 f√ºr Information Security Management mit umfassenden Identity Governance Requirements\n\nüîê Technical Compliance Requirements:\n‚Ä¢ Access Control und Role-Based Permissions f√ºr Least Privilege Enforcement\n‚Ä¢ Audit Logging und Tamper-Proof Record Keeping f√ºr Compliance Evidence\n‚Ä¢ Data Encryption und Protection f√ºr Sensitive Information Handling\n‚Ä¢ Identity Lifecycle Management f√ºr Joiner-Mover-Leaver Processes\n‚Ä¢ Segregation of Duties und Dual Control f√ºr Critical Operations\n\nüåç Regional und Industry-Specific Regulations:\n‚Ä¢ CCPA und US State Privacy Laws f√ºr amerikanische Organisationen\n‚Ä¢ PIPEDA f√ºr kanadische Unternehmen mit Personal Information Processing\n‚Ä¢ Banking Regulations wie Basel III und MiFID II f√ºr Financial Services\n‚Ä¢ Government Standards wie FedRAMP und FISMA f√ºr Public Sector\n‚Ä¢ Industry-specific Requirements wie 21 CFR Part 11 f√ºr Pharmaceutical Companies\n\nüìä Compliance Assessment und Gap Analysis:\n‚Ä¢ Current State Analysis der bestehenden IAM-Capabilities gegen Compliance Requirements\n‚Ä¢ Risk Assessment f√ºr Non-Compliance Scenarios und Potential Penalties\n‚Ä¢ Gap Identification und Prioritization basierend auf Business Impact\n‚Ä¢ Remediation Planning mit Timeline und Resource Allocation\n‚Ä¢ Continuous Monitoring und Compliance Maintenance Strategies\n\nüõ°Ô∏è Technical Safeguards f√ºr Compliance:\n‚Ä¢ Automated Compliance Monitoring und Real-time Alerting f√ºr Violations\n‚Ä¢ Policy Enforcement Engines f√ºr automatisierte Compliance Rule Implementation\n‚Ä¢ Evidence Collection und Documentation f√ºr Audit Preparation\n‚Ä¢ Incident Response und Breach Notification Procedures\n‚Ä¢ Data Retention und Deletion Policies f√ºr Regulatory Compliance\n\n‚öñÔ∏è Governance und Organizational Controls:\n‚Ä¢ Compliance Officer Integration und Responsibility Assignment\n‚Ä¢ Policy Development und Regular Review Processes\n‚Ä¢ Staff Training und Awareness Programs f√ºr Compliance Requirements\n‚Ä¢ Vendor Management und Third-Party Risk Assessment\n‚Ä¢ Board Reporting und Executive Oversight f√ºr Compliance Status\n\nüîÑ Continuous Compliance Management:\n‚Ä¢ Regular Compliance Audits und Assessment Schedules\n‚Ä¢ Regulatory Change Monitoring und Impact Assessment\n‚Ä¢ Policy Updates und Procedure Modifications\n‚Ä¢ Training Updates und Certification Maintenance\n‚Ä¢ Compliance Metrics und KPI Tracking\n\nüìà Compliance Validation und Certification:\n‚Ä¢ Third-Party Audits und Independent Assessments\n‚Ä¢ Certification Maintenance und Renewal Processes\n‚Ä¢ Penetration Testing und Vulnerability Assessments\n‚Ä¢ Compliance Reporting und Stakeholder Communication\n‚Ä¢ Continuous Improvement und Lessons Learned Integration\n\nüéØ Best Practices f√ºr Sustainable Compliance:\n‚Ä¢ Compliance by Design Integration in alle IAM-Prozesse\n‚Ä¢ Automated Compliance Testing und Validation\n‚Ä¢ Cross-Functional Collaboration zwischen Legal, IT und Business\n‚Ä¢ Regular Compliance Training und Awareness Programs\n‚Ä¢ Proactive Regulatory Monitoring und Preparation for Changes"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 12),
        question: 'Wie gew√§hrleistet man die Sicherheit von Identity-Daten in IAM Software und welche Verschl√ºsselungsstandards sind erforderlich?',
        answer: "Die Sicherheit von Identity-Daten ist das Herzst√ºck jeder IAM Software Implementation und erfordert einen mehrschichtigen Sicherheitsansatz, der sowohl technische als auch organisatorische Ma√ünahmen umfasst. Verschl√ºsselung bildet dabei nur einen Baustein einer umfassenden Data Protection Strategy, die alle Aspekte des Identity Data Lifecycle abdecken muss.\n\nüîê Encryption Standards und Cryptographic Requirements:\n‚Ä¢ AES-256 Encryption f√ºr Data at Rest mit Hardware Security Module Integration\n‚Ä¢ TLS 1.3 f√ºr Data in Transit mit Perfect Forward Secrecy\n‚Ä¢ End-to-End Encryption f√ºr sensitive Identity Attributes und Credentials\n‚Ä¢ Key Management Systems mit Hardware-backed Key Storage\n‚Ä¢ Cryptographic Agility f√ºr Future-Proofing gegen Quantum Computing Threats\n\nüõ°Ô∏è Data Classification und Protection Levels:\n‚Ä¢ Sensitive Personal Information mit h√∂chsten Encryption und Access Control Standards\n‚Ä¢ Authentication Credentials mit specialized Hashing und Salting Techniques\n‚Ä¢ Audit Logs mit Tamper-Proof Storage und Integrity Verification\n‚Ä¢ Metadata und Configuration Data mit angemessenen Protection Levels\n‚Ä¢ Backup und Archive Data mit Long-term Encryption und Key Escrow\n\nüèóÔ∏è Secure Architecture Design Principles:\n‚Ä¢ Zero Trust Architecture mit Never Trust, Always Verify Approach\n‚Ä¢ Defense in Depth mit Multiple Security Layers und Redundancy\n‚Ä¢ Principle of Least Privilege f√ºr Data Access und Processing\n‚Ä¢ Data Minimization und Purpose Limitation f√ºr Privacy Protection\n‚Ä¢ Secure by Default Configuration mit Hardening Guidelines\n\nüìä Identity Data Lifecycle Security:\n‚Ä¢ Secure Data Collection mit Input Validation und Sanitization\n‚Ä¢ Protected Data Processing mit Secure Computation Environments\n‚Ä¢ Controlled Data Storage mit Access Logging und Monitoring\n‚Ä¢ Secure Data Transmission mit Authenticated und Encrypted Channels\n‚Ä¢ Secure Data Disposal mit Cryptographic Erasure und Physical Destruction\n\nüîç Access Control und Authorization:\n‚Ä¢ Role-Based Access Control f√ºr Identity Data Access\n‚Ä¢ Attribute-Based Access Control f√ºr granulare Permissions\n‚Ä¢ Just-in-Time Access f√ºr administrative Operations\n‚Ä¢ Privileged Access Management f√ºr System Administrators\n‚Ä¢ API Security mit OAuth und Strong Authentication\n\n‚ö° Monitoring und Threat Detection:\n‚Ä¢ Real-time Monitoring f√ºr unauthorized Data Access Attempts\n‚Ä¢ Anomaly Detection f√ºr unusual Data Access Patterns\n‚Ä¢ Data Loss Prevention f√ºr preventing Data Exfiltration\n‚Ä¢ Insider Threat Detection f√ºr malicious Internal Activities\n‚Ä¢ Incident Response f√ºr Data Breach Scenarios\n\nüîÑ Key Management und Cryptographic Operations:\n‚Ä¢ Hardware Security Modules f√ºr Key Generation und Storage\n‚Ä¢ Key Rotation Policies und Automated Key Lifecycle Management\n‚Ä¢ Secure Key Distribution und Escrow Procedures\n‚Ä¢ Cryptographic Audit Trails f√ºr Key Usage Tracking\n‚Ä¢ Disaster Recovery f√ºr Cryptographic Infrastructure\n\nüåç Regulatory Compliance und Standards:\n‚Ä¢ FIPS 140-2 Level 3 oder h√∂her f√ºr Cryptographic Modules\n‚Ä¢ Common Criteria Evaluations f√ºr Security Assurance\n‚Ä¢ GDPR Compliance f√ºr EU Personal Data Protection\n‚Ä¢ Industry-specific Standards wie HIPAA f√ºr Healthcare Data\n‚Ä¢ International Standards wie ISO 27001 f√ºr Information Security\n\nüéØ Implementation Best Practices:\n‚Ä¢ Security by Design Integration in alle Development Processes\n‚Ä¢ Regular Security Assessments und Penetration Testing\n‚Ä¢ Vulnerability Management und Patch Management Procedures\n‚Ä¢ Security Training f√ºr Development und Operations Teams\n‚Ä¢ Continuous Security Monitoring und Improvement Programs\n\nüìà Emerging Security Technologies:\n‚Ä¢ Homomorphic Encryption f√ºr Computation on Encrypted Data\n‚Ä¢ Secure Multi-Party Computation f√ºr Privacy-Preserving Analytics\n‚Ä¢ Differential Privacy f√ºr Statistical Data Protection\n‚Ä¢ Blockchain Integration f√ºr Immutable Audit Trails\n‚Ä¢ Quantum-Resistant Cryptography f√ºr Future Security Requirements"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
