import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Basel III Implementierung von Stresstests & Szenarioanalysen page with FAQs batch 2 (German)...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'basel-iii-implementierung-von-stresstests-szenarioanalysen' })
    
    if (!existingDoc) {
      throw new Error('Document "basel-iii-implementierung-von-stresstests-szenarioanalysen" not found')
    }
    
    // Create new FAQs in German
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Wie unterscheiden sich regulatorische und interne Stresstests, und wie kann eine optimale Balance zwischen beiden gefunden werden?",
        answer: "Regulatorische und interne Stresstests unterscheiden sich fundamental in ihrer Zielsetzung, methodischen Ausgestaltung und Governance, dienen jedoch komplement√§ren Zwecken im Risikomanagement eines Finanzinstituts. Die Kunst besteht darin, beide Ans√§tze in einem koh√§renten Rahmenwerk zu integrieren, das sowohl aufsichtsrechtliche Anforderungen erf√ºllt als auch institutsspezifischen Mehrwert generiert.\n\nüîç Wesentliche Unterscheidungsmerkmale:\n‚Ä¢ Zielsetzung: Regulatorische Stresstests dienen prim√§r der aufsichtlichen Beurteilung der Finanzstabilit√§t aus systemischer Perspektive, w√§hrend interne Stresstests auf die spezifischen Risikoprofile und Gesch√§ftsmodelle des individuellen Instituts ausgerichtet sind.\n‚Ä¢ Methodische Vorgaben: Aufsichtliche Stresstests folgen standardisierten Szenarien und Methodiken, um Vergleichbarkeit zwischen Instituten zu gew√§hrleisten. Interne Stresstests k√∂nnen dagegen ma√ügeschneiderte Ans√§tze verfolgen, die spezifische Vulnerabilit√§ten des Instituts gezielter adressieren.\n‚Ä¢ Entscheidungsrelevanz: W√§hrend regulatorische Stresstests prim√§r aufsichtliche Ma√ünahmen (z.B. SREP-Aufschl√§ge) begr√ºnden, dienen interne Stresstests als strategisches Entscheidungsinstrument f√ºr das Management des Instituts.\n‚Ä¢ Transparenz und Kommunikation: Ergebnisse regulatorischer Stresstests werden oft √∂ffentlich kommuniziert und k√∂nnen Marktreaktionen ausl√∂sen, w√§hrend interne Stresstests vorwiegend dem internen Risikomanagement dienen.\n\n‚öñÔ∏è Strategien zur optimalen Balance:\n‚Ä¢ Modulare Modellarchitektur: Entwicklung einer flexiblen, modularen Modelllandschaft, die sowohl standardisierte regulatorische Anforderungen erf√ºllen als auch institutsindividuelle Anpassungen erm√∂glichen kann.\n‚Ä¢ Gemeinsame Datenbasis: Etablierung einer einheitlichen, konsistenten Datenbasis f√ºr beide Stresstestarten, um Redundanzen zu vermeiden und die Datenqualit√§t zu erh√∂hen.\n‚Ä¢ Koordinierte Governance: Integration beider Stresstestarten in ein √ºbergreifendes Governance-Framework mit klaren Verantwortlichkeiten, abgestimmten Zeitpl√§nen und konsistenten Qualit√§tssicherungsprozessen.\n‚Ä¢ Szenarien-Toolkit: Entwicklung eines Baukastensystems aus Stressszenarien, das regulatorische Standardszenarien und institutsspezifische Szenarien kombiniert und erweitert.\n\nüí° Best-Practice-Ansatz f√ºr maximalen Mehrwert:\n‚Ä¢ Reverse Engineering: Nutzen Sie regulatorische Vorgaben als Mindeststandard und Ausgangspunkt, der durch institutsspezifische Aspekte erweitert und verfeinert wird.\n‚Ä¢ Regulatorische Szenarien als Benchmarks: Verwenden Sie aufsichtliche Szenarien als Referenzpunkte und entwickeln Sie darauf aufbauend spezifischere Szenarien, die Ihre individuellen Risikotreiber besser abbilden.\n‚Ä¢ Methodisches Cross-Fertilization: Transferieren Sie methodische Innovationen zwischen regulatorischen und internen Stresstests, um beide Ans√§tze kontinuierlich zu verbessern.\n‚Ä¢ Integriertes Reporting: Entwickeln Sie ein Management-Reporting, das die Ergebnisse beider Stresstestarten nebeneinander darstellt und deren Implikationen f√ºr verschiedene Entscheidungsbereiche transparent macht."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Welche Governance-Strukturen und Prozesse sind f√ºr eine effektive Implementierung und kontinuierliche Weiterentwicklung von Stresstests erforderlich?",
        answer: "Eine robuste Governance-Architektur bildet das Fundament f√ºr die erfolgreiche Implementierung und nachhaltige Evolution von Stresstestverfahren. Sie stellt sicher, dass Stresstests nicht nur technisch korrekt durchgef√ºhrt werden, sondern auch tats√§chlich in strategische Entscheidungsprozesse einflie√üen und kontinuierlich weiterentwickelt werden.\n\nüèõÔ∏è Schl√ºsselelemente einer effektiven Stresstest-Governance:\n‚Ä¢ Klare Rollenverteilung zwischen Vorstand, Fachbereichen und Kontrollfunktionen: Der Vorstand tr√§gt die Gesamtverantwortung und definiert den Risikoappetit, Fachbereiche liefern fachliche Expertise und Daten, w√§hrend Kontrollfunktionen (Risikomanagement, Compliance, Interne Revision) die Qualit√§tssicherung und Unabh√§ngigkeit gew√§hrleisten.\n‚Ä¢ Three Lines of Defense Model: Die erste Verteidigungslinie (operatives Gesch√§ft) implementiert die Prozesse, die zweite Linie (Risikomanagement) √ºberwacht und validiert, w√§hrend die dritte Linie (Interne Revision) unabh√§ngige Pr√ºfungen durchf√ºhrt.\n‚Ä¢ Spezialisierte Stresstest-Gremien: Etablierung eines dedizierten Stresstest-Komitees, das die methodische Konsistenz, Relevanz der Szenarien und angemessene Interpretation der Ergebnisse sicherstellt.\n‚Ä¢ Eskalationswege und Entscheidungsprozesse: Klar definierte Prozesse, wie auf kritische Stresstestergebnisse reagiert wird, inklusive Schwellenwerte f√ºr Eskalationen und verbindliche Reaktionspl√§ne.\n\nüìã Prozessuale Erfolgsfaktoren:\n‚Ä¢ Integrierter Stresstest-Zyklus: Etablierung eines strukturierten Jahreskalenders f√ºr Stresstests, der mit anderen Planungs- und Risikoprozessen (ICAAP, ILAAP, Kapitalplanung) synchronisiert ist.\n‚Ä¢ Kontinuierlicher Verbesserungsprozess: Systematische Nachbereitung jedes Stresstest-Durchlaufs mit Lessons-Learned-Workshops und dokumentierten Verbesserungsma√ünahmen.\n‚Ä¢ Dokumentation und Nachvollziehbarkeit: Umfassende Dokumentation von Methoden, Annahmen, Datengrundlagen und Ergebnisinterpretationen, die auch f√ºr Dritte nachvollziehbar ist.\n‚Ä¢ Change Management: Strukturierte Prozesse f√ºr die Einf√ºhrung neuer Methoden, Modelle oder Szenarien, inklusive Impactanalysen und √úbergangsregelungen.\n\nüîÑ Kontinuierliche Weiterentwicklung sicherstellen:\n‚Ä¢ Regelm√§√üige Methodenvalidierung: Unabh√§ngige √úberpr√ºfung der Stresstest-Methodiken auf Angemessenheit, Aktualit√§t und Konformit√§t mit regulatorischen Anforderungen.\n‚Ä¢ Szenario-Review-Prozess: Regelm√§√üige √úberpr√ºfung und Aktualisierung der Stressszenarien unter Ber√ºcksichtigung ver√§nderter Marktbedingungen, Gesch√§ftsmodelle und Risikoprofile.\n‚Ä¢ Benchmarking und externe Perspektiven: Regelm√§√üiger Austausch mit Peers, Aufsichtsbeh√∂rden und Experten, um Best Practices zu identifizieren und zu integrieren.\n‚Ä¢ Qualifizierung und Wissensmanagement: Kontinuierliche Fortbildung der beteiligten Mitarbeiter und systematischer Wissenstransfer, um den Verlust von Expertise zu vermeiden.\n\nüìä Key Performance Indicators (KPIs) f√ºr die Governance-Effektivit√§t:\n‚Ä¢ Zeitnahe Fertigstellung und Qualit√§t der Stresstests: Einhaltung der definierten Zeitpl√§ne bei gleichzeitig hoher methodischer Qualit√§t.\n‚Ä¢ Einfluss auf Gesch√§ftsentscheidungen: Nachweisbare Ber√ºcksichtigung von Stresstestergebnissen in strategischen und operativen Entscheidungen.\n‚Ä¢ Aufsichtliche Beurteilung: Positive Bewertung der Stresstest-Verfahren durch Aufsichtsbeh√∂rden im Rahmen von SREP oder anderen Pr√ºfungen.\n‚Ä¢ Kontinuierliche Verbesserung: Messbarer Fortschritt bei der Behebung identifizierter Schwachstellen und der Weiterentwicklung der Methoden."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Wie k√∂nnen Finanzinstitute eine aussagekr√§ftige Szenarioentwicklung f√ºr Stresstests sicherstellen, die sowohl plausibel als auch herausfordernd genug ist?",
        answer: "Die Entwicklung aussagekr√§ftiger Stressszenarien stellt eine zentrale Herausforderung dar, da sie den schwierigen Balanceakt zwischen Plausibilit√§t und ausreichender Schwere meistern muss. Zu milde Szenarien verfehlen den Zweck des Stresstests, w√§hrend zu extreme oder unrealistische Szenarien an Glaubw√ºrdigkeit und damit Handlungsrelevanz verlieren k√∂nnen.\n\nüß† Konzeptionelle Grundlagen wirksamer Szenarioentwicklung:\n‚Ä¢ Narrative-First-Ansatz: Entwicklung eines koh√§renten √∂konomischen Narrativs als Ausgangspunkt, bevor einzelne Parameter quantifiziert werden, um die interne Konsistenz des Szenarios zu gew√§hrleisten.\n‚Ä¢ Multi-Perspektiven-Methode: Einbeziehung verschiedener Fachbereiche (Treasury, Risikocontrolling, Volkswirtschaft, Gesch√§ftsbereiche) in den Entwicklungsprozess, um blinde Flecken zu vermeiden und Plausibilit√§t sicherzustellen.\n‚Ä¢ Historische Ankerpunkte: Verwendung historischer Krisen als Referenzpunkte, die jedoch an aktuelle Marktbedingungen und Portfoliostrukturen angepasst werden.\n‚Ä¢ Challenge-Kultur: Etablierung einer konstruktiven Challenge-Kultur, in der Annahmen und Parameter kritisch hinterfragt werden, ohne in √ºberm√§√üigen Konservatismus oder Optimismus zu verfallen.\n\nüî® Praktische Ans√§tze und Methoden:\n‚Ä¢ Reverse Stress Testing: Identifikation von Szenarien, die das Institut an kritische Kapital- oder Liquidit√§tsschwellen f√ºhren w√ºrden, um Vulnerabilit√§ten gezielt zu adressieren.\n‚Ä¢ Kombinierte Schocks: Entwicklung von Szenarien, die mehrere Risikofaktoren gleichzeitig ber√ºcksichtigen und deren Wechselwirkungen abbilden, statt isolierte Einzelrisiken zu betrachten.\n‚Ä¢ Mehrstufige Szenarien: Konstruktion von Szenarien mit mehreren Phasen (z.B. Schock, Anpassung, Recovery), die dynamische Marktreaktionen und Feedback-Effekte ber√ºcksichtigen.\n‚Ä¢ Expertenpanels und Delphi-Methode: Systematische Einbindung interner und externer Experten zur Validierung und Verfeinerung von Szenarien, besonders f√ºr schwer quantifizierbare Risiken.\n\nüìà Parametrisierung und Kalibrierung:\n‚Ä¢ Systematische Schweregraduierung: Entwicklung von Szenarien unterschiedlicher Schweregrade (mild, schwer, extrem), um ein breiteres Spektrum potenzieller Entwicklungen abzudecken.\n‚Ä¢ Strukturelle Stresskomponenten: Ber√ºcksichtigung nicht nur zyklischer, sondern auch struktureller Ver√§nderungen (z.B. Disruption von Gesch√§ftsmodellen, regulatorische Paradigmenwechsel).\n‚Ä¢ Korrelationsanalyse unter Stress: Spezielle Ber√ºcksichtigung der Ver√§nderung von Korrelationen zwischen Risikofaktoren in Stresssituationen, die oft von historischen Normalzust√§nden abweichen.\n‚Ä¢ Dynamische Aktualisierung: Kontinuierliche √úberpr√ºfung und Anpassung der Szenarien an neue Marktentwicklungen, emergente Risiken und ver√§nderte Portfoliostrukturen.\n\nüîé Qualit√§tssicherung und Validierung:\n‚Ä¢ Backtesting-Ans√§tze: Soweit m√∂glich, √úberpr√ºfung der Szenariokomponenten gegen historische Stressepisoden, um ihre Plausibilit√§t zu validieren.\n‚Ä¢ Konsistenzpr√ºfungen: Systematische √úberpr√ºfung der internen Konsistenz der Szenarien und ihrer Kompatibilit√§t mit √∂konomischen Grundprinzipien.\n‚Ä¢ Aufsichtlicher Dialog: Proaktiver Austausch mit Aufsichtsbeh√∂rden zur Kalibrierung und Validierung institutsspezifischer Szenarien.\n‚Ä¢ Peer Benchmarking: Vergleich der eigenen Szenarien mit denen anderer Institute und mit Markterwartungen, um potenzielle Ausrei√üer zu identifizieren."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie kann die Datenqualit√§t f√ºr Stresstests nachhaltig sichergestellt werden, und welche architektonischen Ans√§tze sind daf√ºr besonders geeignet?",
        answer: "Die Datenqualit√§t stellt einen kritischen Erfolgsfaktor f√ºr aussagekr√§ftige Stresstests dar, da selbst die sophistiziertesten Modelle nur so gut sein k√∂nnen wie die zugrundeliegenden Daten. Eine nachhaltige Sicherstellung hoher Datenqualit√§t erfordert sowohl organisatorische als auch technische Ma√ünahmen, die systematisch in die Datenwertsch√∂pfungskette integriert werden m√ºssen.\n\nüîç Grundlegende Datenqualit√§tsdimensionen f√ºr Stresstests:\n‚Ä¢ Vollst√§ndigkeit: Alle f√ºr den Stresstest relevanten Positionen und Risikofaktoren m√ºssen erfasst sein, ohne systematische L√ºcken oder blinde Flecken.\n‚Ä¢ Genauigkeit: Die Daten m√ºssen die tats√§chlichen Risikopositionen und -eigenschaften korrekt abbilden, mit minimalen Fehlerquoten und robusten Validierungsmechanismen.\n‚Ä¢ Aktualit√§t: Die Daten m√ºssen zeitnah verf√ºgbar sein, um in aktuellen Stresstests verwendet werden zu k√∂nnen, mit klar definierten Cut-off-Zeitpunkten und Aktualisierungszyklen.\n‚Ä¢ Konsistenz: Die Daten m√ºssen √ºber verschiedene Systeme, Gesch√§ftsbereiche und Zeitpunkte hinweg konsistent sein, mit eindeutigen Definitionen und harmonisierten Taxonomien.\n‚Ä¢ Granularit√§t: Der Detaillierungsgrad der Daten muss ausreichend sein, um die relevanten Risikotreiber und -sensitivit√§ten abzubilden, bei gleichzeitig angemessener Aggregationsf√§higkeit.\n\n‚öôÔ∏è Organisatorische Ma√ünahmen zur Datenqualit√§tssicherung:\n‚Ä¢ Data Ownership und Governance: Klare Zuweisung von Verantwortlichkeiten f√ºr Datenqualit√§t mit definierten Data Stewards und einem √ºbergreifenden Data Governance Framework.\n‚Ä¢ Qualit√§tssicherungsprozesse: Implementierung systematischer Kontrollprozesse an kritischen Punkten der Datenverarbeitung, mit automatisierten Plausibilit√§tspr√ºfungen und manuellen Reviews.\n‚Ä¢ Training und Bewusstsein: Schulung der Mitarbeiter zur Bedeutung der Datenqualit√§t und zu den spezifischen Anforderungen von Stresstests, um eine qualit√§tsorientierte Datenkultur zu f√∂rdern.\n‚Ä¢ Dokumentation und Metadaten: Umfassende Dokumentation von Datenquellen, Transformationen, Annahmen und Einschr√§nkungen, um Transparenz und Nachvollziehbarkeit zu gew√§hrleisten.\n\nüèóÔ∏è Architektonische Ans√§tze f√ºr nachhaltige Datenqualit√§t:\n‚Ä¢ Data Lineage und Mapping: Implementierung von Tools zur Nachverfolgung des Datenflusses von der Quelle bis zum Stresstest-Reporting, um Qualit√§tsprobleme gezielt lokalisieren zu k√∂nnen.\n‚Ä¢ Single Source of Truth: Etablierung einer zentralen, autoritativen Datenquelle f√ºr kritische Risikodaten, um Inkonsistenzen durch Mehrfacherfassung oder parallele Datensilos zu vermeiden.\n‚Ä¢ Data Quality Firewall: Einrichtung dedizierter Qualit√§tssicherungsschichten zwischen Quellsystemen und Stresstest-Anwendungen, die Daten validieren und ggf. bereinigen.\n‚Ä¢ Data Fabric oder Data Mesh Architekturen: Diese modernen Ans√§tze kombinieren zentrale Governance mit dezentraler Datenverantwortung und erm√∂glichen eine flexible, dom√§nenorientierte Datenbereitstellung.\n\nüíª Technologische Enabler f√ºr hochwertige Stresstest-Daten:\n‚Ä¢ Automatisierte Datenqualit√§tspr√ºfungen: Einsatz spezialisierter Tools, die kontinuierlich Datenqualit√§tsmetriken messen und Abweichungen von definierten Schwellenwerten melden.\n‚Ä¢ Master Data Management (MDM): Zentrale Verwaltung kritischer Stammdaten wie Gegenpartei-Informationen, Produkt-Klassifikationen oder Risikoparameter.\n‚Ä¢ Data Cataloging und Discovery: Werkzeuge zur Inventarisierung und Auffindbarkeit relevanter Datens√§tze, die Metadaten, Qualit√§tskennzahlen und Nutzungsinformationen bereitstellen.\n‚Ä¢ Fortgeschrittene ETL/ELT-Prozesse: Robuste Datenintegrationsprozesse mit umfassenden Logging- und Fehlerbehandlungsmechanismen zur sicheren Datenextraktion, -transformation und -ladung."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs (German) to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 2 (German) added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
