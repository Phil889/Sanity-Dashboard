import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating CRA Anforderungen page with FAQs batch 2...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'cra-anforderungen' })
    
    if (!existingDoc) {
      throw new Error('Document "cra-anforderungen" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 5),
        question: 'Wie implementieren wir Cybersecurity by Design Prinzipien in unsere Produktentwicklungsprozesse zur Erf√ºllung der CRA Anforderungen?',
        answer: "Die Implementierung von Cybersecurity by Design Prinzipien erfordert eine fundamentale Neuausrichtung der Produktentwicklungsprozesse, die Sicherheit als integralen Bestandteil von der ersten Konzeptphase bis zur Produkteinstellung betrachtet. Diese Transformation geht √ºber die nachtr√§gliche Addition von Sicherheitsfeatures hinaus und etabliert Sicherheit als Grundprinzip aller Design- und Entwicklungsentscheidungen.\n\nüé® Strategische Design-Integration:\n‚Ä¢ Entwicklung einer Security-First-Mentalit√§t in allen Produktteams durch umfassende Schulungen, klare Richtlinien und Integration von Sicherheitszielen in Produktvision und Roadmap-Planung.\n‚Ä¢ Implementierung von Threat Modeling als standardm√§√üiger Bestandteil der Anforderungsanalyse, um potenzielle Angriffsvektoren fr√ºhzeitig zu identifizieren und entsprechende Schutzma√ünahmen zu planen.\n‚Ä¢ Integration von Privacy by Design Prinzipien, die Datenschutz und Datensicherheit von Anfang an ber√ºcksichtigen und minimale Datensammlung, Zweckbindung und Transparenz gew√§hrleisten.\n‚Ä¢ Aufbau von Security Architecture Reviews als verpflichtende Gates in allen Entwicklungsphasen, die sicherstellen, dass Sicherheitsanforderungen in technische Spezifikationen √ºbersetzt werden.\n‚Ä¢ Entwicklung von Security Design Patterns und wiederverwendbaren Sicherheitskomponenten, die konsistente Implementierung bew√§hrter Sicherheitspraktiken erm√∂glichen.\n\nüîß Technische Implementierungsstrategien:\n‚Ä¢ Adoption von Secure Coding Standards und automatisierten Code-Analyse-Tools, die Sicherheitsschwachstellen bereits w√§hrend der Entwicklung identifizieren und beheben.\n‚Ä¢ Implementierung von Zero Trust Architektur-Prinzipien, die niemals implizites Vertrauen voraussetzen und kontinuierliche Verifikation aller Interaktionen erfordern.\n‚Ä¢ Integration von Hardware Security Modules und Trusted Platform Modules f√ºr kritische Sicherheitsfunktionen wie Schl√ºsselmanagement, sichere Boot-Prozesse und Attestierung.\n‚Ä¢ Entwicklung von Defense in Depth Strategien, die mehrere Sicherheitsebenen implementieren und Single Points of Failure vermeiden.\n‚Ä¢ Aufbau von Secure Update-Mechanismen, die sichere, authentifizierte und rollback-f√§hige Software- und Firmware-Updates erm√∂glichen.\n\nüìã Prozess- und Governance-Integration:\n‚Ä¢ Etablierung von Security Champions Programmen in allen Entwicklungsteams, die als Sicherheitsexperten und Multiplikatoren fungieren.\n‚Ä¢ Integration von Security Testing in alle Phasen des Entwicklungslebenszyklus, einschlie√ülich Unit Tests, Integration Tests und End-to-End Security Tests.\n‚Ä¢ Implementierung von Continuous Security Monitoring und Feedback-Schleifen, die Sicherheitsmetriken kontinuierlich √ºberwachen und Verbesserungen vorantreiben.\n‚Ä¢ Aufbau von Incident Response Capabilities, die schnelle Reaktionen auf Sicherheitsvorf√§lle erm√∂glichen und Lessons Learned in zuk√ºnftige Entwicklungen integrieren.\n‚Ä¢ Entwicklung von Security Documentation Standards, die umfassende Dokumentation aller Sicherheitsma√ünahmen und Entscheidungen gew√§hrleisten."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 6),
        question: 'Welche spezifischen Vulnerability Management Prozesse sind erforderlich, um kontinuierliche CRA Compliance zu gew√§hrleisten?',
        answer: "Ein effektives Vulnerability Management f√ºr CRA Compliance erfordert einen systematischen, kontinuierlichen Ansatz, der √ºber traditionelle Patch-Management-Praktiken hinausgeht und proaktive Schwachstellenidentifikation, Risikobewertung und koordinierte Remediation umfasst. Diese Prozesse m√ºssen sowohl interne Entwicklungen als auch externe Abh√§ngigkeiten abdecken und dabei Gesch√§ftskontinuit√§t und Sicherheit optimal balancieren.\n\nüîç Umfassende Schwachstellenidentifikation:\n‚Ä¢ Implementierung automatisierter Vulnerability Scanning-Tools, die kontinuierlich alle Systemkomponenten, Abh√§ngigkeiten und Infrastrukturen √ºberwachen und bekannte Schwachstellen identifizieren.\n‚Ä¢ Aufbau von Threat Intelligence Capabilities, die externe Bedrohungsinformationen sammeln, analysieren und in interne Risikobewertungen integrieren.\n‚Ä¢ Etablierung von Bug Bounty Programmen und Responsible Disclosure Prozessen, die externe Sicherheitsforscher ermutigen, Schwachstellen zu melden.\n‚Ä¢ Integration von Static Application Security Testing und Dynamic Application Security Testing in Entwicklungspipelines f√ºr fr√ºhzeitige Schwachstellenerkennung.\n‚Ä¢ Durchf√ºhrung regelm√§√üiger Penetration Tests und Red Team Exercises, um komplexe Angriffsvektoren und Schwachstellenkombinationen zu identifizieren.\n\n‚öñÔ∏è Risikobasierte Priorisierung und Bewertung:\n‚Ä¢ Entwicklung einer multidimensionalen Risikobewertungsmatrix, die CVSS-Scores, Exploitability, Gesch√§ftsauswirkungen und Umgebungskontext ber√ºcksichtigt.\n‚Ä¢ Implementierung von Asset-basierten Bewertungen, die die Kritikalit√§t betroffener Systeme und deren Rolle in der Gesch√§ftsarchitektur bewerten.\n‚Ä¢ Aufbau von Threat Modeling-Prozessen, die spezifische Bedrohungsszenarien f√ºr verschiedene Schwachstellentypen analysieren.\n‚Ä¢ Integration von Business Impact Analysis, die potenzielle Auswirkungen von Schwachstellenausnutzung auf Gesch√§ftsprozesse quantifiziert.\n‚Ä¢ Entwicklung von SLA-basierten Response-Zeiten, die verschiedene Risikostufen mit entsprechenden Reaktionszeiten verkn√ºpfen.\n\nüõ†Ô∏è Koordinierte Remediation und Response:\n‚Ä¢ Etablierung von Cross-funktionalen Vulnerability Response Teams mit Vertretern aus Entwicklung, Operations, Security und Business-Bereichen.\n‚Ä¢ Implementierung von Patch Management-Prozessen, die sowohl Emergency Patches als auch geplante Update-Zyklen umfassen.\n‚Ä¢ Aufbau von Compensating Controls f√ºr Situationen, in denen sofortige Patches nicht m√∂glich sind.\n‚Ä¢ Entwicklung von Rollback-Strategien und Testing-Verfahren, die sichere Patch-Deployment gew√§hrleisten.\n‚Ä¢ Integration von Supply Chain Vulnerability Management, das Schwachstellen in Drittanbieter-Komponenten und Abh√§ngigkeiten adressiert.\n\nüìä Kontinuierliche √úberwachung und Verbesserung:\n‚Ä¢ Implementierung von Vulnerability Metrics und KPIs, die Effektivit√§t des Vulnerability Management-Programms messen.\n‚Ä¢ Aufbau von Trend-Analyse-Capabilities, die Schwachstellenmuster und Verbesserungsm√∂glichkeiten identifizieren.\n‚Ä¢ Etablierung von Lessons Learned Prozessen, die Erkenntnisse aus Vulnerability Response in zuk√ºnftige Verbesserungen integrieren.\n‚Ä¢ Integration von Compliance Reporting, das regulatorische Anforderungen erf√ºllt und Audit-Bereitschaft gew√§hrleistet.\n‚Ä¢ Entwicklung von Stakeholder Communication-Strategien, die verschiedene Zielgruppen √ºber Vulnerability Status und Ma√ünahmen informieren."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 7),
        question: 'Wie k√∂nnen wir sichere Update- und Patch-Mechanismen implementieren, die den CRA Anforderungen f√ºr kontinuierliche Sicherheitsupdates entsprechen?',
        answer: "Die Implementierung sicherer Update- und Patch-Mechanismen ist eine kritische CRA Anforderung, die robuste technische L√∂sungen mit operativen Prozessen verbindet, um kontinuierliche Sicherheit w√§hrend des gesamten Produktlebenszyklus zu gew√§hrleisten. Diese Mechanismen m√ºssen sowohl Sicherheit als auch Verf√ºgbarkeit optimieren und dabei verschiedene Deployment-Szenarien und Benutzeranforderungen ber√ºcksichtigen.\n\nüîê Sichere Update-Architektur:\n‚Ä¢ Implementierung von Code Signing und digitalen Signaturen f√ºr alle Updates, die Authentizit√§t und Integrit√§t der Update-Pakete durch kryptographische Verifikation gew√§hrleisten.\n‚Ä¢ Aufbau von Secure Boot Chains und Trusted Execution Environments, die sicherstellen, dass nur verifizierte und autorisierte Updates installiert werden k√∂nnen.\n‚Ä¢ Entwicklung von Delta-Update-Mechanismen, die nur ge√§nderte Komponenten √ºbertragen und dabei Bandbreite optimieren und Angriffsfl√§chen minimieren.\n‚Ä¢ Integration von Rollback-Capabilities und Atomic Updates, die sichere R√ºckkehr zu vorherigen Versionen erm√∂glichen, falls Updates Probleme verursachen.\n‚Ä¢ Implementierung von Multi-Stage Update-Prozessen mit Validierung und Testing auf jeder Stufe vor der finalen Installation.\n\nüì° Robuste Delivery-Mechanismen:\n‚Ä¢ Aufbau redundanter Update-Infrastrukturen mit Content Delivery Networks und geografisch verteilten Update-Servern f√ºr hohe Verf√ºgbarkeit.\n‚Ä¢ Implementierung von Bandwidth-Management und Progressive Rollout-Strategien, die Updates schrittweise an verschiedene Benutzergruppen verteilen.\n‚Ä¢ Integration von Offline-Update-Capabilities f√ºr Umgebungen mit eingeschr√§nkter Konnektivit√§t oder hohen Sicherheitsanforderungen.\n‚Ä¢ Entwicklung von Emergency Update-Kan√§le f√ºr kritische Sicherheitspatches, die beschleunigte Verteilung erm√∂glichen.\n‚Ä¢ Aufbau von Update-Scheduling und Maintenance Window-Management f√ºr minimale Gesch√§ftsunterbrechungen.\n\nüéØ Intelligente Update-Orchestrierung:\n‚Ä¢ Implementierung von Risk-based Update-Priorisierung, die kritische Sicherheitsupdates automatisch identifiziert und priorisiert.\n‚Ä¢ Aufbau von Dependency Management-Systemen, die Update-Reihenfolgen basierend auf Komponentenabh√§ngigkeiten optimieren.\n‚Ä¢ Integration von Health Monitoring und Automated Testing, die Update-Erfolg verifizieren und Probleme fr√ºhzeitig erkennen.\n‚Ä¢ Entwicklung von User Experience-optimierter Update-Prozesse, die Benutzerunterbrechungen minimieren und Transparenz schaffen.\n‚Ä¢ Implementierung von Compliance Tracking, das Update-Status f√ºr regulatorische Berichterstattung dokumentiert.\n\nüîÑ Lifecycle-Management und Governance:\n‚Ä¢ Etablierung von Update Policy Frameworks, die Update-Frequenzen, Kritikalit√§tsstufen und Approval-Prozesse definieren.\n‚Ä¢ Aufbau von End-of-Life Management-Prozessen, die sichere Transition und Support-Beendigung f√ºr veraltete Produkte gew√§hrleisten.\n‚Ä¢ Integration von Supply Chain Update-Management, das Updates von Drittanbieter-Komponenten koordiniert und √ºberwacht.\n‚Ä¢ Entwicklung von Communication Strategies, die Benutzer √ºber verf√ºgbare Updates, Sicherheitsverbesserungen und Installation informieren.\n‚Ä¢ Implementierung von Audit Trails und Compliance Documentation, die alle Update-Aktivit√§ten f√ºr regulatorische Nachweise dokumentieren."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 8),
        question: 'Welche Dokumentations- und Nachweisf√ºhrungsanforderungen m√ºssen wir erf√ºllen, um CRA Compliance zu demonstrieren?',
        answer: "Die CRA Dokumentations- und Nachweisf√ºhrungsanforderungen bilden das R√ºckgrat der Compliance-Demonstration und erfordern systematische, umfassende und kontinuierlich aktualisierte Dokumentation aller Cybersicherheitsma√ünahmen. Diese Dokumentation muss sowohl regulatorische Anforderungen erf√ºllen als auch praktischen Nutzen f√ºr interne Prozesse und externe Audits bieten.\n\nüìã Umfassende Compliance-Dokumentation:\n‚Ä¢ Entwicklung einer EU-Konformit√§tserkl√§rung, die alle anwendbaren CRA Anforderungen auflistet und deren Erf√ºllung detailliert dokumentiert, einschlie√ülich verwendeter Standards und Bewertungsverfahren.\n‚Ä¢ Erstellung technischer Dokumentation, die Produktarchitektur, Sicherheitsma√ünahmen, Risikobewertungen und Implementierungsdetails umfassend beschreibt.\n‚Ä¢ Aufbau von Cybersicherheits-Risikobewertungsdokumentation, die systematische Analyse aller identifizierten Risiken und entsprechende Mitigation-Strategien dokumentiert.\n‚Ä¢ Implementierung von Incident Response Dokumentation, die alle Sicherheitsvorf√§lle, Reaktionsma√ünahmen und Lessons Learned systematisch erfasst.\n‚Ä¢ Entwicklung von Supply Chain Security Dokumentation, die Sicherheitsma√ünahmen aller Lieferanten und Drittanbieter-Komponenten dokumentiert.\n\nüîç Kontinuierliche √úberwachungs- und Audit-Dokumentation:\n‚Ä¢ Etablierung von Security Monitoring Logs und Audit Trails, die alle sicherheitsrelevanten Aktivit√§ten kontinuierlich dokumentieren und f√ºr forensische Analysen verf√ºgbar machen.\n‚Ä¢ Aufbau von Vulnerability Management Dokumentation, die alle identifizierten Schwachstellen, Bewertungen, Remediation-Ma√ünahmen und Verification-Ergebnisse erfasst.\n‚Ä¢ Implementierung von Change Management Dokumentation, die alle Produkt√§nderungen, Sicherheitsauswirkungen und Approval-Prozesse dokumentiert.\n‚Ä¢ Entwicklung von Training und Awareness Dokumentation, die alle Schulungsma√ünahmen, Teilnehmer und Kompetenzentwicklung nachweist.\n‚Ä¢ Aufbau von Performance Metrics Dokumentation, die kontinuierliche Messung und Verbesserung der Cybersicherheitsma√ünahmen belegt.\n\nüìä Strukturierte Dokumentations-Management-Systeme:\n‚Ä¢ Implementierung von Document Management Systemen, die Versionskontrolle, Zugriffskontrolle und Audit-Trails f√ºr alle Compliance-Dokumente gew√§hrleisten.\n‚Ä¢ Aufbau von Automated Documentation Generation, die technische Dokumentation automatisch aus Systemkonfigurationen und Code-Repositories generiert.\n‚Ä¢ Entwicklung von Cross-Reference-Systemen, die Verbindungen zwischen verschiedenen Dokumenten und Anforderungen transparent machen.\n‚Ä¢ Integration von Compliance Dashboards, die aktuellen Dokumentationsstatus und Compliance-L√ºcken visualisieren.\n‚Ä¢ Etablierung von Document Lifecycle Management, das regelm√§√üige Reviews, Updates und Archivierung von Dokumenten gew√§hrleistet.\n\nüéØ Audit-Bereitschaft und Stakeholder-Kommunikation:\n‚Ä¢ Entwicklung von Audit-Ready Documentation Packages, die alle erforderlichen Nachweise f√ºr regulatorische Pr√ºfungen strukturiert bereitstellen.\n‚Ä¢ Aufbau von Stakeholder-spezifischer Dokumentation, die verschiedene Zielgruppen mit relevanten Informationen in angemessener Detailtiefe versorgt.\n‚Ä¢ Implementierung von Multilingual Documentation Support f√ºr internationale M√§rkte und regulatorische Anforderungen.\n‚Ä¢ Entwicklung von Executive Summary Reports, die Compliance-Status und kritische Erkenntnisse f√ºr Management-Entscheidungen zusammenfassen.\n‚Ä¢ Etablierung von External Communication Protocols, die sichere und angemessene Informationsfreigabe an Beh√∂rden und Partner gew√§hrleisten."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 2 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
