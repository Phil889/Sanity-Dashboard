import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating FRTB Gap-Analyse Daten & Prozesse page with FAQs batch 3...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'frtb-gap-analyse-daten-prozesse' })
    
    if (!existingDoc) {
      throw new Error('Document "frtb-gap-analyse-daten-prozesse" not found')
    }
    
    // Create new FAQs
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: "Wie sollten Banken die Kosten-Nutzen-Analyse zwischen Standardansatz und internem Modellansatz f√ºr FRTB strukturieren?",
        answer: "Die Entscheidung zwischen Standardansatz (SA-TB) und internem Modellansatz (IMA) f√ºr FRTB stellt eine komplexe strategische Weichenstellung dar, die weit √ºber reine Compliance-√úberlegungen hinausgeht. Eine fundierte Kosten-Nutzen-Analyse erfordert eine mehrdimensionale Bewertung unter Ber√ºcksichtigung quantitativer und qualitativer Faktoren, die weit in die Zukunft des Handelsgesch√§fts reichen.\n\n‚öñÔ∏è Mehrdimensionale Bewertungskriterien f√ºr die Ansatzwahl:\n‚Ä¢ Kapitalauswirkungen: Quantitative Analyse der Kapitalunterschiede zwischen SA-TB und IMA auf Desk-, Portfolio- und Institutsebene unter verschiedenen Marktszenarien und Gesch√§ftsstrategien.\n‚Ä¢ Implementierungskosten: Detaillierte Erhebung der einmaligen Investitionskosten f√ºr Dateninfrastruktur, Systemanpassungen, Modellentwicklung und Validierung sowie Prozessimplementierung f√ºr beide Ans√§tze.\n‚Ä¢ Laufende Betriebskosten: Bewertung der fortlaufenden Kosten f√ºr Datenmanagement, Berechnung, Reporting, Modellvalidierung und aufsichtsrechtliche Prozesse im Regelbetrieb.\n‚Ä¢ Implementierungsrisiken: Analyse der Umsetzungsrisiken hinsichtlich Komplexit√§t, Ressourcenverf√ºgbarkeit, Zeitplan und m√∂glicher regulatorischer √Ñnderungen w√§hrend der Implementierungsphase.\n‚Ä¢ Gesch√§ftsstrategische Implikationen: Bewertung der Auswirkungen auf das Handelsgesch√§ft, Produktportfolio, Wettbewerbsposition und strategische Entwicklungsm√∂glichkeiten.\n\nüìä ADVISORI's strukturierter Analyse-Ansatz:\n‚Ä¢ Desk-spezifische Bewertung: Differenzierte Analyse f√ºr jeden Trading Desk, da die Kosten-Nutzen-Relation je nach Handelsaktivit√§t, Datenqualit√§t und Komplexit√§t stark variieren kann.\n‚Ä¢ Szenariobasierte Kapitalmodellierung: Berechnung der Kapitalanforderungen unter verschiedenen Marktbedingungen und Portfoliozusammensetzungen zur robusten Entscheidungsfindung.\n‚Ä¢ Stufenweise Implementierungsstrategie: Entwicklung einer phasenweisen Implementierungsstrategie, beginnend mit den Desks mit dem g√ºnstigsten Kosten-Nutzen-Verh√§ltnis f√ºr den internen Modellansatz.\n‚Ä¢ Hybride Zielarchitektur: Konzeption einer flexiblen IT- und Prozessarchitektur, die sowohl SA-TB als auch IMA unterst√ºtzt und einen nahtlosen √úbergang zwischen den Ans√§tzen erm√∂glicht.\n‚Ä¢ Kontinuierliche Neubewertung: Etablierung eines Frameworks zur regelm√§√üigen Neubewertung der Kosten-Nutzen-Relation, um auf ver√§nderte Marktbedingungen, Gesch√§ftsstrategien oder regulatorische Entwicklungen reagieren zu k√∂nnen.\n\nüîç Kritische Erfolgsfaktoren f√ºr die Entscheidungsfindung:\n‚Ä¢ Datenqualit√§tsabh√§ngigkeit: Realistische Bewertung der aktuellen Datenqualit√§t und -verf√ºgbarkeit als entscheidender Faktor f√ºr die Machbarkeit und Wirtschaftlichkeit des internen Modellansatzes.\n‚Ä¢ P&L-Attribution als Schl√ºsselkriterium: Fr√ºhzeitige Bewertung der F√§higkeit zur Erf√ºllung der strengen P&L-Attributionsanforderungen als entscheidender Indikator f√ºr die IMA-Eignung.\n‚Ä¢ Organisatorische Reife: Ber√ºcksichtigung der organisatorischen Reife und Erfahrung mit komplexen Risikomodellen als wesentlicher Faktor f√ºr eine erfolgreiche IMA-Implementierung.\n‚Ä¢ Langfristige Gesch√§ftsperspektive: Integration der langfristigen Handelsstrategien und Gesch√§ftsentwicklungspl√§ne in die Entscheidungsfindung, da die FRTB-Implementierung typischerweise einen mehrj√§hrigen Horizont hat."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: "Welche Datenqualit√§tsanforderungen stellt FRTB und wie kann ein effektives Datenqualit√§tsmanagement etabliert werden?",
        answer: "Die FRTB-Regulierung stellt au√üergew√∂hnlich hohe Anforderungen an die Datenqualit√§t, die weit √ºber bisherige regulatorische Standards hinausgehen. Die Etablierung eines robusten Datenqualit√§tsmanagements ist daher ein kritischer Erfolgsfaktor f√ºr die FRTB-Implementierung und den nachhaltigen Betrieb ‚Äì insbesondere bei Nutzung interner Modelle.\n\nüîç Spezifische Datenqualit√§tsanforderungen unter FRTB:\n‚Ä¢ Vollst√§ndigkeit und L√ºckenlosigkeit: Notwendigkeit kompletter Zeitreihen ohne L√ºcken f√ºr alle relevanten Risikofaktoren, mit spezifischen Anforderungen an die Mindestanzahl von Beobachtungen f√ºr die Modellierbarkeit.\n‚Ä¢ Genauigkeit und Pr√§zision: Hohe Anforderungen an die Exaktheit der Daten, insbesondere f√ºr die P&L-Attribution, wo bereits kleine Ungenauigkeiten zu Modellversagen f√ºhren k√∂nnen.\n‚Ä¢ Konsistenz und Integrit√§t: Erfordernis konsistenter Datendefinitionen und -behandlung √ºber verschiedene Systeme und Abteilungen hinweg, insbesondere zwischen Front Office und Risikomanagement.\n‚Ä¢ Aktualit√§t und Zeitn√§he: Strenge Anforderungen an die zeitnahe Verf√ºgbarkeit von Markt- und Positionsdaten f√ºr t√§gliche Berechnungen und Validierungen.\n‚Ä¢ Nachvollziehbarkeit und Auditierbarkeit: Umfassende Anforderungen an die Dokumentation der Datenherkunft, -transformation und -verwendung mit l√ºckenlosen Audit Trails.\n\n‚öôÔ∏è Komponenten eines effektiven FRTB-Datenqualit√§tsmanagements:\n‚Ä¢ Datenqualit√§ts-Governance: Etablierung einer klaren Governance-Struktur mit definierten Rollen und Verantwortlichkeiten f√ºr Datenqualit√§t, einschlie√ülich spezialisierter Datenqualit√§tsmanager und eines √ºbergreifenden Data Governance Boards.\n‚Ä¢ Umfassendes Metadatenmanagement: Entwicklung eines detaillierten Metadatenkatalogs, der alle FRTB-relevanten Datenelemente mit pr√§zisen Definitionen, Qualit√§tsanforderungen und Verantwortlichkeiten dokumentiert.\n‚Ä¢ Automatisierte Datenqualit√§tskontrollen: Implementation systematischer, automatisierter Kontrollen zur Pr√ºfung der Datenqualit√§t an kritischen Punkten des Datenflusses, von der Erfassung bis zur Berichterstattung.\n‚Ä¢ Integriertes Problemmanagement: Etablierung eines strukturierten Prozesses zur Identifikation, Eskalation, Behebung und Nachverfolgung von Datenqualit√§tsproblemen mit klaren SLAs und Verantwortlichkeiten.\n‚Ä¢ Kontinuierliches Monitoring: Entwicklung eines Dashboards zur laufenden √úberwachung zentraler Datenqualit√§tsmetriken mit Fr√ºhwarnsystem f√ºr potenzielle Probleme.\n\nüõ†Ô∏è ADVISORI's bew√§hrte Methodik zur Datenqualit√§tsoptimierung:\n‚Ä¢ Datenqualit√§ts-Assessment: Systematische Bewertung der bestehenden Datenqualit√§t f√ºr alle FRTB-relevanten Daten anhand regulatorischer Anforderungen und Best Practices.\n‚Ä¢ Gap-Analyse und Priorisierung: Identifikation kritischer Datenqualit√§tsl√ºcken und Priorisierung basierend auf regulatorischer Relevanz, Gesch√§ftsauswirkungen und Behebungsaufwand.\n‚Ä¢ Data Quality Target Operating Model: Entwicklung eines ganzheitlichen Zielbilds f√ºr das Datenqualit√§tsmanagement, das Prozesse, Organisation, Governance und Technologie umfasst.\n‚Ä¢ Implementierungsroadmap: Erstellung einer stufenweisen Implementierungsroadmap mit Quick Wins und langfristigen strukturellen Ma√ünahmen zur nachhaltigen Verbesserung der Datenqualit√§t.\n‚Ä¢ Toolauswahl und -implementation: Unterst√ºtzung bei der Auswahl und Implementierung geeigneter Datenqualit√§tsmanagement-Tools, die optimal zu den spezifischen FRTB-Anforderungen passen."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: "Wie kann die Integration zwischen Marktrisiko und Handelsbereichen f√ºr die FRTB-Compliance effektiv gestaltet werden?",
        answer: "Die erfolgreiche FRTB-Implementierung erfordert eine beispiellos enge Integration zwischen Marktrisikomanagement und Handelsbereichen. Diese neue Ebene der Zusammenarbeit stellt nicht nur technische und prozessuale, sondern auch erhebliche kulturelle und organisatorische Herausforderungen dar, die ein durchdachtes Integrationskonzept erfordern.\n\nüîÑ Dimensionen der Integration f√ºr FRTB-Compliance:\n‚Ä¢ Datenintegration: Harmonisierung der Marktdaten, Bewertungsmodelle und Berechnungsmethoden zwischen Handels- und Risikosystemen, um eine konsistente Basis f√ºr P&L-Attribution und Risikobewertung zu schaffen.\n‚Ä¢ Prozessintegration: Synchronisierung der t√§glichen Arbeitsabl√§ufe und Zeitpl√§ne zwischen Front Office und Risikomanagement, um zeitnahe, abgestimmte Bewertungen und Analysen zu erm√∂glichen.\n‚Ä¢ Organisatorische Integration: Schaffung √ºbergreifender Team- und Governance-Strukturen, die traditionelle Silos √ºberwinden und eine gemeinsame Verantwortung f√ºr FRTB-Compliance etablieren.\n‚Ä¢ Kulturelle Integration: Entwicklung einer gemeinsamen Sprache und eines geteilten Verst√§ndnisses zwischen H√§ndlern und Risikoexperten mit Alignment der Anreizstrukturen und Zielvereinbarungen.\n‚Ä¢ Technologische Integration: Implementierung integrierter oder nahtlos kommunizierender Systemlandschaften, die konsistente Berechnungen und Datenfl√ºsse gew√§hrleisten.\n\nüè¢ Organisatorische Gestaltungsoptionen f√ºr effektive Integration:\n‚Ä¢ Joint Centers of Excellence: Etablierung gemeinsamer Kompetenzteams aus Front Office und Risikomanagement f√ºr kritische FRTB-Funktionen wie P&L-Attribution, Modellierbarkeitsbeurteilung und Trading Desk-Definition.\n‚Ä¢ Cross-funktionale Desk-Teams: Bildung desk-spezifischer Teams mit Vertretern aus Handel, Risikomanagement und IT, die gemeinsam f√ºr die FRTB-Compliance ihres Bereichs verantwortlich sind.\n‚Ä¢ Integrierte Governance-Strukturen: Implementierung eines mehrstufigen Governance-Frameworks mit gemeinsamen Entscheidungsgremien und klaren Eskalationswegen f√ºr FRTB-spezifische Themen.\n‚Ä¢ Rotationsprogramme: Einf√ºhrung gezielter Rotationen zwischen Handel und Risikomanagement zur F√∂rderung des gegenseitigen Verst√§ndnisses und Aufbau √ºbergreifender Expertise.\n‚Ä¢ Aligned Incentive Structures: Neugestaltung der Anreizsysteme und Leistungsbewertungen, um die gemeinsame Verantwortung f√ºr FRTB-Compliance zu reflektieren und Zielkonflikte zu minimieren.\n\nüõ†Ô∏è ADVISORI's integrierter Implementierungsansatz:\n‚Ä¢ Joint Assessment Workshops: Durchf√ºhrung gemeinsamer Workshops mit Vertretern aus Front Office, Risikomanagement und IT zur Identifikation von Integrationsl√ºcken und -herausforderungen.\n‚Ä¢ Integrated Target Operating Model: Entwicklung eines ganzheitlichen Zielbilds f√ºr die integrierte Organisation mit detaillierten Rollen, Verantwortlichkeiten und Interaktionsmodellen.\n‚Ä¢ Golden Source Konzeption: Design einer konsistenten Daten- und Methodenlandschaft, die als gemeinsame Referenz f√ºr Handel und Risikomanagement dient.\n‚Ä¢ Cultural Alignment Program: Unterst√ºtzung bei der Entwicklung und Umsetzung von Ma√ünahmen zur F√∂rderung der kulturellen Konvergenz und des gegenseitigen Verst√§ndnisses.\n‚Ä¢ Change Management Begleitung: Umfassende Unterst√ºtzung bei der Implementierung der neuen Integrationsstrukturen mit gezielter Kommunikation, Schulung und Coaching der betroffenen Mitarbeiter."
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: "Wie k√∂nnen Banken die Herausforderungen bei der Modellierbarkeit von Risikofaktoren unter FRTB effektiv bew√§ltigen?",
        answer: "Die Modellierbarkeit von Risikofaktoren stellt eine der gr√∂√üten Herausforderungen bei der Implementierung des internen Modellansatzes (IMA) unter FRTB dar. Die strengen regulatorischen Kriterien f√ºr 'Real Price Observations' (RPOs) und deren Nachweis erfordern innovative Ans√§tze und strategisches Datenmanagement, um die Kapitalisierung als Non-Modellable Risk Factors (NMRFs) zu minimieren.\n\nüîç Kernherausforderungen der Risikofaktor-Modellierbarkeit:\n‚Ä¢ Strenge RPO-Kriterien: Die Anforderung von mindestens 24 'echten' Preisbeobachtungen pro Jahr mit maximal einem Monat zwischen aufeinanderfolgenden Beobachtungen f√ºr jeden Risikofaktor ist f√ºr viele weniger liquide M√§rkte kaum erf√ºllbar.\n‚Ä¢ Komplexe Nachweispflichten: Umfangreiche Dokumentationsanforderungen f√ºr jede einzelne Preisbeobachtung, einschlie√ülich Nachweis der 'Echtheit' und Marktrepr√§sentativit√§t, stellen eine massive operative Herausforderung dar.\n‚Ä¢ Hohe NMRF-Kapitalaufschl√§ge: Die Kapitalisierung nicht modellierbarer Risikofaktoren f√ºhrt typischerweise zu deutlich h√∂heren Kapitalanforderungen, was die Wirtschaftlichkeit bestimmter Handelsaktivit√§ten fundamental in Frage stellen kann.\n‚Ä¢ Volatilit√§t der Modellierbarkeit: Die dynamische Natur der Modellierbarkeit mit potenziellen monatlichen √Ñnderungen im Status von Risikofaktoren erfordert flexible Systeme und Prozesse.\n‚Ä¢ Aggregationsherausforderungen: Die Notwendigkeit, modellierbare und nicht modellierbare Risikofaktoren in einem konsistenten Rahmen zu aggregieren, stellt erhebliche methodische und technische Anforderungen.\n\n‚öôÔ∏è Strategische L√∂sungsans√§tze f√ºr Modellierbarkeitsherausforderungen:\n‚Ä¢ Risikofaktor-Optimierung: √úberpr√ºfung und Optimierung der Risikofaktor-Taxonomie zur Reduzierung der Anzahl separat zu bewertender Faktoren durch methodisch fundierte Zusammenfassung korrelierter Faktoren.\n‚Ä¢ Proxying-Frameworks: Entwicklung robuster Methoden zur Ableitung nicht direkt beobachtbarer Risikofaktoren aus modellierbaren Faktoren mit klarer Dokumentation der Zusammenh√§nge und regulatorischer Akzeptanz.\n‚Ä¢ Datenpool-Kooperationen: Teilnahme an oder Initiierung von branchenweiten Datenpool-Initiativen zur Erweiterung der verf√ºgbaren Preisbeobachtungen, insbesondere f√ºr weniger liquide M√§rkte.\n‚Ä¢ Datenlieferanten-Management: Entwicklung einer Strategie zur Optimierung externer Datenquellen und -lieferanten mit spezifischem Fokus auf die Erf√ºllung der FRTB-Modellierbarkeitsanforderungen.\n‚Ä¢ Backtesting-Optimierung: Implementation fortschrittlicher Backtesting-Methoden, die die Auswirkungen nicht modellierbarer Risikofaktoren isolieren und deren Einfluss minimieren.\n\nüõ†Ô∏è ADVISORI's umfassender Unterst√ºtzungsansatz:\n‚Ä¢ Modellierbarkeits-Assessment: Durchf√ºhrung einer detaillierten Analyse aller relevanten Risikofaktoren hinsichtlich ihrer aktuellen und potenziellen Modellierbarkeit unter FRTB-Kriterien.\n‚Ä¢ Daten-Sourcing-Strategie: Entwicklung einer optimierten Strategie zur Beschaffung und Verwaltung der ben√∂tigten Marktdaten f√ºr maximale Modellierbarkeit bei kontrollierten Kosten.\n‚Ä¢ Methodisches Framework: Konzeption eines robusten methodischen Rahmens f√ºr die konsistente Behandlung modellierbarer und nicht modellierbarer Risikofaktoren mit regulatorischer Akzeptanz.\n‚Ä¢ Prozessdesign: Entwicklung effizienter Prozesse f√ºr die kontinuierliche √úberwachung, Dokumentation und Berichterstattung zur Risikofaktor-Modellierbarkeit.\n‚Ä¢ Implementierungsunterst√ºtzung: Begleitung bei der technischen Implementierung der erforderlichen Systeme und Prozesse f√ºr das Modellierbarkeitsmanagement mit Best-Practice-Ans√§tzen aus erfolgreichen Projekten."
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQs batch 3 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
