import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Business Continuity Management ISO 27001 page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'business-continuity-management-iso-27001' })
    
    if (!existingDoc) {
      throw new Error('Document "business-continuity-management-iso-27001" not found')
    }
    
    // Create new FAQs for BCM-ISO 27001 integration fundamentals
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Wie k√∂nnen Business Continuity Management und ISO 27001 strategisch integriert werden und welche Synergien entstehen?',
        answer: "Die strategische Integration von Business Continuity Management und ISO 27001 schafft eine neue Dimension organisationaler Resilienz, die √ºber traditionelle Silo-Ans√§tze hinausgeht. Diese Konvergenz erm√∂glicht es Organisationen, Informationssicherheit und Gesch√§ftskontinuit√§t als komplement√§re Disziplinen zu verstehen, die gemeinsam eine robuste Grundlage f√ºr umfassende Risikobew√§ltigung bilden.\n\nüîó Strategische Alignment-Dimensionen:\n‚Ä¢ ISMS und BCMS teilen fundamentale Prinzipien wie risikobasierte Ans√§tze, kontinuierliche Verbesserung und stakeholder-orientierte Governance\n‚Ä¢ Beide Standards folgen der High Level Structure von ISO, was strukturelle Integration und harmonisierte Dokumentation erm√∂glicht\n‚Ä¢ Gemeinsame Risikobewertungs-Methodologien schaffen einheitliche Grundlagen f√ºr Threat Assessment und Impact Analysis\n‚Ä¢ Integrierte Governance-Strukturen reduzieren administrative Redundanzen und verbessern Entscheidungseffizienz\n‚Ä¢ Koordinierte Audit-Zyklen und Compliance-Management optimieren Ressourcenallokation und reduzieren Pr√ºfungsaufwand\n\nüí° Synergie-Potentiale und Wertsch√∂pfung:\n‚Ä¢ Information Security Incidents werden automatisch im Kontext ihrer Business Continuity Auswirkungen bewertet\n‚Ä¢ BCM-Szenarien ber√ºcksichtigen systematisch Informationssicherheits-Aspekte und Cyber-Resilienz-Anforderungen\n‚Ä¢ Gemeinsame Risk Register eliminieren Doppelarbeit und schaffen ganzheitliche Risikotransparenz\n‚Ä¢ Integrierte Incident Response Teams k√∂nnen sowohl Security-Events als auch Business Disruptions koordiniert adressieren\n‚Ä¢ Unified Recovery-Strategien ber√ºcksichtigen sowohl technische Wiederherstellung als auch Gesch√§ftsprozess-Kontinuit√§t\n\nüéØ Implementierungs-Strategien:\n‚Ä¢ Gap-Analyse zwischen bestehenden ISMS und BCMS identifiziert √úberschneidungen und Optimierungsm√∂glichkeiten\n‚Ä¢ Harmonisierte Policy-Frameworks schaffen konsistente Governance-Grundlagen f√ºr beide Disziplinen\n‚Ä¢ Cross-funktionale Teams entwickeln integrierte Prozesse und eliminieren organisatorische Silos\n‚Ä¢ Gemeinsame Training-Programme f√∂rdern ganzheitliches Verst√§ndnis von Security und Continuity\n‚Ä¢ Koordinierte Kommunikationsstrategien stellen sicher, dass alle Stakeholder die integrierten Ans√§tze verstehen und unterst√ºtzen\n\nüìä Compliance-Effizienz und Audit-Optimierung:\n‚Ä¢ Integrierte Management-Reviews reduzieren Meeting-Aufwand und verbessern strategische Entscheidungsfindung\n‚Ä¢ Harmonisierte Dokumentations-Strukturen eliminieren redundante Policies und Procedures\n‚Ä¢ Koordinierte interne Audits maximieren Pr√ºfungseffizienz und minimieren operative St√∂rungen\n‚Ä¢ Gemeinsame Corrective Action-Prozesse beschleunigen Probleml√∂sung und Verbesserungsma√ünahmen\n‚Ä¢ Unified Reporting-Dashboards bieten ganzheitliche Sicht auf Resilienz-Performance und Compliance-Status\n\nüöÄ Zukunftsorientierte Integration:\n‚Ä¢ Emerging Technologies wie KI und Machine Learning k√∂nnen f√ºr beide Disziplinen gemeinsam entwickelt und implementiert werden\n‚Ä¢ Cloud-Security und Cloud-Continuity werden als integrierte Herausforderung adressiert\n‚Ä¢ Cyber-Physical Systems erfordern koordinierte Ans√§tze f√ºr Security und Continuity\n‚Ä¢ ESG-Anforderungen werden durch integrierte Sustainability-Frameworks in beiden Standards adressiert\n‚Ä¢ Digital Transformation-Initiativen profitieren von koordinierten Security und Continuity-Strategien"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Welche ISO 27001 Annex A Controls sind besonders relevant f√ºr Business Continuity Management und wie werden sie integriert?',
        answer: "Die Integration spezifischer ISO 27001 Annex A Controls in Business Continuity Management schafft eine robuste Grundlage f√ºr ganzheitliche organisationale Resilienz. Diese Controls adressieren kritische Schnittstellen zwischen Informationssicherheit und Gesch√§ftskontinuit√§t und erm√∂glichen koordinierte Ans√§tze zur Risikobew√§ltigung.\n\nüõ°Ô∏è Kritische Security Controls f√ºr BCM:\n‚Ä¢ A.17 Information Security Aspects of Business Continuity Management bildet die direkte Br√ºcke zwischen beiden Disziplinen\n‚Ä¢ A.12 Operations Security stellt sicher, dass BCM-Prozesse selbst sicher und integer sind\n‚Ä¢ A.16 Information Security Incident Management integriert sich nahtlos in BCM-Aktivierungsprozesse\n‚Ä¢ A.18 Compliance gew√§hrleistet, dass sowohl Security als auch Continuity-Anforderungen erf√ºllt werden\n‚Ä¢ A.8 Asset Management identifiziert kritische Informationsassets f√ºr BCM-Schutzstrategien\n\nüîÑ Operational Continuity Controls:\n‚Ä¢ A.12.3 Information Backup stellt sicher, dass kritische Daten f√ºr Business Continuity verf√ºgbar bleiben\n‚Ä¢ A.12.6 Management of Technical Vulnerabilities reduziert Risiken, die sowohl Security als auch Continuity bedrohen\n‚Ä¢ A.13 Communications Security sch√ºtzt kritische Kommunikationskan√§le w√§hrend St√∂rungen\n‚Ä¢ A.14 System Acquisition, Development and Maintenance gew√§hrleistet, dass neue Systeme BCM-Anforderungen erf√ºllen\n‚Ä¢ A.15 Supplier Relationships adressiert Third-Party-Risiken f√ºr beide Disziplinen\n\nüìã Integration in BCM-Prozesse:\n‚Ä¢ Business Impact Analysis ber√ºcksichtigt systematisch Informationssicherheits-Auswirkungen von St√∂rungen\n‚Ä¢ Risk Assessment-Prozesse integrieren sowohl Security-Threats als auch Continuity-Risiken\n‚Ä¢ Recovery Strategies werden unter Ber√ºcksichtigung von Security-Anforderungen entwickelt\n‚Ä¢ Testing und Exercising-Programme validieren sowohl Continuity als auch Security-Aspekte\n‚Ä¢ Incident Response-Pl√§ne koordinieren Security-Events mit BCM-Aktivierung\n\nüéØ Spezifische Control-Implementierung:\n‚Ä¢ A.17.1.1 Planning Information Security Continuity erfordert integrierte Planung f√ºr beide Disziplinen\n‚Ä¢ A.17.1.2 Implementing Information Security Continuity stellt sicher, dass Security-Ma√ünahmen in BCM-Pl√§nen verankert sind\n‚Ä¢ A.17.1.3 Verify, Review and Evaluate Information Security Continuity etabliert kontinuierliche Verbesserung\n‚Ä¢ A.17.2.1 Availability of Information Processing Facilities gew√§hrleistet, dass kritische IT-Services kontinuierlich verf√ºgbar sind\n‚Ä¢ Diese Controls werden durch BCM-spezifische Ma√ünahmen wie RTO und RPO-Definitionen erg√§nzt\n\nüîç Monitoring und Measurement:\n‚Ä¢ Integrierte KPIs messen sowohl Security-Effectiveness als auch Continuity-Readiness\n‚Ä¢ Gemeinsame Dashboards bieten ganzheitliche Sicht auf Resilienz-Performance\n‚Ä¢ Koordinierte Reporting-Strukturen eliminieren redundante Metriken und fokussieren auf wesentliche Indikatoren\n‚Ä¢ Cross-funktionale Review-Prozesse stellen sicher, dass beide Perspektiven in Entscheidungen einflie√üen\n‚Ä¢ Trend-Analysen identifizieren emerging Risiken, die sowohl Security als auch Continuity betreffen\n\n‚ö° Incident Response Integration:\n‚Ä¢ Security Incidents werden automatisch auf BCM-Relevanz bewertet und entsprechend eskaliert\n‚Ä¢ BCM-Aktivierung ber√ºcksichtigt systematisch Security-Implikationen und Schutzma√ünahmen\n‚Ä¢ Koordinierte Communication-Strategien stellen sicher, dass sowohl Security als auch Continuity-Aspekte adressiert werden\n‚Ä¢ Post-Incident-Reviews analysieren sowohl Security-Lessons-Learned als auch Continuity-Verbesserungen\n‚Ä¢ Forensic-Aktivit√§ten werden mit BCM-Recovery-Priorit√§ten koordiniert"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Wie entwickelt man ein integriertes Risikomanagement-Framework f√ºr ISMS und BCMS?',
        answer: "Die Entwicklung eines integrierten Risikomanagement-Frameworks f√ºr ISMS und BCMS erfordert einen systematischen Ansatz, der die spezifischen Anforderungen beider Standards harmonisiert und gleichzeitig Synergien maximiert. Dieses Framework bildet das Herzst√ºck einer erfolgreichen Integration und erm√∂glicht koordinierte Risikobew√§ltigung.\n\nüéØ Framework-Architektur und Grundprinzipien:\n‚Ä¢ Unified Risk Taxonomy entwickelt gemeinsame Kategorien f√ºr Security und Continuity-Risiken\n‚Ä¢ Harmonisierte Risk Assessment-Methodologien nutzen konsistente Bewertungskriterien und Skalen\n‚Ä¢ Integrierte Risk Appetite-Statements definieren akzeptable Risikoniveaus f√ºr beide Disziplinen\n‚Ä¢ Cross-funktionale Risk Governance-Strukturen stellen sicher, dass alle Perspektiven ber√ºcksichtigt werden\n‚Ä¢ Gemeinsame Risk Register eliminieren Redundanzen und schaffen ganzheitliche Risikotransparenz\n\nüìä Risk Identification und Assessment:\n‚Ä¢ Threat Modeling ber√ºcksichtigt sowohl Cyber-Threats als auch physische und operative Risiken\n‚Ä¢ Vulnerability Assessments analysieren Schwachstellen aus Security und Continuity-Perspektive\n‚Ä¢ Business Impact Analysis integriert systematisch Informationssicherheits-Auswirkungen\n‚Ä¢ Scenario-basierte Risikobewertung entwickelt realistische St√∂rungsszenarien mit Security-Komponenten\n‚Ä¢ Interdependency-Mapping identifiziert kritische Abh√§ngigkeiten zwischen IT-Systemen und Gesch√§ftsprozessen\n\nüîÑ Risk Treatment und Mitigation:\n‚Ä¢ Koordinierte Risk Treatment-Pl√§ne adressieren sowohl Security als auch Continuity-Aspekte\n‚Ä¢ Shared Controls werden identifiziert und optimiert, um Effizienz zu maximieren\n‚Ä¢ Residual Risk-Management ber√ºcksichtigt die Wechselwirkungen zwischen verschiedenen Ma√ünahmen\n‚Ä¢ Cost-Benefit-Analysen bewerten Risk Treatment-Optionen ganzheitlich\n‚Ä¢ Risk Transfer-Strategien wie Versicherungen decken sowohl Security als auch Continuity-Risiken ab\n\nüìà Monitoring und Review-Prozesse:\n‚Ä¢ Integrierte Risk Dashboards bieten Real-time-Sicht auf kritische Risikoindikatoren\n‚Ä¢ Koordinierte Risk Reporting eliminiert redundante Berichte und fokussiert auf wesentliche Informationen\n‚Ä¢ Cross-funktionale Risk Reviews stellen sicher, dass beide Perspektiven in Entscheidungen einflie√üen\n‚Ä¢ Trend-Analysen identifizieren emerging Risiken und sich ver√§ndernde Bedrohungslandschaften\n‚Ä¢ Performance-Metriken messen die Effectiveness des integrierten Risk Management-Ansatzes\n\nüé™ Stakeholder-Integration und Communication:\n‚Ä¢ Risk Communication-Strategien stellen sicher, dass alle Stakeholder die integrierten Ans√§tze verstehen\n‚Ä¢ Executive Risk Reporting bietet Board-Level-Sicht auf ganzheitliche Risikosituation\n‚Ä¢ Training-Programme entwickeln Risk Awareness f√ºr beide Disziplinen\n‚Ä¢ Risk Culture-Initiativen f√∂rdern integriertes Risikobewusstsein in der gesamten Organisation\n‚Ä¢ Stakeholder-Feedback wird systematisch in Framework-Verbesserungen integriert\n\nüîß Technology und Tool-Integration:\n‚Ä¢ Gemeinsame Risk Management-Plattformen eliminieren Tool-Redundanzen und verbessern Effizienz\n‚Ä¢ Automated Risk Assessment-Tools ber√ºcksichtigen sowohl Security als auch Continuity-Faktoren\n‚Ä¢ Integration mit SIEM und BCM-Tools erm√∂glicht Real-time-Risk-Monitoring\n‚Ä¢ Data Analytics und Machine Learning unterst√ºtzen predictive Risk Management\n‚Ä¢ API-Integration stellt sicher, dass Risk-Daten zwischen verschiedenen Systemen flie√üen k√∂nnen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Welche Governance-Strukturen sind erforderlich f√ºr die erfolgreiche Integration von ISMS und BCMS?',
        answer: "Effektive Governance-Strukturen bilden das Fundament f√ºr die erfolgreiche Integration von ISMS und BCMS und stellen sicher, dass beide Disziplinen strategisch ausgerichtet und operativ koordiniert werden. Diese Strukturen m√ºssen sowohl die spezifischen Anforderungen jedes Standards erf√ºllen als auch Synergien zwischen beiden Bereichen maximieren.\n\nüèõÔ∏è Executive Governance und Leadership:\n‚Ä¢ Integrated Steering Committee mit Vertretern aus IT, Security, Risk Management und Business Continuity\n‚Ä¢ Chief Resilience Officer oder √§hnliche Rolle koordiniert strategische Integration beider Disziplinen\n‚Ä¢ Board-Level-Oversight stellt sicher, dass Integration als strategische Priorit√§t behandelt wird\n‚Ä¢ Executive Sponsorship gew√§hrleistet ausreichende Ressourcen und organisatorische Unterst√ºtzung\n‚Ä¢ Quarterly Executive Reviews bewerten Fortschritt und strategische Ausrichtung der Integration\n\nüìã Operational Governance-Strukturen:\n‚Ä¢ Cross-funktionale Working Groups entwickeln integrierte Policies und Procedures\n‚Ä¢ Joint Risk Committee koordiniert Risikomanagement-Aktivit√§ten f√ºr beide Standards\n‚Ä¢ Integrated Incident Response Team adressiert sowohl Security-Events als auch Business Disruptions\n‚Ä¢ Shared Service-Modelle eliminieren Redundanzen und verbessern Effizienz\n‚Ä¢ Koordinierte Change Management-Prozesse stellen sicher, dass √Ñnderungen beide Disziplinen ber√ºcksichtigen\n\nüéØ Rollen und Verantwortlichkeiten:\n‚Ä¢ Information Security Manager und Business Continuity Manager arbeiten eng zusammen und teilen Verantwortlichkeiten\n‚Ä¢ Risk Owners sind f√ºr beide Aspekte ihrer Risiken verantwortlich\n‚Ä¢ Process Owners integrieren Security und Continuity-Anforderungen in ihre Bereiche\n‚Ä¢ Audit Coordinators stellen sicher, dass beide Standards effizient gepr√ºft werden\n‚Ä¢ Training Coordinators entwickeln integrierte Awareness-Programme\n\nüìä Decision-Making und Escalation:\n‚Ä¢ Integrierte Escalation-Pfade stellen sicher, dass kritische Entscheidungen beide Perspektiven ber√ºcksichtigen\n‚Ä¢ Joint Decision-Making-Prozesse f√ºr Investitionen, die beide Bereiche betreffen\n‚Ä¢ Conflict Resolution-Mechanismen adressieren potentielle Interessenskonflikte zwischen den Disziplinen\n‚Ä¢ Priority-Setting-Frameworks balancieren Security und Continuity-Anforderungen\n‚Ä¢ Resource Allocation-Prozesse optimieren Investitionen f√ºr maximale Resilienz\n\nüîÑ Performance Management und Accountability:\n‚Ä¢ Integrierte KPIs messen Erfolg der Integration und Effectiveness beider Disziplinen\n‚Ä¢ Balanced Scorecards bieten ganzheitliche Sicht auf Resilienz-Performance\n‚Ä¢ Regular Performance Reviews bewerten sowohl individuelle als auch integrierte Leistung\n‚Ä¢ Incentive-Strukturen f√∂rdern Zusammenarbeit und gemeinsame Zielerreichung\n‚Ä¢ Continuous Improvement-Prozesse optimieren Governance-Strukturen basierend auf Erfahrungen\n\nüåê Stakeholder-Engagement und Communication:\n‚Ä¢ Stakeholder-Mapping identifiziert alle relevanten internen und externen Parteien\n‚Ä¢ Communication-Strategien stellen sicher, dass Integration transparent und verst√§ndlich kommuniziert wird\n‚Ä¢ Regular Stakeholder-Updates halten alle Beteiligten √ºber Fortschritt und √Ñnderungen informiert\n‚Ä¢ Feedback-Mechanismen erm√∂glichen kontinuierliche Verbesserung der Governance-Ans√§tze\n‚Ä¢ External Stakeholder-Management koordiniert Kommunikation mit Regulatoren, Kunden und Partnern"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
