import 'dotenv/config'
import { createClient } from '@sanity/client'

// Create client with direct credentials
const client = createClient({
  projectId: 'wwmm9rbb',
  dataset: 'production',
  apiVersion: '2024-02-14',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

// Helper function to generate unique keys
function generateKey(prefix: string, index: number): string {
  return `${prefix}_${Date.now()}_${index}`
}

const run = async () => {
  try {
    console.log('Updating Microsoft PKI page with FAQ batch 1...')
    
    // First, get the existing document
    console.log('Fetching existing document...')
    const existingDoc = await client.fetch('*[_id == $id][0]', { id: 'microsoft-pki' })
    
    if (!existingDoc) {
      throw new Error('Document "microsoft-pki" not found')
    }
    
    // Create new FAQs for Microsoft PKI fundamentals and AD CS
    const newFaqs = [
      {
        _type: 'object',
        _key: generateKey('faq', 1),
        question: 'Warum ist Active Directory Certificate Services mehr als traditionelle PKI und wie transformiert es Microsoft Enterprise-Vertrauen?',
        answer: "Active Directory Certificate Services repr√§sentiert einen paradigmatischen Wandel von isolierten PKI-Systemen zu strategisch integrierten Microsoft-Vertrauensarchitekturen. Es etabliert PKI als nativen Bestandteil der Microsoft-Infrastruktur, der nicht nur Certificate-Management erm√∂glicht, sondern auch als strategischer Enabler f√ºr Azure-Migration, Office 365-Integration und moderne Microsoft-Workplace-Transformation fungiert.\n\nüèõÔ∏è Enterprise-Integration und Domain-native PKI:\n‚Ä¢ Active Directory Certificate Services etabliert PKI als nativen Bestandteil der Windows-Domain-Infrastruktur mit nahtloser Integration in bestehende Authentifizierungs- und Autorisierungssysteme\n‚Ä¢ Domain-integrierte Certificate Templates erm√∂glichen automatisierte Certificate-Ausstellung basierend auf Active Directory-Gruppenmitgliedschaften und Benutzerattributen\n‚Ä¢ Auto-Enrollment-Funktionalit√§t gew√§hrleistet transparente Certificate-Bereitstellung ohne Benutzerinteraktion f√ºr Workstations, Server und Benutzer\n‚Ä¢ Group Policy-Integration erm√∂glicht zentrale Verwaltung von Certificate-Richtlinien und automatische Verteilung von Root-Zertifikaten\n‚Ä¢ Multi-Forest-Unterst√ºtzung erweitert PKI-Vertrauen √ºber komplexe Enterprise-Topologien hinweg\n\nüîê Enterprise Root CA und Hierarchie-Design:\n‚Ä¢ Enterprise Root CA-Implementierung schafft vertrauensvolle Grundlage f√ºr alle Microsoft-Services mit optimaler Integration in Windows Certificate Stores\n‚Ä¢ Subordinate CA-Hierarchien erm√∂glichen granulare Kontrolle und Delegation von Certificate-Ausstellungsrechten an verschiedene Organisationseinheiten\n‚Ä¢ Certificate Revocation List-Optimierung und Online Certificate Status Protocol-Implementation gew√§hrleisten Echtzeit-Validierung von Certificate-Status\n‚Ä¢ Cross-Certification-F√§higkeiten erm√∂glichen Vertrauen zwischen verschiedenen PKI-Hierarchien und externen Certificate Authorities\n‚Ä¢ Hardware Security Module-Integration sch√ºtzt kritische CA-Schl√ºssel mit h√∂chsten Sicherheitsstandards\n\nüåê Microsoft Ecosystem-Harmonisierung:\n‚Ä¢ Nahtlose Integration mit Office 365 erm√∂glicht S/MIME-Verschl√ºsselung, digitale Signaturen und sichere E-Mail-Kommunikation\n‚Ä¢ SharePoint-Integration unterst√ºtzt Document Protection, digitale Workflows und sichere Collaboration-Szenarien\n‚Ä¢ Exchange Server-Integration erm√∂glicht Certificate-basierte Authentifizierung und verschl√ºsselte Messaging-Infrastrukturen\n‚Ä¢ Microsoft Teams-Integration schafft sichere Kommunikationskan√§le mit Certificate-basierter Identit√§tsvalidierung\n‚Ä¢ System Center-Integration erm√∂glicht umfassendes Monitoring und Management von Certificate-Lifecycles\n\nüíº Business Value und strategische Vorteile:\n‚Ä¢ Signifikante Kosteneinsparungen durch Eliminierung externer Certificate Authority-Abh√§ngigkeiten f√ºr interne Anwendungen\n‚Ä¢ Beschleunigte Deployment-Zyklen durch automatisierte Certificate-Bereitstellung in DevOps-Pipelines\n‚Ä¢ Verbesserte Compliance-Posture durch integrierte Audit-Trails und automatisierte Reporting-Funktionen\n‚Ä¢ Erh√∂hte Sicherheit durch Certificate-basierte Authentifizierung f√ºr kritische Anwendungen und Services\n‚Ä¢ Strategische Flexibilit√§t f√ºr Hybrid Cloud-Szenarien mit einheitlicher PKI-Governance\n\nüöÄ Innovation und Future-Readiness:\n‚Ä¢ Azure Active Directory-Integration erm√∂glicht Hybrid Identity-Szenarien mit einheitlicher Certificate-Verwaltung\n‚Ä¢ PowerShell-Automation unterst√ºtzt Infrastructure as Code-Ans√§tze f√ºr PKI-Management\n‚Ä¢ REST API-Integration erm√∂glicht moderne Anwendungsintegration und DevOps-Workflows\n‚Ä¢ Container-Unterst√ºtzung f√ºr moderne Anwendungsarchitekturen mit dynamischer Certificate-Bereitstellung\n‚Ä¢ Quantum-ready Cryptography-Vorbereitung f√ºr zuk√ºnftige Sicherheitsanforderungen"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 2),
        question: 'Wie funktioniert Microsoft Certificate Template-Management und warum ist es gesch√§ftskritisch f√ºr Enterprise-Skalierung?',
        answer: "Microsoft Certificate Template-Management transformiert statische Certificate-Konfigurationen in dynamische, policy-gesteuerte Systeme, die automatisch auf Gesch√§ftsanforderungen reagieren. Es eliminiert nicht nur manuelle Certificate-Verwaltung, sondern schafft auch strategische Vorteile durch konsistente Sicherheitsrichtlinien, automatisierte Compliance und nahtlose Skalierung f√ºr wachsende Microsoft-Infrastrukturen.\n\nüìã Template-basierte Certificate-Governance:\n‚Ä¢ Certificate Templates definieren einheitliche Sicherheitsrichtlinien und Verwendungszwecke f√ºr verschiedene Certificate-Typen mit granularer Kontrolle √ºber Schl√ºssell√§ngen, G√ºltigkeitsdauern und Verwendungseinschr√§nkungen\n‚Ä¢ Version-Management erm√∂glicht kontrollierte Evolution von Certificate-Richtlinien ohne Unterbrechung bestehender Services\n‚Ä¢ Permission-basierte Template-Zugriffe gew√§hrleisten, dass nur autorisierte Benutzer und Systeme spezifische Certificate-Typen anfordern k√∂nnen\n‚Ä¢ Custom Object Identifier-Unterst√ºtzung erm√∂glicht organisationsspezifische Certificate-Extensions und Compliance-Anforderungen\n‚Ä¢ Template-Inheritance-Mechanismen vereinfachen Management komplexer Certificate-Hierarchien\n\nü§ñ Auto-Enrollment und Policy-Automation:\n‚Ä¢ Group Policy-gesteuerte Auto-Enrollment-Konfiguration erm√∂glicht transparente Certificate-Bereitstellung basierend auf Benutzer- und Computer-Gruppenmitgliedschaften\n‚Ä¢ Conditional Access-Integration gew√§hrleistet, dass Certificate-Ausstellung nur unter definierten Sicherheitsbedingungen erfolgt\n‚Ä¢ Automatic Certificate Request-Processing eliminiert manuelle Genehmigungsworkflows f√ºr Routine-Certificate-Anfragen\n‚Ä¢ Certificate Renewal-Automation verhindert Service-Unterbrechungen durch abgelaufene Certificates\n‚Ä¢ Intelligent Certificate Distribution stellt sicher, dass Certificates automatisch in relevante Certificate Stores installiert werden\n\nüîÑ Lifecycle-Management und Renewal-Strategien:\n‚Ä¢ Proactive Certificate Renewal-Benachrichtigungen informieren Administratoren und Anwendungsbesitzer rechtzeitig √ºber anstehende Certificate-Abl√§ufe\n‚Ä¢ Automated Renewal-Workflows koordinieren Certificate-Updates mit Anwendungs-Deployments und Service-Restarts\n‚Ä¢ Certificate Archival-Policies gew√§hrleisten langfristige Verf√ºgbarkeit historischer Certificates f√ºr Compliance und Forensik\n‚Ä¢ Emergency Certificate Replacement-Prozesse erm√∂glichen schnelle Reaktion auf Sicherheitsvorf√§lle oder Kompromittierungen\n‚Ä¢ Certificate Usage Analytics identifizieren ungenutzte oder redundante Certificates f√ºr Optimierung\n\nüõ°Ô∏è Security und Compliance-Integration:\n‚Ä¢ Template-basierte Security Policies gew√§hrleisten konsistente Anwendung von Sicherheitsstandards √ºber alle Certificate-Typen hinweg\n‚Ä¢ Audit Trail-Integration dokumentiert alle Certificate-Template-√Ñnderungen und -Verwendungen f√ºr Compliance-Nachweise\n‚Ä¢ Role-based Access Control f√ºr Template-Management gew√§hrleistet, dass nur autorisierte Administratoren Certificate-Richtlinien √§ndern k√∂nnen\n‚Ä¢ Certificate Transparency-Integration erm√∂glicht Monitoring und Validierung ausgestellter Certificates\n‚Ä¢ Compliance Reporting-Automation generiert regelm√§√üige Berichte √ºber Certificate-Template-Verwendung und Sicherheitsstatus\n\nüìä Enterprise-Skalierung und Performance-Optimierung:\n‚Ä¢ Template-Caching-Mechanismen optimieren Certificate-Ausstellungsperformance in gro√üen Enterprise-Umgebungen\n‚Ä¢ Load Balancing zwischen mehreren Certificate Authorities gew√§hrleistet hohe Verf√ºgbarkeit und Skalierbarkeit\n‚Ä¢ Geographic Distribution von Certificate Templates erm√∂glicht lokale Certificate-Ausstellung in globalen Organisationen\n‚Ä¢ Capacity Planning-Tools prognostizieren Certificate-Anforderungen basierend auf Template-Verwendungsmustern\n‚Ä¢ Performance Monitoring identifiziert Engp√§sse und Optimierungspotenziale in Template-Processing-Workflows"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 3),
        question: 'Welche Rolle spielt Certificate Revocation List-Management in modernen Microsoft PKI-Architekturen und wie gew√§hrleistet es Enterprise-Sicherheit?',
        answer: "Certificate Revocation List-Management bildet das kritische Sicherheitsfundament f√ºr Microsoft PKI-Architekturen, das nicht nur kompromittierte Certificates identifiziert, sondern auch als strategisches Sicherheitsinstrument f√ºr Incident Response, Compliance-Enforcement und Trust-Management fungiert. Es transformiert statische Certificate-Validierung in dynamische, Echtzeit-Sicherheitssysteme, die proaktiv auf Bedrohungen reagieren.\n\nüîç CRL-Distribution und Availability-Management:\n‚Ä¢ Certificate Revocation List-Distribution-Points gew√§hrleisten hochverf√ºgbare und skalierbare Bereitstellung von Revocation-Informationen √ºber Content Delivery Networks und lokale Caching-Systeme\n‚Ä¢ Delta CRL-Mechanismen optimieren Netzwerk-Traffic und Update-Performance durch inkrementelle Revocation-Updates\n‚Ä¢ CRL Publication-Scheduling koordiniert Revocation-Updates mit Gesch√§ftsanforderungen und minimiert Performance-Impact\n‚Ä¢ Geographic CRL Distribution erm√∂glicht lokale Revocation-Validierung in globalen Enterprise-Umgebungen\n‚Ä¢ Offline CRL-Caching gew√§hrleistet Certificate-Validierung auch bei tempor√§ren Netzwerkunterbrechungen\n\n‚ö° Online Certificate Status Protocol-Implementation:\n‚Ä¢ OCSP Responder-Services erm√∂glichen Echtzeit-Certificate-Status-Validierung mit minimaler Latenz und optimaler User Experience\n‚Ä¢ OCSP Stapling-Integration reduziert Client-Server-Roundtrips und verbessert SSL/TLS-Performance erheblich\n‚Ä¢ High Availability OCSP-Clustering gew√§hrleistet kontinuierliche Certificate-Validierung auch bei Server-Ausf√§llen\n‚Ä¢ OCSP Response Caching optimiert Performance und reduziert Load auf Certificate Authority-Infrastrukturen\n‚Ä¢ OCSP Security Extensions sch√ºtzen Revocation-Responses vor Manipulation und Man-in-the-Middle-Angriffen\n\nüö® Emergency Revocation und Incident Response:\n‚Ä¢ Emergency Certificate Revocation-Prozesse erm√∂glichen sofortige Deaktivierung kompromittierter Certificates mit automatischer Benachrichtigung betroffener Systeme\n‚Ä¢ Automated Threat Response-Integration koordiniert Certificate-Revocation mit Security Information and Event Management-Systemen\n‚Ä¢ Bulk Revocation-Capabilities erm√∂glichen schnelle Reaktion auf Massenkomprommittierungen oder Sicherheitsvorf√§lle\n‚Ä¢ Revocation Reason Codes dokumentieren Ursachen f√ºr Certificate-Revocations f√ºr Forensik und Compliance-Zwecke\n‚Ä¢ Recovery Procedures definieren strukturierte Prozesse f√ºr Certificate-Wiederherstellung nach False-Positive-Revocations\n\nüìä Monitoring und Analytics-Integration:\n‚Ä¢ Real-time Revocation Monitoring √ºberwacht CRL-Distribution-Performance und identifiziert potenzielle Verf√ºgbarkeitsprobleme proaktiv\n‚Ä¢ Revocation Pattern Analysis identifiziert ungew√∂hnliche Revocation-Aktivit√§ten, die auf Sicherheitsvorf√§lle hindeuten k√∂nnten\n‚Ä¢ Certificate Lifecycle Analytics korrelieren Revocation-Daten mit Certificate-Ausstellungsmustern f√ºr Optimierungsempfehlungen\n‚Ä¢ Compliance Reporting-Automation generiert detaillierte Berichte √ºber Revocation-Aktivit√§ten f√ºr regulatorische Anforderungen\n‚Ä¢ Performance Metrics-Tracking misst CRL-Distribution-Effizienz und OCSP-Response-Zeiten kontinuierlich\n\nüîó Enterprise-Integration und Automation:\n‚Ä¢ Active Directory-Integration erm√∂glicht automatische Certificate-Revocation basierend auf Benutzer- oder Computer-Account-√Ñnderungen\n‚Ä¢ PowerShell-Automation unterst√ºtzt skriptbasierte Revocation-Workflows und Integration in DevOps-Pipelines\n‚Ä¢ REST API-Integration erm√∂glicht programmatische Certificate-Revocation durch Anwendungen und Monitoring-Systeme\n‚Ä¢ System Center-Integration koordiniert Certificate-Revocation mit Configuration Management und Change Control-Prozessen\n‚Ä¢ Azure Integration erm√∂glicht Hybrid Cloud-Revocation-Management mit einheitlicher Governance √ºber On-Premises und Cloud-Certificates"
      },
      {
        _type: 'object',
        _key: generateKey('faq', 4),
        question: 'Wie gew√§hrleistet Multi-Forest AD CS-Integration nahtlose PKI-Governance in komplexen Microsoft Enterprise-Topologien?',
        answer: "Multi-Forest AD CS-Integration transformiert fragmentierte PKI-Landschaften in koh√§rente, enterprise-weite Vertrauensarchitekturen, die komplexe Organisationsstrukturen, Merger & Acquisitions-Szenarien und globale Gesch√§ftsanforderungen optimal unterst√ºtzen. Es etabliert PKI als strategisches Governance-Instrument, das nicht nur technische Integration erm√∂glicht, sondern auch als Business-Enabler f√ºr organisatorische Flexibilit√§t und Wachstum fungiert.\n\nüå≥ Cross-Forest Trust und Certificate-Hierarchien:\n‚Ä¢ Cross-Forest Certificate Trust-Relationships etablieren sichere PKI-Verbindungen zwischen verschiedenen Active Directory-Forests mit granularer Kontrolle √ºber Vertrauensebenen und Certificate-Verwendung\n‚Ä¢ Qualified Subordination erm√∂glicht kontrollierte Certificate-Ausstellung zwischen verschiedenen Organizational Units und Forests\n‚Ä¢ Certificate Chain Validation-Optimierung gew√§hrleistet effiziente Trust Path-Discovery √ºber komplexe Multi-Forest-Topologien\n‚Ä¢ Cross-Forest Certificate Template-Sharing erm√∂glicht einheitliche Certificate-Richtlinien √ºber Organizational Boundaries hinweg\n‚Ä¢ Trust Anchor-Management koordiniert Root Certificate-Distribution und -Validierung zwischen verschiedenen Forest-Infrastrukturen\n\nüîó Enterprise PKI-Bridging und Interoperability:\n‚Ä¢ PKI Bridge-Architekturen verbinden verschiedene Certificate Authority-Hierarchien mit einheitlicher Trust-Governance und Policy-Enforcement\n‚Ä¢ Certificate Policy Mapping erm√∂glicht Translation zwischen verschiedenen Certificate-Standards und Verwendungsrichtlinien\n‚Ä¢ Cross-Certification-Workflows automatisieren Vertrauensbeziehungen zwischen verschiedenen PKI-Domains\n‚Ä¢ Certificate Path Validation-Optimierung reduziert Latenz und verbessert Performance bei Cross-Forest-Certificate-Validierung\n‚Ä¢ Unified Certificate Repository-Integration erm√∂glicht zentrale Certificate-Discovery √ºber alle Forest-Boundaries hinweg\n\nüè¢ Organizational Flexibility und M&A-Support:\n‚Ä¢ Merger & Acquisition PKI-Integration unterst√ºtzt schnelle und sichere Verbindung neu erworbener Organisationen mit bestehenden PKI-Infrastrukturen\n‚Ä¢ Organizational Unit-basierte Certificate-Delegation erm√∂glicht autonome PKI-Verwaltung f√ºr verschiedene Gesch√§ftsbereiche\n‚Ä¢ Flexible Trust Policies unterst√ºtzen verschiedene Sicherheitsanforderungen und Compliance-Standards zwischen Organizational Units\n‚Ä¢ Certificate Migration-Tools erm√∂glichen nahtlose √úbertragung von Certificates zwischen verschiedenen Forest-Umgebungen\n‚Ä¢ Gradual Integration-Strategien unterst√ºtzen phasenweise PKI-Konsolidierung ohne Service-Unterbrechungen\n\nüåê Global Enterprise-Skalierung:\n‚Ä¢ Geographic Forest Distribution erm√∂glicht lokale PKI-Services mit globaler Trust-Governance und einheitlichen Sicherheitsrichtlinien\n‚Ä¢ Regional Certificate Authority-Deployment optimiert Certificate-Ausstellungsperformance und reduziert WAN-Traffic\n‚Ä¢ Time Zone-aware Certificate-Management koordiniert Certificate-Lifecycles √ºber verschiedene geografische Regionen\n‚Ä¢ Disaster Recovery-Integration gew√§hrleistet PKI-Kontinuit√§t auch bei regionalen Ausf√§llen oder Katastrophen\n‚Ä¢ Compliance Boundary-Management unterst√ºtzt verschiedene regulatorische Anforderungen in verschiedenen Jurisdiktionen\n\n‚öôÔ∏è Management und Operational Excellence:\n‚Ä¢ Centralized PKI-Management-Konsolen erm√∂glichen einheitliche Verwaltung von Multi-Forest-PKI-Infrastrukturen\n‚Ä¢ Cross-Forest Certificate-Monitoring √ºberwacht Certificate-Health und -Performance √ºber alle Forest-Boundaries hinweg\n‚Ä¢ Unified Reporting-Systeme aggregieren PKI-Metriken und Compliance-Daten aus verschiedenen Forest-Umgebungen\n‚Ä¢ Automated Certificate-Lifecycle-Management koordiniert Certificate-Operations √ºber komplexe Multi-Forest-Topologien\n‚Ä¢ Performance Optimization-Tools identifizieren und beheben Engp√§sse in Cross-Forest-Certificate-Workflows"
      }
    ]
    
    // Update the document with new FAQs
    const updatedFaqs = [...(existingDoc.faq || []), ...newFaqs]
    
    console.log(`Adding ${newFaqs.length} new FAQs to the document...`)
    const transaction = client.transaction()
    transaction.patch(existingDoc._id, {
      set: {
        faq: updatedFaqs
      }
    })
    
    await transaction.commit()
    console.log('‚úÖ FAQ batch 1 added successfully')
  } catch (error) {
    console.error('Error:', error)
    throw error
  }
}

run()
